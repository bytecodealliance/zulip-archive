[
    {
        "content": "<p>jeffcharles opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>Any Wasm module.</p>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">engine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Engine</span><span class=\"p\">::</span><span class=\"n\">default</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"p\">::</span><span class=\"n\">from_file</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"testcase.wasm\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"p\">.</span><span class=\"n\">image_range</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">offset</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">unsafe</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">.</span><span class=\"n\">offset_from</span><span class=\"p\">(</span><span class=\"n\">range</span><span class=\"p\">.</span><span class=\"n\">start</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">};</span>\n<span class=\"w\">    </span><span class=\"fm\">println!</span><span class=\"p\">(</span><span class=\"s\">\"Offset is {offset}\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p><a href=\"https://docs.wasmtime.dev/api/wasmtime/struct.Module.html#method.image_range\">The documentation for the method</a> says:</p>\n<blockquote>\n<p>Returns the range of bytes in memory where this module’s compilation image resides.</p>\n<p>The compilation image for a module contains executable code, data, debug information, etc. This is roughly the same as the Module::serialize but not the exact same.</p>\n</blockquote>\n<p>I was expecting the range to contain the bytes that contain all of the compilation image.</p>\n<h3>Actual Results</h3>\n<p>The range contains the bytes for the executable code but no longer includes data, debug information, or any other parts of the compilation image.</p>\n<p>The source code for the method appears to only retrieve the text section.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: Wasmtime 40.0.0</p>\n<p>Operating system: All</p>\n<p>Architecture: All</p>\n<h3>Extra Info</h3>\n<p>We're using the <code>image_size</code> API in wasmtime-rb to inform the Ruby garbage collector about the size of the memory used for the anonymous mmap when creating a module.</p>\n<p>It looks like the change in implementation was introduced <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12051/changes#diff-ecf07886113ffb74af3125fb7d286276bcc8c81f6b2113a9439d1ca3807e9e59R975\">here on line 975</a>.</p>\n</blockquote>",
        "id": 566967569,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767885430
    },
    {
        "content": "<p><a href=\"https://github.com/jeffcharles\">jeffcharles</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">Issue #12284</a>.</p>",
        "id": 566967571,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767885431
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284#issuecomment-3726687696\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<p>Thanks for the report and for the bisection! cc @cfallin when you get back would you be willing to take a look at this?</p>\n</blockquote>",
        "id": 567060019,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767922803
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284#issuecomment-3727751278\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<p>Yep, just sent a PR -- sorry and thanks for the heads-up!</p>\n</blockquote>",
        "id": 567091113,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767947254
    },
    {
        "content": "<p>cfallin closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>Any Wasm module.</p>\n<h3>Steps to Reproduce</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">engine</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Engine</span><span class=\"p\">::</span><span class=\"n\">default</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"p\">::</span><span class=\"n\">from_file</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">engine</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"testcase.wasm\"</span><span class=\"p\">).</span><span class=\"n\">unwrap</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"p\">.</span><span class=\"n\">image_range</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">offset</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">unsafe</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">.</span><span class=\"n\">offset_from</span><span class=\"p\">(</span><span class=\"n\">range</span><span class=\"p\">.</span><span class=\"n\">start</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">};</span>\n<span class=\"w\">    </span><span class=\"fm\">println!</span><span class=\"p\">(</span><span class=\"s\">\"Offset is {offset}\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p><a href=\"https://docs.wasmtime.dev/api/wasmtime/struct.Module.html#method.image_range\">The documentation for the method</a> says:</p>\n<blockquote>\n<p>Returns the range of bytes in memory where this module’s compilation image resides.</p>\n<p>The compilation image for a module contains executable code, data, debug information, etc. This is roughly the same as the Module::serialize but not the exact same.</p>\n</blockquote>\n<p>I was expecting the range to contain the bytes that contain all of the compilation image.</p>\n<h3>Actual Results</h3>\n<p>The range contains the bytes for the executable code but no longer includes data, debug information, or any other parts of the compilation image.</p>\n<p>The source code for the method appears to only retrieve the text section.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: Wasmtime 40.0.0</p>\n<p>Operating system: All</p>\n<p>Architecture: All</p>\n<h3>Extra Info</h3>\n<p>We're using the <code>image_size</code> API in wasmtime-rb to inform the Ruby garbage collector about the size of the memory used for the anonymous mmap when creating a module.</p>\n<p>It looks like the change in implementation was introduced <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12051/changes#diff-ecf07886113ffb74af3125fb7d286276bcc8c81f6b2113a9439d1ca3807e9e59R975\">here on line 975</a>.</p>\n</blockquote>",
        "id": 567248614,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767986974
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284#issuecomment-3730384397\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<p>@jeffcharles would you be ok waiting for the 41.0.0 release in ~11 days, or would you prefer a 40.0.2 release with this fix?</p>\n</blockquote>",
        "id": 567253006,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767988636
    },
    {
        "content": "<p>jeffcharles <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284#issuecomment-3730434656\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12284\">issue #12284</a>:</p>\n<blockquote>\n<p>I'm okay with waiting. We don't have anyone pressing us for the version 40 release of wasmtime-rb at the moment so we can probably just wait and cut a release for version 41.</p>\n</blockquote>",
        "id": 567255531,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767989678
    }
]