[
    {
        "content": "<p><a href=\"https://github.com/weijinjinnihao\">weijinjinnihao</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">Issue #12401</a>.</p>",
        "id": 569643551,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769149729
    },
    {
        "content": "<p>weijinjinnihao opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">issue #12401</a>:</p>\n<blockquote>\n<h1>Bug Report</h1>\n<h2>Describe the Bug</h2>\n<p>Executing a spec-conformant WebAssembly module (<code>file134.wasm</code>) in Wasmtime v40.0.0 consistently triggers a panic in the Cranelift backend during compilation.</p>\n<p>The module passes <code>wasm-tools validate</code> without any errors, but Wasmtime aborts with an internal <code>unimplemented for &gt; 64 bits</code> panic during the optimization phase, leading to immediate process termination.</p>\n<p>This crash does not occur in other WebAssembly engines (Wasmer, WasmEdge, WAMR), suggesting an engine-specific bug in Wasmtime/Cranelift.</p>\n<p>The issue represents a compiler crash on valid input and can be exploited to cause denial-of-service in Wasmtime-based deployments.</p>\n<h2>Key Insight from Dump File</h2>\n<ul>\n<li>\n<p>We provide an attached disassembly dump (<code>file134.dump</code>) generated by <code>wasm-tools</code> for detailed inspection.</p>\n</li>\n<li>\n<p>Based on the dump file, we verified that:</p>\n<ul>\n<li>All memory accesses are within declared bounds.</li>\n<li>All data segments are placed within the allocated linear memory.</li>\n<li>No obvious out-of-bounds memory or malformed section layout is present.</li>\n</ul>\n</li>\n<li>\n<p>Despite the absence of memory or data section violations, the dump reveals instruction patterns that still trigger an internal Cranelift optimization path leading to the panic:<br>\n<code>\n    unimplemented for &gt; 64 bits\n    </code></p>\n</li>\n<li>\n<p>This indicates that the crash is not caused by malformed memory layout or invalid data segments, but by an <strong>unhandled or missing implementation path in Cranelift’s optimization pipeline</strong>, likely related to wide integer or SIMD-related lowering.</p>\n</li>\n<li>\n<p>Differential testing further confirms this as an engine-specific issue:</p>\n</li>\n<li>wasmtime: <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span> panic</li>\n<li>wasmer: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n<li>wasmedge: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n<li>wamr: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n</ul>\n<p>This strongly suggests a compiler bug in Wasmtime/Cranelift triggered by a valid instruction pattern, rather than by out-of-bounds memory, malformed sections, or undefined behavior in the input module.</p>\n<h2>To Reproduce</h2>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">v40</span><span class=\"p\">.</span><span class=\"mf\">0.0</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">file134</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">main</span>\n</code></pre></div>\n<ul>\n<li>This issue was not discovered via cargo fuzz.</li>\n</ul>\n<h2>Desktop Environment</h2>\n<ul>\n<li>OS and Version: Linux (Ubuntu 24.04.2 LTS)</li>\n<li>Wasmtime Version and Source: <br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/releases/download/v40.0.0/wasmtime-v40.0.0-x86_64-linux.tar.xz\">https://github.com/bytecodealliance/wasmtime/releases/download/v40.0.0/wasmtime-v40.0.0-x86_64-linux.tar.xz</a></li>\n</ul>\n<h2>Stack trace or other relevant details</h2>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">1307851</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">cranelift</span><span class=\"o\">/</span><span class=\"n\">codegen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">opts</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">191</span><span class=\"p\">:</span><span class=\"mi\">5</span><span class=\"p\">:</span>\n<span class=\"nc\">unimplemented</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">64</span><span class=\"w\"> </span><span class=\"n\">bits</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">__rustc</span><span class=\"p\">::</span><span class=\"n\">rust_begin_unwind</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic_fmt</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">option</span><span class=\"p\">::</span><span class=\"n\">expect_failed</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">cranelift_codegen</span><span class=\"p\">::</span><span class=\"n\">opts</span><span class=\"p\">::</span><span class=\"n\">generated_code</span><span class=\"p\">::</span><span class=\"n\">constructor_iconst_u</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"w\"> </span><span class=\"nc\">details</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">omitted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"n\">full</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">verbose</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">.</span>\n<span class=\"n\">Aborted</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/24814532/wasmtime_panic_file134.zip\">wasmtime_panic_file134.zip</a></p>\n</blockquote>",
        "id": 569643552,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769149729
    },
    {
        "content": "<p><a href=\"https://github.com/weijinjinnihao\">weijinjinnihao</a> added the fuzz-bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">Issue #12401</a>.</p>",
        "id": 569643558,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769149730
    },
    {
        "content": "<p>tschneidereit closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">issue #12401</a>:</p>\n<blockquote>\n<h1>Bug Report</h1>\n<h2>Describe the Bug</h2>\n<p>Executing a spec-conformant WebAssembly module (<code>file134.wasm</code>) in Wasmtime v40.0.0 consistently triggers a panic in the Cranelift backend during compilation.</p>\n<p>The module passes <code>wasm-tools validate</code> without any errors, but Wasmtime aborts with an internal <code>unimplemented for &gt; 64 bits</code> panic during the optimization phase, leading to immediate process termination.</p>\n<p>This crash does not occur in other WebAssembly engines (Wasmer, WasmEdge, WAMR), suggesting an engine-specific bug in Wasmtime/Cranelift.</p>\n<p>The issue represents a compiler crash on valid input and can be exploited to cause denial-of-service in Wasmtime-based deployments.</p>\n<h2>Key Insight from Dump File</h2>\n<ul>\n<li>\n<p>We provide an attached disassembly dump (<code>file134.dump</code>) generated by <code>wasm-tools</code> for detailed inspection.</p>\n</li>\n<li>\n<p>Based on the dump file, we verified that:</p>\n<ul>\n<li>All memory accesses are within declared bounds.</li>\n<li>All data segments are placed within the allocated linear memory.</li>\n<li>No obvious out-of-bounds memory or malformed section layout is present.</li>\n</ul>\n</li>\n<li>\n<p>Despite the absence of memory or data section violations, the dump reveals instruction patterns that still trigger an internal Cranelift optimization path leading to the panic:<br>\n<code>\n    unimplemented for &gt; 64 bits\n    </code></p>\n</li>\n<li>\n<p>This indicates that the crash is not caused by malformed memory layout or invalid data segments, but by an <strong>unhandled or missing implementation path in Cranelift’s optimization pipeline</strong>, likely related to wide integer or SIMD-related lowering.</p>\n</li>\n<li>\n<p>Differential testing further confirms this as an engine-specific issue:</p>\n</li>\n<li>wasmtime: <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span> panic</li>\n<li>wasmer: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n<li>wasmedge: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n<li>wamr: <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> runs without crash</li>\n</ul>\n<p>This strongly suggests a compiler bug in Wasmtime/Cranelift triggered by a valid instruction pattern, rather than by out-of-bounds memory, malformed sections, or undefined behavior in the input module.</p>\n<h2>To Reproduce</h2>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">wasmtime</span><span class=\"o\">-</span><span class=\"n\">v40</span><span class=\"p\">.</span><span class=\"mf\">0.0</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">file134</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">main</span>\n</code></pre></div>\n<ul>\n<li>This issue was not discovered via cargo fuzz.</li>\n</ul>\n<h2>Desktop Environment</h2>\n<ul>\n<li>OS and Version: Linux (Ubuntu 24.04.2 LTS)</li>\n<li>Wasmtime Version and Source: <br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/releases/download/v40.0.0/wasmtime-v40.0.0-x86_64-linux.tar.xz\">https://github.com/bytecodealliance/wasmtime/releases/download/v40.0.0/wasmtime-v40.0.0-x86_64-linux.tar.xz</a></li>\n</ul>\n<h2>Stack trace or other relevant details</h2>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">1307851</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">cranelift</span><span class=\"o\">/</span><span class=\"n\">codegen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">opts</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">191</span><span class=\"p\">:</span><span class=\"mi\">5</span><span class=\"p\">:</span>\n<span class=\"nc\">unimplemented</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">64</span><span class=\"w\"> </span><span class=\"n\">bits</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">__rustc</span><span class=\"p\">::</span><span class=\"n\">rust_begin_unwind</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic_fmt</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">option</span><span class=\"p\">::</span><span class=\"n\">expect_failed</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">cranelift_codegen</span><span class=\"p\">::</span><span class=\"n\">opts</span><span class=\"p\">::</span><span class=\"n\">generated_code</span><span class=\"p\">::</span><span class=\"n\">constructor_iconst_u</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"w\"> </span><span class=\"nc\">details</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">omitted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"n\">full</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">verbose</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">.</span>\n<span class=\"n\">Aborted</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span>\n</code></pre></div>\n<p><a href=\"https://github.com/user-attachments/files/24814532/wasmtime_panic_file134.zip\">wasmtime_panic_file134.zip</a></p>\n</blockquote>",
        "id": 569666190,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769159333
    },
    {
        "content": "<p>tschneidereit <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401#issuecomment-3789183725\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">issue #12401</a>:</p>\n<blockquote>\n<p>This is a duplicate of #12170, and I confirmed that it reproduces in <code>v40.0.0</code> and is fixed in <code>v40.0.2</code> and onward.</p>\n<p>On a related note, it's clear that you used an LLM to generate this report. We don't have any rules against doing so, and appreciate reports of real issues. This clearly is a real issue, but it has was fixed before the report. Please ensure that, however exactly you discover issues, you always check whether the issue reproduces with the latest supported releases.</p>\n</blockquote>",
        "id": 569666197,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769159334
    },
    {
        "content": "<p>weijinjinnihao <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401#issuecomment-3789790327\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12401\">issue #12401</a>:</p>\n<blockquote>\n<p>Ok, thank you for your response.<br>\n</p>\n</blockquote>",
        "id": 569691827,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769167251
    }
]