[
    {
        "content": "<p>dicej opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a> from <code>dicej:cm-async-plumbing</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This pulls in the latest Component Model async ABI code from the<br>\n<code>wasip3-prototyping</code> repo, including various API refactors and spec updates.</p>\n<p>This includes all the changes to the <code>wasmtime</code> crate from <code>wasip3-prototyping</code><br>\n_except_ that the <code>concurrent</code> submodule and child submodules contain only<br>\nnon-functional stubs.  For that reason, and the fact that<br>\ne.g. <code>Func::call_async</code> is now implemented in terms of <code>Func::call_concurrent</code>,<br>\nmost of the component model tests are failing.  This commit is not meant to be<br>\nmerged as-is; a follow-up commit (to be PR'd separately) will contain the real<br>\n<code>concurrent</code> implementation, at which point the tests will pass again.  I'm<br>\nsplitting these into separate PRs to make review easier.</p>\n<p>Note that this builds on<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/pull/11114\">https://github.com/bytecodealliance/wasmtime/pull/11114</a>; only the second commit<br>\nis new.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 525557011,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750783102
    },
    {
        "content": "<p>dicej edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<p>This pulls in the latest Component Model async ABI code from the <code>wasip3-prototyping</code> repo, including various API refactors and spec updates.</p>\n<p>This includes all the changes to the <code>wasmtime</code> crate from <code>wasip3-prototyping</code> _except_ that the <code>concurrent</code> submodule and child submodules contain only non-functional stubs.  For that reason, and the fact that<br>\ne.g. <code>Func::call_async</code> is now implemented in terms of <code>Func::call_concurrent</code>, most of the component model tests are failing.  This commit is not meant to be merged as-is; a follow-up commit (to be PR'd separately) will contain the real<br>\n<code>concurrent</code> implementation, at which point the tests will pass again.  I'm splitting these into separate PRs to make review easier.</p>\n<p>Note that this builds on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11114\">https://github.com/bytecodealliance/wasmtime/pull/11114</a>; only the second commit is new.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 525557132,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750783156
    },
    {
        "content": "<p>dicej edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<p>This pulls in the latest Component Model async ABI code from the <code>wasip3-prototyping</code> repo, including various API refactors and spec updates.</p>\n<p>This includes all the changes to the <code>wasmtime</code> crate from <code>wasip3-prototyping</code> _except_ that the <code>concurrent</code> submodule and child submodules contain only non-functional stubs.  For that reason, and the fact that e.g. <code>Func::call_async</code> is now implemented in terms of <code>Func::call_concurrent</code>, most of the component model tests are failing.  This commit is not meant to be merged as-is; a follow-up commit (to be PR'd separately) will contain the real<br>\n<code>concurrent</code> implementation, at which point the tests will pass again.  I'm splitting these into separate PRs to make review easier.</p>\n<p>Note that this builds on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11114\">https://github.com/bytecodealliance/wasmtime/pull/11114</a>; only the second commit is new.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 525557162,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750783168
    },
    {
        "content": "<p>dicej edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<p>This pulls in the latest Component Model async ABI code from the <code>wasip3-prototyping</code> repo, including various API refactors and spec updates.</p>\n<p>This includes all the changes to the <code>wasmtime</code> crate from <code>wasip3-prototyping</code> _except_ that the <code>concurrent</code> submodule and child submodules contain only non-functional stubs.  For that reason, and the fact that e.g. <code>Func::call_async</code> is now implemented in terms of <code>Func::call_concurrent</code>, most of the component model tests are failing.  This commit is not meant to be merged as-is; a follow-up commit (to be PR'd separately) will contain the real <code>concurrent</code> implementation, at which point the tests will pass again.  I'm splitting these into separate PRs to make review easier.</p>\n<p>Note that this builds on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11114\">https://github.com/bytecodealliance/wasmtime/pull/11114</a>; only the second commit is new.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 525557185,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750783179
    },
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 525575102,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750790290
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 525989545,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1750978138
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526103994,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751036645
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526104595,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751036833
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526104872,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751036937
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526110462,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751038852
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526112324,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751039581
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#pullrequestreview-2966962144\">PR review</a>:</p>\n<blockquote>\n<p>These are a few comments so far but I've yet to really get into the meat of this. FWIW I also rebased <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11127\">https://github.com/bytecodealliance/wasmtime/pull/11127</a> on top of some of the local changes I've made, mostly to ensure that the changes don't break the full build.</p>\n</blockquote>",
        "id": 526117455,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041431
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172262019\">PR review comment</a>:</p>\n<blockquote>\n<p>Did this not end up getting stored in <code>Options</code>?</p>\n</blockquote>",
        "id": 526117456,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041432
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172269742\">PR review comment</a>:</p>\n<blockquote>\n<p>Are these TODOs still applicable? If so mind converting these to doc comments?</p>\n</blockquote>",
        "id": 526117457,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041432
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172303333\">PR review comment</a>:</p>\n<blockquote>\n<p>We'll want to smith this module a bit, mind moving this to a <code>concurrent_disabled.rs</code> or similar? Otherwise the big-ish changes we'll want here are:</p>\n<ul>\n<li>Types in this module should somehow contain an uninhabited enum. We've got <code>crate::runtime::Uninhabited</code> for this purpose and that'll ensure that we never accidentally create these types.</li>\n<li>Ideally there are no <code>panic!</code>s in this module. If anything takes <code>self</code> you can <code>match self.uninhabited {}</code> which is a compile-time assertion that it's not possible to be in that method.</li>\n<li>For other methods that are panicking they'll want to return an error/trap, at least where possible.</li>\n</ul>\n<p>Basically the worry is that if we have substantial #[cfg]'d-out functionality it's basically never tested in this repo so we want to make sure it's as simple as it can be an \"obviously correct\" for its situation. In that sense my worry here is that I don't want anything to accidentally get into a situation where a runtime panic can happen. In theory many of these methods are dynamically unreachable but it's hard to infer that just from looking at this module, so I'd feel safer transforming things to returning an error to at least know that if we are wrong and these functions are reachable that they'll return some sort of error instead of panicking.</p>\n</blockquote>",
        "id": 526117458,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041432
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#issuecomment-3013629810\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<p>This may not be plausible as I haven't gotten into the \"meat\" yet, but I'd like to pursue ideally the ability to land this PR as-is independent of <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11127\">https://github.com/bytecodealliance/wasmtime/pull/11127</a>. Would it be possible to avoid changing <code>call_async</code> in this PR and <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11127\">https://github.com/bytecodealliance/wasmtime/pull/11127</a> would be where the implementation changes?</p>\n</blockquote>",
        "id": 526117664,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041511
    },
    {
        "content": "<p>dicej submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#pullrequestreview-2967178163\">PR review</a>.</p>",
        "id": 526117985,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041639
    },
    {
        "content": "<p>dicej created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172399938\">PR review comment</a>:</p>\n<blockquote>\n<p>Sorry, I don't think I understand the question.  If you're wondering why the field name is prefixed with an underscore, it's because it won't be used until the full async implementation is merged.  I can add a comment and/or <code>#[cfg(allow(dead_code))]</code> if that helps.</p>\n</blockquote>",
        "id": 526117988,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041640
    },
    {
        "content": "<p>dicej submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#pullrequestreview-2967181422\">PR review</a>.</p>",
        "id": 526118118,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041698
    },
    {
        "content": "<p>dicej created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172402539\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, they're still applicable.  I'll convert them.</p>\n</blockquote>",
        "id": 526118119,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751041698
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#issuecomment-3014069866\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"fuzzing\", \"wasmtime:api\", \"wasmtime:c-api\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>fitzgen: fuzzing</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 526137643,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751050171
    },
    {
        "content": "<p>dicej submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#pullrequestreview-2967890762\">PR review</a>.</p>",
        "id": 526147400,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751055566
    },
    {
        "content": "<p>dicej created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#discussion_r2172820755\">PR review comment</a>:</p>\n<blockquote>\n<p>I started changing the panics into compile-time assertions or traps, but I quickly realized that in almost all cases the code really should be unreachable, since any attempt to use CM async features should have failed at <code>wasmparser</code> validation time.  It feels misleading to me to trap in those cases, because it implies that the code _is_ reachable, i.e. that a guest would somehow sneak use of an async feature past the validator.</p>\n<p>I'll go ahead and switch to traps, but also add comments indicating that it's our (Wasmtime's) fault if they're hit, not the guest's.</p>\n</blockquote>",
        "id": 526147401,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751055566
    },
    {
        "content": "<p>dicej <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123#issuecomment-3014287299\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>:</p>\n<blockquote>\n<blockquote>\n<p>Would it be possible to avoid changing <code>call_async</code> in this PR and #11127 would be where the implementation changes?</p>\n</blockquote>\n<p>I'll take a shot at it.</p>\n</blockquote>",
        "id": 526148856,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751056281
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526150097,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751057046
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11123\">PR #11123</a>.</p>",
        "id": 526152083,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1751058286
    }
]