[
    {
        "content": "<p>songtianlei opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<h3><code>.clif</code> Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">optimize</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">opt_level</span><span class=\"o\">=</span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">preserve_frame_pointers</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">enable_multi_ret_implicit_sret</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n<span class=\"w\">    </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span>\n\n<span class=\"n\">function</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">i16x8</span><span class=\"w\"> </span><span class=\"n\">fast</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">ss0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">explicit_slot</span><span class=\"w\"> </span><span class=\"mi\">32</span>\n\n<span class=\"n\">block0</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">v1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iconst</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"mh\">0x0011_0022_0033_0044</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">8</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">16</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">24</span>\n\n<span class=\"w\">    </span><span class=\"n\">v80</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">stack_addr</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"w\">    </span><span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">v80</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v81</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v82</span>\n<span class=\"p\">}</span>\n\n<span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">print</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span>\n</code></pre></div>\n<h3>Description</h3>\n<p>When I specify the <code>load</code> and <code>sload8x8</code> instructions as big-endian</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<p>the execution results are as follows.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">274928428480</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4785220636311620</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mh\">0x00440000003300000022000000110000</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>Then I changed them to little-endian, and the results are as follows.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">274928428480</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4899972470242545920</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mh\">0x00440000003300000022000000110000</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>The value of <code>v81</code> changed, which is expected. But the value of <code>v82</code> stayed the same, indicating that little/big-endian has no effect on <code>sload8x8</code>.</p>\n<h3>Environment</h3>\n<p><code>qemu-s390x</code> to emulate execution on an x86 machine.</p>\n</blockquote>",
        "id": 520894396,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748439286
    },
    {
        "content": "<p><a href=\"https://github.com/songtianlei\">songtianlei</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">Issue #10852</a>.</p>",
        "id": 520894398,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748439286
    },
    {
        "content": "<p><a href=\"https://github.com/songtianlei\">songtianlei</a> added the cranelift label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">Issue #10852</a>.</p>",
        "id": 520894399,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748439286
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the cranelift:area:s390x label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">Issue #10852</a>.</p>",
        "id": 520911762,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748443684
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2916628383\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>cc @uweigand </p>\n</blockquote>",
        "id": 520911786,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748443691
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2916693427\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>There should be no effect - an array (or vector) of  8 single-byte elements has the same in-memory representation on both big-endian and little-endian systems.</p>\n</blockquote>",
        "id": 520915976,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748444780
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<h3><code>.clif</code> Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">optimize</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">opt_level</span><span class=\"o\">=</span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">preserve_frame_pointers</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">enable_multi_ret_implicit_sret</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n<span class=\"w\">    </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span>\n\n<span class=\"n\">function</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">i16x8</span><span class=\"w\"> </span><span class=\"n\">fast</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">ss0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">explicit_slot</span><span class=\"w\"> </span><span class=\"mi\">32</span>\n\n<span class=\"n\">block0</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">v1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iconst</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"mh\">0x0011_0022_0033_0044</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">8</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">16</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">24</span>\n\n<span class=\"w\">    </span><span class=\"n\">v80</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">stack_addr</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"w\">    </span><span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">v80</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v81</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">v82</span>\n<span class=\"p\">}</span>\n\n<span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">print</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span>\n</code></pre></div>\n<h3>Description</h3>\n<p>When I specify the <code>load</code> and <code>sload8x8</code> instructions as big-endian</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<p>the execution results are as follows.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">274928428480</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4785220636311620</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mh\">0x00440000003300000022000000110000</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>Then I changed them to little-endian, and the results are as follows.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">load</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"n\">v82</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload8x8</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">274928428480</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4899972470242545920</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mh\">0x00440000003300000022000000110000</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>The value of <code>v81</code> changed, which is expected. But the value of <code>v82</code> stayed the same, indicating that little/big-endian has no effect on <code>sload8x8</code>.</p>\n<h3>Environment</h3>\n<p><code>qemu-s390x</code> to emulate execution on an x86 machine.</p>\n</blockquote>",
        "id": 520917177,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748445127
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2916714548\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>Oops yes indeed! I'll close this as \"working as intended\", but @songtianlei if you have follow-up questions please feel free to post them here too.</p>\n</blockquote>",
        "id": 520917180,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748445127
    },
    {
        "content": "<p>songtianlei <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2918789536\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>@alexcrichton @uweigand <br>\nI also noticed that <code>sload</code> behaves differently on x86 and s390x when using little or big endian.</p>\n<h3><code>.clif</code> Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">optimize</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">opt_level</span><span class=\"o\">=</span><span class=\"n\">none</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">preserve_frame_pointers</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n<span class=\"w\">    </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">enable_multi_ret_implicit_sret</span><span class=\"o\">=</span><span class=\"kc\">true</span>\n\n<span class=\"n\">function</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"nc\">fast</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">ss0</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">explicit_slot</span><span class=\"w\"> </span><span class=\"mi\">32</span>\n\n<span class=\"n\">block0</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">v1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">iconst</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"mh\">0x0011_0022_0033_0044</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">8</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">16</span>\n<span class=\"w\">    </span><span class=\"n\">stack_store</span><span class=\"w\"> </span><span class=\"n\">v1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ss0</span><span class=\"o\">+</span><span class=\"mi\">24</span>\n\n<span class=\"w\">    </span><span class=\"n\">v80</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">stack_addr</span><span class=\"p\">.</span><span class=\"kt\">i64</span><span class=\"w\"> </span><span class=\"n\">ss0</span>\n<span class=\"w\">    </span><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">v81</span>\n<span class=\"p\">}</span>\n<span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">print</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span>\n</code></pre></div>\n<p>The <code>sload</code> instruction is set to little-endian and run on both x86 and s390x.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload32</span><span class=\"w\"> </span><span class=\"n\">little</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<p>The reslut:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[</span><span class=\"n\">x86</span><span class=\"w\">  </span><span class=\"p\">]</span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"mi\">3342404</span>\n<span class=\"p\">[</span><span class=\"n\">s390x</span><span class=\"p\">]</span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"mi\">570429696</span>\n</code></pre></div>\n<p>Then changed it to big-endian.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">v81</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sload32</span><span class=\"w\"> </span><span class=\"n\">big</span><span class=\"w\"> </span><span class=\"n\">v80</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[</span><span class=\"n\">x86</span><span class=\"w\">  </span><span class=\"p\">]</span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"mi\">3342404</span>\n<span class=\"p\">[</span><span class=\"n\">s390x</span><span class=\"p\">]</span><span class=\"o\">%</span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"mi\">1114146</span>\n</code></pre></div>\n<p>Why does the result change on s390x but stay the same on x86?</p>\n</blockquote>",
        "id": 521052610,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748509698
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2918817373\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>stack_store instructions are always using the native endian, so s390x and x86_64 have different data on the stack in your example, so using a fixed endianness for the load still results in different values.</p>\n</blockquote>",
        "id": 521054415,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748510413
    },
    {
        "content": "<p>songtianlei <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919012340\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>I know the stack data is different. I'm not asking why s390x and x86 give different results. My point is: when I switch between little and big endian, sload gives different results on s390x,  but on x86, both cases produce the same result.</p>\n</blockquote>",
        "id": 521067861,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748515322
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919037210\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>Right. I think the reason is that the s390x backend is the only one that supports endianness flags. It is the only architecture Cranelift supports where the wasm and native endianness are different. For all other architectures both Wasmtime and rustc_codegen_cranelift agree on which endianness to use, so probably nobody bothered to actually add big-endian support.</p>\n</blockquote>",
        "id": 521069548,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748515942
    },
    {
        "content": "<p>songtianlei <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919508697\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>Thank you very much for your detailed answer.</p>\n</blockquote>",
        "id": 521100826,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748527308
    },
    {
        "content": "<p>songtianlei deleted a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919508697\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>Thank you very much for your detailed answer.</p>\n</blockquote>",
        "id": 521101250,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748527437
    },
    {
        "content": "<p>songtianlei <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919515664\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>@bjorn3 Thank you very much for your detailed answer.</p>\n</blockquote>",
        "id": 521101340,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748527459
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852#issuecomment-2919749637\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10852\">issue #10852</a>:</p>\n<blockquote>\n<p>Opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10861\">https://github.com/bytecodealliance/wasmtime/issues/10861</a> to track either implementing or emitting an error for the big-endian flag on little-endian targets.</p>\n</blockquote>",
        "id": 521117676,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748532337
    }
]