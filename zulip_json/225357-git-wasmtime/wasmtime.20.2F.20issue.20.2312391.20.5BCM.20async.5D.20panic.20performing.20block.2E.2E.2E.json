[
    {
        "content": "<p><a href=\"https://github.com/lukewagner\">lukewagner</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">Issue #12391</a>.</p>",
        "id": 569391493,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769045772
    },
    {
        "content": "<p>lukewagner opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<p>Currently, this WAST:</p>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"err\">assert_trap</span>\n  <span class=\"p\">(</span><span class=\"err\">component</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">module</span> <span class=\"nv\">$Memory</span> <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"mem\"</span><span class=\"p\">)</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"err\">instance</span> <span class=\"nv\">$memory</span> <span class=\"p\">(</span><span class=\"err\">instantiate</span> <span class=\"nv\">$Memory</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">module</span> <span class=\"nv\">$M</span>\n      <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"\"</span> <span class=\"s2\">\"waitable-set.new\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span> <span class=\"p\">(</span><span class=\"k\">result</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"\"</span> <span class=\"s2\">\"waitable-set.wait\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">result</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$start</span>\n        <span class=\"p\">(</span><span class=\"nb\">drop</span> <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$waitable-set.wait</span> <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">0</span><span class=\"p\">)))</span>\n      <span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">start</span> <span class=\"nv\">$start</span><span class=\"p\">)</span>\n    <span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">canon</span> <span class=\"err\">wai</span><span class=\"k\">table</span><span class=\"err\">-set.new</span> <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">canon</span> <span class=\"err\">wai</span><span class=\"k\">table</span><span class=\"err\">-set.wait</span> <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"nv\">$memory</span> <span class=\"s2\">\"mem\"</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"err\">instance</span> <span class=\"nv\">$m</span> <span class=\"p\">(</span><span class=\"err\">instantiate</span> <span class=\"nv\">$M</span> <span class=\"p\">(</span><span class=\"err\">with</span> <span class=\"s2\">\"\"</span> <span class=\"p\">(</span><span class=\"err\">instance</span>\n      <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"waitable-set.new\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">))</span>\n      <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"waitable-set.wait\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span><span class=\"p\">))</span>\n    <span class=\"p\">))))</span>\n  <span class=\"p\">)</span>\n  <span class=\"s2\">\"cannot block a synchronous task before returning\"</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>panics with:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">2367885</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">component</span><span class=\"o\">/</span><span class=\"n\">concurrent</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">1517</span><span class=\"p\">:</span><span class=\"mi\">39</span><span class=\"p\">:</span>\n<span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">None</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">__rustc</span><span class=\"p\">::</span><span class=\"n\">rust_begin_unwind</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic_fmt</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">option</span><span class=\"p\">::</span><span class=\"n\">unwrap_failed</span>\n<span class=\"w\">   </span><span class=\"mi\">4</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">concurrent</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">store</span><span class=\"p\">::</span><span class=\"n\">StoreOpaque</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">check_blocking</span>\n<span class=\"w\">   </span><span class=\"mi\">5</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">concurrent</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">instance</span><span class=\"p\">::</span><span class=\"n\">Instance</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">waitable_set_wait</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 569391494,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769045772
    },
    {
        "content": "<p>lukewagner <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391#issuecomment-3782036095\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<p>This test case and another like it now available to pull in from <a href=\"https://github.com/WebAssembly/component-model/blob/main/test/async/dont-block-start.wast\"><code>test/async/dont-block-start.wast</code></a> on <code>main</code>.</p>\n</blockquote>",
        "id": 569392377,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769046389
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391#issuecomment-3785185022\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<p>@dicej this should be fixed by <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12379\">https://github.com/bytecodealliance/wasmtime/pull/12379</a> I think, right?</p>\n</blockquote>",
        "id": 569528403,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769097387
    },
    {
        "content": "<p>dicej <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391#issuecomment-3785270802\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<blockquote>\n<p><a href=\"https://github.com/dicej\">@dicej</a> this should be fixed by <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12379\">#12379</a> I think, right?</p>\n</blockquote>\n<p>Yes, it should be.  I'll test it on that branch when I get a chance.</p>\n</blockquote>",
        "id": 569532753,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769098400
    },
    {
        "content": "<p>dicej <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391#issuecomment-3785288398\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<p>Yup, test passes (no panic) on that branch.</p>\n</blockquote>",
        "id": 569533655,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769098622
    },
    {
        "content": "<p>dicej closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12391\">issue #12391</a>:</p>\n<blockquote>\n<p>Currently, this WAST:</p>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"p\">(</span><span class=\"err\">assert_trap</span>\n  <span class=\"p\">(</span><span class=\"err\">component</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">module</span> <span class=\"nv\">$Memory</span> <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"mem\"</span><span class=\"p\">)</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"err\">instance</span> <span class=\"nv\">$memory</span> <span class=\"p\">(</span><span class=\"err\">instantiate</span> <span class=\"nv\">$Memory</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">module</span> <span class=\"nv\">$M</span>\n      <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"\"</span> <span class=\"s2\">\"waitable-set.new\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span> <span class=\"p\">(</span><span class=\"k\">result</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"s2\">\"\"</span> <span class=\"s2\">\"waitable-set.wait\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span> <span class=\"p\">(</span><span class=\"k\">param</span> <span class=\"kt\">i32</span> <span class=\"kt\">i32</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">result</span> <span class=\"kt\">i32</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$start</span>\n        <span class=\"p\">(</span><span class=\"nb\">drop</span> <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$waitable-set.wait</span> <span class=\"p\">(</span><span class=\"nb\">call</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">0</span><span class=\"p\">)))</span>\n      <span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">start</span> <span class=\"nv\">$start</span><span class=\"p\">)</span>\n    <span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">canon</span> <span class=\"err\">wai</span><span class=\"k\">table</span><span class=\"err\">-set.new</span> <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">canon</span> <span class=\"err\">wai</span><span class=\"k\">table</span><span class=\"err\">-set.wait</span> <span class=\"p\">(</span><span class=\"k\">memory</span> <span class=\"nv\">$memory</span> <span class=\"s2\">\"mem\"</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"err\">core</span> <span class=\"err\">instance</span> <span class=\"nv\">$m</span> <span class=\"p\">(</span><span class=\"err\">instantiate</span> <span class=\"nv\">$M</span> <span class=\"p\">(</span><span class=\"err\">with</span> <span class=\"s2\">\"\"</span> <span class=\"p\">(</span><span class=\"err\">instance</span>\n      <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"waitable-set.new\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.new</span><span class=\"p\">))</span>\n      <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"waitable-set.wait\"</span> <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"nv\">$waitable-set.wait</span><span class=\"p\">))</span>\n    <span class=\"p\">))))</span>\n  <span class=\"p\">)</span>\n  <span class=\"s2\">\"cannot block a synchronous task before returning\"</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n<p>panics with:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">2367885</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">component</span><span class=\"o\">/</span><span class=\"n\">concurrent</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">1517</span><span class=\"p\">:</span><span class=\"mi\">39</span><span class=\"p\">:</span>\n<span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">None</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>\n<span class=\"n\">stack</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">   </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">__rustc</span><span class=\"p\">::</span><span class=\"n\">rust_begin_unwind</span>\n<span class=\"w\">   </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic_fmt</span>\n<span class=\"w\">   </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">panicking</span><span class=\"p\">::</span><span class=\"n\">panic</span>\n<span class=\"w\">   </span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">core</span><span class=\"p\">::</span><span class=\"n\">option</span><span class=\"p\">::</span><span class=\"n\">unwrap_failed</span>\n<span class=\"w\">   </span><span class=\"mi\">4</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">concurrent</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">store</span><span class=\"p\">::</span><span class=\"n\">StoreOpaque</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">check_blocking</span>\n<span class=\"w\">   </span><span class=\"mi\">5</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">concurrent</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"k\">impl</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"p\">::</span><span class=\"n\">runtime</span><span class=\"p\">::</span><span class=\"n\">component</span><span class=\"p\">::</span><span class=\"n\">instance</span><span class=\"p\">::</span><span class=\"n\">Instance</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">waitable_set_wait</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 569778958,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1769192259
    }
]