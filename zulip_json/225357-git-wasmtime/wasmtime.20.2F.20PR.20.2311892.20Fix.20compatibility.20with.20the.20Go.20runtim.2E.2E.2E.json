[
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a> from <code>alexcrichton:fix-go</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This commit fixes some fallout of #11592 where that PR resulted in Wasmtime no longer running within the context of the Go runtime (e.g. <code>wasmtime-go</code>). The reasons for this are quite Windows-specific and I've attempted to document the situation in <code>vectored_exceptions.go</code>. The basic TL;DR; is that by returning from a vectored exception handler (which #11592 introduced) we're now subjecting ourselves to \"continue handlers\" as well, and Go's continue handlers will abort the process for non-Go exceptions. Some logic is added here to try to bypass Go's continue handlers and get back to wasm.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 546079945,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760989921
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546079946,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760989922
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546079947,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760989922
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#issuecomment-3423511485\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>:</p>\n<blockquote>\n<p>I have, yet again as is the case with wasmtime-go and integrating on various platforms, lost an embarassingly large amount of time debugging this...</p>\n</blockquote>",
        "id": 546080069,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760989959
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3357878039\">PR review</a>.</p>",
        "id": 546092660,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760993207
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2446084545\">PR review comment</a>:</p>\n<blockquote>\n<p>*list</p>\n</blockquote>",
        "id": 546092664,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760993208
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546096216,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760994459
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3361619880\">PR review</a>:</p>\n<blockquote>\n<p>Sounds like this one was super fun to track down!</p>\n</blockquote>",
        "id": 546280325,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761064082
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2448958973\">PR review comment</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>//\n// # Safety\n//\n// Invoked by Windows' vectored exception system; should\n// not be called by anyone else.\nunsafe extern \"system\" fn continue_handler(exception_info: &amp;EXCEPTION_POINTERS) -&gt; i32 {\n    let context = &amp;exception_info.ContextRecord;\n</code></pre></div>\n<p>Perhaps? Yes, it doesn't really actually change anything about the safety here, but it does mean there is one less <code>unsafe</code> block to decide whether it merits a <code>// SAFETY:</code> comment...</p>\n</blockquote>",
        "id": 546280326,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761064083
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2448937109\">PR review comment</a>:</p>\n<blockquote>\n<p>The title of this section suggests that this is an overview of how continue handlers work, and then it proceeds to be a discussion about working around how the go runtime (ab)uses them. I think this comment could be a little more clear if we explicitly had a few different sections:</p>\n<ol>\n<li>An explanation of how VEH and continue handlers work and are intended to be used.</li>\n<li>An explanation of how the go runtime (ab)uses the system, and how this doesn't play nice / compose with other runtimes that need to install handlers, like Wasmtime.</li>\n<li>A description of what we are doing to work around (2).</li>\n</ol>\n<p>All that said, this comment was super helpful for understanding the issues involved. Thanks for writing this stuff up!</p>\n</blockquote>",
        "id": 546280327,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761064083
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546312434,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761074884
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3362400762\">PR review</a>.</p>",
        "id": 546312497,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761074913
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2449482304\">PR review comment</a>:</p>\n<blockquote>\n<p>Good point! I reorganized to make it flow better like you suggested, I think I was a bit too frustrated with all of this yesterday to write clearly...</p>\n</blockquote>",
        "id": 546312498,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761074913
    },
    {
        "content": "<p>alexcrichton has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546312519,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761074922
    },
    {
        "content": "<p>alexcrichton merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11892\">PR #11892</a>.</p>",
        "id": 546318110,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1761077139
    }
]