[
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571538520,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770071647
    },
    {
        "content": "<p>dicej opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a> from <code>dicej:deprecate-post-return</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>With the advent of the Component Model concurrency ABI and it's <code>task.return</code> intrinsic, post-return functions have been informally deprecated and are expected to be removed for WASI 1.0 and the corresponding stable edition of the Component Model.  Consequently, it does not make sense anymore to require embedders to explicitly call the post-return function after using <code>[Typed]Func::call[_async]</code>.</p>\n<p>As of this commit, <code>[Typed]Func::post_return[_async]</code> are no-ops.  Instead, the post-return function is called automatically as part of <code>[Typed]Func::call[_async]</code> if present, which is how <code>[Typed]Func::call_concurrent</code> has worked all along.  In addition, this commit fixes and tests a couple of cases where the task and/or thread was being disposed of before the post-return function was called.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 571538523,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770071647
    },
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers\">wasmtime-fuzz-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571538528,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770071648
    },
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571538531,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770071648
    },
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers\">wasmtime-default-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571538532,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770071648
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wasmtime:c-api</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571553214,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770080775
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wasmtime:api</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571553215,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770080775
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wizer</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571553216,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770080775
    },
    {
        "content": "<p>github-actions[bot] added the label <code>fuzzing</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571553217,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770080775
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#issuecomment-3838195927\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"fuzzing\", \"wasmtime:api\", \"wasmtime:c-api\", \"wizer\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>fitzgen: fuzzing, wizer</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 571553329,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770080819
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#pullrequestreview-3742339367\">PR review</a>:</p>\n<blockquote>\n<p>For the \"Monolith checks\" CI job if you rebase on <code>main</code> that'll resolve that error</p>\n</blockquote>",
        "id": 571555484,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756679728\">PR review comment</a>:</p>\n<blockquote>\n<p>Can this percolate up into the C API documentation to indicate that the function is a noop?</p>\n</blockquote>",
        "id": 571555485,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756680244\">PR review comment</a>:</p>\n<blockquote>\n<p>It's ok to just return <code>None</code> from this function, no need to use the <code>handle_result</code> helper</p>\n</blockquote>",
        "id": 571555486,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756701546\">PR review comment</a>:</p>\n<blockquote>\n<p>Could this be clarified to indicate that calls can be removed? Something like \"no longer needed to call this, this function has no effect\" or something like that. Mostly something to at-a-glance ensure users see that the solution is to just delete the call to this function.</p>\n</blockquote>",
        "id": 571555487,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756719350\">PR review comment</a>:</p>\n<blockquote>\n<p>In theory we can probably jettison all this handling since the only purpose of this flag was for the API of a dedicated <code>post_return</code> function itself. That's fine to defer to later though</p>\n</blockquote>",
        "id": 571555488,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756721002\">PR review comment</a>:</p>\n<blockquote>\n<p>Should the boolean parameter to <code>with_lower_context</code> get removed as well? I think it's always <code>true</code> now, right?</p>\n</blockquote>",
        "id": 571555489,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756722847\">PR review comment</a>:</p>\n<blockquote>\n<p>Similar to <code>TypedFunc</code>, I think this'd be good to merge into <code>call_impl</code> to ensure that no-concurrency <code>call_async</code> also calls post-return (I think it's missing that currently)</p>\n</blockquote>",
        "id": 571555490,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756698371\">PR review comment</a>:</p>\n<blockquote>\n<p>This reminds me that this was actually intentional that it's inserted between <code>call_async</code> and <code>post_return_async</code>. This <a href=\"https://github.com/bytecodealliance/wasmtime/blob/f248b5c06d041681a0c9d629d5c4146fe8bac860/crates/wizer/src/component/wasmtime.rs#L127\">specifically uses <code>WasmList&lt;u8&gt;</code></a> to avoid copying the entire memory. That being said though there's <a href=\"https://github.com/bytecodealliance/wasmtime/blob/f248b5c06d041681a0c9d629d5c4146fe8bac860/crates/wizer/src/component/instrument.rs#L284-L290\">no post-return on this function</a> so it's fine either way. Mostly just a quirk I figured I'd point out</p>\n</blockquote>",
        "id": 571555491,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756714583\">PR review comment</a>:</p>\n<blockquote>\n<p>Can this get folded into <code>call_impl</code>? It looks like, for example, that below <code>call_async</code> may not be calling <code>post-return</code>  when concurrency is disabled. Mind expanding the test coverage to catch that as well? In theory it's mostly a matter of finding the case already testing this and then also do the same thing for <code>Config::concurrency_support(false)</code></p>\n</blockquote>",
        "id": 571555492,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2756725722\">PR review comment</a>:</p>\n<blockquote>\n<p>I think this function on <code>vm::ComponentInstance</code>, as well as the internal slot for this, may all be deletable now too</p>\n</blockquote>",
        "id": 571555493,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770082183
    },
    {
        "content": "<p>dicej submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#pullrequestreview-3745584428\">PR review</a>.</p>",
        "id": 571675342,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770128626
    },
    {
        "content": "<p>dicej created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2759351083\">PR review comment</a>:</p>\n<blockquote>\n<p>I thought so too, at first, but we pass <code>false</code> to it in <code>call_raw</code>.</p>\n</blockquote>",
        "id": 571675344,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770128626
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#discussion_r2759856230\">PR review comment</a>:</p>\n<blockquote>\n<p>I think we'll still want to work to jettison the boolean in the long-run since that flag there looks like it's also related to post-return which isn't needed any more, but that's ok to happen in a follow-up.</p>\n</blockquote>",
        "id": 571703538,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770135045
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#pullrequestreview-3746178354\">PR review</a>.</p>",
        "id": 571703542,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770135045
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571713234,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770137493
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571724919,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770140612
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571726587,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770141161
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571728730,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770141777
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571730873,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770142463
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571736979,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770144435
    },
    {
        "content": "<p><strong>dicej</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571737045,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770144460
    },
    {
        "content": "<p>dicej <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#issuecomment-3843052370\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>:</p>\n<blockquote>\n<p>@alexcrichton thanks for the feedback as always.  I believe I've addressed everything, including removing the obsolete functions, flags, fields, and parameters.</p>\n</blockquote>",
        "id": 571737192,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770144509
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498#pullrequestreview-3747028324\">PR review</a>.</p>",
        "id": 571738790,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770144992
    },
    {
        "content": "<p>dicej updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571739055,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770145080
    },
    {
        "content": "<p>dicej has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571739099,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770145090
    },
    {
        "content": "<p>dicej added <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498 deprecate <code>[Typed]Func::post_return[_async]</code> and make them no-ops</a> to the merge queue.</p>",
        "id": 571742090,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770146029
    },
    {
        "content": "<p>dicej merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498</a>.</p>",
        "id": 571746680,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770147439
    },
    {
        "content": "<p>dicej removed <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12498\">PR #12498 deprecate <code>[Typed]Func::post_return[_async]</code> and make them no-ops</a> from the merge queue.</p>",
        "id": 571746682,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770147440
    }
]