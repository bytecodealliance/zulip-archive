[
    {
        "content": "<p>MangoPeachGrape opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">issue #11963</a>:</p>\n<blockquote>\n<p>Hi,</p>\n<p>I would like to have a way to redirect stdout/stderr to an in-memory queue or pipe, and then have some API to get the output from C.</p>\n<p>I see <code>MemoryOutputPipe</code> in <code>p2/pipe.rs</code>, but I'm unsure if calling <code>.contents()</code> removes from the underlying pipe? I think I would prefer if a reading operation would remove from it, so that the pipe wouldn't get full.</p>\n<p>I was also thinking, what would be the API for this? Would reading from the pipe require an allocation and a copy, or could we get away with passing an non-owning pointer to the data to some callback instead?</p>\n<p>Feel free to let me know if any ideas come to mind!</p>\n<p>Thanks,<br>\nMangoPeachGrape</p>\n</blockquote>",
        "id": 548322804,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762016709
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963#issuecomment-3476575567\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">issue #11963</a>:</p>\n<blockquote>\n<p>Would something like this work?</p>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"k\">typedef</span><span class=\"w\"> </span><span class=\"kt\">size_t</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">wasi_output_callback_t</span><span class=\"p\">)(</span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">size_t</span><span class=\"p\">);</span>\n\n<span class=\"n\">WASI_API_EXTERN</span><span class=\"w\"> </span><span class=\"kt\">bool</span>\n<span class=\"n\">wasi_config_set_stdout_custom</span><span class=\"p\">(</span><span class=\"n\">wasi_config_t</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">config</span><span class=\"p\">,</span>\n<span class=\"w\">                              </span><span class=\"n\">wasi_output_callback_t</span><span class=\"w\"> </span><span class=\"n\">callback</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"n\">env</span><span class=\"p\">,</span>\n<span class=\"w\">                              </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">finalizer</span><span class=\"p\">)(</span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"p\">));</span>\n</code></pre></div>\n<p>Basically the ability to have a custom callback which receives the bytes and can figure out what to do with it. That'd be up to the C implementation to figure out how to collect the output but being able to customize it entirely is sort of the next level up from what we currently have in the API.</p>\n<p>(something similar could in theory be used for stdin too)</p>\n</blockquote>",
        "id": 548324246,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762017826
    },
    {
        "content": "<p>MangoPeachGrape <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963#issuecomment-3476615242\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">issue #11963</a>:</p>\n<blockquote>\n<p>I think so yes!</p>\n<p>I was thinking of it requiring a variant of <code>MemoryOutputPipe</code> with a callback to its data, but your solution seems _a lot_ better.</p>\n<p>Should I try implementing it?</p>\n</blockquote>",
        "id": 548325491,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762018671
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963#issuecomment-3476618219\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">issue #11963</a>:</p>\n<blockquote>\n<p>Please do!</p>\n</blockquote>",
        "id": 548325884,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762018927
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasmtime:c-api label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">Issue #11963</a>.</p>",
        "id": 548325891,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762018931
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11963\">issue #11963</a>:</p>\n<blockquote>\n<p>Hi,</p>\n<p>I would like to have a way to redirect stdout/stderr to an in-memory queue or pipe, and then have some API to get the output from C.</p>\n<p>I see <code>MemoryOutputPipe</code> in <code>p2/pipe.rs</code>, but I'm unsure if calling <code>.contents()</code> removes from the underlying pipe? I think I would prefer if a reading operation would remove from it, so that the pipe wouldn't get full.</p>\n<p>I was also thinking, what would be the API for this? Would reading from the pipe require an allocation and a copy, or could we get away with passing an non-owning pointer to the data to some callback instead?</p>\n<p>Feel free to let me know if any ideas come to mind!</p>\n<p>Thanks,<br>\nMangoPeachGrape</p>\n</blockquote>",
        "id": 553728779,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762295688
    }
]