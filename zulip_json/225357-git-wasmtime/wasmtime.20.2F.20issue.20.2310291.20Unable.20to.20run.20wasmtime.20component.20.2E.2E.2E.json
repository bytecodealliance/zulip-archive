[
    {
        "content": "<p>tpmccallum opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>I am compiling using the following command:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>cargo<span class=\"w\"> </span>component<span class=\"w\"> </span>build<span class=\"w\"> </span>--target<span class=\"w\"> </span>wasm32-wasip2\n<span class=\"w\">  </span>Generating<span class=\"w\"> </span>bindings<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>compress<span class=\"w\"> </span><span class=\"o\">(</span>src/bindings.rs<span class=\"o\">)</span>\n<span class=\"w\">    </span>Finished<span class=\"w\"> </span><span class=\"sb\">`</span>dev<span class=\"sb\">`</span><span class=\"w\"> </span>profile<span class=\"w\"> </span><span class=\"o\">[</span>unoptimized<span class=\"w\"> </span>+<span class=\"w\"> </span>debuginfo<span class=\"o\">]</span><span class=\"w\"> </span>target<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">0</span>.07s\n</code></pre></div>\n<p>But when I use wasmtime I get an error:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>wasmtime<span class=\"w\"> </span>component<span class=\"w\"> </span>run<span class=\"w\"> </span>--env<span class=\"w\"> </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span><span class=\"w\"> </span>--dir<span class=\"w\"> </span>.<span class=\"w\"> </span>--invoke<span class=\"w\"> </span>compress<span class=\"w\"> </span>target/wasm32-wasip2/debug/compress.wasm\nError:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span><span class=\"o\">(</span>os<span class=\"w\"> </span>error<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I put the source code and config in a repo so you can see everything. Super stumped on this one, would appreciate some assistance.</p>\n<p><a href=\"https://github.com/tpmccallum/testing_components/blob/main/README.md\">https://github.com/tpmccallum/testing_components/blob/main/README.md</a></p>\n</blockquote>",
        "id": 501795618,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740487011
    },
    {
        "content": "<p>tpmccallum <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681874110\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Here are some details of my system/setup that might help with the diagnosis:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>rustc<span class=\"w\"> </span>--version\nrustc<span class=\"w\"> </span><span class=\"m\">1</span>.87.0-nightly<span class=\"w\"> </span><span class=\"o\">(</span>f8a913b13<span class=\"w\"> </span><span class=\"m\">2025</span>-02-23<span class=\"o\">)</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>cargo<span class=\"w\"> </span>component<span class=\"w\"> </span>--version\ncargo-component-component<span class=\"w\"> </span><span class=\"m\">0</span>.20.0\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>wasmtime<span class=\"w\"> </span>--version\nwasmtime<span class=\"w\"> </span><span class=\"m\">30</span>.0.1\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>uname<span class=\"w\"> </span>-a\nDarwin<span class=\"w\"> </span>Kernel<span class=\"w\"> </span>Version<span class=\"w\"> </span><span class=\"m\">24</span>.3.0:<span class=\"w\"> </span>X86_64\n</code></pre></div>\n<p>The <code>target/wasm32-wasip2</code> file exists.<br>\nI tried updating <code>cargo-component</code>, forcing <code>wasip2</code> in config but output in the CLI still says <code>wasip1</code>.<br>\nIs <code>wasmtime 30.0.1</code> mishandling <code>wasip2</code> components?<br>\nThe auto-generated <code>bindings.rs</code> mention <code>wit-bindgen:0.36.0</code> and I am not sure if the bindings being generated are correct.<br>\n<a href=\"https://github.com/tpmccallum/testing_components/blob/main/compress/src/bindings.rs#L93\">wit-bindgen:0.36.0</a></p>\n</blockquote>",
        "id": 501797568,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740487637
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681899867\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Does the <code>target/wasm32-wasip2/debug/compress.wasm</code> file exist?</p>\n</blockquote>",
        "id": 501799517,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740488183
    },
    {
        "content": "<p>tpmccallum <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681973730\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Yes, the <code>target/wasm32-wasip2/debug/compress.wasm</code> does exist.</p>\n</blockquote>",
        "id": 501805227,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740489852
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682439283\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Thanks for the report! (and <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span>)</p>\n<p>I think the problem here is that <code>wasmtime component run</code> isn't a subcommand of the <code>wasmtime</code> executable. Coupled with Wasmtime's bad error message (which is improved at <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10292\">https://github.com/bytecodealliance/wasmtime/pull/10292</a> now) I think that led to the confusion here.</p>\n<p>When removing <code>component</code> I then get:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">env</span><span class=\"w\"> </span><span class=\"n\">PATH</span><span class=\"o\">=</span><span class=\"cp\">$PATH</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">invoke</span><span class=\"w\"> </span><span class=\"n\">compress</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">compress</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">compress</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"err\">`</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">using</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">invoke</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">components</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">supported</span>\n</code></pre></div>\n<p>which is expected in that <code>--invoke</code> isn't supported for components just yet.</p>\n</blockquote>",
        "id": 501838464,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740498296
    },
    {
        "content": "<p>pchickey <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682909348\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<blockquote>\n<p>expected in that --invoke isn't supported for components just yet.<br>\nIts not that far off but I haven't had the time or energy to get it over the finish line. If someone else wants to pick it up, ping me on the PR or zulip <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10054\">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>\n</blockquote>\n</blockquote>",
        "id": 501881097,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740507444
    },
    {
        "content": "<p>pchickey edited a <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682909348\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<blockquote>\n<p>expected in that --invoke isn't supported for components just yet.</p>\n</blockquote>\n<p>Its not that far off but I haven't had the time or energy to get it over the finish line. If someone else wants to pick it up, ping me on the PR or zulip <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10054\">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>\n</blockquote>",
        "id": 501881115,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740507451
    },
    {
        "content": "<p>tpmccallum <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2683859920\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Thanks for the reply @bjorn3, @pchickey.<br>\nThanks, @alexcrichton (and <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> back). </p>\n<p>This is super helpful and appreciated. </p>\n<p><strong>wasip1/wasip2</strong><br>\nSome of the confusion (not <code>wasmtime</code> related specifically) was because I thought the <code>cargo component</code> command supported <code>wasip2</code>. I have since learned that <a href=\"https://github.com/bytecodealliance/cargo-component/issues/364#issuecomment-2683673580\">it does not</a>. Based on the output I was getting when generating the bindings I  thought that something was off with my config or toolchain and I chased my own tail for quite a while.</p>\n<p><strong>Error: No such file or directory (os error 2)</strong><br>\nThanks for the improved error message, that makes sense now.</p>\n<p><strong>Invoke Functionality</strong><br>\nI went ahead and fetched @pchickey's PR to test the --invoke out locally. Here's the results:</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"go\">cd /Users/tpmccallum</span>\n<span class=\"go\">git clone https://github.com/bytecodealliance/wasmtime.git</span>\n<span class=\"go\">cd wasmtime</span>\n<span class=\"go\">git checkout main</span>\n<span class=\"go\">git pull origin main</span>\n<span class=\"go\">git checkout pch/invoke_wave</span>\n<span class=\"go\">git merge main</span>\n<span class=\"go\">cargo clean</span>\n<span class=\"go\">cargo build --release</span>\n</code></pre></div>\n<p>I then tried to run the component and got the following result (hopefully useful feedback for the continuation of the work on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10054\">https://github.com/bytecodealliance/wasmtime/pull/10054</a>):</p>\n<div class=\"codehilite\" data-code-language=\"Bash Session\"><pre><span></span><code><span class=\"gp\">tpmccallum@192-168-1-17 compress % </span>/Users/tpmccallum/wasmtime/target/release/wasmtime<span class=\"w\"> </span>run<span class=\"w\"> </span>--invoke<span class=\"w\"> </span>compress<span class=\"w\"> </span>target/wasm32-wasip1/debug/compress.wasm\n\n<span class=\"go\">Error: failed to run main module `target/wasm32-wasip1/debug/compress.wasm`</span>\n\n<span class=\"go\">Caused by:</span>\n<span class=\"go\">    0: parsing invoke \"compress\"</span>\n<span class=\"go\">    1: unexpected end of input at 8..8</span>\n</code></pre></div>\n</blockquote>",
        "id": 501959235,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1740543829
    },
    {
        "content": "<p>tpmccallum <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2771819133\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Update at <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10511\">https://github.com/bytecodealliance/wasmtime/pull/10511</a></p>\n</blockquote>",
        "id": 509634496,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743582997
    },
    {
        "content": "<p>tpmccallum closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>I am compiling using the following command:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>cargo<span class=\"w\"> </span>component<span class=\"w\"> </span>build<span class=\"w\"> </span>--target<span class=\"w\"> </span>wasm32-wasip2\n<span class=\"w\">  </span>Generating<span class=\"w\"> </span>bindings<span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span>compress<span class=\"w\"> </span><span class=\"o\">(</span>src/bindings.rs<span class=\"o\">)</span>\n<span class=\"w\">    </span>Finished<span class=\"w\"> </span><span class=\"sb\">`</span>dev<span class=\"sb\">`</span><span class=\"w\"> </span>profile<span class=\"w\"> </span><span class=\"o\">[</span>unoptimized<span class=\"w\"> </span>+<span class=\"w\"> </span>debuginfo<span class=\"o\">]</span><span class=\"w\"> </span>target<span class=\"o\">(</span>s<span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">0</span>.07s\n</code></pre></div>\n<p>But when I use wasmtime I get an error:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>$<span class=\"w\"> </span>wasmtime<span class=\"w\"> </span>component<span class=\"w\"> </span>run<span class=\"w\"> </span>--env<span class=\"w\"> </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span><span class=\"w\"> </span>--dir<span class=\"w\"> </span>.<span class=\"w\"> </span>--invoke<span class=\"w\"> </span>compress<span class=\"w\"> </span>target/wasm32-wasip2/debug/compress.wasm\nError:<span class=\"w\"> </span>No<span class=\"w\"> </span>such<span class=\"w\"> </span>file<span class=\"w\"> </span>or<span class=\"w\"> </span>directory<span class=\"w\"> </span><span class=\"o\">(</span>os<span class=\"w\"> </span>error<span class=\"w\"> </span><span class=\"m\">2</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I put the source code and config in a repo so you can see everything. Super stumped on this one, would appreciate some assistance.</p>\n<p><a href=\"https://github.com/tpmccallum/testing_components/blob/main/README.md\">https://github.com/tpmccallum/testing_components/blob/main/README.md</a></p>\n</blockquote>",
        "id": 511755639,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744417177
    },
    {
        "content": "<p>tpmccallum <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2798249248\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10291\">issue #10291</a>:</p>\n<blockquote>\n<p>Congrats @pchickey and @alexcrichton on getting this work done and merging <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10054\">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>\n<p>For others reading this, please note that the docs at <a href=\"https://docs.wasmtime.dev/cli-options.html#run\">https://docs.wasmtime.dev/cli-options.html#run</a> show examples of invoking a component's exported functions.</p>\n</blockquote>",
        "id": 511755641,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744417177
    }
]