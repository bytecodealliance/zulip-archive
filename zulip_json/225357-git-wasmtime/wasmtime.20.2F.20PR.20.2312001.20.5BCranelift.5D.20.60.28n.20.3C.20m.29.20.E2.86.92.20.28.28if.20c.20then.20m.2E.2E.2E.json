[
    {
        "content": "<p>bongjunj opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001\">PR #12001</a> from <code>bongjunj:select_slt_falase</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>…= false`</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 554248814,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762498356
    },
    {
        "content": "<p><strong>bongjunj</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001\">PR #12001</a>.</p>",
        "id": 554248815,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762498357
    },
    {
        "content": "<p><strong>bongjunj</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001\">PR #12001</a>.</p>",
        "id": 554248817,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762498357
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#issuecomment-3501548402\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001\">PR #12001</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @cfallin, @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"cranelift\", \"isle\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>cfallin: isle</li>\n<li>fitzgen: isle</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 554277747,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762508740
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#pullrequestreview-3435421095\">PR review</a>:</p>\n<blockquote>\n<p>Thanks again for finding another missing optimization! Comment below with a suggested way to do this a little differently.</p>\n</blockquote>",
        "id": 554380741,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762537252
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#discussion_r2504761070\">PR review comment</a>:</p>\n<blockquote>\n<p>It might make sense to add a general rule to dedupe selects, something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Common Lisp\"><pre><span></span><code><span class=\"p\">(</span><span class=\"nv\">rule</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">simplify</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">slt</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">_</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">b</span><span class=\"p\">)</span>\n<span class=\"w\">                        </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">_</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">c</span><span class=\"w\"> </span><span class=\"nv\">d</span><span class=\"p\">)))</span>\n<span class=\"w\">      </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">slt</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">c</span><span class=\"p\">)</span>\n<span class=\"w\">                      </span><span class=\"p\">(</span><span class=\"nv\">slt</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">b</span><span class=\"w\"> </span><span class=\"nv\">d</span><span class=\"p\">)))</span>\n</code></pre></div>\n<p>I think this could be an intermediate step that would reveal optimization possibilities for existing small rules and effectively subsume this larger rule. I think this is also beneficial on its own, since <code>select</code>s should generally be more expensive than <code>slt</code>s (although I am not sure that our cost functions encode that at the moment), so I'm not worried about unnecessarily blowing up the enode count in this case.</p>\n<p>All that said, we would really want the equivalent of this rule for ~all operators, not just <code>slt</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Common Lisp\"><pre><span></span><code><span class=\"p\">(</span><span class=\"nv\">rule</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">simplify</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">iadd</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">_</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">b</span><span class=\"p\">)</span>\n<span class=\"w\">                         </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">_</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">c</span><span class=\"w\"> </span><span class=\"nv\">d</span><span class=\"p\">)))</span>\n<span class=\"w\">      </span><span class=\"p\">(</span><span class=\"nv\">select</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nv\">iadd</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">a</span><span class=\"w\"> </span><span class=\"nv\">c</span><span class=\"p\">)</span>\n<span class=\"w\">                      </span><span class=\"p\">(</span><span class=\"nv\">iadd</span><span class=\"w\"> </span><span class=\"nv\">ty</span><span class=\"w\"> </span><span class=\"nb\">cond</span><span class=\"w\"> </span><span class=\"nv\">b</span><span class=\"w\"> </span><span class=\"nv\">d</span><span class=\"p\">)))</span>\n</code></pre></div>\n<p>And all those rules would be annoying to write in ISLE today without macros or higher-order terms.</p>\n<p>But then again, roughly the same could be said about this rule as-is (it is combining a cprop rule, a <code>x &lt; x ==&gt; false</code> rule, and the pull-selects-out rule I sketched above; we could do the same kind of thing for all other operators' rules by combining them with their own version of the pull-selects-out rule).</p>\n<p>So after writing all this out, I think I have convinced myself that my proposed intermediate rule is the way to go, rather than writing out the \"combined\" rule as you have here. (And we don't need to add all the other operator variants of that rule now, but probably should eventually.) But we should check that adding that rule really is enough to do the \"combined\" rewrite you've proposed in this PR. We should be able to check that via your existing tests.</p>\n<p>Does all that make sense?</p>\n</blockquote>",
        "id": 554380904,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762537289
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#pullrequestreview-3435421987\">PR review</a>.</p>",
        "id": 554380911,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762537289
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#pullrequestreview-3435549130\">PR review</a>.</p>",
        "id": 554386688,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762538916
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#discussion_r2504861078\">PR review comment</a>:</p>\n<blockquote>\n<blockquote>\n<p>(although I am not sure that our cost functions encode that at the moment)</p>\n</blockquote>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/pull/12006\">https://github.com/bytecodealliance/wasmtime/pull/12006</a></p>\n</blockquote>",
        "id": 554386691,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762538916
    },
    {
        "content": "<p>bongjunj submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#pullrequestreview-3440068578\">PR review</a>.</p>",
        "id": 554566881,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762698705
    },
    {
        "content": "<p>bongjunj created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#discussion_r2508092790\">PR review comment</a>:</p>\n<blockquote>\n<p>Hi, just want to let you know it could take a while to leave my thoughts here due to my schedule. Gonna come back later soon! Thanks for your thoughtful comment.</p>\n</blockquote>",
        "id": 554566882,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762698705
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#pullrequestreview-3440422009\">PR review</a>.</p>",
        "id": 554599158,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762729990
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001#discussion_r2508386633\">PR review comment</a>:</p>\n<blockquote>\n<p>For sure, no rush! I’m out of office visiting family for a week or so, so I will also be slow to respond </p>\n</blockquote>",
        "id": 554599159,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762729990
    },
    {
        "content": "<p>bongjunj edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12001\">PR #12001</a>.</p>",
        "id": 555061340,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762937522
    }
]