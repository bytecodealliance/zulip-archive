[
    {
        "content": "<p>catamorphism opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">issue #11337</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>TODO: upload Wasm file here</p>\n<h3>Steps to Reproduce</h3>\n<p>The .wasm file was created with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">sysroot</span><span class=\"o\">=</span><span class=\"cp\">$HOME</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">libc</span><span class=\"o\">/</span><span class=\"n\">sysroot</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O0</span>\n</code></pre></div>\n<p>and <code>wasi-libc</code> was built from source.</p>\n<p><code>function-pointer.c</code> is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">void</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">f</span><span class=\"p\">)();</span>\n<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"n\">myfile</span><span class=\"p\">;</span>\n\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">f</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"c1\">// If the above line is commented out and the next line is uncommented,</span>\n<span class=\"w\">    </span><span class=\"c1\">// it works as expected</span>\n<span class=\"w\">    </span><span class=\"c1\">// f()</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">data</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">f</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">f1</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Steps:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">lldb</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">debug</span><span class=\"o\">-</span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O</span><span class=\"w\"> </span><span class=\"n\">opt</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"o\">-</span><span class=\"n\">model</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"p\">.::</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">run</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"p\">(</span><span class=\"n\">WebAssemblyPtrWrapper</span><span class=\"o\">&lt;</span><span class=\"n\">myfile</span><span class=\"o\">&gt;</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">__ptr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">199872</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">materialize</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">variable</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">available</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">errored</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">DoExecute</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">PrepareToExecuteJITExpression</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>I would expect to be able to view <code>f1</code> in the debugger at any point during the execution of <code>foo()</code>.</p>\n<h3>Actual Results</h3>\n<p>\"Couldn't materialize\" error as above.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 35.0.0</p>\n<p>Operating system: Linux (Ubuntu 24.04)</p>\n<p>Architecture: x86_64<br>\n</p>\n</blockquote>",
        "id": 531510611,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753764072
    },
    {
        "content": "<p><a href=\"https://github.com/catamorphism\">catamorphism</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">Issue #11337</a>.</p>",
        "id": 531510612,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753764073
    },
    {
        "content": "<p>catamorphism edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">issue #11337</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p>TODO: upload Wasm file here</p>\n<h3>Steps to Reproduce</h3>\n<p>The .wasm file was created with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">sysroot</span><span class=\"o\">=</span><span class=\"cp\">$HOME</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">libc</span><span class=\"o\">/</span><span class=\"n\">sysroot</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O0</span>\n</code></pre></div>\n<p>and <code>wasi-libc</code> was built from source.</p>\n<p><code>function-pointer.c</code> is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">void</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">f</span><span class=\"p\">)();</span>\n<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"n\">myfile</span><span class=\"p\">;</span>\n\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">f</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"c1\">// If the above line is commented out and the next line is uncommented,</span>\n<span class=\"w\">    </span><span class=\"c1\">// it works as expected</span>\n<span class=\"w\">    </span><span class=\"c1\">// f()</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">data</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">f</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">f1</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Steps:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">lldb</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">debug</span><span class=\"o\">-</span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O</span><span class=\"w\"> </span><span class=\"n\">opt</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"o\">-</span><span class=\"n\">model</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"p\">.::</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">run</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"p\">(</span><span class=\"n\">WebAssemblyPtrWrapper</span><span class=\"o\">&lt;</span><span class=\"n\">myfile</span><span class=\"o\">&gt;</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">__ptr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">199872</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">materialize</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">variable</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">available</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">errored</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">DoExecute</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">PrepareToExecuteJITExpression</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>I would expect to be able to view <code>f1</code> in the debugger at any point during the execution of <code>foo()</code>.</p>\n<h3>Actual Results</h3>\n<p>\"Couldn't materialize\" error as above.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 35.0.0</p>\n<p>lldb version: 18.1.3</p>\n<p>Operating system: Linux (Ubuntu 24.04)</p>\n<p>Architecture: x86_64<br>\n</p>\n</blockquote>",
        "id": 531510665,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753764111
    },
    {
        "content": "<p>catamorphism edited <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">issue #11337</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p><a href=\"https://github.com/user-attachments/files/21480824/function-pointer.wasm.gz\">function-pointer.wasm.gz</a></p>\n<h3>Steps to Reproduce</h3>\n<p>The .wasm file was created with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">sysroot</span><span class=\"o\">=</span><span class=\"cp\">$HOME</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">libc</span><span class=\"o\">/</span><span class=\"n\">sysroot</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O0</span>\n</code></pre></div>\n<p>and <code>wasi-libc</code> was built from source.</p>\n<p><code>function-pointer.c</code> is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">void</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">f</span><span class=\"p\">)();</span>\n<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"n\">myfile</span><span class=\"p\">;</span>\n\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">f</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"c1\">// If the above line is commented out and the next line is uncommented,</span>\n<span class=\"w\">    </span><span class=\"c1\">// it works as expected</span>\n<span class=\"w\">    </span><span class=\"c1\">// f()</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">data</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">f</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">f1</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Steps:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">lldb</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">debug</span><span class=\"o\">-</span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O</span><span class=\"w\"> </span><span class=\"n\">opt</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"o\">-</span><span class=\"n\">model</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"p\">.::</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">run</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"p\">(</span><span class=\"n\">WebAssemblyPtrWrapper</span><span class=\"o\">&lt;</span><span class=\"n\">myfile</span><span class=\"o\">&gt;</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">__ptr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">199872</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">materialize</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">variable</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">available</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">errored</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">DoExecute</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">PrepareToExecuteJITExpression</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>I would expect to be able to view <code>f1</code> in the debugger at any point during the execution of <code>foo()</code>.</p>\n<h3>Actual Results</h3>\n<p>\"Couldn't materialize\" error as above.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 35.0.0</p>\n<p>lldb version: 18.1.3</p>\n<p>Operating system: Linux (Ubuntu 24.04)</p>\n<p>Architecture: x86_64<br>\n</p>\n</blockquote>",
        "id": 531510745,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753764172
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337#issuecomment-3130873777\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">issue #11337</a>:</p>\n<blockquote>\n<p>Unfortunately I don't have an easy answer/fix, but I'll note that historically our native-debugger support has been quite best-effort, and is more or less unmaintained at the moment. The DWARF translation has had known bugs, and we know that various aspects of our lowering can cause values to become unavailable. All of that to say: I'm not surprised that you are finding holes, and I wouldn't recommend relying on debugging by attaching a native debugger to wasmtime at the moment.</p>\n<p>We do have a <a href=\"https://github.com/bytecodealliance/rfcs/blob/main/accepted/wasmtime-debugging.md\">debugging RFC</a> that captures a lot of thinking about our debugging plans from a year ago; and assuming plans don't change, I should be able to start work on pieces of this later in the year.</p>\n</blockquote>",
        "id": 531523489,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753770516
    },
    {
        "content": "<p><a href=\"https://github.com/fitzgen\">fitzgen</a> added the wasmtime:debugging label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">Issue #11337</a>.</p>",
        "id": 532122976,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753980410
    },
    {
        "content": "<p><a href=\"https://github.com/fitzgen\">fitzgen</a> added the cranelift:area:debug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">Issue #11337</a>.</p>",
        "id": 532122977,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1753980410
    },
    {
        "content": "<p>cfallin closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11337\">issue #11337</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<p><a href=\"https://github.com/user-attachments/files/21480824/function-pointer.wasm.gz\">function-pointer.wasm.gz</a></p>\n<h3>Steps to Reproduce</h3>\n<p>The .wasm file was created with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">clang</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip2</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">sysroot</span><span class=\"o\">=</span><span class=\"cp\">$HOME</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">libc</span><span class=\"o\">/</span><span class=\"n\">sysroot</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O0</span>\n</code></pre></div>\n<p>and <code>wasi-libc</code> was built from source.</p>\n<p><code>function-pointer.c</code> is as follows:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">  </span><span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">data</span><span class=\"p\">;</span>\n<span class=\"w\">  </span><span class=\"n\">void</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">*</span><span class=\"n\">f</span><span class=\"p\">)();</span>\n<span class=\"p\">}</span><span class=\"w\"> </span><span class=\"n\">myfile</span><span class=\"p\">;</span>\n\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">f</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"c1\">// If the above line is commented out and the next line is uncommented,</span>\n<span class=\"w\">    </span><span class=\"c1\">// it works as expected</span>\n<span class=\"w\">    </span><span class=\"c1\">// f()</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">f1</span><span class=\"p\">-&gt;</span><span class=\"nc\">data</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">int</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"k\">struct</span><span class=\"w\"> </span><span class=\"nc\">myfile</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">f</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"n\">f1</span><span class=\"p\">.</span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">42</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">f1</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Steps:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">lldb</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"n\">debug</span><span class=\"o\">-</span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">O</span><span class=\"w\"> </span><span class=\"n\">opt</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">component</span><span class=\"o\">-</span><span class=\"n\">model</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">dir</span><span class=\"w\"> </span><span class=\"p\">.::</span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">pointer</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">foo</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">run</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"p\">(</span><span class=\"n\">WebAssemblyPtrWrapper</span><span class=\"o\">&lt;</span><span class=\"n\">myfile</span><span class=\"o\">&gt;</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"p\">(</span><span class=\"n\">__ptr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">199872</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"p\">(</span><span class=\"n\">lldb</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">f1</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">materialize</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">variable</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">available</span>\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">errored</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">DoExecute</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">couldn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"n\">PrepareToExecuteJITExpression</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p>I would expect to be able to view <code>f1</code> in the debugger at any point during the execution of <code>foo()</code>.</p>\n<h3>Actual Results</h3>\n<p>\"Couldn't materialize\" error as above.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: 35.0.0</p>\n<p>lldb version: 18.1.3</p>\n<p>Operating system: Linux (Ubuntu 24.04)</p>\n<p>Architecture: x86_64<br>\n</p>\n</blockquote>",
        "id": 571999341,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1770235597
    }
]