[
    {
        "content": "<p>tomasol opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113\">issue #12113</a>:</p>\n<blockquote>\n<h3>Steps to Reproduce</h3>\n<p>Current <code>ResourceTable::iter_mut</code> does not filter out deleted resources, and forces following pattern:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">join_set</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">resource_table</span><span class=\"p\">.</span><span class=\"n\">iter_mut</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">join_set</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">join_set</span><span class=\"p\">.</span><span class=\"n\">downcast_ref</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"n\">JoinSetResource</span><span class=\"o\">&gt;</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"c1\">// Must be `Tombstone`:</span>\n<span class=\"w\">        </span><span class=\"k\">continue</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">};</span>\n<span class=\"w\">        </span><span class=\"o\">..</span><span class=\"p\">.</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p><code>iter_mut</code> should not return <code>Tombstone</code> values. This change would make it consistent with other functions like <code>is_empty</code> and <code>Debug</code> output.</p>\n<h3>Actual Results</h3>\n<p><code>Tombstone</code> is returned, forcing to skip unknown resource types, which can lead to bugs.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime 39.0.1</p>\n<h3>Extra Info</h3>\n<p>This happens only in debug mode, as <code>Tombstone</code>s are not used when debug assertions are disabled.<br>\nI can make the PR if this issue is confirmed.</p>\n</blockquote>",
        "id": 561663367,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764771516
    },
    {
        "content": "<p><a href=\"https://github.com/tomasol\">tomasol</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113\">Issue #12113</a>.</p>",
        "id": 561663369,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764771516
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113#issuecomment-3607608746\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113\">issue #12113</a>:</p>\n<blockquote>\n<p>Thanks for the report! Related, but somewhat orthogonal as well, I've sent <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12114\">https://github.com/bytecodealliance/wasmtime/pull/12114</a> to disable <code>Tombstone</code> in debug builds since while that was useful for development I don't think we want it on-by-default. Regardless though if you'd like to send a PR to fix the iterator behavior that also sounds good!</p>\n</blockquote>",
        "id": 561694412,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764778084
    },
    {
        "content": "<p>tomasol closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113\">issue #12113</a>:</p>\n<blockquote>\n<h3>Steps to Reproduce</h3>\n<p>Current <code>ResourceTable::iter_mut</code> does not filter out deleted resources, and forces following pattern:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">join_set</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">resource_table</span><span class=\"p\">.</span><span class=\"n\">iter_mut</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">join_set</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">join_set</span><span class=\"p\">.</span><span class=\"n\">downcast_ref</span><span class=\"p\">::</span><span class=\"o\">&lt;</span><span class=\"n\">JoinSetResource</span><span class=\"o\">&gt;</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">        </span><span class=\"c1\">// Must be `Tombstone`:</span>\n<span class=\"w\">        </span><span class=\"k\">continue</span><span class=\"p\">;</span>\n<span class=\"w\">    </span><span class=\"p\">};</span>\n<span class=\"w\">        </span><span class=\"o\">..</span><span class=\"p\">.</span>\n</code></pre></div>\n<h3>Expected Results</h3>\n<p><code>iter_mut</code> should not return <code>Tombstone</code> values. This change would make it consistent with other functions like <code>is_empty</code> and <code>Debug</code> output.</p>\n<h3>Actual Results</h3>\n<p><code>Tombstone</code> is returned, forcing to skip unknown resource types, which can lead to bugs.</p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime 39.0.1</p>\n<h3>Extra Info</h3>\n<p>This happens only in debug mode, as <code>Tombstone</code>s are not used when debug assertions are disabled.<br>\nI can make the PR if this issue is confirmed.</p>\n</blockquote>",
        "id": 561712218,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764782333
    },
    {
        "content": "<p>tomasol <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113#issuecomment-3607939286\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12113\">issue #12113</a>:</p>\n<blockquote>\n<p>Thanks for the quick response, I think the filter is no longer needed.</p>\n</blockquote>",
        "id": 561712219,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764782334
    }
]