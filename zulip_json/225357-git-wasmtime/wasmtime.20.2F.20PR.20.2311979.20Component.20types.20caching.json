[
    {
        "content": "<p>EthanBlackburn opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a> from <code>EthanBlackburn:component-types-contention</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>PR to resolve performance issue discovered in <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11974\">https://github.com/bytecodealliance/wasmtime/issues/11974</a></p>\n<p>This caches the component types to prevent inc/dec contention on <code>arc::clone</code><br>\n</p>\n</blockquote>",
        "id": 553694614,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762283646
    },
    {
        "content": "<p><strong>EthanBlackburn</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>.</p>",
        "id": 553694615,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762283646
    },
    {
        "content": "<p><strong>EthanBlackburn</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>.</p>",
        "id": 553694619,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762283646
    },
    {
        "content": "<p>EthanBlackburn edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>:</p>\n<blockquote>\n<p>PR to resolve performance issue discovered in <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11974\">https://github.com/bytecodealliance/wasmtime/issues/11974</a></p>\n<p>This caches the component types to prevent inc/dec contention on <code>arc::clone</code>.</p>\n<p>Not sure how you'd want to do this, but happy to go through several iterations or let Alex handle it.<br>\n</p>\n</blockquote>",
        "id": 553694763,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762283706
    },
    {
        "content": "<p>EthanBlackburn edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>:</p>\n<blockquote>\n<p>PR to resolve performance issue discovered in <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11974\">https://github.com/bytecodealliance/wasmtime/issues/11974</a></p>\n<p>This caches the component types to prevent inc/dec contention on <code>arc::clone</code>.</p>\n<p>From our own benchmarks:</p>\n<p>Before change</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">producer</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">consumed</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"mf\">2798.62</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"mf\">93.28</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">guest</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">bytes_in</span><span class=\"o\">=</span><span class=\"mf\">2794.94</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">avg_latency</span><span class=\"o\">=</span><span class=\"mf\">19.490</span><span class=\"w\"> </span><span class=\"n\">ms</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"mi\">12169</span><span class=\"w\"> </span><span class=\"n\">calls</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>After change</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">producer</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">consumed</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"mf\">3731.03</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"mf\">124.36</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">guest</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">bytes_in</span><span class=\"o\">=</span><span class=\"mf\">3728.28</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">avg_latency</span><span class=\"o\">=</span><span class=\"mf\">13.473</span><span class=\"w\"> </span><span class=\"n\">ms</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"mi\">16252</span><span class=\"w\"> </span><span class=\"n\">calls</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>Not sure how you'd want to do this, but happy to go through several iterations or let Alex handle it.<br>\n</p>\n</blockquote>",
        "id": 553699647,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762285395
    },
    {
        "content": "<p>EthanBlackburn edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>:</p>\n<blockquote>\n<p>PR to resolve performance issue discovered in <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11974\">https://github.com/bytecodealliance/wasmtime/issues/11974</a></p>\n<p>This caches the component types to prevent inc/dec contention on <code>arc::clone</code>.</p>\n<p>From our own benchmarks:</p>\n<p>Before change</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">producer</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">consumed</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"mf\">2798.62</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"mf\">93.28</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">guest</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">bytes_in</span><span class=\"o\">=</span><span class=\"mf\">2794.94</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">avg_latency</span><span class=\"o\">=</span><span class=\"mf\">19.490</span><span class=\"w\"> </span><span class=\"n\">ms</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"mi\">12169</span><span class=\"w\"> </span><span class=\"n\">calls</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>After change</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">producer</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">consumed</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"mf\">3731.03</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"mf\">124.36</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">guest</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">bytes_in</span><span class=\"o\">=</span><span class=\"mf\">3728.28</span><span class=\"w\"> </span><span class=\"n\">MiB</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">avg_latency</span><span class=\"o\">=</span><span class=\"mf\">13.473</span><span class=\"w\"> </span><span class=\"n\">ms</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">over</span><span class=\"w\"> </span><span class=\"mi\">16252</span><span class=\"w\"> </span><span class=\"n\">calls</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>I'm not sure if my approach is the right one, but happy to go through several iterations or let Alex handle it.<br>\n</p>\n</blockquote>",
        "id": 553700804,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762285842
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979#pullrequestreview-3418460099\">PR review</a>:</p>\n<blockquote>\n<p>Thanks for the PR! This is something though where I'd prefer to not add extra unsafe abstractions if we can. I haven't studied this too too much yet but I'll try to spend some time in the near future looking at the call graphs here and see if I can't figure out a way to plumb a borrow around that'd help out</p>\n</blockquote>",
        "id": 553703186,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762286754
    },
    {
        "content": "<p>EthanBlackburn closed without merge <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>.</p>",
        "id": 553718897,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762291169
    },
    {
        "content": "<p>EthanBlackburn <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979#issuecomment-3488052202\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>:</p>\n<blockquote>\n<p>Makes sense. I took a look at plumbing a borrow, but seems like I'd have to change several layers in the callstack I'm not familiar with, and my change would require several review turnarounds. Will leave it to you</p>\n<p>Thanks again</p>\n</blockquote>",
        "id": 553718899,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762291169
    },
    {
        "content": "<p>EthanBlackburn edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979#issuecomment-3488052202\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11979\">PR #11979</a>:</p>\n<blockquote>\n<p>Makes sense. I took a look at plumbing a borrow, but seems like I'd have to change several layers in the callstack I'm not familiar with, and my change would require several review turnarounds. Will leave it to you</p>\n<p>Thanks again for taking a look!</p>\n</blockquote>",
        "id": 553718929,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1762291182
    }
]