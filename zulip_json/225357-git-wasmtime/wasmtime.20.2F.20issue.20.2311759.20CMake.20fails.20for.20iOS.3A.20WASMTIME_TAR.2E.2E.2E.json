[
    {
        "content": "<p>josephg opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">issue #11759</a>:</p>\n<blockquote>\n<p>Right now if you try and build for iOS:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>cmake<span class=\"w\"> </span>-S<span class=\"w\"> </span>crates/c-api<span class=\"w\"> </span>-B<span class=\"w\"> </span>target/c-api<span class=\"w\"> </span>--install-prefix<span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"k\">$(</span><span class=\"nb\">pwd</span><span class=\"k\">)</span><span class=\"s2\">/artifacts\"</span><span class=\"w\"> </span>-DWASMTIME_TARGET<span class=\"o\">=</span>aarch64-apple-ios<span class=\"w\"> </span>-DWASMTIME_FEATURES<span class=\"o\">=</span><span class=\"s2\">\"parallel-compilation,pooling-allocator,cranelift,demangle,profiling,coredump,addr2line,winch,pulley\"</span>\n\ncmake<span class=\"w\"> </span>--build<span class=\"w\"> </span>target/c-api\ncmake<span class=\"w\"> </span>--install<span class=\"w\"> </span>target/c-api\n</code></pre></div>\n<p>The cmake install fails:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CMake</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">cmake_install</span><span class=\"p\">.</span><span class=\"n\">cmake</span><span class=\"p\">:</span><span class=\"mi\">45</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">):</span>\n<span class=\"w\">  </span><span class=\"nc\">file</span><span class=\"w\"> </span><span class=\"n\">INSTALL</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">find</span>\n<span class=\"w\">  </span><span class=\"s\">\"/Users/seph/3rdparty/wasmtime/crates/c-api/../../target/aarch64-apple-ios/release/libwasmtime.so\"</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"nc\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>The problem is this line in CMakeLists.txt:</p>\n<div class=\"codehilite\" data-code-language=\"CMake\"><pre><span></span><code><span class=\"nb\">if</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_TARGET</span><span class=\"w\"> </span><span class=\"s\">MATCHES</span><span class=\"w\"> </span><span class=\"s2\">\"darwin\"</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_SHARED_FILES</span><span class=\"w\"> </span><span class=\"s\">libwasmtime.dylib</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_STATIC_FILES</span><span class=\"w\"> </span><span class=\"s\">libwasmtime.a</span><span class=\"p\">)</span>\n<span class=\"nb\">elseif</span><span class=\"p\">(</span><span class=\"s\">...</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>This case should also match for ios, and other apple targets. Changing it to this:</p>\n<div class=\"codehilite\" data-code-language=\"CMake\"><pre><span></span><code><span class=\"nb\">if</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_TARGET</span><span class=\"w\"> </span><span class=\"s\">MATCHES</span><span class=\"w\"> </span><span class=\"s2\">\"apple\"</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>Fixes the problem.</p>\n</blockquote>",
        "id": 542182412,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759207256
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759#issuecomment-3352428137\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">issue #11759</a>:</p>\n<blockquote>\n<p>Thanks for the report! Would you be up for sending a PR for this?</p>\n</blockquote>",
        "id": 542289171,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759241881
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasmtime:c-api label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">Issue #11759</a>.</p>",
        "id": 542289258,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759241902
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasmtime:platform-support label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">Issue #11759</a>.</p>",
        "id": 542289263,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759241903
    },
    {
        "content": "<p>josephg <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759#issuecomment-3362773044\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">issue #11759</a>:</p>\n<blockquote>\n<p>Sure thing:</p>\n<p><a href=\"https://github.com/bytecodealliance/wasmtime/pull/11782\">https://github.com/bytecodealliance/wasmtime/pull/11782</a></p>\n</blockquote>",
        "id": 542823814,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759436078
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11759\">issue #11759</a>:</p>\n<blockquote>\n<p>Right now if you try and build for iOS:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>cmake<span class=\"w\"> </span>-S<span class=\"w\"> </span>crates/c-api<span class=\"w\"> </span>-B<span class=\"w\"> </span>target/c-api<span class=\"w\"> </span>--install-prefix<span class=\"w\"> </span><span class=\"s2\">\"</span><span class=\"k\">$(</span><span class=\"nb\">pwd</span><span class=\"k\">)</span><span class=\"s2\">/artifacts\"</span><span class=\"w\"> </span>-DWASMTIME_TARGET<span class=\"o\">=</span>aarch64-apple-ios<span class=\"w\"> </span>-DWASMTIME_FEATURES<span class=\"o\">=</span><span class=\"s2\">\"parallel-compilation,pooling-allocator,cranelift,demangle,profiling,coredump,addr2line,winch,pulley\"</span>\n\ncmake<span class=\"w\"> </span>--build<span class=\"w\"> </span>target/c-api\ncmake<span class=\"w\"> </span>--install<span class=\"w\"> </span>target/c-api\n</code></pre></div>\n<p>The cmake install fails:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">CMake</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">-</span><span class=\"n\">api</span><span class=\"o\">/</span><span class=\"n\">cmake_install</span><span class=\"p\">.</span><span class=\"n\">cmake</span><span class=\"p\">:</span><span class=\"mi\">45</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">):</span>\n<span class=\"w\">  </span><span class=\"nc\">file</span><span class=\"w\"> </span><span class=\"n\">INSTALL</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">find</span>\n<span class=\"w\">  </span><span class=\"s\">\"/Users/seph/3rdparty/wasmtime/crates/c-api/../../target/aarch64-apple-ios/release/libwasmtime.so\"</span><span class=\"p\">:</span>\n<span class=\"w\">  </span><span class=\"nc\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"p\">.</span>\n</code></pre></div>\n<p>The problem is this line in CMakeLists.txt:</p>\n<div class=\"codehilite\" data-code-language=\"CMake\"><pre><span></span><code><span class=\"nb\">if</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_TARGET</span><span class=\"w\"> </span><span class=\"s\">MATCHES</span><span class=\"w\"> </span><span class=\"s2\">\"darwin\"</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_SHARED_FILES</span><span class=\"w\"> </span><span class=\"s\">libwasmtime.dylib</span><span class=\"p\">)</span>\n<span class=\"w\">  </span><span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_STATIC_FILES</span><span class=\"w\"> </span><span class=\"s\">libwasmtime.a</span><span class=\"p\">)</span>\n<span class=\"nb\">elseif</span><span class=\"p\">(</span><span class=\"s\">...</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>This case should also match for ios, and other apple targets. Changing it to this:</p>\n<div class=\"codehilite\" data-code-language=\"CMake\"><pre><span></span><code><span class=\"nb\">if</span><span class=\"p\">(</span><span class=\"s\">WASMTIME_TARGET</span><span class=\"w\"> </span><span class=\"s\">MATCHES</span><span class=\"w\"> </span><span class=\"s2\">\"apple\"</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>Fixes the problem.</p>\n</blockquote>",
        "id": 542980212,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1759508037
    }
]