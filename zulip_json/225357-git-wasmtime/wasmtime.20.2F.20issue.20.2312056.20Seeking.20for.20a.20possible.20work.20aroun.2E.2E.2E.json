[
    {
        "content": "<p>leandro-benedet-garcia opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<p>Hello, I am doing something related to implementing function calls from a table, I did find this post which would do exactly what I need <a href=\"https://github.com/bytecodealliance/wasmtime/issues/2646#issuecomment-775491554\">https://github.com/bytecodealliance/wasmtime/issues/2646#issuecomment-775491554</a>. But seemingly the related api seems to have been removed, and I cannot find at all anything close to it from the documentation, and since the documentation of the C API is extremely hard to follow, I am opening this issue.</p>\n<p>Basically, is there any work around that might allow me to get a function in <code>__indirect_function_table</code> and call it with the current API?</p>\n</blockquote>",
        "id": 558486942,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763658862
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559285253\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<p>If <code>__indirect_function_table</code> is exported by a wasm module, I think you can use <code>wasmtime_instance_export_get</code> to get the table export, check that the <code>kind</code> is <code>WASMTIME_EXTERN_TABLE</code> and then use <code>wasmtime_table_get</code> to get an individual table item.</p>\n</blockquote>",
        "id": 558492354,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763660563
    },
    {
        "content": "<p>leandro-benedet-garcia <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559328602\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<blockquote>\n<p>If <code>__indirect_function_table</code> is exported by a wasm module, I think you can use <code>wasmtime_instance_export_get</code> to get the table export, check that the <code>kind</code> is <code>WASMTIME_EXTERN_TABLE</code> and then use <code>wasmtime_table_get</code> to get an individual table item.</p>\n</blockquote>\n<p>Is there any way to convert a <code>wasm</code> type into a <code>wasmtime</code> type without the need to start the process of creating a <code>wasmtime_instance_t</code>?</p>\n<p>Basically I am trying to collaborate to a project that already uses  the regular wasm functions and not wasmtime, basically I was able to get it working to get a <code>wasm_ref_t</code> with <code>wasm_table_get</code> but I had not realized that functions related to <code>wasm_ref_t</code> where not available and was wanting to know if it was possible to, somehow convert then into callable functions without starting the chain again just to call a function.</p>\n</blockquote>",
        "id": 558494946,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763661265
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559393394\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<p>If you want to use <code>wasm.h</code> instead of <code>wasmtime.h</code> you should use <code>wasm_module_exports</code> and <code>wasm_instance_exports</code> together. They both return a list of the same size. The former allows you to get the index of the export you need while the later allows you to get the right export as <code>wasm_extern_t</code> that you can pass to <code>wasm_extern_as_table</code> (make sure to check that <code>wasm_extern_kind</code> returns a table first).</p>\n<p>AFAIK there is no way to mix and match <code>wasm.h</code> and <code>wasmtime.h</code>.</p>\n</blockquote>",
        "id": 558498250,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763662277
    },
    {
        "content": "<p>leandro-benedet-garcia <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559481885\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<blockquote>\n<p>If you want to use <code>wasm.h</code> instead of <code>wasmtime.h</code> you should use <code>wasm_module_exports</code> and <code>wasm_instance_exports</code> together. They both return a list of the same size. The former allows you to get the index of the export you need while the later allows you to get the right export as <code>wasm_extern_t</code> that you can pass to <code>wasm_extern_as_table</code> (make sure to check that <code>wasm_extern_kind</code> returns a table first).</p>\n</blockquote>\n<p>Yes, that part I already have, the problem is that I cannot seem to convert <code>wasm_ref_t</code> to a callable function with wasm.h hence why I was hoping to at least figure out a way to convert.</p>\n<blockquote>\n<p>AFAIK there is no way to mix and match <code>wasm.h</code> and <code>wasmtime.h</code>.</p>\n</blockquote>\n<p>So basically if I have something already with wasm.h I will need to at least open the wasm file again just to be able to get the wasmtime types?<br>\n</p>\n</blockquote>",
        "id": 558502399,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763663589
    },
    {
        "content": "<p>bjorn3 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559688318\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<blockquote>\n<p>Yes, that part I already have, the problem is that I cannot seem to convert wasm_ref_t to a callable function with wasm.h hence why I was hoping to at least figure out a way to convert.</p>\n</blockquote>\n<p>That would be <code>wasm_ref_as_func</code>, but Wasmtime doesn't implement it...</p>\n<blockquote>\n<p>So basically if I have something already with wasm.h I will need to at least open the wasm file again just to be able to get the wasmtime types?</p>\n</blockquote>\n<p>If you want to use anything from wasmtime.h at all you pretty much have to rewrite everything to use wasmtime.h. There is no way to convert between <code>wasm_*_t</code> and <code>wasmtime_*_t</code>, so even reopening the wasm file with the wasmtime.h api won't be all that useful as you can't use it to call a function of a <code>wasm_instance_t</code>.</p>\n</blockquote>",
        "id": 558511980,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763666759
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3559997496\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<p>Using <code>wasm.h</code> exclusively you'd need to use <code>wasm_ref_as_func</code>, yeah, and that's not implemented today. If you're interested though I think it would be implementable to do this so this is likely \"just a PR away\" from getting filled out. If you're already using <code>wasm.h</code> for another engine, that's makes sense to want to keep using that, but I'll caution you that in general <code>wasmtime.h</code>-style APIs are what we recommend for the C API.</p>\n</blockquote>",
        "id": 558526350,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763671879
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasmtime:c-api label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">Issue #12056</a>.</p>",
        "id": 558526380,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763671885
    },
    {
        "content": "<p>leandro-benedet-garcia <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3560002586\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<blockquote>\n<p>Using <code>wasm.h</code> exclusively you'd need to use <code>wasm_ref_as_func</code>, yeah, and that's not implemented today. If you're interested though I think it would be implementable to do this so this is likely \"just a PR away\" from getting filled out. If you're already using <code>wasm.h</code> for another engine, that's makes sense to want to keep using that, but I'll caution you that in general <code>wasmtime.h</code>-style APIs are what we recommend for the C API.</p>\n</blockquote>\n<p>How difficult would be to implement it tho</p>\n</blockquote>",
        "id": 558526601,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763671973
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056#issuecomment-3560014127\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12056\">issue #12056</a>:</p>\n<blockquote>\n<p>It would be filling out <a href=\"https://github.com/bytecodealliance/wasmtime/blob/449e5962eaa47a23096b62e23bd15d430f9952c8/crates/c-api/src/ref.rs#L94C19-L94C35\">this function</a>  which would involve changing [the representation of <a href=\"https://github.com/bytecodealliance/wasmtime/blob/449e5962eaa47a23096b62e23bd15d430f9952c8/crates/c-api/src/ref.rs#L19-L21\"><code>wasm_ref_t</code></a> to internally contain a <code>wasm_func_t</code> instead of a <code>Ref</code>. This is a bit weird, but it's because <a href=\"https://github.com/bytecodealliance/wasmtime/blob/449e5962eaa47a23096b62e23bd15d430f9952c8/crates/c-api/src/ref.rs#L27\">we only support functions</a> when creating <code>wasm_ref_t</code></p>\n</blockquote>",
        "id": 558527158,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1763672227
    }
]