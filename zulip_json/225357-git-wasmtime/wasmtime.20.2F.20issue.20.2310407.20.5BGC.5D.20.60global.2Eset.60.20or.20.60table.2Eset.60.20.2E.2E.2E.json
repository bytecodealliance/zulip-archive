[
    {
        "content": "<p><a href=\"https://github.com/f52985\">f52985</a> added the bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">Issue #10407</a>.</p>",
        "id": 506085641,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742202423
    },
    {
        "content": "<p>f52985 opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"c1\">;; global.wast</span>\n<span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">global</span> <span class=\"nv\">$g</span> <span class=\"p\">(</span><span class=\"k\">mut</span> <span class=\"err\">anyref</span><span class=\"p\">)</span> <span class=\"c1\">;; or eqref</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"f\"</span><span class=\"p\">)</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">global.set</span> <span class=\"nv\">$g</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"err\">assert_</span><span class=\"nb\">return</span> <span class=\"p\">(</span><span class=\"err\">invoke</span> <span class=\"s2\">\"f\"</span><span class=\"p\">))</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"c1\">;; table.wast</span>\n<span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">table</span> <span class=\"nv\">$t</span> <span class=\"kt\">i32</span> <span class=\"mi\">1</span> <span class=\"err\">anyref</span> <span class=\"c1\">;; or eqref</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"f\"</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">table.set</span> <span class=\"nv\">$t</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"err\">assert_</span><span class=\"nb\">return</span> <span class=\"p\">(</span><span class=\"err\">invoke</span> <span class=\"s2\">\"f\"</span><span class=\"p\">))</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<p><code>wasmtime wast -W gc=y global.wast</code><br>\n<code>wasmtime wast -W gc=y -W function-references=y table.wast</code></p>\n<h3>Expected Results</h3>\n<p>Ternimates normally</p>\n<h3>Actual Results</h3>\n<p><code>[1]    57797 illegal hardware instruction  wasmtime wast -W gc=y global.wast</code><br>\n<code>[1]    57844 illegal hardware instruction  wasmtime wast -W gc=y -W function-references=y table.wast</code></p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: wasmtime 30.0.2 (398694a59 2025-02-25)</p>\n<p>Operating system: MacOS Sonoma 14.5(23F79) (Also confirmed on Ubuntu 20.04.6 LTS)</p>\n<p>Architecture: Apple M3</p>\n<h3>Extra Info</h3>\n<p>There are some specific requirements for triggering this bug:</p>\n<ol>\n<li><code>global.set</code> or <code>table.set</code> is required. The bug is not triggered for <code>global.get</code> or <code>table.get</code>.</li>\n<li>There are two <code>ref.i31</code> values for each module: the initializer value, and the new value being set. At least one number that goes into the <code>ref.i31</code> should be larger than or equal to 262,136 (Perhaps it has something to do with the fact that <code>2^18 == 262,144</code>?)</li>\n<li>The global type or table type must be <code>anyref</code> or <code>eqref</code>. The bug is not triggered for non-nullable references (<code>ref any</code>, <code>ref eq</code>), or i31 references (<code>i31ref</code>)</li>\n</ol>\n<p>These might be helpful for localizing the root cause.</p>\n</blockquote>",
        "id": 506085651,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742202424
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the fuzz-bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">Issue #10407</a>.</p>",
        "id": 506164630,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742220927
    },
    {
        "content": "<p>alexcrichton assigned fitzgen to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>.</p>",
        "id": 506164660,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742220932
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407#issuecomment-2730041785\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<p>Thanks for filing, the reduced test case, and the extra info!</p>\n</blockquote>",
        "id": 506194171,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742226929
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407#issuecomment-2731290956\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<p>Hm, I'm not able to reproduce on <code>main</code> at commit <code>1ea710d60a</code> with either test case.</p>\n</blockquote>",
        "id": 506293999,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742258967
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407#issuecomment-2731291603\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<p>FWIW, I am on x86_64, not aarch64, but I really wouldn't expect that to make a difference here.</p>\n</blockquote>",
        "id": 506294038,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742258999
    },
    {
        "content": "<p>f52985 closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<h3>Test Case</h3>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"c1\">;; global.wast</span>\n<span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">global</span> <span class=\"nv\">$g</span> <span class=\"p\">(</span><span class=\"k\">mut</span> <span class=\"err\">anyref</span><span class=\"p\">)</span> <span class=\"c1\">;; or eqref</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"f\"</span><span class=\"p\">)</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">global.set</span> <span class=\"nv\">$g</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"err\">assert_</span><span class=\"nb\">return</span> <span class=\"p\">(</span><span class=\"err\">invoke</span> <span class=\"s2\">\"f\"</span><span class=\"p\">))</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"WebAssembly\"><pre><span></span><code><span class=\"c1\">;; table.wast</span>\n<span class=\"p\">(</span><span class=\"k\">module</span>\n  <span class=\"p\">(</span><span class=\"k\">table</span> <span class=\"nv\">$t</span> <span class=\"kt\">i32</span> <span class=\"mi\">1</span> <span class=\"err\">anyref</span> <span class=\"c1\">;; or eqref</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">func</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"s2\">\"f\"</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"c1\">;;(i32.const 262_135) ;; OK</span>\n    <span class=\"p\">(</span><span class=\"nb\">i32.const</span> <span class=\"mf\">262_136</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">ref.i</span><span class=\"mi\">31</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"err\">table.set</span> <span class=\"nv\">$t</span><span class=\"p\">)</span>\n  <span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"err\">assert_</span><span class=\"nb\">return</span> <span class=\"p\">(</span><span class=\"err\">invoke</span> <span class=\"s2\">\"f\"</span><span class=\"p\">))</span>\n</code></pre></div>\n<h3>Steps to Reproduce</h3>\n<p><code>wasmtime wast -W gc=y global.wast</code><br>\n<code>wasmtime wast -W gc=y -W function-references=y table.wast</code></p>\n<h3>Expected Results</h3>\n<p>Ternimates normally</p>\n<h3>Actual Results</h3>\n<p><code>[1]    57797 illegal hardware instruction  wasmtime wast -W gc=y global.wast</code><br>\n<code>[1]    57844 illegal hardware instruction  wasmtime wast -W gc=y -W function-references=y table.wast</code></p>\n<h3>Versions and Environment</h3>\n<p>Wasmtime version or commit: wasmtime 30.0.2 (398694a59 2025-02-25)</p>\n<p>Operating system: MacOS Sonoma 14.5(23F79) (Also confirmed on Ubuntu 20.04.6 LTS)</p>\n<p>Architecture: Apple M3</p>\n<h3>Extra Info</h3>\n<p>There are some specific requirements for triggering this bug:</p>\n<ol>\n<li><code>global.set</code> or <code>table.set</code> is required. The bug is not triggered for <code>global.get</code> or <code>table.get</code>.</li>\n<li>There are two <code>ref.i31</code> values for each module: the initializer value, and the new value being set. At least one number that goes into the <code>ref.i31</code> should be larger than or equal to 262,136 (Perhaps it has something to do with the fact that <code>2^18 == 262,144</code>?)</li>\n<li>The global type or table type must be <code>anyref</code> or <code>eqref</code>. The bug is not triggered for non-nullable references (<code>ref any</code>, <code>ref eq</code>), or i31 references (<code>i31ref</code>)</li>\n</ol>\n<p>These might be helpful for localizing the root cause.</p>\n</blockquote>",
        "id": 506326735,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742275178
    },
    {
        "content": "<p>f52985 <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407#issuecomment-2731678498\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<p>Thanks for checking! I also tested again on the commit (1ea710d60a) and can confirm that the issue is no longer reproducible. It looks like it was fixed somewhere along the way. I'll go ahead and close the issue.</p>\n</blockquote>",
        "id": 506326741,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742275179
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407#issuecomment-2733626804\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/10407\">issue #10407</a>:</p>\n<blockquote>\n<p>Bisection shows this was fixed in #10221</p>\n</blockquote>",
        "id": 506508877,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1742310928
    }
]