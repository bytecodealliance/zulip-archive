[
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a> from <code>alexcrichton:more-func-refactor</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This commit refactors the internals of how guest functions call out to the host. Previously Wasmtime had a split where <code>Func::new</code>-style constructors used one entrypoint and <code>Func::wrap</code>-style entrypoints used a different entrypoint. This was required long ago when we had an array and native ABI calling convention, but nowadays this is no longer required. This refactors things to have a single base-level signature which is the narrow waist through which all other function entrypoints go through. This enables having a single function handle all the things like panicking, call hooks, etc, and everything further builds on top of it.</p>\n<p>This commit additionally pushes the async-ness of a function down even further. Previously many <code>*_async</code> constructors would quickly delegate to their non-async counterpart, but this is expected to more-or-less become not the right way to do things as wasmtime moves into the future. Historical refactorings related to GC, for example, have pushed <code>async</code> further down within Wasmtime and this continues that trend. There's no immediate benefit just yet, but this is hoped to make future refactorings easier.</p>\n<p>Along the way some minor API changes happened too:</p>\n<ul>\n<li><code>*_unchecked</code> constructors now work with <code>MaybeUninit&lt;ValRaw&gt;</code> to correctly model how some values may not be initialized.</li>\n<li>Some <code>*_async</code> functions picked up <code>T: Send</code> which should have in theory been required before and are now compiler-required.</li>\n<li>Longstanding/old internal functions have been shuffled around/refactored.</li>\n</ul>\n<p>Finally, another eventual goal of this work is to share more between core wasm and components in terms of implementation. Right now the component host function entrypoints are quite different than the core wasm ones and that ideally wouldn't endure forever.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 568537776,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768604829
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568537779,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768604830
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568537780,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768604831
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568544380,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768610378
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568545841,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768611636
    },
    {
        "content": "<p><strong>alexcrichton</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers\">wasmtime-default-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568545842,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768611636
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wasmtime:api</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568550702,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768616605
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wasmtime:c-api</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 568550704,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768616605
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366#discussion_r2709845410\">PR review comment</a>:</p>\n<blockquote>\n<p>A while back we found that our <code>pub fn new(impl AsContextMut)</code>/<code>pub(crate) fn _new(&amp;mut StoreOpaque)</code> pair conventions were hiding when the latter constructor was dead code due to its underscore prefix.</p>\n<p>Do we want to avoid the underscore prefix here as well?</p>\n</blockquote>",
        "id": 569118361,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768939737
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366#pullrequestreview-3684009110\">PR review</a>:</p>\n<blockquote>\n<p>Looks great, thanks for this clean up!</p>\n</blockquote>",
        "id": 569118362,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768939737
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366#discussion_r2709906360\">PR review comment</a>:</p>\n<blockquote>\n<p><code>ensure!</code>?</p>\n</blockquote>",
        "id": 569118363,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768939737
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366#discussion_r2709901087\">PR review comment</a>:</p>\n<blockquote>\n<p>Nitpick: newlines between methods in the impl block.</p>\n</blockquote>",
        "id": 569118364,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768939737
    },
    {
        "content": "<p>alexcrichton updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 569120980,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768940686
    },
    {
        "content": "<p>alexcrichton has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 569121009,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768940697
    },
    {
        "content": "<p>alexcrichton added <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366 Refactor core wasm host entrypoints</a> to the merge queue.</p>",
        "id": 569123612,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768941604
    },
    {
        "content": "<p>alexcrichton merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366</a>.</p>",
        "id": 569127554,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768943147
    },
    {
        "content": "<p>alexcrichton removed <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12366\">PR #12366 Refactor core wasm host entrypoints</a> from the merge queue.</p>",
        "id": 569127555,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768943147
    }
]