[
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602\">issue #11602</a>:</p>\n<blockquote>\n<p>Given this input:</p>\n<div class=\"codehilite\" data-code-language=\"wasm\"><pre><span></span><code>(module\n  (func (export \"f\")\n    (param\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n    (result\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n\n    (block $h\n      (try_table (catch_all $h)\n        local.get 0\n        local.get 1\n        local.get 2\n        local.get 3\n        local.get 4\n        local.get 5\n        local.get 6\n        local.get 7\n        local.get 8\n        local.get 9\n        local.get 10\n        local.get 11\n        local.get 12\n        local.get 13\n        local.get 14\n        local.get 15\n        local.get 16\n\n        call $f2_callee\n        return\n      )\n    )\n    unreachable\n  )\n  (func $f2_callee\n    (param\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n    (result\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n\n    local.get 0\n    local.get 1\n    local.get 2\n    local.get 3\n    local.get 4\n    local.get 5\n    local.get 6\n    local.get 7\n    local.get 8\n    local.get 9\n    local.get 10\n    local.get 11\n    local.get 12\n    local.get 13\n    local.get 14\n    local.get 15\n    local.get 16\n  )\n)\n\n(assert_return (invoke \"f\"\n    (i32.const 0)\n    (i32.const 1)\n    (i32.const 2)\n    (i32.const 3)\n    (i32.const 4)\n    (i32.const 5)\n    (i32.const 6)\n    (i32.const 7)\n    (i32.const 8)\n    (i32.const 9)\n    (i32.const 10)\n    (i32.const 11)\n    (i32.const 12)\n    (i32.const 13)\n    (i32.const 14)\n    (i32.const 15)\n    (i32.const 16)\n  )\n  (i32.const 0)\n  (i32.const 1)\n  (i32.const 2)\n  (i32.const 3)\n  (i32.const 4)\n  (i32.const 5)\n  (i32.const 6)\n  (i32.const 7)\n  (i32.const 8)\n  (i32.const 9)\n  (i32.const 10)\n  (i32.const 11)\n  (i32.const 12)\n  (i32.const 13)\n  (i32.const 14)\n  (i32.const 15)\n  (i32.const 16)\n)\n</code></pre></div>\n<p>locally this fails for me as:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">foo</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">exceptions</span>\n<span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"n\">qemu</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">uncaught</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">signal</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span>\n<span class=\"n\">zsh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">foo</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">exceptions</span>\n</code></pre></div>\n<p>debugging this it appears that the array-to-wasm trampoline's stack pointer isn't restored upon it being returned to. The fault appears to be that the place-to-save-wasm results is saved on the stack but when it's reloaded from the stack the wrong value is reloaded. Beyond this though I'm not entirely sure where the issue lies.</p>\n<p>cc @uweigand </p>\n</blockquote>",
        "id": 537545357,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1756929543
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the cranelift:area:s390x label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602\">Issue #11602</a>.</p>",
        "id": 537545358,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1756929543
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasm-proposal:exceptions label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602\">Issue #11602</a>.</p>",
        "id": 537545360,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1756929543
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602#issuecomment-3251416596\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602\">issue #11602</a>:</p>\n<blockquote>\n<p>After <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11597\">https://github.com/bytecodealliance/wasmtime/pull/11597</a> merges the reproduction will require reverting <a href=\"https://github.com/bytecodealliance/wasmtime/pull/11597/files#diff-908a422cef87524478865a23918af79040c970e02a3cc6862f6eb508710606f9\">these changes first</a></p>\n</blockquote>",
        "id": 537577205,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1756950876
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11602\">issue #11602</a>:</p>\n<blockquote>\n<p>Given this input:</p>\n<div class=\"codehilite\" data-code-language=\"wasm\"><pre><span></span><code>(module\n  (func (export \"f\")\n    (param\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n    (result\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n\n    (block $h\n      (try_table (catch_all $h)\n        local.get 0\n        local.get 1\n        local.get 2\n        local.get 3\n        local.get 4\n        local.get 5\n        local.get 6\n        local.get 7\n        local.get 8\n        local.get 9\n        local.get 10\n        local.get 11\n        local.get 12\n        local.get 13\n        local.get 14\n        local.get 15\n        local.get 16\n\n        call $f2_callee\n        return\n      )\n    )\n    unreachable\n  )\n  (func $f2_callee\n    (param\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n    (result\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32 i32 i32 i32\n      i32\n    )\n\n    local.get 0\n    local.get 1\n    local.get 2\n    local.get 3\n    local.get 4\n    local.get 5\n    local.get 6\n    local.get 7\n    local.get 8\n    local.get 9\n    local.get 10\n    local.get 11\n    local.get 12\n    local.get 13\n    local.get 14\n    local.get 15\n    local.get 16\n  )\n)\n\n(assert_return (invoke \"f\"\n    (i32.const 0)\n    (i32.const 1)\n    (i32.const 2)\n    (i32.const 3)\n    (i32.const 4)\n    (i32.const 5)\n    (i32.const 6)\n    (i32.const 7)\n    (i32.const 8)\n    (i32.const 9)\n    (i32.const 10)\n    (i32.const 11)\n    (i32.const 12)\n    (i32.const 13)\n    (i32.const 14)\n    (i32.const 15)\n    (i32.const 16)\n  )\n  (i32.const 0)\n  (i32.const 1)\n  (i32.const 2)\n  (i32.const 3)\n  (i32.const 4)\n  (i32.const 5)\n  (i32.const 6)\n  (i32.const 7)\n  (i32.const 8)\n  (i32.const 9)\n  (i32.const 10)\n  (i32.const 11)\n  (i32.const 12)\n  (i32.const 13)\n  (i32.const 14)\n  (i32.const 15)\n  (i32.const 16)\n)\n</code></pre></div>\n<p>locally this fails for me as:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">foo</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">exceptions</span>\n<span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"n\">qemu</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">uncaught</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">signal</span><span class=\"w\"> </span><span class=\"mi\">11</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">Segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span>\n<span class=\"n\">zsh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"n\">s390x</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">foo</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">W</span><span class=\"w\"> </span><span class=\"n\">exceptions</span>\n</code></pre></div>\n<p>debugging this it appears that the array-to-wasm trampoline's stack pointer isn't restored upon it being returned to. The fault appears to be that the place-to-save-wasm results is saved on the stack but when it's reloaded from the stack the wrong value is reloaded. Beyond this though I'm not entirely sure where the issue lies.</p>\n<p>cc @uweigand </p>\n</blockquote>",
        "id": 538955435,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1757632836
    }
]