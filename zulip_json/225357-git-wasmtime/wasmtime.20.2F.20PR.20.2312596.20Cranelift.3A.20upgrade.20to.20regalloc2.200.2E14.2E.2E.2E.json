[
    {
        "content": "<p>cfallin opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a> from <code>cfallin:regalloc2-upgrade</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This builds on the work in <a href=\"https://github.com/bytecoealliance/regalloc2/issues/254\">bytecoealliance/regalloc2#254</a> and removes our use of <code>OnceLock</code> to construct <code>MachineEnv</code>s for the register allocator that contain <code>Vec</code>s of registers, instead using <code>PRegSet</code>s that are truly constant data.</p>\n<p>There's a little awkwardness and refactoring to make the necessary bits <code>const fn</code>s, and I also had to remove a few <code>debug_assert</code>s because the necessary <code>Eq</code> comparisons seem not to be supported in <code>const fn</code>-land, but otherwise this is pretty mechanical.</p>\n<p>As a result of switching to the new register traversal order based on bitsets rather than lists, the register assignments changed in a large fraction of our golden test outputs, so a majority of the diff exists in those bits (kept in separate commits here).</p>\n<p>This is logically stacked on top of <a href=\"https://github.com/bytecodealliance/regalloc2/issues/255\">bytecodealliance/regalloc2#255</a> and <a href=\"https://github.com/bytecodealliance/regalloc2/issues/256\">bytecodealliance/regalloc2#256</a>, and then an RA2 release; the <code>Cargo.toml</code> update here refers to version 0.14.0 which hasn't been released yet.</p>\n</blockquote>",
        "id": 573933371,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111638
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573933372,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111638
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573933373,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111638
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573933374,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111638
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers\">wasmtime-default-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573933375,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111638
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>:</p>\n<blockquote>\n<p>This builds on the work in <a href=\"https://github.com/bytecodealliance/regalloc2/issues/254\">bytecodealliance/regalloc2#254</a> and removes our use of <code>OnceLock</code> to construct <code>MachineEnv</code>s for the register allocator that contain <code>Vec</code>s of registers, instead using <code>PRegSet</code>s that are truly constant data.</p>\n<p>There's a little awkwardness and refactoring to make the necessary bits <code>const fn</code>s, and I also had to remove a few <code>debug_assert</code>s because the necessary <code>Eq</code> comparisons seem not to be supported in <code>const fn</code>-land, but otherwise this is pretty mechanical.</p>\n<p>As a result of switching to the new register traversal order based on bitsets rather than lists, the register assignments changed in a large fraction of our golden test outputs, so a majority of the diff exists in those bits (kept in separate commits here).</p>\n<p>This is logically stacked on top of <a href=\"https://github.com/bytecodealliance/regalloc2/issues/255\">bytecodealliance/regalloc2#255</a> and <a href=\"https://github.com/bytecodealliance/regalloc2/issues/256\">bytecodealliance/regalloc2#256</a>, and then an RA2 release; the <code>Cargo.toml</code> update here refers to version 0.14.0 which hasn't been released yet.</p>\n</blockquote>",
        "id": 573933388,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771111652
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#pullrequestreview-3802848982\">PR review</a>.</p>",
        "id": 573933884,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112372
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808111471\">PR review comment</a>:</p>\n<blockquote>\n<p>FWIW while <code>debug_assert_eq!(a, b)</code> is not usable in const-contexts I think <code>debug_assert!(a == b)</code> should work to help keep these around</p>\n</blockquote>",
        "id": 573933885,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112373
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808111863\">PR review comment</a>:</p>\n<blockquote>\n<p>Mind throwing a <code>debug_assert!</code> that <code>XReg::SPECIAL_START == 30</code> here?</p>\n</blockquote>",
        "id": 573933886,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112373
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808112698\">PR review comment</a>:</p>\n<blockquote>\n<p>Like above I think this can be kept with <code>debug_assert!(a == b)</code></p>\n</blockquote>",
        "id": 573933887,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112373
    },
    {
        "content": "<p>cfallin edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>:</p>\n<blockquote>\n<p>This builds on the work in <a href=\"https://github.com/bytecodealliance/regalloc2/issues/254\">bytecodealliance/regalloc2#254</a> and removes our use of <code>OnceLock</code> to construct <code>MachineEnv</code>s for the register allocator that contain <code>Vec</code>s of registers, instead using <code>PRegSet</code>s that are truly constant data.</p>\n<p>There's a little awkwardness and refactoring to make the necessary bits <code>const fn</code>s, and I also had to remove a few <code>debug_assert</code>s because the necessary <code>Eq</code> comparisons seem not to be supported in <code>const fn</code>-land, but otherwise this is pretty mechanical.</p>\n<p>As a result of switching to the new register traversal order based on bitsets rather than lists, the register assignments changed in a large fraction of our golden test outputs, so a majority of the diff exists in those bits (kept in separate commits here).</p>\n</blockquote>",
        "id": 573933936,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112457
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573933999,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771112556
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573934583,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113570
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#pullrequestreview-3802870698\">PR review</a>.</p>",
        "id": 573934602,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113600
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808133452\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 573934609,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113600
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808133207\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, yep, that worked -- thanks.</p>\n</blockquote>",
        "id": 573934610,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113600
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#discussion_r2808131779\">PR review comment</a>:</p>\n<blockquote>\n<p>Yep, the <code>Eq</code> impl for <code>Reg</code> is non-const but I pulled out the actual constant register number and asserted that directly.</p>\n</blockquote>",
        "id": 573934611,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113600
    },
    {
        "content": "<p>cfallin has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573934629,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771113615
    },
    {
        "content": "<p>cfallin added <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> to the merge queue</p>",
        "id": 573935332,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771114363
    },
    {
        "content": "<p>github-merge-queue[bot] removed <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> from the merge queue</p>",
        "id": 573936718,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771115760
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573937034,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771116151
    },
    {
        "content": "<p>cfallin has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573937045,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771116167
    },
    {
        "content": "<p>cfallin added <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> to the merge queue</p>",
        "id": 573937643,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771116965
    },
    {
        "content": "<p>github-merge-queue[bot] removed <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> from the merge queue</p>",
        "id": 573938675,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771118370
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596#issuecomment-3903010376\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>:</p>\n<blockquote>\n<p>Noting for purposes of ongoing CI frustration: DNS failure consistent over 4 retries when downloading the Rust toolchain in <a href=\"https://github.com/bytecodealliance/wasmtime/actions/runs/22027147726/job/63645683131\">this job</a>; retrying merge.</p>\n</blockquote>",
        "id": 573940203,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771120279
    },
    {
        "content": "<p>cfallin added <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> to the merge queue</p>",
        "id": 573940209,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771120281
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596</a>.</p>",
        "id": 573941374,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771121695
    },
    {
        "content": "<p>cfallin removed <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12596\">PR #12596 Cranelift: upgrade to regalloc2 0.14.0 and use static/constant <code>MachineEnv</code>s.</a> from the merge queue</p>",
        "id": 573941375,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771121696
    }
]