[
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850\">issue #11850</a>:</p>\n<blockquote>\n<p>Using Wasmtime 37.0.2 I get:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Oregalloc</span><span class=\"o\">-</span><span class=\"n\">algorithm</span><span class=\"o\">=</span><span class=\"n\">single</span><span class=\"o\">-</span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wexceptions</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">throw</span><span class=\"p\">.</span><span class=\"n\">wast</span>\n\n<span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">main</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">runner</span><span class=\"o\">/</span><span class=\"n\">work</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">unwinder</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">exception_table</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">168</span><span class=\"p\">:</span><span class=\"mi\">25</span><span class=\"p\">:</span>\n<span class=\"nc\">Wasmtime</span><span class=\"w\"> </span><span class=\"n\">exception</span><span class=\"w\"> </span><span class=\"n\">unwind</span><span class=\"w\"> </span><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"n\">supports</span><span class=\"w\"> </span><span class=\"n\">dynamic</span><span class=\"w\"> </span><span class=\"n\">contexts</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">stack</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">display</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>\n<span class=\"n\">zsh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">IOT</span><span class=\"w\"> </span><span class=\"n\">instruction</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"n\">wasmtime</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span>\n</code></pre></div>\n<p>using <code>main</code> I get: </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Oregalloc</span><span class=\"o\">-</span><span class=\"n\">algorithm</span><span class=\"o\">=</span><span class=\"n\">single</span><span class=\"o\">-</span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wexceptions</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">throw</span><span class=\"p\">.</span><span class=\"n\">wast</span>\n<span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"n\">zsh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span>\n</code></pre></div>\n<p>My guess is that this is related to the single-pass register allocator, so cc @d-sonuga</p>\n</blockquote>",
        "id": 544766237,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760452435
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the fuzz-bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850\">Issue #11850</a>.</p>",
        "id": 544766239,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760452436
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the cranelift:area:regalloc label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850\">Issue #11850</a>.</p>",
        "id": 544766240,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760452436
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasm-proposal:exceptions label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850\">Issue #11850</a>.</p>",
        "id": 544766242,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760452436
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850#issuecomment-3407201471\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/issues/11850\">issue #11850</a>:</p>\n<blockquote>\n<p>Another example is:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Oopt</span><span class=\"o\">-</span><span class=\"n\">level</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Oregalloc</span><span class=\"o\">-</span><span class=\"n\">algorithm</span><span class=\"o\">=</span><span class=\"n\">single</span><span class=\"o\">-</span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wexceptions</span><span class=\"p\">,</span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">references</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">try_table</span><span class=\"p\">.</span><span class=\"n\">wast</span>\n<span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"n\">zsh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">segmentation</span><span class=\"w\"> </span><span class=\"n\">fault</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">core</span><span class=\"w\"> </span><span class=\"n\">dumped</span><span class=\"p\">)</span><span class=\"w\">  </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span>\n</code></pre></div>\n<p>When <code>-Oopt-level=0</code> is removed this yields:</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">wast</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Cinlining</span><span class=\"o\">=</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Ccranelift</span><span class=\"o\">-</span><span class=\"n\">wasmtime_inlining_intra_module</span><span class=\"o\">=</span><span class=\"n\">yes</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Oregalloc</span><span class=\"o\">-</span><span class=\"n\">algorithm</span><span class=\"o\">=</span><span class=\"n\">single</span><span class=\"o\">-</span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">Wexceptions</span><span class=\"p\">,</span><span class=\"n\">function</span><span class=\"o\">-</span><span class=\"n\">references</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">try_table</span><span class=\"p\">.</span><span class=\"n\">wast</span>\n<span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">script</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">try_table</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"o\">'</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">failed</span><span class=\"w\"> </span><span class=\"n\">directive</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">spec_testsuite</span><span class=\"o\">/</span><span class=\"n\">proposals</span><span class=\"o\">/</span><span class=\"n\">wasm</span><span class=\"o\">-</span><span class=\"mf\">3.0</span><span class=\"o\">/</span><span class=\"n\">try_table</span><span class=\"p\">.</span><span class=\"n\">wast</span><span class=\"p\">:</span><span class=\"mi\">302</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">result</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">didn</span><span class=\"o\">'</span><span class=\"na\">t</span><span class=\"w\"> </span><span class=\"k\">match</span>\n<span class=\"w\">    </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">expected</span><span class=\"w\">                  </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mh\">0x0000000000000005</span>\n<span class=\"w\">       </span><span class=\"n\">actual</span><span class=\"w\">                    </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"mh\">0x0000000000000000</span>\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 545006542,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1760544096
    }
]