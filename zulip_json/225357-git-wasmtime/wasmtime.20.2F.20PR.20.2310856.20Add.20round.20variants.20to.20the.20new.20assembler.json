[
    {
        "content": "<p>jlb6740 opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a> from <code>jlb6740:add-rounding-to-new-assembler</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 520997442,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479354
    },
    {
        "content": "<p><strong>jlb6740</strong> requested <a href=\"https://github.com/cfallin\">cfallin</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 520997443,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479354
    },
    {
        "content": "<p><strong>jlb6740</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 520997444,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479355
    },
    {
        "content": "<p>jlb6740 <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#issuecomment-2917922379\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>:</p>\n<blockquote>\n<p>Will add vround variants in a follow-up to this patch.</p>\n</blockquote>",
        "id": 520997460,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479373
    },
    {
        "content": "<p>jlb6740 <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#issuecomment-2917922693\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>:</p>\n<blockquote>\n<p>Only touches the assembler part. </p>\n</blockquote>",
        "id": 520997490,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479390
    },
    {
        "content": "<p>jlb6740 deleted a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#issuecomment-2917922693\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>:</p>\n<blockquote>\n<p>Only touches the assembler part. </p>\n</blockquote>",
        "id": 520997499,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479395
    },
    {
        "content": "<p>jlb6740 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#issuecomment-2917922379\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>:</p>\n<blockquote>\n<p>Will add vround variants in a follow-up to this patch. Also, this only touches the assembler and does not connect isle.</p>\n</blockquote>",
        "id": 520997527,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748479411
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521190426,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748563368
    },
    {
        "content": "<p>jlb6740 edited a <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#issuecomment-2917922379\">comment</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>:</p>\n<blockquote>\n<p>This only touches the assembler and does not connect isle.</p>\n</blockquote>",
        "id": 521190570,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748563440
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521364775,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748635736
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521365532,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748636049
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521366624,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748636585
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521368199,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748637343
    },
    {
        "content": "<p>abrown submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882582284\">PR review</a>.</p>",
        "id": 521373259,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748639998
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882584117\">PR review</a>.</p>",
        "id": 521373400,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748640081
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116682224\">PR review comment</a>:</p>\n<blockquote>\n<p>Should these be <code>align(xmm_m128)</code>?</p>\n<p>(should we maybe have a check in the DSL that non-avx <code>xmm_m128</code> arguments are required to be <code>align</code>?)</p>\n</blockquote>",
        "id": 521373401,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748640081
    },
    {
        "content": "<p>jlb6740 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882603622\">PR review</a>.</p>",
        "id": 521374916,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748640888
    },
    {
        "content": "<p>jlb6740 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116694456\">PR review comment</a>:</p>\n<blockquote>\n<p>I read this comment multiple times trying to interpret: </p>\n<p>\"NB: the non-AVX variant of this instruction does not require that the operand<br>\n;; is aligned, but the instruction variant used here requires it to be aligned.\"</p>\n<p>Perhaps I should have asked. So the non-AVX variant here does require alignment? </p>\n</blockquote>",
        "id": 521374917,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748640888
    },
    {
        "content": "<p>jlb6740 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116694456\">PR review comment</a>.</p>",
        "id": 521374941,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748640903
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116699400\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah yeah I believe that comment is referring to <code>rounds{s,d}</code>, as opposed to <code>roundp{s,d}</code>. I'm under the impression that the f32/f64 versions do not require aligned memory but the 128-bit versions require aligned memory. The comment in ISLE I believe can be deleted with the new instructions since it's correctly modeled.</p>\n<p>This reminds me as well, should <code>rounds{s,d}</code> below use <code>xmm_m{32,64}</code> instead of <code>xmm_m128</code>? We don't have anything actually checking that right now but with PCC in the future (or some other integration) it might matter to annotate that with the appropriate bit-width.</p>\n</blockquote>",
        "id": 521375285,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641091
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882611853\">PR review</a>.</p>",
        "id": 521375286,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641091
    },
    {
        "content": "<p>jlb6740 updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521375716,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641338
    },
    {
        "content": "<p>jlb6740 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116694456\">PR review comment</a>.</p>",
        "id": 521375821,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641404
    },
    {
        "content": "<p>jlb6740 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116694456\">PR review comment</a>.</p>",
        "id": 521375858,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641424
    },
    {
        "content": "<p>abrown merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856\">PR #10856</a>.</p>",
        "id": 521376734,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748641963
    },
    {
        "content": "<p>jlb6740 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882641014\">PR review</a>.</p>",
        "id": 521378094,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748642712
    },
    {
        "content": "<p>jlb6740 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116719548\">PR review comment</a>:</p>\n<blockquote>\n<p>@alexcrichton Yes you are right on the rounds{s,d}. I am not sure how this would come in to play but let me update this to the correct annotation and also maybe remove that comment. </p>\n</blockquote>",
        "id": 521378095,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748642713
    },
    {
        "content": "<p>jlb6740 edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116719548\">PR review comment</a>.</p>",
        "id": 521378107,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748642725
    },
    {
        "content": "<p>alexcrichton created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#discussion_r2116732820\">PR review comment</a>:</p>\n<blockquote>\n<p>Oh sorry fully reading your comment I can also clarify more:</p>\n<p>The documentation there referred to the ISLE-specific abstraction of <code>XmmUnaryRmRImm</code> which internally stores <code>XmmMemAligned</code>. The <code>roundss</code> and <code>roundsd</code> instructions used <code>XmmUnaryRmRImm</code> but this was technically not a correct way to model these instructions. The <code>roundss</code> and <code>roundsd</code> instructions do not actually require alignment. The problem, and where the comment comes from, is that the way this happens in ISLE is that first a <code>Value</code> is converted to <code>XmmMem</code> as the load is \"sinkable\". Next it goes to the <code>x64_round</code> helper which takes <code>XmmMem</code>. Next, without AVX, it would go to <code>XmmUnaryRmRImm</code>, but this required converting the <code>XmmMem</code> to <code>XmmMemAligned</code>. That, for all WebAssembly loads/stores, would automatically do an unaligned load and then use a register operand. The problem with this is that the automatic load inserted would load 128-bits, not the appropriate number of bits for the f32/f64. </p>\n<p>So basically that long comment was an artifact of a precisely how ISLE is set up today. None of it is applicable under the new assembler, and I think that the <code>roundps</code> and <code>roundpd</code> instructions need <code>align(xmm_m128)</code> but <code>roundss</code> and <code>roundsd</code> can use <code>xmm_m32</code> and <code>xmm_m64</code> since they don't require alignment.</p>\n<p>Also FWIW I see a new commit here but I don't believe it landed because it was pushed after this was already in the merge queue, so mind filing a follow-up commit with that?</p>\n</blockquote>",
        "id": 521378498,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748642999
    },
    {
        "content": "<p>alexcrichton submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10856#pullrequestreview-2882661922\">PR review</a>.</p>",
        "id": 521378499,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1748643000
    }
]