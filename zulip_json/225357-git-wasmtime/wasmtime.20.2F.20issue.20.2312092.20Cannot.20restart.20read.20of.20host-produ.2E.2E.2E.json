[
    {
        "content": "<p>alexcrichton assigned dicej to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12092\">issue #12092</a>.</p>",
        "id": 560309769,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764136357
    },
    {
        "content": "<p>alexcrichton opened <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12092\">issue #12092</a>:</p>\n<blockquote>\n<p>Applying this diff:</p>\n<p>&lt;details&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">diff --git a/tests/all/component_model/async.rs b/tests/all/component_model/async.rs</span>\n<span class=\"gh\">index b3e816c758..b1e3bf8d55 100644</span>\n<span class=\"gd\">--- a/tests/all/component_model/async.rs</span>\n<span class=\"gi\">+++ b/tests/all/component_model/async.rs</span>\n<span class=\"gu\">@@ -1,5 +1,7 @@</span>\n<span class=\"w\"> </span>use crate::async_functions::{PollOnce, execute_across_threads};\n<span class=\"w\"> </span>use anyhow::Result;\n<span class=\"gi\">+use std::pin::Pin;</span>\n<span class=\"gi\">+use std::task::{Context, Poll};</span>\n<span class=\"w\"> </span>use wasmtime::{AsContextMut, Config, component::*};\n<span class=\"w\"> </span>use wasmtime::{Engine, Store, StoreContextMut, Trap};\n<span class=\"w\"> </span>use wasmtime_component_util::REALLOC_AND_FREE;\n<span class=\"gu\">@@ -670,3 +672,98 @@ async fn task_deletion() -&gt; Result&lt;()&gt; {</span>\n\n<span class=\"w\"> </span>    Ok(())\n<span class=\"w\"> </span>}\n<span class=\"gi\">+</span>\n<span class=\"gi\">+#[tokio::test]</span>\n<span class=\"gi\">+#[cfg_attr(miri, ignore)]</span>\n<span class=\"gi\">+async fn cancel_host_future() -&gt; Result&lt;()&gt; {</span>\n<span class=\"gi\">+    let mut config = Config::new();</span>\n<span class=\"gi\">+    config.async_support(true);</span>\n<span class=\"gi\">+    config.wasm_component_model_async(true);</span>\n<span class=\"gi\">+    let engine = Engine::new(&amp;config)?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    let component = Component::new(</span>\n<span class=\"gi\">+        &amp;engine,</span>\n<span class=\"gi\">+        r#\"</span>\n<span class=\"gi\">+(component</span>\n<span class=\"gi\">+  (core module $libc (memory (export \"memory\") 1))</span>\n<span class=\"gi\">+  (core instance $libc (instantiate $libc))</span>\n<span class=\"gi\">+  (core module $m</span>\n<span class=\"gi\">+    (import \"\" \"future.read\" (func $future.read (param i32 i32) (result i32)))</span>\n<span class=\"gi\">+    (import \"\" \"future.cancel-read\" (func $future.cancel-read (param i32) (result i32)))</span>\n<span class=\"gi\">+    (memory (export \"memory\") 1)</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    (func (export \"run\") (param i32)</span>\n<span class=\"gi\">+      ;; read/cancel attempt 1</span>\n<span class=\"gi\">+      (call $future.read (local.get 0) (i32.const 100))</span>\n<span class=\"gi\">+      i32.const -1 ;; BLOCKED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      (call $future.cancel-read (local.get 0))</span>\n<span class=\"gi\">+      i32.const 2 ;; CANCELLED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      ;; read/cancel attempt 2</span>\n<span class=\"gi\">+      (call $future.read (local.get 0) (i32.const 100))</span>\n<span class=\"gi\">+      i32.const -1 ;; BLOCKED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      (call $future.cancel-read (local.get 0))</span>\n<span class=\"gi\">+      i32.const 2 ;; CANCELLED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+    )</span>\n<span class=\"gi\">+  )</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (type $f (future u32))</span>\n<span class=\"gi\">+  (core func $future.read (canon future.read $f async (memory $libc \"memory\")))</span>\n<span class=\"gi\">+  (core func $future.cancel-read (canon future.cancel-read $f))</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (core instance $i (instantiate $m</span>\n<span class=\"gi\">+    (with \"\" (instance</span>\n<span class=\"gi\">+      (export \"future.read\" (func $future.read))</span>\n<span class=\"gi\">+      (export \"future.cancel-read\" (func $future.cancel-read))</span>\n<span class=\"gi\">+    ))</span>\n<span class=\"gi\">+  ))</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (func (export \"run\") (param \"f\" $f)</span>\n<span class=\"gi\">+    (canon lift</span>\n<span class=\"gi\">+      (core func $i \"run\")</span>\n<span class=\"gi\">+      (memory $libc \"memory\")</span>\n<span class=\"gi\">+    )</span>\n<span class=\"gi\">+  )</span>\n<span class=\"gi\">+)</span>\n<span class=\"gi\">+        \"#,</span>\n<span class=\"gi\">+    )?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    let mut store = Store::new(&amp;engine, ());</span>\n<span class=\"gi\">+    let instance = Linker::new(&amp;engine)</span>\n<span class=\"gi\">+        .instantiate_async(&amp;mut store, &amp;component)</span>\n<span class=\"gi\">+        .await?;</span>\n<span class=\"gi\">+    let func = instance.get_typed_func::&lt;(FutureReader&lt;u32&gt;,), ()&gt;(&amp;mut store, \"run\")?;</span>\n<span class=\"gi\">+    let reader = FutureReader::new(&amp;mut store, MyFutureReader);</span>\n<span class=\"gi\">+    func.call_async(&amp;mut store, (reader,)).await?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    return Ok(());</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    struct MyFutureReader;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    impl FutureProducer&lt;()&gt; for MyFutureReader {</span>\n<span class=\"gi\">+        type Item = u32;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+        fn poll_produce(</span>\n<span class=\"gi\">+            self: Pin&lt;&amp;mut Self&gt;,</span>\n<span class=\"gi\">+            _cx: &amp;mut Context&lt;'_&gt;,</span>\n<span class=\"gi\">+            _store: StoreContextMut&lt;()&gt;,</span>\n<span class=\"gi\">+            finish: bool,</span>\n<span class=\"gi\">+        ) -&gt; Poll&lt;Result&lt;Option&lt;Self::Item&gt;&gt;&gt; {</span>\n<span class=\"gi\">+            if finish {</span>\n<span class=\"gi\">+                Poll::Ready(Ok(None))</span>\n<span class=\"gi\">+            } else {</span>\n<span class=\"gi\">+                Poll::Pending</span>\n<span class=\"gi\">+            }</span>\n<span class=\"gi\">+        }</span>\n<span class=\"gi\">+    }</span>\n<span class=\"gi\">+}</span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>currently fails with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">cancel_host_future</span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">test</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">profile</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">unoptimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.10</span><span class=\"n\">s</span>\n<span class=\"w\">     </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">all</span><span class=\"o\">/</span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">deps</span><span class=\"o\">/</span><span class=\"n\">all</span><span class=\"o\">-</span><span class=\"n\">e79d98f84418a5e1</span><span class=\"p\">)</span>\n\n<span class=\"n\">running</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">test</span>\n<span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">FAILED</span>\n\n<span class=\"n\">failures</span><span class=\"p\">:</span>\n\n<span class=\"o\">----</span><span class=\"w\"> </span><span class=\"n\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span><span class=\"w\"> </span><span class=\"n\">stdout</span><span class=\"w\"> </span><span class=\"o\">----</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">executing</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\">     </span><span class=\"mh\">0xba</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">cannot</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">future</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"w\"> </span><span class=\"n\">succeeded</span>\n\n\n<span class=\"n\">failures</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span>\n\n<span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">FAILED</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">passed</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">measured</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">982</span><span class=\"w\"> </span><span class=\"n\">filtered</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">finished</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.01</span><span class=\"n\">s</span>\n\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">test</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">rerun</span><span class=\"w\"> </span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"err\">`</span>\n</code></pre></div>\n<p>where the second <code>future.read</code> call is what's failing here</p>\n</blockquote>",
        "id": 560309770,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764136358
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the wasm-proposal:component-model-async label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12092\">Issue #12092</a>.</p>",
        "id": 560309772,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764136358
    },
    {
        "content": "<p><a href=\"https://github.com/alexcrichton\">alexcrichton</a> added the fuzz-bug label to <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12092\">Issue #12092</a>.</p>",
        "id": 560309776,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764136361
    },
    {
        "content": "<p>alexcrichton closed <a href=\"https://github.com/bytecodealliance/wasmtime/issues/12092\">issue #12092</a>:</p>\n<blockquote>\n<p>Applying this diff:</p>\n<p>&lt;details&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Diff\"><pre><span></span><code><span class=\"gh\">diff --git a/tests/all/component_model/async.rs b/tests/all/component_model/async.rs</span>\n<span class=\"gh\">index b3e816c758..b1e3bf8d55 100644</span>\n<span class=\"gd\">--- a/tests/all/component_model/async.rs</span>\n<span class=\"gi\">+++ b/tests/all/component_model/async.rs</span>\n<span class=\"gu\">@@ -1,5 +1,7 @@</span>\n<span class=\"w\"> </span>use crate::async_functions::{PollOnce, execute_across_threads};\n<span class=\"w\"> </span>use anyhow::Result;\n<span class=\"gi\">+use std::pin::Pin;</span>\n<span class=\"gi\">+use std::task::{Context, Poll};</span>\n<span class=\"w\"> </span>use wasmtime::{AsContextMut, Config, component::*};\n<span class=\"w\"> </span>use wasmtime::{Engine, Store, StoreContextMut, Trap};\n<span class=\"w\"> </span>use wasmtime_component_util::REALLOC_AND_FREE;\n<span class=\"gu\">@@ -670,3 +672,98 @@ async fn task_deletion() -&gt; Result&lt;()&gt; {</span>\n\n<span class=\"w\"> </span>    Ok(())\n<span class=\"w\"> </span>}\n<span class=\"gi\">+</span>\n<span class=\"gi\">+#[tokio::test]</span>\n<span class=\"gi\">+#[cfg_attr(miri, ignore)]</span>\n<span class=\"gi\">+async fn cancel_host_future() -&gt; Result&lt;()&gt; {</span>\n<span class=\"gi\">+    let mut config = Config::new();</span>\n<span class=\"gi\">+    config.async_support(true);</span>\n<span class=\"gi\">+    config.wasm_component_model_async(true);</span>\n<span class=\"gi\">+    let engine = Engine::new(&amp;config)?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    let component = Component::new(</span>\n<span class=\"gi\">+        &amp;engine,</span>\n<span class=\"gi\">+        r#\"</span>\n<span class=\"gi\">+(component</span>\n<span class=\"gi\">+  (core module $libc (memory (export \"memory\") 1))</span>\n<span class=\"gi\">+  (core instance $libc (instantiate $libc))</span>\n<span class=\"gi\">+  (core module $m</span>\n<span class=\"gi\">+    (import \"\" \"future.read\" (func $future.read (param i32 i32) (result i32)))</span>\n<span class=\"gi\">+    (import \"\" \"future.cancel-read\" (func $future.cancel-read (param i32) (result i32)))</span>\n<span class=\"gi\">+    (memory (export \"memory\") 1)</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    (func (export \"run\") (param i32)</span>\n<span class=\"gi\">+      ;; read/cancel attempt 1</span>\n<span class=\"gi\">+      (call $future.read (local.get 0) (i32.const 100))</span>\n<span class=\"gi\">+      i32.const -1 ;; BLOCKED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      (call $future.cancel-read (local.get 0))</span>\n<span class=\"gi\">+      i32.const 2 ;; CANCELLED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      ;; read/cancel attempt 2</span>\n<span class=\"gi\">+      (call $future.read (local.get 0) (i32.const 100))</span>\n<span class=\"gi\">+      i32.const -1 ;; BLOCKED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+      (call $future.cancel-read (local.get 0))</span>\n<span class=\"gi\">+      i32.const 2 ;; CANCELLED</span>\n<span class=\"gi\">+      i32.ne</span>\n<span class=\"gi\">+      if unreachable end</span>\n<span class=\"gi\">+    )</span>\n<span class=\"gi\">+  )</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (type $f (future u32))</span>\n<span class=\"gi\">+  (core func $future.read (canon future.read $f async (memory $libc \"memory\")))</span>\n<span class=\"gi\">+  (core func $future.cancel-read (canon future.cancel-read $f))</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (core instance $i (instantiate $m</span>\n<span class=\"gi\">+    (with \"\" (instance</span>\n<span class=\"gi\">+      (export \"future.read\" (func $future.read))</span>\n<span class=\"gi\">+      (export \"future.cancel-read\" (func $future.cancel-read))</span>\n<span class=\"gi\">+    ))</span>\n<span class=\"gi\">+  ))</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+  (func (export \"run\") (param \"f\" $f)</span>\n<span class=\"gi\">+    (canon lift</span>\n<span class=\"gi\">+      (core func $i \"run\")</span>\n<span class=\"gi\">+      (memory $libc \"memory\")</span>\n<span class=\"gi\">+    )</span>\n<span class=\"gi\">+  )</span>\n<span class=\"gi\">+)</span>\n<span class=\"gi\">+        \"#,</span>\n<span class=\"gi\">+    )?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    let mut store = Store::new(&amp;engine, ());</span>\n<span class=\"gi\">+    let instance = Linker::new(&amp;engine)</span>\n<span class=\"gi\">+        .instantiate_async(&amp;mut store, &amp;component)</span>\n<span class=\"gi\">+        .await?;</span>\n<span class=\"gi\">+    let func = instance.get_typed_func::&lt;(FutureReader&lt;u32&gt;,), ()&gt;(&amp;mut store, \"run\")?;</span>\n<span class=\"gi\">+    let reader = FutureReader::new(&amp;mut store, MyFutureReader);</span>\n<span class=\"gi\">+    func.call_async(&amp;mut store, (reader,)).await?;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    return Ok(());</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    struct MyFutureReader;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+    impl FutureProducer&lt;()&gt; for MyFutureReader {</span>\n<span class=\"gi\">+        type Item = u32;</span>\n<span class=\"gi\">+</span>\n<span class=\"gi\">+        fn poll_produce(</span>\n<span class=\"gi\">+            self: Pin&lt;&amp;mut Self&gt;,</span>\n<span class=\"gi\">+            _cx: &amp;mut Context&lt;'_&gt;,</span>\n<span class=\"gi\">+            _store: StoreContextMut&lt;()&gt;,</span>\n<span class=\"gi\">+            finish: bool,</span>\n<span class=\"gi\">+        ) -&gt; Poll&lt;Result&lt;Option&lt;Self::Item&gt;&gt;&gt; {</span>\n<span class=\"gi\">+            if finish {</span>\n<span class=\"gi\">+                Poll::Ready(Ok(None))</span>\n<span class=\"gi\">+            } else {</span>\n<span class=\"gi\">+                Poll::Pending</span>\n<span class=\"gi\">+            }</span>\n<span class=\"gi\">+        }</span>\n<span class=\"gi\">+    }</span>\n<span class=\"gi\">+}</span>\n</code></pre></div>\n<p>&lt;/details&gt;</p>\n<p>currently fails with:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">$</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"w\"> </span><span class=\"n\">cancel_host_future</span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">test</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">profile</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">unoptimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.10</span><span class=\"n\">s</span>\n<span class=\"w\">     </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">all</span><span class=\"o\">/</span><span class=\"n\">main</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">deps</span><span class=\"o\">/</span><span class=\"n\">all</span><span class=\"o\">-</span><span class=\"n\">e79d98f84418a5e1</span><span class=\"p\">)</span>\n\n<span class=\"n\">running</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">test</span>\n<span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">FAILED</span>\n\n<span class=\"n\">failures</span><span class=\"p\">:</span>\n\n<span class=\"o\">----</span><span class=\"w\"> </span><span class=\"n\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span><span class=\"w\"> </span><span class=\"n\">stdout</span><span class=\"w\"> </span><span class=\"o\">----</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"k\">while</span><span class=\"w\"> </span><span class=\"n\">executing</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">backtrace</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\">     </span><span class=\"mh\">0xba</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">!&lt;</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">&gt;</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">cannot</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">future</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"w\"> </span><span class=\"n\">succeeded</span>\n\n\n<span class=\"n\">failures</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"nc\">component_model</span><span class=\"p\">::</span><span class=\"n\">r</span><span class=\"p\">#</span><span class=\"k\">async</span><span class=\"p\">::</span><span class=\"n\">cancel_host_future</span>\n\n<span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">result</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">FAILED</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">passed</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">ignored</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">measured</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">982</span><span class=\"w\"> </span><span class=\"n\">filtered</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">finished</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.01</span><span class=\"n\">s</span>\n\n<span class=\"n\">error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">test</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">rerun</span><span class=\"w\"> </span><span class=\"n\">pass</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">--</span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"n\">all</span><span class=\"err\">`</span>\n</code></pre></div>\n<p>where the second <code>future.read</code> call is what's failing here</p>\n</blockquote>",
        "id": 560433742,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1764174854
    }
]