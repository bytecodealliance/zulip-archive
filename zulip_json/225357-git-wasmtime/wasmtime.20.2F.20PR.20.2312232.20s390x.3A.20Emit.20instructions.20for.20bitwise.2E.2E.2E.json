[
    {
        "content": "<p>theotherjimmy opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a> from <code>theotherjimmy:s390x-bitwise-fp</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>cranelift requires that bitwise operations work across all data types, including floating point. The prior implementation of bitwise operations, xor in this example, would cause a panic<br>\n with the message:<br>\n    no rule matched for term aluop_xor</p>\n<p>This patch adds lowerings for bitwise operations on floating point registers using the vector instructions and the vector register overlay property of the s390x register file.</p>\n<p>Partially addresses Issue #12197 </p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 565803071,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767109770
    },
    {
        "content": "<p><strong>theotherjimmy</strong> requested <a href=\"https://github.com/alexcrichton\">alexcrichton</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 565803074,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767109772
    },
    {
        "content": "<p><strong>theotherjimmy</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 565803075,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767109772
    },
    {
        "content": "<p>theotherjimmy edited <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>cranelift requires that bitwise operations work across all data types, including floating point. The prior implementation of bitwise operations, xor in this example, would cause a panic with the message:<br>\n    no rule matched for term aluop_xor</p>\n<p>This patch adds lowerings for bitwise operations on floating point registers using the vector instructions and the vector register overlay property of the s390x register file.</p>\n<p>Partially addresses Issue #12197 </p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 565837895,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767132389
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#pullrequestreview-3624133210\">PR review</a>:</p>\n<blockquote>\n<p>The lowerings here look reasonable but would you mind adding a runtest (or adding s390x to an existing runtest if one exists) as well, to verify?</p>\n</blockquote>",
        "id": 566115706,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767404043
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3714898460\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>Yes. I'll make sure this is part of a runtest.</p>\n</blockquote>",
        "id": 566553409,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767709434
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3719620746\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>So I added a simple test to bitops:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">test_bnot_f32</span><span class=\"p\">(</span><span class=\"kt\">f32</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">f32</span><span class=\"w\"> </span><span class=\"nc\">fast</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"n\">block0</span><span class=\"p\">(</span><span class=\"n\">v0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kt\">f32</span><span class=\"p\">):</span>\n<span class=\"w\">    </span><span class=\"nc\">v2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">bnot</span><span class=\"w\"> </span><span class=\"n\">v0</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"n\">v2</span>\n<span class=\"p\">}</span>\n\n<span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"n\">test_bnot_f32</span><span class=\"p\">(</span><span class=\"mh\">0x1</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mh\">0x1</span><span class=\"p\">.</span><span class=\"n\">fffffep1</span>\n</code></pre></div>\n<p>which causes pulley to panic:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">cargo</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">runtests</span><span class=\"o\">/</span><span class=\"n\">bitops</span><span class=\"p\">.</span><span class=\"n\">clif</span>\n<span class=\"w\">    </span><span class=\"n\">Finished</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">dev</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">profile</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">unoptimized</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">debuginfo</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.09</span><span class=\"n\">s</span>\n<span class=\"w\">     </span><span class=\"n\">Running</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">jimbri01</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">target</span><span class=\"o\">/</span><span class=\"n\">debug</span><span class=\"o\">/</span><span class=\"n\">clif</span><span class=\"o\">-</span><span class=\"n\">util</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">runtests</span><span class=\"o\">/</span><span class=\"n\">bitops</span><span class=\"p\">.</span><span class=\"n\">clif</span><span class=\"err\">`</span>\n\n<span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">worker</span><span class=\"w\"> </span><span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"o\">'</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mi\">299483</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">cranelift</span><span class=\"o\">/</span><span class=\"n\">codegen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">isa</span><span class=\"o\">/</span><span class=\"n\">pulley_shared</span><span class=\"o\">/</span><span class=\"n\">lower</span><span class=\"o\">/</span><span class=\"n\">isle</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">207</span><span class=\"p\">:</span><span class=\"mi\">22</span><span class=\"p\">:</span>\n<span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">None</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">display</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>\n<span class=\"p\">[</span><span class=\"mi\">2026</span><span class=\"o\">-</span><span class=\"mi\">01</span><span class=\"o\">-</span><span class=\"mi\">07</span><span class=\"n\">T16</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">:</span><span class=\"mi\">38</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">ERROR</span><span class=\"w\"> </span><span class=\"n\">cranelift_filetests</span><span class=\"p\">::</span><span class=\"n\">concurrent</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">FAIL</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">panicked</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">worker</span><span class=\"w\"> </span><span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">None</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>\n<span class=\"n\">FAIL</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">filetests</span><span class=\"o\">/</span><span class=\"n\">runtests</span><span class=\"o\">/</span><span class=\"n\">bitops</span><span class=\"p\">.</span><span class=\"n\">clif</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">panicked</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">worker</span><span class=\"w\"> </span><span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Option</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">None</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span>\n<span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">tests</span>\n<span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">failure</span>\n</code></pre></div>\n<p>So do I need to fix something in pulley to get this working?</p>\n</blockquote>",
        "id": 566768927,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767802287
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3719921266\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>I believe that's because Pulley doesn't implement bitwise fp ops, so you'll want to add a new <code>*.clif</code> runtest file which excludes pulley from the targets that are tested for that</p>\n</blockquote>",
        "id": 566784586,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767806535
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3719932501\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>Is pulley missing these bitops something that we should track in Issue #12197 ?</p>\n</blockquote>",
        "id": 566785147,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767806691
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 566788433,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767807730
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3720043762\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>Looks like aarch64 has a problem with fp bitops as well.</p>\n</blockquote>",
        "id": 566790066,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767808276
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 566793570,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767809376
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3720118673\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>I removed aarch64 from the fp-bitops test. I'm thinking this should pass now.</p>\n</blockquote>",
        "id": 566793680,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767809413
    },
    {
        "content": "<p>alexcrichton <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232#issuecomment-3720140495\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>:</p>\n<blockquote>\n<p>Thanks! It's fine I think to leave Pulley out of that issue since it's a much more constrained backend than the others, but thanks for the consideration!</p>\n</blockquote>",
        "id": 566794868,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767809811
    },
    {
        "content": "<p>alexcrichton has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 566794875,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767809813
    },
    {
        "content": "<p>alexcrichton merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12232\">PR #12232</a>.</p>",
        "id": 566801722,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767812120
    }
]