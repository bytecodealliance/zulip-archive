[
    {
        "content": "<p>theotherjimmy opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a> from <code>theotherjimmy:s390x-bxd20</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>Previously, cranelift did not emit memory operations using 20 bit immedates for reg + reg memory modes on s390x. This patch enables that in a type safe manner by exporting a few extractors for 20 bit immediates and changing the argument to the MemArg constructor for reg + reg addressing mode to accept that 20 bit offset instead of the u8 offset.</p>\n<p>&lt;!--<br>\nPlease make sure you include the following information:</p>\n<ul>\n<li>\n<p>If this work has been discussed elsewhere, please include a link to that<br>\n  conversation. If it was discussed in an issue, just mention \"issue #...\".</p>\n</li>\n<li>\n<p>Explain why this change is needed. If the details are in an issue already,<br>\n  this can be brief.</p>\n</li>\n</ul>\n<p>Our development process is documented in the Wasmtime book:<br>\n<a href=\"https://docs.wasmtime.dev/contributing-development-process.html\">https://docs.wasmtime.dev/contributing-development-process.html</a></p>\n<p>Please ensure all communication follows the code of conduct:<br>\n<a href=\"https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md\">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>\n--&gt;</p>\n</blockquote>",
        "id": 565294492,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766590213
    },
    {
        "content": "<p><strong>theotherjimmy</strong> requested <a href=\"https://github.com/abrown\">abrown</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 565294494,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766590214
    },
    {
        "content": "<p><strong>theotherjimmy</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 565294496,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766590214
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 565294658,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766590330
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 565296294,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766591546
    },
    {
        "content": "<p>github-actions[bot] <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#issuecomment-3690303328\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>:</p>\n<blockquote>\n<h4>Subscribe to Label Action</h4>\n<p>cc @cfallin, @fitzgen</p>\n<p>&lt;details&gt;<br>\nThis issue or pull request has been labeled: \"cranelift\", \"isle\"</p>\n<p>Thus the following users have been cc'd because of the following labels:</p>\n<ul>\n<li>cfallin: isle</li>\n<li>fitzgen: isle</li>\n</ul>\n<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>\n<p><a href=\"https://github.com/bytecodealliance/subscribe-to-label-action\">Learn more.</a><br>\n&lt;/details&gt;</p>\n</blockquote>",
        "id": 565304993,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766598346
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#issuecomment-3693637128\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>:</p>\n<blockquote>\n<p>cc @uweigand -- would you mind taking a look?</p>\n</blockquote>",
        "id": 565487603,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1766808321
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#issuecomment-3719722405\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>:</p>\n<blockquote>\n<p>Hi @theotherjimmy this makes sense in principle, but I have a couple of comments:</p>\n<ul>\n<li>The <code>bias</code> naming was intended to reflect small offset generated by the back-end to access part of a value (e.g. when accessing a 16-byte value as two 8-byte values, the second value needs to have the address biased by 8); it was not intended to act as a generic displacement.  If we want that, we should probably rename the function to <code>reg_plus_reg_plus_off</code> or something.</li>\n<li>With your code, we're now greedily generating reg+reg+simm20 always, and retroactively fix things if the instruction doesn't have that addressing mode.  That is probably the right thing to do in general, but in many cases we already know that the addressing mode isn't available (e.g. vector instructions always only have uimm12 displacements).  We'll likely get better code if we leave the addition separately from the beginning in those cases.<br>\n</li>\n</ul>\n</blockquote>",
        "id": 566774199,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767803635
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#issuecomment-3720132059\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>:</p>\n<blockquote>\n<p>Thanks for the review @uweigand </p>\n<p>I think I'll rework this to write a new extractor with your suggested name, and migrate to that new extractor where we know the instructions support the extended offset. That should resolve your concerns.</p>\n</blockquote>",
        "id": 566794452,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1767809650
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 567631520,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768247783
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 567631691,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768247844
    },
    {
        "content": "<p>theotherjimmy <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#issuecomment-3740260270\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>:</p>\n<blockquote>\n<p>@uweigand Is this more in line with what you expected?</p>\n</blockquote>",
        "id": 567631725,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768247858
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#discussion_r2685606303\">PR review comment</a>:</p>\n<blockquote>\n<p>This doesn't appear to be used anywhere?</p>\n</blockquote>",
        "id": 567727402,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768299587
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#pullrequestreview-3654803676\">PR review</a>:</p>\n<blockquote>\n<p>This looks generally good to me.  As a small enhancement it might be interesting to also extend the <code>lower_address_bias</code> version with a <code>memarg_reg_plus_reg_plus_off</code> clause (which would add the bias to the offset); this probably doesn't have much effect on performance but would preserve the symmetry.</p>\n<p>A much bigger (future) enhancement could be to be more specific in generating proper addressing modes for the target instruction in the first place:</p>\n<ul>\n<li>Avoid using the generic <code>RegOffset</code> mode but rather generate explicit code to begin with (e.g. along the lines of the AArch64 <code>amode</code> rules).</li>\n<li>Use more specific flavors of <code>lower_address</code> (e.g. <code>lower_address_bdaddr12</code>, <code>lower_address_bdaddr20</code>, <code>lower_address_bdxaddr12</code>, <code>lower_address_bdxaddr20</code> to follow LLWM nomenclature) and update the various rules to use the specific flavors instead of the generic, as appropriate for the target instruction of each rule.</li>\n</ul>\n</blockquote>",
        "id": 567727403,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768299587
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 567807794,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768321375
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#pullrequestreview-3657074382\">PR review</a>.</p>",
        "id": 567826230,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768326466
    },
    {
        "content": "<p>uweigand created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#discussion_r2687448494\">PR review comment</a>:</p>\n<blockquote>\n<p>The above rule should now be redundant, shouldn't it?  With offset 0 the rule below should always match and give the same result.</p>\n</blockquote>",
        "id": 567826237,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768326467
    },
    {
        "content": "<p>theotherjimmy updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 567834690,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768329284
    },
    {
        "content": "<p>theotherjimmy submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#pullrequestreview-3657261501\">PR review</a>.</p>",
        "id": 567834755,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768329305
    },
    {
        "content": "<p>theotherjimmy created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#discussion_r2687607051\">PR review comment</a>:</p>\n<blockquote>\n<p>Deleted, tests still pass.</p>\n</blockquote>",
        "id": 567834756,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768329305
    },
    {
        "content": "<p>uweigand submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#pullrequestreview-3657329703\">PR review</a>:</p>\n<blockquote>\n<p>This LGTM now, thanks!</p>\n</blockquote>",
        "id": 567837575,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768330351
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218#pullrequestreview-3657469275\">PR review</a>:</p>\n<blockquote>\n<p>Thanks Ulrich for the review on this!</p>\n</blockquote>",
        "id": 567841973,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768331896
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12218\">PR #12218</a>.</p>",
        "id": 567846200,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1768333317
    }
]