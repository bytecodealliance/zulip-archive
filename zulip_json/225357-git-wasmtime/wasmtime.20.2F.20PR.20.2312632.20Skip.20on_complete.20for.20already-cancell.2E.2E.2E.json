[
    {
        "content": "<p>jellevandenhooff opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a> from <code>jellevandenhooff:fix-on-complete-after-cancel</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>While working on a program with many outgoing DNS requests that also got cancelled I ran into a race with subtask management: </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">wasmtime</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">runtime</span><span class=\"o\">/</span><span class=\"n\">component</span><span class=\"o\">/</span><span class=\"n\">concurrent</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">5108</span><span class=\"p\">:</span><span class=\"mi\">37</span><span class=\"p\">:</span>\n<span class=\"w\">     </span><span class=\"nc\">called</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Result</span><span class=\"p\">::</span><span class=\"n\">unwrap</span><span class=\"p\">()</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">an</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Err</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">NotPresent</span>\n</code></pre></div>\n<p>The included reproducing test fails before the fix and works after.</p>\n<p>Code and commit message by Claude. It looks sane to me, but I am not sure about eating the error in the branch; please consider if this makes sense. If the commit message is too long I am happy to rewrite it human-style.</p>\n</blockquote>",
        "id": 575051969,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771638219
    },
    {
        "content": "<p>jellevandenhooff requested <a href=\"https://github.com/pchickey\">pchickey</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>.</p>",
        "id": 575051970,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771638220
    },
    {
        "content": "<p>jellevandenhooff requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>.</p>",
        "id": 575051971,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771638220
    },
    {
        "content": "<p>github-actions[bot] added the label <code>wasmtime:api</code> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>.</p>",
        "id": 575061414,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771650248
    },
    {
        "content": "<p>jellevandenhooff updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>.</p>",
        "id": 575064003,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771653717
    },
    {
        "content": "<p>jellevandenhooff updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>.</p>",
        "id": 575064277,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771653990
    },
    {
        "content": "<p>jellevandenhooff <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632#issuecomment-3938253122\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/12632\">PR #12632</a>:</p>\n<blockquote>\n<p>Okay, then ran into a similar but related issue where a cancelled task's on_complete handler was able to steal a replacement task's on_complete. The test is kind of gnarly and I am concerned it's not deterministic. What it tries to show is that:</p>\n<ul>\n<li>task A would run</li>\n<li>task A gets cancelled</li>\n<li>task B would run, with task A's original handle</li>\n<li>task A's on_complete would run... and signal success to what is now task B's handle</li>\n<li>task B's on_complete would never run</li>\n<li>now the guest is very confused because B's results are garbage<br>\nThe epoch fix seems clean, but I am sure there might be other approaches. Without the fixes in either commit both tests fail.</li>\n</ul>\n</blockquote>",
        "id": 575064359,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1771654081
    }
]