[
    {
        "content": "<p>cfallin opened <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a> from <code>cfallin:lets-be-truly-exceptional</code> to <code>bytecodealliance:main</code>:</p>\n<blockquote>\n<p>This PR adds <code>try_call</code> and <code>try_call_indirect</code> instructions, and lowerings on four of five ISAs (x86-64, aarch64, riscv64, pulley; s390x has its own non-shared ABI code that will need separate work).</p>\n<p>It extends CLIF to support these instructions as new kinds of branches, and extends block-calls to accept <code>retN</code> and <code>exnN</code> block-call args that carry the normal return values or exception payloads (respectively) into the appropriate successor blocks.</p>\n<p>It wires up the \"normal return path\" so that it continues to work. It updates the ABI so that unwinding is possible without an initial register state at throw: specifically, as per our RFC, all registers are clobbered. It also includes metadata in the <code>MachBuffer</code> that describes exception-catch destinations. However, no unwinder exists to interpret these catch-destinations yet, so they are untested.</p>\n</blockquote>",
        "id": 509573794,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554395
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 509573796,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554395
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers\">wasmtime-compiler-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 509573797,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554395
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers\">wasmtime-core-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 509573798,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554395
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2770983293\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>This builds on #10502; only the last commit is new.</p>\n</blockquote>",
        "id": 509573889,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554423
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2770985531\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Procedural note: I'm happy to go through review on this and try to land it with the \"normal return\" path working (ah, I should add runtests too!), or we can wait until I've implemented a test unwinder in the <code>clif-util</code> function runner. I'm happy to go either way.</p>\n<p>I'm also happy to add a Cranelift feature to gate this off by default until we've got it fully tested, if desired.</p>\n</blockquote>",
        "id": 509574189,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554549
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2770987314\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Also, I haven't built full Wasmtime since rebasing so some newer CLIF-producing code needs to be updated; I'll put this in draft until then (and the runtests).</p>\n</blockquote>",
        "id": 509574431,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743554654
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 509577279,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743556157
    },
    {
        "content": "<p>fitzgen <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2771015639\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<blockquote>\n<p>Procedural note: I'm happy to go through review on this and try to land it with the \"normal return\" path working (ah, I should add runtests too!), or we can wait until I've implemented a test unwinder in the <code>clif-util</code> function runner. I'm happy to go either way.</p>\n</blockquote>\n<p>Testing the normal path only for the moment seems fine by me.</p>\n<p>Will take a look at this PR tomorrow.</p>\n</blockquote>",
        "id": 509577527,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743556319
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 509789062,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743626244
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2737400037\">PR review</a>:</p>\n<blockquote>\n<p>Looks great! A bunch of nitpicks and a couple more serious comments below.</p>\n</blockquote>",
        "id": 509796031,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025484742\">PR review comment</a>:</p>\n<blockquote>\n<p>Nitpick: it shouldn't catch <em>any</em> thrown exception, just the exceptions specified in its exceptions table, so maybe rename this to</p>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>        Call a function, catching the specified exceptions.\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 509796032,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025506789\">PR review comment</a>:</p>\n<blockquote>\n<p>I don't think we even need to specify this do we? The embedder can choose whether the reserved value is \"catch all\", or instead use <code>tag0</code>, or even whether they have a \"catch all\" tag at all or not.</p>\n<p>It may still make sense to explicitly communicate this freedom by saying something like</p>\n<blockquote>\n<p>The embedder may reserve a particular tag (for example, the reserved value or <code>tag0</code>) to mean \"catch all\".</p>\n</blockquote>\n</blockquote>",
        "id": 509796033,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025486870\">PR review comment</a>:</p>\n<blockquote>\n<p>Not prepended anymore, right? There is a special kind of block call parameter to specify where they go, no? (I haven't read through everything yet)</p>\n</blockquote>",
        "id": 509796034,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025499905\">PR review comment</a>:</p>\n<blockquote>\n<p>If this is already going to be a generic function over the type of <code>args</code>, it makes sense to also be generic over the <code>Item</code>, which (with <code>From&lt;Value&gt; for BlockCall</code> and <code>From&lt;&amp;'a Value&gt; for BlockCall</code> impls) should make a bunch of call sites a little less noisy:</p>\n<p><div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>    pub fn block_call&lt;T&gt;(\n        &amp;mut self,\n        block: Block,\n        args: impl IntoIterator&lt;Item = T&gt;,\n    ) -&gt; BlockCall\n    where\n        T: Into&lt;BlockArg&gt;\n    {\n</code></pre></div><br>\n</p>\n</blockquote>",
        "id": 509796035,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025523946\">PR review comment</a>:</p>\n<blockquote>\n<p>Maybe we should put the normal return last, so that <code>tags[i]</code> is for <code>targets[i]</code>?</p>\n<p>And maybe we should make the members of this struct not-<code>pub</code> (maybe not even <code>pub(crate)</code>?) and only expose accessors that we can ensure are correct, use the right indices, etc...? This would mean that only this module needs to check/maintain the length invariant, or be concerned with correct indexing, not all code that interacts exception tables.</p>\n</blockquote>",
        "id": 509796036,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025512042\">PR review comment</a>:</p>\n<blockquote>\n<p>Care to just put this in the <code>entity_impl!</code> macro? Then we could implement the constructors that assert that <code>n != u32::MAX</code> with unwrapping a call to this.</p>\n</blockquote>",
        "id": 509796037,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025520225\">PR review comment</a>:</p>\n<blockquote>\n<p>Idle comment, not suggesting we actually do this or anything, but we <em>could</em> do a ref-counting + CoW kind of thing here. Not really worth the complexity tho.</p>\n</blockquote>",
        "id": 509796038,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025527824\">PR review comment</a>:</p>\n<blockquote>\n<p>Ditto about making the iterator's <code>Item</code> generic here.</p>\n</blockquote>",
        "id": 509796039,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025530008\">PR review comment</a>:</p>\n<blockquote>\n<p>And then this could be </p>\n<div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>    pub fn append_argument(&amp;mut self, arg: impl Into&lt;BlockArg&gt;, pool: &amp;mut ValueListPool) {\n</code></pre></div>\n<p>as well</p>\n</blockquote>",
        "id": 509796040,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025513344\">PR review comment</a>:</p>\n<blockquote>\n<p>\"ex\" feels a little too brief and potentially ambiguous, maybe</p>\n<div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>entity_impl!(ExceptionTable, \"exn_table\");\n</code></pre></div>\n<p>?</p>\n</blockquote>",
        "id": 509796041,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025566451\">PR review comment</a>:</p>\n<blockquote>\n<p>This is the one thing that cranelift is constraining on the embedder's runtime: it must supply the exception values in the expected registers and this is inherently ISA specific. I don't know how to be document and communicate this. Maybe just a list of each ISA's registers in the docs for the <code>try_call</code> instruction? Or maybe in the docs for exception tags?</p>\n<p>But it is also per-calling convention, so maybe on the calling convention's docs? Bit of a mess...</p>\n</blockquote>",
        "id": 509796042,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025534630\">PR review comment</a>:</p>\n<blockquote>\n<p>And here as well</p>\n</blockquote>",
        "id": 509796043,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025548114\">PR review comment</a>:</p>\n<blockquote>\n<p>Would be kinda nice if <code>PRegSet</code> had a <code>with_range</code> method or something like that. I've vaguely wanted that method before, and this function would sure appreciate that method's existence.</p>\n</blockquote>",
        "id": 509796044,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628807
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025558553\">PR review comment</a>:</p>\n<blockquote>\n<div class=\"codehilite\" data-code-language=\"suggestion\"><pre><span></span><code>            &amp;Inst::Call { ref info } if info.try_call_info.is_some() =&gt; MachTerminator::Direct,\n</code></pre></div>\n<p>right?</p>\n</blockquote>",
        "id": 509796045,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025614558\">PR review comment</a>:</p>\n<blockquote>\n<p>It looks like we are laying the code out such that the exceptional blocks are coming before the normal return blocks here. Ideally the call would fall through to the normal return block. Obviously, with blocks that are both a <code>try_call</code>'s normal return and the successor of many other blocks, this isn't always possible/desirable, but that is not the case in this example, which means we have room for improvement.</p>\n<p>This isn't anything to fix before this PR can land, but is something we should think about for follow ups.</p>\n</blockquote>",
        "id": 509796046,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025577245\">PR review comment</a>:</p>\n<blockquote>\n<p>Looks like the exception payload registers for each handler are not included in here. But I think they should be, or else the unwinder implementation will have to just know what we happen to use since, while system-v documents this, there is no such existing docs/constraints for our <code>tail</code> convention. We could even theoretically let regalloc pick the registers, if we wanted.</p>\n</blockquote>",
        "id": 509796047,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025616733\">PR review comment</a>:</p>\n<blockquote>\n<p>It would also be good to test when both normal return blocks and exceptional return blocks don't only have <code>try_call</code> predecessors, but also regular control-flow predecessors.</p>\n</blockquote>",
        "id": 509796048,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025573394\">PR review comment</a>:</p>\n<blockquote>\n<p>I guess we could include this in the unwind table data structures returned by cranelift after compilation. That actually seems easiest to me. Maybe that is indeed what is done and I haven't seen it yet or overlooked it.</p>\n</blockquote>",
        "id": 509796049,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025618032\">PR review comment</a>:</p>\n<blockquote>\n<p>It would also be nice to have a runtest to exercise the normal return path, even before we have a filetest unwinder to exercise exceptional paths.</p>\n</blockquote>",
        "id": 509796050,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2025489795\">PR review comment</a>:</p>\n<blockquote>\n<p>Maybe some kind of mention here that it is the user's responsibility to coordinate with the runtime on the meaning of tags and how look up is done, and that all of that is outside of Cranelift's purview, itself here.</p>\n</blockquote>",
        "id": 509796051,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743628808
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510006173,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743703491
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510006646,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743703655
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510007280,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743703867
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741300543\">PR review</a>.</p>",
        "id": 510045368,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718182
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027813458\">PR review comment</a>:</p>\n<blockquote>\n<p>Unfortunately this seems to create a ton of noise elsewhere: it means that <code>ins.jump(target, &amp;[])</code> leads to a type-inference error, because <code>T</code> is now unconstrained. I've tried a bunch of things here including a custom trait <code>IntoBlockArgs</code> etc and this seems to be the least-bad; other ideas welcome...</p>\n</blockquote>",
        "id": 510045370,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718182
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510045449,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718208
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741301119\">PR review</a>.</p>",
        "id": 510045452,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718211
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027813870\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510045453,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718211
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741301205\">PR review</a>.</p>",
        "id": 510045466,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718215
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027813928\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510045467,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718215
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741301402\">PR review</a>.</p>",
        "id": 510045487,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718224
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027814028\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah yes, fixed, sorry, this is old text. Fixed.</p>\n</blockquote>",
        "id": 510045488,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718224
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741302435\">PR review</a>.</p>",
        "id": 510045558,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718270
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027814686\">PR review comment</a>:</p>\n<blockquote>\n<p>Unfortunately runs into the same unconstrained-generic problem with empty args list as above...</p>\n</blockquote>",
        "id": 510045560,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718270
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741321668\">PR review</a>.</p>",
        "id": 510046194,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718638
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027820508\">PR review comment</a>:</p>\n<blockquote>\n<p>Indeed; that's a type from <code>regalloc2</code> so this would need a separate PR and release roundtrip, so unfortunately not in this PR, but will file this away...</p>\n</blockquote>",
        "id": 510046197,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718638
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510046209,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718652
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741322459\">PR review</a>.</p>",
        "id": 510046212,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718652
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027820640\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510046213,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718653
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741322807\">PR review</a>.</p>",
        "id": 510046222,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718659
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027820720\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510046224,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718659
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741324778\">PR review</a>.</p>",
        "id": 510046322,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718702
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027821306\">PR review comment</a>:</p>\n<blockquote>\n<p>Yes, that's true; bigger change for sure, and we'd want to do it for jumptables for consistency. Might be worth it if we end up with large lists of handler locations on lots of callsites someday.</p>\n</blockquote>",
        "id": 510046324,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743718703
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741356645\">PR review</a>.</p>",
        "id": 510048409,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743719888
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027840027\">PR review comment</a>:</p>\n<blockquote>\n<p>That's technically true, but there are a number of reasons that pushed me toward \"fixed payload registers\" and \"not listed in metadata\":</p>\n<ul>\n<li>Letting these be dynamic and allocating them with regalloc is pretty complex, because non-fixed-reg-but-still-reg-constrained defs on calls are error-prone -- we have to carefully poke holes in the clobbers to try to force regalloc to use those holes, then we have to assert that it did the right thing (because otherwise everything is clobbered). We really want a \"def after clobbers\" constraint but that is a weird thing in its own way.</li>\n<li>Naming different registers per exception handler record per callsite is going to be quite bloated -- right now we have three <code>u32</code>s here, vs. 5.</li>\n<li>Naming a variable-length list of registers (we don't specify that there are exactly e.g. two payload regs; that's a property of the platform and calling convention) is also complex: do we have an owned smallvec/vec per record here? separate list and ranges in it?</li>\n<li>Letting the register choice be dynamic means that the unwinder needs a way to take an index and set an arbitrary register, rather than a fixed one. That rules out small handwritten longjmp-like trampolines/stubs (set rsp/rbp/rax and jump).</li>\n</ul>\n<p>So basically it seemed like too much generality, leading to far too much complexity, vs. saying that each platform gets to specify fixed payload regs. I think I'm comfortable with specifying that the payload registers are a fixed choice and this choice becomes part of our public contract (we should document this somewhere; I'll add it to the doc-comments on <code>try_call</code> / <code>try_call_indirect</code> and/or the <code>CallConv</code> arms...).</p>\n</blockquote>",
        "id": 510048410,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743719888
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510048829,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720117
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741363344\">PR review</a>.</p>",
        "id": 510049105,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720244
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027844354\">PR review comment</a>:</p>\n<blockquote>\n<p>(comment below -- added docs on <code>CallConv</code> and a note pointing to those docs on <code>try_call</code>)</p>\n</blockquote>",
        "id": 510049107,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720245
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027848478\">PR review comment</a>:</p>\n<blockquote>\n<p>Actually removed this paragraph -- I ended up with <code>PackedOption&lt;ExceptionTag&gt;</code> to allow <code>None</code> to mean \"catch-all\".</p>\n</blockquote>",
        "id": 510049595,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720558
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741369376\">PR review</a>.</p>",
        "id": 510049596,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720558
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510049597,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720559
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510050236,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720941
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2741376521\">PR review</a>.</p>",
        "id": 510050237,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720941
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2027853320\">PR review comment</a>:</p>\n<blockquote>\n<p>Good call, went for <code>extable</code> (underscores don't seem to be used elsewhere in these tags).</p>\n</blockquote>",
        "id": 510050239,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743720941
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2743746070\">PR review</a>.</p>",
        "id": 510259238,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743789033
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029222945\">PR review comment</a>:</p>\n<blockquote>\n<p>Sure, mind if I do this in a separate refactor? This is following the pattern that all the entities use -- happy to do them all at once.</p>\n</blockquote>",
        "id": 510259241,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743789034
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510267459,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743791867
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2743835089\">PR review</a>.</p>",
        "id": 510267626,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743791914
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029276388\">PR review comment</a>:</p>\n<blockquote>\n<p>Interesting -- I took a look at where this is consumed and it seems we don't really need the distinction anymore (it's left over from older one-vs-two-armed conditional branches and branch finalization). So I collapsed direct/indirect/conditional into one \"Branch\" case.</p>\n</blockquote>",
        "id": 510267628,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743791914
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2744258661\">PR review</a>.</p>",
        "id": 510305672,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808350
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029538293\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, great idea, done on both counts. This also had the nice side-effect of putting the normal-return path first in block order (i.e. fallthrough) because the <code>BlockLoweringOrder</code> processes out-edges in reverse order for particular heuristic reasons that I forget...</p>\n</blockquote>",
        "id": 510305674,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808350
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510305706,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808369
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510305968,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808549
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2744261249\">PR review</a>.</p>",
        "id": 510306022,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808565
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029540193\">PR review comment</a>:</p>\n<blockquote>\n<p>Resolved by above!</p>\n</blockquote>",
        "id": 510306023,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808565
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2744261390\">PR review</a>.</p>",
        "id": 510306037,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808577
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029540276\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510306039,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808577
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510306602,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808935
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2744264596\">PR review</a>.</p>",
        "id": 510306606,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808937
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2029542618\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510306608,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808938
    },
    {
        "content": "<p><strong>cfallin</strong> has marked <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a> as ready for review.</p>",
        "id": 510306628,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743808961
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2779894678\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>@fitzgen I think I've addressed everything except for the unresolved comments above (see comments, happy to take suggestions). I think #10502 also needs a review (Alex deferred to you per [here]https://github.com/bytecodealliance/wasmtime/pull/10502#pullrequestreview-2733680435); I'll make the update that Ulrich suggests in a separate commit). Thanks!</p>\n</blockquote>",
        "id": 510306820,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743809087
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510309126,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743810686
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2779914127\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Rebased on top of latest #10502 (and had to squash the stack of review-feedback commits to avoid too many conflicts-at-every-step but they're still at <a href=\"https://github.com/bytecodealliance/wasmtime/commit/8f95de2101c6bfd5b72ba2e2c74f2b7ecff5615a\">this branch</a>)</p>\n</blockquote>",
        "id": 510309228,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743810753
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/fitzgen\">fitzgen</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510309382,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743810887
    },
    {
        "content": "<p><strong>cfallin</strong> requested <a href=\"https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers\">wasmtime-fuzz-reviewers</a> for a review on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510309383,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743810887
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510309384,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1743810887
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2747585366\">PR review</a>.</p>",
        "id": 510730140,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047249
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2031700890\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah yeah, I wish we could provide default type parameters for functions too, not just types. Oh well.</p>\n</blockquote>",
        "id": 510730141,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047250
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2747586098\">PR review</a>.</p>",
        "id": 510730207,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047270
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2031701339\">PR review comment</a>:</p>\n<blockquote>\n<p>Sure thing, thanks</p>\n</blockquote>",
        "id": 510730212,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047271
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2747588344\">PR review</a>.</p>",
        "id": 510730399,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047332
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2031702789\">PR review comment</a>:</p>\n<blockquote>\n<p>That seems fair. Figuring out a good place to document this for users is going to be annoying.</p>\n</blockquote>",
        "id": 510730400,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744047332
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2747606299\">PR review</a>:</p>\n<blockquote>\n<p>Thanks!</p>\n</blockquote>",
        "id": 510733418,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744048297
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2031715809\">PR review comment</a>:</p>\n<blockquote>\n<p>And then somewhere around here is where we would actually implement that check.</p>\n</blockquote>",
        "id": 510733420,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744048297
    },
    {
        "content": "<p>fitzgen created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2031714029\">PR review comment</a>:</p>\n<blockquote>\n<p>Since we are only defining the exception registers for the <code>tail</code> calling convention, can we also check that <code>try_call</code>ing a function of a different calling convention triggers verifier errors? At least for now, we can always loosen this later and document the registers used for other conventions at that point. I double checked the <code>try_call.clif</code> verifier filetest and didn't see a case for this there.</p>\n</blockquote>",
        "id": 510733421,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744048297
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510780535,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744066551
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510783718,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744068190
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510785161,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744068986
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2748327025\">PR review</a>.</p>",
        "id": 510785182,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069001
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2032148444\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510785183,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069001
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2748327130\">PR review</a>.</p>",
        "id": 510785191,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069008
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2032148535\">PR review comment</a>:</p>\n<blockquote>\n<p>Done!</p>\n</blockquote>",
        "id": 510785192,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069009
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2784866568\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Thanks! All addressed; while looking over it I noticed I still had <code>try_call_indirect</code> lowerings as a TODO and added the ~20 lines of final plumbing to wire it up. Separated that as last commit and wanted to flag before merging -- lemme know if good.</p>\n</blockquote>",
        "id": 510785399,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069149
    },
    {
        "content": "<p>cfallin updated <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510785673,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069308
    },
    {
        "content": "<p>fitzgen submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2748337540\">PR review</a>.</p>",
        "id": 510785867,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069409
    },
    {
        "content": "<p>cfallin has enabled auto merge for <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510786088,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744069523
    },
    {
        "content": "<p>cfallin merged <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>.</p>",
        "id": 510790239,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744071795
    },
    {
        "content": "<p>uweigand <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2786224329\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Hi @cfallin , I'm looking to implement this for s390x, and I'm a bit confused about the two (different?) SigRef's in play in <code>gen_try_call</code>: one passed as direct argument, and one taken from the <code>et</code>.   Which one is supposed to be used when?  The current code mixed them in unexpected ways:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">caller_conv</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">lower_ctx</span><span class=\"p\">.</span><span class=\"n\">abi</span><span class=\"p\">().</span><span class=\"n\">call_conv</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">lower_ctx</span><span class=\"p\">.</span><span class=\"n\">sigs</span><span class=\"p\">());</span>\n<span class=\"w\">            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">sigref</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">lower_ctx</span><span class=\"p\">.</span><span class=\"n\">dfg</span><span class=\"p\">().</span><span class=\"n\">exception_tables</span><span class=\"p\">[</span><span class=\"n\">et</span><span class=\"p\">].</span><span class=\"n\">signature</span><span class=\"p\">();</span>\n<span class=\"w\">            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">lower_ctx</span><span class=\"p\">.</span><span class=\"n\">dfg</span><span class=\"p\">().</span><span class=\"n\">signatures</span><span class=\"p\">[</span><span class=\"n\">sigref</span><span class=\"p\">];</span>\n<span class=\"w\">            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">num_rets</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sig</span><span class=\"p\">.</span><span class=\"n\">returns</span><span class=\"p\">.</span><span class=\"n\">len</span><span class=\"p\">();</span>\n<span class=\"w\">            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">caller</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"cp\">$abicaller</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"n\">from_func</span><span class=\"p\">(</span>\n<span class=\"w\">                </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">lower_ctx</span><span class=\"p\">.</span><span class=\"n\">sigs</span><span class=\"p\">(),</span>\n<span class=\"w\">                </span><span class=\"n\">sig_ref</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"o\">&amp;</span><span class=\"n\">extname</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"n\">IsTailCall</span><span class=\"p\">::</span><span class=\"n\">No</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"n\">dist</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"n\">caller_conv</span><span class=\"p\">,</span>\n<span class=\"w\">                </span><span class=\"bp\">self</span><span class=\"p\">.</span><span class=\"n\">backend</span><span class=\"p\">.</span><span class=\"n\">flags</span><span class=\"p\">().</span><span class=\"n\">clone</span><span class=\"p\">(),</span>\n<span class=\"w\">            </span><span class=\"p\">);</span>\n</code></pre></div>\n<p>Why do we compute <code>num_rets</code> from one <code>SigRef</code> but pass the other to <code>from_func</code>?   Also, why is this handled differently between <code>gen_try_call</code> and <code>gen_try_call_indirect</code> ?<br>\n</p>\n</blockquote>",
        "id": 510914614,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744114137
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750262516\">PR review</a>.</p>",
        "id": 510953317,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123353
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033361367\">PR review comment</a>:</p>\n<blockquote>\n<p>FWIW I had put it in <code>MachCallSite</code> instead, but this should also work fine.</p>\n</blockquote>",
        "id": 510953319,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123353
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750287248\">PR review</a>.</p>",
        "id": 510954737,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123682
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033373454\">PR review comment</a>:</p>\n<blockquote>\n<p>Cranelift doesn't care about this, right? Only the embedder should care. I don't see why they can't choose to do a different assignment, so should this really be documented and there be a <code>PackedOption</code> around the <code>ExceptionTag</code>. Wasmtime could assign exception tag 0 to the catch-all handler, right?</p>\n</blockquote>",
        "id": 510954751,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123682
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750292041\">PR review</a>.</p>",
        "id": 510955128,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123767
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033376519\">PR review comment</a>:</p>\n<blockquote>\n<p>This isn't currently checked by the verifier, right? It probably should be.</p>\n</blockquote>",
        "id": 510955130,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123767
    },
    {
        "content": "<p>bjorn3 deleted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033376519\">PR review comment</a>.</p>",
        "id": 510956054,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744123984
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750308753\">PR review</a>.</p>",
        "id": 510956427,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744124067
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033386802\">PR review comment</a>:</p>\n<blockquote>\n<p>Why are all registers clobbered for <code>try_call</code>? For regular systemv unwinding, all callee saved registers are preserved on the unwind path too.</p>\n</blockquote>",
        "id": 510956428,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744124067
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750580633\">PR review</a>.</p>",
        "id": 510973797,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744128516
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033547517\">PR review comment</a>:</p>\n<blockquote>\n<p>Right, I suppose the alternative is to give the embedder a raw <code>u32</code> to plumb through, or let it assign a special sentinel value by convention; I guess one advantage of this approach is that it distinguishes the tags in CLIF so they aren't just bare integers.</p>\n</blockquote>",
        "id": 510973798,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744128516
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750589096\">PR review</a>.</p>",
        "id": 510974371,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744128676
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033552840\">PR review comment</a>:</p>\n<blockquote>\n<p>Ah, yes, this came out of our discussions regarding the Wasmtime side of the implementation: we didn't want to have to require all registers to be saved and accessible in all trampolines out to the host as a starting-point for the unwind register state (otherwise we are penalizing. all existing programs when the feature is turned on); and we didn't necessarily want to have the unwind-info be load-bearing for correctness. With this approach we can restart at the catch-point without having to set up any register state other than the payload.</p>\n<p>This could definitely become a codegen flag for use in native code; not doing that is just an oversight in the initial PR, sorry. I'd be happy to review a PR for that!</p>\n</blockquote>",
        "id": 510974373,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744128676
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2750689279\">PR review</a>.</p>",
        "id": 510980249,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744130368
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033610908\">PR review comment</a>:</p>\n<blockquote>\n<p>It would be possible to make <code>ExceptionTag</code> a wrapper around a u32 without niche, right?</p>\n</blockquote>",
        "id": 510980250,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744130368
    },
    {
        "content": "<p>bjorn3 submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2751212066\">PR review</a>.</p>",
        "id": 511012773,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744141386
    },
    {
        "content": "<p>bjorn3 created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2033914102\">PR review comment</a>:</p>\n<blockquote>\n<p>It would have been nice if this accepted <code>impl IntoIterator&lt;Item = BlockArg&gt;</code>. <code>BlockArg</code> is <code>Copy</code>, so you can use <code>.copied()</code> on the iterator if necessary to convert from an <code>&amp;BlockArg</code> to a <code>BlockArg</code> iterator. However if you are trying to build the <code>BlockArgs</code>s on the fly, you are forced to collect them into a <code>Vec</code> before passing it to <code>block_call</code> with the current function signature.</p>\n</blockquote>",
        "id": 511012775,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744141386
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2787632143\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>Hi @uweigand,</p>\n<blockquote>\n<p>Why do we compute <code>num_rets</code> from one <code>SigRef</code> but pass the other to <code>from_func</code>? Also, why is this handled differently between <code>gen_try_call</code> and <code>gen_try_call_indirect</code> ?</p>\n</blockquote>\n<p>I think this is just an oversight, sorry! The signature ID needs to be in the exception table because <code>TryCallIndirect</code> doesn't have space in the <code>InstructionData</code> directly for the ID, as the <code>CallIndirect</code> case does. IMHO we should uniformly use the version from the exception table in both <code>try_call</code> and <code>try_call_indirect</code> handling (and thus not take a separate parameter). In the direct-call case, the verifier checks that the exception table's sigref matches the called function's signature, so it should be fine no matter the source we use.</p>\n</blockquote>",
        "id": 511023432,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744145473
    },
    {
        "content": "<p>cfallin <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#issuecomment-2787633112\">commented</a> on <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510\">PR #10510</a>:</p>\n<blockquote>\n<p>(And: please feel free to update this as you need to when building out s390x support for this!)</p>\n</blockquote>",
        "id": 511023493,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744145504
    },
    {
        "content": "<p>cfallin submitted <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#pullrequestreview-2751373023\">PR review</a>.</p>",
        "id": 511023798,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744145626
    },
    {
        "content": "<p>cfallin created <a href=\"https://github.com/bytecodealliance/wasmtime/pull/10510#discussion_r2034014368\">PR review comment</a>:</p>\n<blockquote>\n<p>IIRC, this was necessary to allow <code>&amp;[a, b]</code>-style arg-lists, which are everywhere in other crates in-repo, to continue to work. Although now that I think about it, I suppose just <code>[a, b]</code> might work with <code>Item = BlockArg</code>. I don't have strong feelings here and I'm happy to review a PR if you can find a way to make it nicer (including with existing callsites)...</p>\n</blockquote>",
        "id": 511023801,
        "sender_full_name": "Wasmtime GitHub notifications bot",
        "timestamp": 1744145626
    }
]