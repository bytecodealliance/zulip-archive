[
    {
        "content": "<p>I am trying to embed wasmtime using the c api and am getting this error:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">compile</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">wasm</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]::</span><span class=\"n\">function</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n\n<span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"p\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">WebAssembly</span><span class=\"w\"> </span><span class=\"n\">translation</span><span class=\"w\"> </span><span class=\"n\">error</span>\n<span class=\"w\">    </span><span class=\"mi\">1</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Invalid</span><span class=\"w\"> </span><span class=\"n\">input</span><span class=\"w\"> </span><span class=\"n\">WebAssembly</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">offset</span><span class=\"w\"> </span><span class=\"mi\">118</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unknown</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"mi\">264208125</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">function</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">bounds</span>\n</code></pre></div>\n<p>it might be a memory issue since it is coded in c but the numbers stayed constant over restarts and doesn't correspond to 0xccc... which it did with a previous memory issue.<br>\nI have attached the wasm file and the rs&amp;toml file it came from. It was built in release mode<br>\n<a href=\"/user_uploads/15107/IS8Y9ADC8dtTBy1PrEMsZATS/hello.wasm\">hello.wasm</a><br>\n<a href=\"/user_uploads/15107/k96-XejIBzwWiY-1iqz-Shm1/Cargo.toml\">Cargo.toml</a><br>\n<a href=\"/user_uploads/15107/-M9sKSvXGkwBjmM6eIi0TVyG/lib.rs\">lib.rs</a><br>\nnote that with similar code, the following worked<br>\n<a href=\"/user_uploads/15107/hAGez6n4i5Dc2OfwzaBn-hcF/hello.wasm\">hello.wasm</a><br>\n<a href=\"/user_uploads/15107/DAl76q94nicYY7Grc4Xl7dDi/hello.wat\">hello.wat</a></p>",
        "id": 508086277,
        "sender_full_name": "Sammy Hamdani",
        "timestamp": 1742923715
    },
    {
        "content": "<p>There's probably a bug in how you are using the C API, that you either haven't read the entire wasm code into memory or corrupted memory somehow. <code>wasm-tools print ~/Downloads/hello.wasm</code> shows a valid wasm module for that input. if the module itself was the problem, that would give the exact same error as you see at 1, because thats wasmtime invoking the same wasmparser inside wasm-tools print</p>",
        "id": 508088657,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1742924318
    }
]