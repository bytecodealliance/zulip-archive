[
    {
        "content": "<p>I introduced the <a href=\"https://docs.rs/wasmtime/latest/wasmtime/struct.Store.html#method.call_hook\"><code>call_hook</code></a> machinery when I was working on Fastly's embedding of wasmtime. I'm noodling what some design changes there might look like and I'm curious if any other embedders are actually using that feature with components, and if so, what are you using it for?</p>",
        "id": 570667774,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1769637557
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254083\">@Dan Gohman</span> is Fastly still using the call hook in roughly the same way as before with the component embedding?</p>",
        "id": 570667968,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1769637627
    },
    {
        "content": "<p>pinging some other folks who have maintained major embeddings: <span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> <span class=\"user-mention\" data-user-id=\"421591\">@Bailey Hayes</span> <span class=\"user-mention\" data-user-id=\"344849\">@Yosh Wuyts</span> <span class=\"user-mention\" data-user-id=\"411395\">@Saúl Cabrera</span></p>",
        "id": 570668186,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1769637703
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"253992\">@Pat Hickey</span> We're still using it, or rather, we're using <code>call_hook_async</code> now, but for effectively the same purpose, iiuc.</p>",
        "id": 570669000,
        "sender_full_name": "Dan Gohman",
        "timestamp": 1769638032
    },
    {
        "content": "<p>we're not currently using it</p>",
        "id": 570669882,
        "sender_full_name": "Bailey Hayes",
        "timestamp": 1769638389
    },
    {
        "content": "<p>cc/ <span class=\"user-mention\" data-user-id=\"443063\">@Dan Chiarlone (danbugs)</span> <span class=\"user-mention\" data-user-id=\"761042\">@Lucy Menon</span></p>",
        "id": 570680016,
        "sender_full_name": "Yosh Wuyts",
        "timestamp": 1769643697
    },
    {
        "content": "<p>cc/ <span class=\"user-mention\" data-user-id=\"477345\">@Jeff Charles</span></p>",
        "id": 570681840,
        "sender_full_name": "Saúl Cabrera",
        "timestamp": 1769644678
    },
    {
        "content": "<p>I believe that Spin is using the synchronous version for tracking time-in and time-out for requests</p>",
        "id": 570700377,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1769658312
    },
    {
        "content": "<p>correct yeah, we're using it. However, I think we should actually do more coarse-grained time tracking based on Tokio tasks, so if there's a good argument for removing them, that's something we could discuss</p>",
        "id": 570810503,
        "sender_full_name": "Till Schneidereit",
        "timestamp": 1769697014
    },
    {
        "content": "<p>We're not currently using it</p>",
        "id": 570828487,
        "sender_full_name": "Jeff Charles",
        "timestamp": 1769700977
    },
    {
        "content": "<p>Spin uses it to emit metrics for guest execution wall time. Till is right that we could potentially replace that with task busy time but they aren't <em>exactly</em> equivalent. We've also discussed using them for tracking CPU counters but I'd be even happier to add e.g. USDT probes for that (since counters aren't terribly portable to begin with).</p>",
        "id": 571066841,
        "sender_full_name": "Lann Martin",
        "timestamp": 1769788882
    },
    {
        "content": "<p>I don't believe we are using it right now. We don't need per-instance execution time or anything like that at the moment.</p>",
        "id": 572163883,
        "sender_full_name": "Lucy Menon",
        "timestamp": 1770301830
    },
    {
        "content": "<p>Thanks all. FWIW I moved on to working on another mechanism at the moment and don't plan to make any changes to call hooks.</p>",
        "id": 572200259,
        "sender_full_name": "Pat Hickey",
        "timestamp": 1770309821
    }
]