[
    {
        "content": "<p>As the OOM-handling effort progresses, it has become clear that we probably shouldn't name our OOM-handling collections the same as their equivalent abort-on-OOM <code>alloc</code>/<code>std</code> types. This is because things get pretty confusing during this period of time where we haven't migrated everything over to the OOM-handling collections (and almost certainly won't have migrated 100% any time soon; we may never even bother migrating the stuff under <code>wasmtime::compile::*</code>) and so when you see a <code>Vec</code> you have to wonder \"is this abort-on-OOM <code>alloc::vec::Vec</code> or OOM-handling <code>wasmtime_core::alloc::Vec</code>?\" That is annoying and we shouldn't add the additional and unnecessary mental load on ourselves.</p>\n<p><strong>So that begs the question: what naming scheme should we use for our OOM-handling, fallible-allocation-only collections?</strong> </p>\n<p>The following candidates will use <code>Vec</code> as an example, but to be clear this will naming scheme also apply to our OOM-handling <code>String</code>, <code>HashMap</code>, etc...</p>\n<p>Some initial ideas from <span class=\"user-mention\" data-user-id=\"253994\">@Alex Crichton</span> :</p>\n<blockquote>\n<ul>\n<li><code>TryVec</code> - perhaps accurate, but long. <code>TryIndexMap</code> is a lot.</li>\n<li><code>TVec</code> - personally I kinda like the ring of \"letter plus collection\". It's short and clearly \"not <code>std</code>\"</li>\n<li><code>WVec</code> - wasmtime's vec?</li>\n<li><code>XVec</code> - any other random letter</li>\n<li><code>OomVec</code> - I don't like this b/c the container handles OOMs, it doesn't make OOMs</li>\n<li><code>VecT</code> (or <code>VecW</code> or such) - subjectively not a fan</li>\n</ul>\n</blockquote>\n<p>Some more ideas:</p>\n<ul>\n<li><code>WtVec</code> -- another riff on \"wasmtime's vec\", kinda fun to read as \"what the vec\"</li>\n<li><code>OomHandlingVec</code></li>\n<li><code>OhVec</code> -- shortened version of \"OOM-handling\"</li>\n<li><code>FallibleVec</code></li>\n<li><code>FVec</code> -- f for fallible</li>\n<li><code>QVec</code> -- q for \"question mark\" which you use to propagate OOM errors</li>\n<li><code>Xec</code>/<code>XashMap</code>/<code>Xtring</code>etc -- very xtreme, also cool cyberpunk (or post-cyberpunk?) transhumanism vibes</li>\n<li><code>AfVec</code> - allocation fallibility vec, cool af</li>\n<li><code>ZVec</code> -- z is a rare and cool letter</li>\n</ul>\n<p>I hate every one of these options, pls help</p>",
        "id": 573800955,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771005744
    },
    {
        "content": "<blockquote>\n<p>I hate every one of these options, pls help</p>\n</blockquote>\n<p>honestly I agree with this take, but I'd also say that my dissatisfaction with these names isn't enough to overcome the desire to rename and avoid name clashes with the standard types</p>",
        "id": 573801922,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006054
    },
    {
        "content": "<p>oh for sure, I think we are in the same boat here</p>",
        "id": 573801991,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006078
    },
    {
        "content": "<p><code>OpVec</code> - \"oom propagating\" or \"overpowered\"</p>",
        "id": 573802065,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006109
    },
    {
        "content": "<p>the original pusher</p>",
        "id": 573802140,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006134
    },
    {
        "content": "<p>I'd ever-so-slightly lean towards <code>TVec</code> still so far along the lines of \"T for try\" where the libstd methods are <code>try_*</code> so far</p>",
        "id": 573802295,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006196
    },
    {
        "content": "<p>I don't know why by <code>TVec</code> just feels weird to me. maybe because <code>T</code> is so often a type param</p>\n<p>I think the least-worst choices IMO rn are</p>\n<ul>\n<li><code>TryVec</code></li>\n<li><code>QVec</code></li>\n<li><code>Xec</code> (it is so ridiculous, but also it is kinda growing on me and it is very concise)</li>\n</ul>",
        "id": 573802674,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006327
    },
    {
        "content": "<p>I also didn't recoil as much as I thought I would at <code>Xec</code></p>",
        "id": 573802781,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006366
    },
    {
        "content": "<p>lol we could also do <code>Wec</code>, <code>WashMap</code>, etc and if you use a polish pronunciation of \"W\" then it is the same as \"vec\"</p>",
        "id": 573802853,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006397
    },
    {
        "content": "<p>I'm feeling like leaning towards something small to demarcate these collections insofar as I'd rule out <code>TryVec</code></p>",
        "id": 573802865,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006402
    },
    {
        "content": "<p>lol well the polish part doesn't work soo well for <code>Wtring</code></p>",
        "id": 573802917,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006423
    },
    {
        "content": "<p>it really doesn't</p>",
        "id": 573802938,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006432
    },
    {
        "content": "<p>I think I might still lean more towards a prefix though</p>",
        "id": 573803010,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006460
    },
    {
        "content": "<p>and <code>Q*</code> seems fine by me</p>",
        "id": 573803024,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006468
    },
    {
        "content": "<p><code>QHashMap</code>, <code>QString</code>, <code>QVec</code>, <code>QIndexMap</code>, ...</p>",
        "id": 573803054,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006481
    },
    {
        "content": "<p><code>QHashSet</code></p>",
        "id": 573803101,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006495
    },
    {
        "content": "<p><code>QPrimaryMap</code></p>",
        "id": 573803125,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006501
    },
    {
        "content": "<p>shouldn't wec come before xec after vec? (sorry)</p>",
        "id": 573803158,
        "sender_full_name": "Ramon Klass",
        "timestamp": 1771006508
    },
    {
        "content": "<p><code>QEntitySet</code></p>",
        "id": 573803162,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006510
    },
    {
        "content": "<p><code>XndexMap</code> doesn't really work</p>",
        "id": 573803171,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006512
    },
    {
        "content": "<p>looks like xanax</p>",
        "id": 573803196,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006523
    },
    {
        "content": "<p>lol</p>",
        "id": 573803214,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006530
    },
    {
        "content": "<p>okay so <code>QVec</code> et al?</p>",
        "id": 573803257,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006547
    },
    {
        "content": "<p>my gut is <code>_Vec</code>, although I'm not wed to <code>Q</code> in particular there</p>",
        "id": 573803348,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006579
    },
    {
        "content": "<p>Q is a p cool letter</p>",
        "id": 573803405,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006602
    },
    {
        "content": "<p>Q sort of makes me think \"qt vec\"</p>",
        "id": 573803410,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006605
    },
    {
        "content": "<p>hrm</p>",
        "id": 573803425,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006612
    },
    {
        "content": "<p>Q feels not unreasonable to type though</p>",
        "id": 573803444,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006622
    },
    {
        "content": "<p>\"double yoo\" is just too long</p>",
        "id": 573803445,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006622
    },
    {
        "content": "<p>good point</p>",
        "id": 573803468,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006633
    },
    {
        "content": "<p>gotta have a single-syllable-letter...</p>",
        "id": 573803488,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006639
    },
    {
        "content": "<p>although that literally only rules out W</p>",
        "id": 573803519,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006650
    },
    {
        "content": "<p>I'd say <code>QVec</code></p>",
        "id": 573803569,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771006665
    },
    {
        "content": "<p>never thought about that before</p>",
        "id": 573803579,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006668
    },
    {
        "content": "<p>okay lets go with Q</p>",
        "id": 573803755,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006710
    },
    {
        "content": "<p>it has a nice ring to it</p>",
        "id": 573803789,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771006717
    },
    {
        "content": "<p>I'm late to this convo but I'd second the \"Q_ looks like Qt types\" that could lead to confusion (that's certainly where my mind went). very bikeshed comment of me (but that's the thread, sorry!) but ZVec maybe? reminiscent of \"zero\" and embedded stuff somehow</p>",
        "id": 573813547,
        "sender_full_name": "Chris Fallin",
        "timestamp": 1771010132
    },
    {
        "content": "<p>Having done my time with Qt, I had the same thought <span class=\"user-mention\" data-user-id=\"254389\">@Chris Fallin</span> but I do think the form makes sense.  I've seen <code>S</code> prefixes for \"safe\" variants but don't love that either as safe has a very defined meaning in Rust already.</p>",
        "id": 573816524,
        "sender_full_name": "Paul Osborne",
        "timestamp": 1771011515
    },
    {
        "content": "<p><code>BVec</code> for \"bikeshed vec\"</p>",
        "id": 573817277,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771011888
    },
    {
        "content": "<p><code>BBTreeMap</code></p>",
        "id": 573817342,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771011913
    },
    {
        "content": "<p><code>BsVec</code> -- bikeshed vec</p>",
        "id": 573817362,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771011922
    },
    {
        "content": "<p>I'd agree though \"safe\" wouldn't be right for this in that both variants (libstd and fallible) are safe Rust-wise</p>",
        "id": 573817498,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771011985
    },
    {
        "content": "<p>I'm also loathe to acknowledge that Qt has a monopoly on Q-prefixed things in code...</p>",
        "id": 573817553,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771012017
    },
    {
        "content": "<p>not that I've ever done anything with or in Qt myself heh</p>",
        "id": 573817567,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771012025
    },
    {
        "content": "<p><code>KVec</code> - \"kernel suitable\"</p>",
        "id": 573817661,
        "sender_full_name": "Alex Crichton",
        "timestamp": 1771012064
    },
    {
        "content": "<p>that seems decent to me</p>",
        "id": 573818033,
        "sender_full_name": "fitzgen (he/him)",
        "timestamp": 1771012233
    },
    {
        "content": "<p>my response is just... \"K\"</p>",
        "id": 573819532,
        "sender_full_name": "Chris Fallin",
        "timestamp": 1771012854
    },
    {
        "content": "<p>(seems fine!)</p>",
        "id": 573819538,
        "sender_full_name": "Chris Fallin",
        "timestamp": 1771012856
    },
    {
        "content": "<p><span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> K is fine, the easily pronounceable <code>Wa</code> prefix has not been mentioned, yet ... <code>WaVec</code> reminds me more of Wasmtime than <code>KVec</code>.</p>",
        "id": 573825881,
        "sender_full_name": "Christof Petig",
        "timestamp": 1771015915
    },
    {
        "content": "<p>It sounds like <code>KVec</code> is already the winner here, but allow me to offer some more paint buckets:</p>\n<p><code>CheckedVec</code>/<code>CzechedVec</code><br>\n<code>FVec</code> (\"F\" for fallible)<br>\n<code>AllocVec</code>/<code>AVec</code><br>\n<code>OFVec</code> (\"OF\" for \"OOM Free\")<br>\n<code>OomfVec</code> (personal favorite)</p>",
        "id": 573849555,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1771030877
    },
    {
        "content": "<p>I find the <code>CzechedVec</code>humorous, but would shorten it to <code>CzVec</code>,</p>",
        "id": 574363462,
        "sender_full_name": "matt rice",
        "timestamp": 1771354304
    }
]