[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"625613\">@James Sturtevant</span>  Was looking into what needed changing to support linux,the first thing I see when running <code>dotnet add package BytecodeAlliance.Componentize.DotNet.Wasm.SDK --prerelease</code> from the readme, is that it attempts to download the compiler from</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"p\">:</span><span class=\"w\">   </span><span class=\"nc\">NotFound</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"c1\">//api.nuget.org/v3-flatcontainer/microsoft.dotnet.ilcompiler.llvm/index.json 175ms</span>\n</code></pre></div>\n<p>Does it need a nuget.config or something to add <a href=\"https://dev.azure.com/dnceng/public/_artifacts/feed/dotnet-experimental\">https://dev.azure.com/dnceng/public/_artifacts/feed/dotnet-experimental</a> ?</p>",
        "id": 466125187,
        "sender_full_name": "Scott Waye",
        "timestamp": 1724972288
    },
    {
        "content": "<p>oh, I might have pulled and had it cached via the compontize-dotnet repo. Can you add <a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/main/nuget.config\">https://github.com/bytecodealliance/componentize-dotnet/blob/main/nuget.config</a> to your project root and see if that fixes?</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/main/nuget.config\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/77e68bb0e0c1881cc1892813a65f324b6b84b93d/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f633730653136633066326463663932306233626130306233616361613862363236653764383139316231303166346136323830396263386565643131376166342f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e6574&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/main/nuget.config\" title=\"componentize-dotnet/nuget.config at main · bytecodealliance/componentize-dotnet\">componentize-dotnet/nuget.config at main · bytecodealliance/componentize-dotnet</a></div><div class=\"message_embed_description\">Tooling for creating WebAssembly components from C# - bytecodealliance/componentize-dotnet</div></div></div>",
        "id": 466127992,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1724973887
    },
    {
        "content": "<p>should add that step to the docs</p>",
        "id": 466128087,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1724973951
    },
    {
        "content": "<p>Thanks, yes that fixes the locations</p>",
        "id": 466128340,
        "sender_full_name": "Scott Waye",
        "timestamp": 1724974093
    },
    {
        "content": "<p>I can add that to the docs</p>",
        "id": 466128398,
        "sender_full_name": "Scott Waye",
        "timestamp": 1724974145
    },
    {
        "content": "<p>I think you are right, we only need the experimental feed</p>",
        "id": 466131628,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1724976263
    },
    {
        "content": "<p>was thinking, Another option would be to write that file to disk, if the native-aot option is on</p>",
        "id": 466306830,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725035900
    },
    {
        "content": "<p>Might make it easier for newcomers, but would not overwrite any existing config I guess, so would work sometimes.</p>",
        "id": 466347818,
        "sender_full_name": "Scott Waye",
        "timestamp": 1725054743
    },
    {
        "content": "<p>I have a problem with <code>dotnet build</code> for the <code>E2EConsumer</code> and <code>E2EProducer</code> projects:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\">    </span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">scott</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24412.1</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NETCore</span><span class=\"p\">.</span><span class=\"n\">Native</span><span class=\"p\">.</span><span class=\"n\">targets</span><span class=\"p\">(</span><span class=\"mi\">361</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"n\">MSB3073</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">The</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"s\">\"'/tools/ilc' @\"</span><span class=\"n\">obj</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net8</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">native</span><span class=\"o\">/</span><span class=\"n\">E2EProducer</span><span class=\"p\">.</span><span class=\"n\">ilc</span><span class=\"p\">.</span><span class=\"n\">rsp</span><span class=\"s\">\"\"</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">127.</span>\n</code></pre></div>\n<p>You can see it is not finding the path for the Ilc tools folder.  What is strange is that other projects like <code>Addr</code> are compiling and finding <code>Ilc</code> successfully.</p>",
        "id": 466533408,
        "sender_full_name": "Scott Waye",
        "timestamp": 1725110198
    },
    {
        "content": "<p>I also tried building these projects directly with <code>dotnet build</code> from their respective directories but that gives the same error.  What is the mechanism for these projects to bring in the Naot-LLVM compiler?  Is it via <code>&lt;PackageReference Include=\"ByteCodeAlliance.Componentize.DotNet.Wasm.SDK\" Version=\"$(PackageVersion)\" /&gt;</code> ?</p>",
        "id": 466534050,
        "sender_full_name": "Scott Waye",
        "timestamp": 1725110332
    },
    {
        "content": "<p>That just sets the version across all the projects, the sdk brings it in via <a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\">https://github.com/bytecodealliance/componentize-dotnet/blob/26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/d7b7f0605d4f6d13794339b66f4ad96cbc437102/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643663666133303861653833303931643637373932356637303535306239353235303633623031316162363731663632343239343635343163656433623831622f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e6574&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\" title=\"componentize-dotnet/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj at 26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525 · bytecodealliance/componentize-dotnet\">componentize-dotnet/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj at 26b5b5a839f7a2a786cfe9d2498dfa42dd6ac525 · bytecodealliance/componentize-dotnet</a></div><div class=\"message_embed_description\">Tooling for creating WebAssembly components from C# - bytecodealliance/componentize-dotnet</div></div></div>",
        "id": 466598794,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725133441
    },
    {
        "content": "<p>the e2e test projects can be finicky since the are relying on the local package, i've found clearing caches sometimes helps.  and it seem to always work in CI since its a clean env</p>",
        "id": 466599013,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725133529
    },
    {
        "content": "<p>THanks, cleaning the caches did it.</p>",
        "id": 466618767,
        "sender_full_name": "Scott Waye",
        "timestamp": 1725147697
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395878\">@Scott Waye</span>  saw you are pushing some changes, I got it working locally</p>",
        "id": 468303663,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725662586
    },
    {
        "content": "<p>you beat me to it by 5 mins, I pushed to your branch and was blocked</p>",
        "id": 468303926,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725662736
    },
    {
        "content": "<p>this is the diff I came up with </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"w\"> </span><span class=\"o\">&lt;?</span><span class=\"n\">xml</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">=</span><span class=\"s\">\"1.0\"</span><span class=\"w\"> </span><span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s\">\"utf-8\"</span><span class=\"o\">?&gt;</span>\n<span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"n\">configuration</span><span class=\"o\">&gt;</span>\n<span class=\"w\">   </span><span class=\"o\">&lt;</span><span class=\"n\">packageSources</span><span class=\"o\">&gt;</span>\n<span class=\"o\">-</span><span class=\"w\">    </span><span class=\"o\">&lt;</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">key</span><span class=\"o\">=</span><span class=\"s\">\"dev\"</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"o\">=</span><span class=\"s\">\"..\\PackageTest\\packages\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"o\">+</span><span class=\"w\">    </span><span class=\"o\">&lt;</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">key</span><span class=\"o\">=</span><span class=\"s\">\"dev\"</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"o\">=</span><span class=\"s\">\"../PackageTest/packages\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"w\">   </span><span class=\"o\">&lt;/</span><span class=\"n\">packageSources</span><span class=\"o\">&gt;</span>\n<span class=\"w\">   </span><span class=\"o\">&lt;</span><span class=\"n\">packageSourceMapping</span><span class=\"o\">&gt;</span>\n<span class=\"w\">     </span><span class=\"o\">&lt;</span><span class=\"n\">packageSource</span><span class=\"w\"> </span><span class=\"n\">key</span><span class=\"o\">=</span><span class=\"s\">\"dev\"</span><span class=\"o\">&gt;</span>\n<span class=\"o\">-</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">=</span><span class=\"s\">\"BytecodeAlliance.Componentize.DotNet.WitBindgen\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"o\">-</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">=</span><span class=\"s\">\"BytecodeAlliance.Componentize.DotNet.Wasm.SDK\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"o\">+</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">=</span><span class=\"s\">\"BytecodeAlliance.Componentize.*\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"o\">+</span><span class=\"w\">      </span><span class=\"o\">&lt;</span><span class=\"n\">package</span><span class=\"w\"> </span><span class=\"n\">pattern</span><span class=\"o\">=</span><span class=\"s\">\"BytecodeAlliance.Componentize.*\"</span><span class=\"w\"> </span><span class=\"o\">/&gt;</span>\n<span class=\"w\">     </span><span class=\"o\">&lt;/</span><span class=\"n\">packageSource</span><span class=\"o\">&gt;</span>\n<span class=\"w\">   </span><span class=\"o\">&lt;/</span><span class=\"n\">packageSourceMapping</span><span class=\"o\">&gt;</span>\n<span class=\"w\"> </span><span class=\"o\">&lt;/</span><span class=\"n\">configuration</span><span class=\"o\">&gt;</span>\n</code></pre></div>",
        "id": 468304022,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1725662774
    },
    {
        "content": "<p>Ah yes. I can close this thread now.  Thanks for the review.</p>",
        "id": 468312972,
        "sender_full_name": "Scott Waye",
        "timestamp": 1725668228
    },
    {
        "content": "<p>Hey! If I'm compiling a project from a fresh machine following componentize-dotnet's README, I run into two errors:</p>\n<p><a href=\"https://github.com/bytecodealliance/componentize-dotnet\">https://github.com/bytecodealliance/componentize-dotnet</a></p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">dotnet</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">Restore</span><span class=\"w\"> </span><span class=\"n\">complete</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.3</span><span class=\"n\">s</span><span class=\"p\">)</span>\n<span class=\"n\">You</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">using</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">preview</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">See</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">https</span><span class=\"p\">:</span><span class=\"c1\">//aka.ms/dotnet-support-policy</span>\n<span class=\"w\">  </span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net9</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">dll</span>\n<span class=\"w\">    </span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NETCore</span><span class=\"p\">.</span><span class=\"n\">Native</span><span class=\"p\">.</span><span class=\"n\">targets</span><span class=\"p\">(</span><span class=\"mi\">361</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"n\">MSB3073</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">The</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"s\">\"\"</span><span class=\"err\">\\</span><span class=\"n\">tools</span><span class=\"err\">\\\\</span><span class=\"n\">ilc</span><span class=\"s\">\" @\"</span><span class=\"n\">obj</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net9</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">native</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">ilc</span><span class=\"p\">.</span><span class=\"n\">rsp</span><span class=\"s\">\"\"</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">127.</span>\n\n<span class=\"n\">Build</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.6</span><span class=\"n\">s</span>\n</code></pre></div>\n<p>Easy enough... Just need to add <code>&lt;SelfContained&gt;true&lt;/SelfContained&gt;</code> to the <code>PropertyGroup</code>.</p>\n<p>But then I hit this afterwards:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">dotnet</span><span class=\"w\"> </span><span class=\"n\">build</span>\n<span class=\"n\">Restore</span><span class=\"w\"> </span><span class=\"n\">complete</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.3</span><span class=\"n\">s</span><span class=\"p\">)</span>\n<span class=\"n\">You</span><span class=\"w\"> </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">using</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">preview</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"n\">See</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">https</span><span class=\"p\">:</span><span class=\"c1\">//aka.ms/dotnet-support-policy</span>\n<span class=\"w\">  </span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"mf\">0.1</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"err\">→</span><span class=\"w\"> </span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net9</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">dll</span>\n<span class=\"w\">    </span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NETCore</span><span class=\"p\">.</span><span class=\"n\">Native</span><span class=\"p\">.</span><span class=\"n\">targets</span><span class=\"p\">(</span><span class=\"mi\">361</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"n\">MSB3073</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">The</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"s\">\"\"</span><span class=\"err\">\\</span><span class=\"n\">tools</span><span class=\"err\">\\\\</span><span class=\"n\">ilc</span><span class=\"s\">\" @\"</span><span class=\"n\">obj</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net9</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">native</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">ilc</span><span class=\"p\">.</span><span class=\"n\">rsp</span><span class=\"s\">\"\"</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">127.</span>\n\n<span class=\"n\">Build</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">0.6</span><span class=\"n\">s</span>\n</code></pre></div>\n<p>Is there a package missing from the README or a step I'm missing?</p>\n<p>This is from WSL2 FYI. <a href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/45\">https://github.com/bytecodealliance/componentize-dotnet/pull/45</a> was merged 2 weeks ago so I assume this should work on Linux?</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/7168607fa68defa3c75ccd6a63fe8e556ba31fee/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333837636361653532343730373234653263313632656637663830613464393236336663333935613238366263626638613435656534333233663635666664332f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e6574&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet\" title=\"GitHub - bytecodealliance/componentize-dotnet: Tooling for creating WebAssembly components from C#\">GitHub - bytecodealliance/componentize-dotnet: Tooling for creating WebAssembly components from C#</a></div><div class=\"message_embed_description\">Tooling for creating WebAssembly components from C# - bytecodealliance/componentize-dotnet</div></div></div><div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/45\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/22625f54293bd99204e92f395511099f61af93d5/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323139653834303039393664323333386538626230363031643539623534333833323861636430346335383265616132653963306239616630376630383366372f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e65742f70756c6c2f3435&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/45\" title=\"Release new version with linux support by jsturtevant · Pull Request #45 · bytecodealliance/componentize-dotnet\">Release new version with linux support by jsturtevant · Pull Request #45 · bytecodealliance/componentize-dotnet</a></div><div class=\"message_embed_description\">We read every piece of feedback, and take your input very seriously.</div></div></div>",
        "id": 471320412,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726683270
    },
    {
        "content": "<p>We could do with surfacing the underlying error..</p>",
        "id": 471324037,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726684620
    },
    {
        "content": "<p>And yes should work.  adding /bl would get you a binlog which should have the underlying error I hope.</p>",
        "id": 471324655,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726684843
    },
    {
        "content": "<p>Here's the binlog:</p>\n<p><a href=\"/user_uploads/15107/_zt3QLvnPBXlmgzSXfy0yX4Z/msbuild.binlog\">msbuild.binlog</a></p>",
        "id": 471326126,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726685395
    },
    {
        "content": "<p>this looks similiar too <a href=\"https://github.com/dotnet/runtime/issues/106845\">https://github.com/dotnet/runtime/issues/106845</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/dotnet/runtime/issues/106845\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/00eb5ef8bac2acd17070aabbf3c8904e7b8ee593/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f656639333937646633666233393265656332633432623865336165323463393430333562366262393533356161623362633364386530366465313933373264312f646f746e65742f72756e74696d652f6973737565732f313036383435&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/dotnet/runtime/issues/106845\" title=\"wasi project with long path results in error clang linking on Windows · Issue #106845 · dotnet/runtime\">wasi project with long path results in error clang linking on Windows · Issue #106845 · dotnet/runtime</a></div><div class=\"message_embed_description\">Description When creating a wasi mono project following https://github.com/dotnet/runtime/tree/main/src/mono/wasi#prototype-wasi-support in preview 7 if the path the project is installed on is long...</div></div></div>",
        "id": 471331151,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726687120
    },
    {
        "content": "<p>I <em>think</em> i noticed some issues with the latest .net 9 sdk pacakges (like needing <code>&lt;SelfContained&gt;true&lt;/SelfContained&gt;</code>) have you tired with .net 8?</p>",
        "id": 471331490,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726687223
    },
    {
        "content": "<p>we are using <code>9.0.100-preview.4.24267.66</code> in CI where it is passing</p>",
        "id": 471331594,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726687259
    },
    {
        "content": "<p>I have not tried with .NET 8. Let me see if I can install an earlier preview release. I think the BCA blog post from Eric Gregory recommended .NET 9 preview 7. If that fails I'll fall back to .NET 8.</p>\n<p><a href=\"https://bytecodealliance.org/articles/simplifying-components-for-dotnet-developers-with-componentize-dotnet\">https://bytecodealliance.org/articles/simplifying-components-for-dotnet-developers-with-componentize-dotnet</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://bytecodealliance.org/articles/simplifying-components-for-dotnet-developers-with-componentize-dotnet\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/b666ca74a20745aca2566cd241108afdcfa09d04/68747470733a2f2f62797465636f6465616c6c69616e63652e6f72672f696d616765732f6176617461722e706e67&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://bytecodealliance.org/articles/simplifying-components-for-dotnet-developers-with-componentize-dotnet\" title=\"Simplifying components for .NET/C# developers with componentize-dotnet\">Simplifying components for .NET/C# developers with componentize-dotnet</a></div><div class=\"message_embed_description\">If you’re a .NET/C# developer, componentize-dotnet makes it easy to compile your code to WebAssembly components using a single tool. This Bytecode Alliance project is a NuGet package that can be used to create a fully AOT-compiled compon...</div></div></div>",
        "id": 471332190,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726687458
    },
    {
        "content": "<p>yea, I think something changed from preview7 to the RC you are using...</p>",
        "id": 471332388,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726687544
    },
    {
        "content": "<p>also opened <a href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/47\">https://github.com/bytecodealliance/componentize-dotnet/pull/47</a>  to see if run into it CI</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/47\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/0178e5f88d2e99207cbd80441d5850b8f2234ef0/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f383933633734636132393064336636393135653937353932663438366266313837646661613939626661313832643837666465636166373162363136373339302f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e65742f70756c6c2f3437&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet/pull/47\" title=\"Update .net 9 RC by jsturtevant · Pull Request #47 · bytecodealliance/componentize-dotnet\">Update .net 9 RC by jsturtevant · Pull Request #47 · bytecodealliance/componentize-dotnet</a></div><div class=\"message_embed_description\">We read every piece of feedback, and take your input very seriously.</div></div></div>",
        "id": 471333145,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726687777
    },
    {
        "content": "<p>If RC is the problem, it _might_ get fixed with the latest merge, which might break something else :-)</p>",
        "id": 471333358,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726687845
    },
    {
        "content": "<p>looks like RC passed in CI</p>",
        "id": 471333933,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726688060
    },
    {
        "content": "<p>Oddly switching to preview.7 didn't work for me. It does appear to be installing <code>microsoft.dotnet.ilcompiler.llvm/9.0.0-rc.1.24429.1</code> regardless of the SDK version I choose, but that seems normal</p>",
        "id": 471334632,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726688327
    },
    {
        "content": "<p>.NET 8 fails outright:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"o\">/</span><span class=\"n\">sdk</span><span class=\"o\">/</span><span class=\"mf\">8.0.401</span><span class=\"o\">/</span><span class=\"n\">Sdks</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"p\">.</span><span class=\"n\">Sdk</span><span class=\"o\">/</span><span class=\"n\">targets</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"p\">.</span><span class=\"n\">TargetFrameworkInference</span><span class=\"p\">.</span><span class=\"n\">targets</span><span class=\"p\">(</span><span class=\"mi\">166</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"n\">NETSDK1045</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">The</span><span class=\"w\"> </span><span class=\"n\">current</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"n\">SDK</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">targeting</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"mf\">9.0.</span><span class=\"w\">  </span><span class=\"n\">Either</span><span class=\"w\"> </span><span class=\"n\">target</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"mf\">8.0</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">lower</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"n\">SDK</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">supports</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"mf\">9.0.</span><span class=\"w\"> </span><span class=\"n\">Download</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"p\">.</span><span class=\"n\">NET</span><span class=\"w\"> </span><span class=\"n\">SDK</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"c1\">//aka.ms/dotnet/download [/home/bacongobbler/code/hello-wasm/hello-wasm.csproj]</span>\n</code></pre></div>",
        "id": 471335442,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726688618
    },
    {
        "content": "<p>you would need to change your &lt;TargetFramework&gt; in the project your working on</p>",
        "id": 471335757,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726688717
    },
    {
        "content": "<p>Oh right</p>",
        "id": 471335834,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726688743
    },
    {
        "content": "<p>do you have a simple project that reproduces this?</p>",
        "id": 471335960,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726688781
    },
    {
        "content": "<p>Sure! Here it is: <a href=\"https://github.com/bacongobbler/hello-wasm\">https://github.com/bacongobbler/hello-wasm</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bacongobbler/hello-wasm\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/b84d415c0bd0ef8e4b93ff4601eefae9e4a901f7/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643233633363626333653762666633626563386630396261666135353839333436363833386361373533616461613639303638343963303162313565363038342f6261636f6e676f62626c65722f68656c6c6f2d7761736d&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bacongobbler/hello-wasm\" title=\"GitHub - bacongobbler/hello-wasm: example app using componentize-dotnet.\">GitHub - bacongobbler/hello-wasm: example app using componentize-dotnet.</a></div><div class=\"message_embed_description\">example app using componentize-dotnet. Contribute to bacongobbler/hello-wasm development by creating an account on GitHub.</div></div></div>",
        "id": 471336169,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726688868
    },
    {
        "content": "<p>It's just from following the steps in the README + adding the <code>&lt;SelfContained&gt;</code> tag in the PropertyGroup</p>",
        "id": 471336485,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726688981
    },
    {
        "content": "<p>If it helps, it looks like the <code>tools</code> directory in that package doesn't contain <code>ilc</code> for me:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"o\">~/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">tools</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">tools</span>\n<span class=\"err\">└──</span><span class=\"w\"> </span><span class=\"n\">netstandard</span>\n<span class=\"w\">    </span><span class=\"err\">├──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">deps</span><span class=\"p\">.</span><span class=\"n\">json</span>\n<span class=\"w\">    </span><span class=\"err\">├──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">dll</span>\n<span class=\"w\">    </span><span class=\"err\">└──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">pdb</span>\n\n<span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">files</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">uname</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">a</span>\n<span class=\"n\">Linux</span><span class=\"w\"> </span><span class=\"n\">ultralisk</span><span class=\"w\"> </span><span class=\"mf\">5.15.153.1</span><span class=\"o\">-</span><span class=\"n\">microsoft</span><span class=\"o\">-</span><span class=\"n\">standard</span><span class=\"o\">-</span><span class=\"n\">WSL2</span><span class=\"w\"> </span><span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">SMP</span><span class=\"w\"> </span><span class=\"n\">Fri</span><span class=\"w\"> </span><span class=\"n\">Mar</span><span class=\"w\"> </span><span class=\"mi\">29</span><span class=\"w\"> </span><span class=\"mi\">23</span><span class=\"p\">:</span><span class=\"mi\">14</span><span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"n\">UTC</span><span class=\"w\"> </span><span class=\"mi\">2024</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">GNU</span><span class=\"o\">/</span><span class=\"n\">Linux</span>\n</code></pre></div>",
        "id": 471337967,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726689462
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"745985\">Matt Fisher</span> <a href=\"#narrow/stream/407028-C.23.2F.2Enet-collaboration/topic/componentize-dotnet.20on.20linux/near/471337967\">said</a>:</p>\n<blockquote>\n<p>If it helps, it looks like the <code>tools</code> directory in that package doesn't contain <code>ilc</code> for me:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"o\">~/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">tools</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">tools</span>\n<span class=\"err\">└──</span><span class=\"w\"> </span><span class=\"n\">netstandard</span>\n<span class=\"w\">    </span><span class=\"err\">├──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">deps</span><span class=\"p\">.</span><span class=\"n\">json</span>\n<span class=\"w\">    </span><span class=\"err\">├──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">dll</span>\n<span class=\"w\">    </span><span class=\"err\">└──</span><span class=\"w\"> </span><span class=\"n\">ILCompiler</span><span class=\"p\">.</span><span class=\"n\">Build</span><span class=\"p\">.</span><span class=\"n\">Tasks</span><span class=\"p\">.</span><span class=\"n\">pdb</span>\n\n<span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">files</span>\n</code></pre></div>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">uname</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">a</span>\n<span class=\"n\">Linux</span><span class=\"w\"> </span><span class=\"n\">ultralisk</span><span class=\"w\"> </span><span class=\"mf\">5.15.153.1</span><span class=\"o\">-</span><span class=\"n\">microsoft</span><span class=\"o\">-</span><span class=\"n\">standard</span><span class=\"o\">-</span><span class=\"n\">WSL2</span><span class=\"w\"> </span><span class=\"p\">#</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">SMP</span><span class=\"w\"> </span><span class=\"n\">Fri</span><span class=\"w\"> </span><span class=\"n\">Mar</span><span class=\"w\"> </span><span class=\"mi\">29</span><span class=\"w\"> </span><span class=\"mi\">23</span><span class=\"p\">:</span><span class=\"mi\">14</span><span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"w\"> </span><span class=\"n\">UTC</span><span class=\"w\"> </span><span class=\"mi\">2024</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">x86_64</span><span class=\"w\"> </span><span class=\"n\">GNU</span><span class=\"o\">/</span><span class=\"n\">Linux</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>That's normal, ilc is under the <code>runtime...</code> package</p>",
        "id": 471338564,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726689657
    },
    {
        "content": "<p>From the binlog, the path for the ilc tools is not getting set</p>",
        "id": 471338638,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726689693
    },
    {
        "content": "<p>Oh! This is interesting. It looks like it pulled down the win-x64 runtime package.</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">pwd</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span>\n<span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">runtime</span>\n<span class=\"n\">runtime</span><span class=\"p\">.</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span>\n<span class=\"n\">runtime</span><span class=\"p\">.</span><span class=\"n\">win</span><span class=\"o\">-</span><span class=\"n\">x64</span><span class=\"p\">.</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span>\n</code></pre></div>",
        "id": 471338836,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726689761
    },
    {
        "content": "<p>You can manually set it as a property <code>IlcHostPackagePath</code></p>",
        "id": 471338980,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726689824
    },
    {
        "content": "<p>I've seen some tools get confused in WSL when it tries to identify the correct OS.</p>",
        "id": 471338983,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726689825
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"745985\">Matt Fisher</span> <a href=\"#narrow/stream/407028-C.23.2F.2Enet-collaboration/topic/componentize-dotnet.20on.20linux/near/471338836\">said</a>:</p>\n<blockquote>\n<p>Oh! This is interesting. It looks like it pulled down the win-x64 runtime package.</p>\n<p><div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">pwd</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">bacongobbler</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span>\n<span class=\"o\">&gt;&lt;&gt;</span><span class=\"w\"> </span><span class=\"n\">ls</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"n\">runtime</span>\n<span class=\"n\">runtime</span><span class=\"p\">.</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span>\n<span class=\"n\">runtime</span><span class=\"p\">.</span><span class=\"n\">win</span><span class=\"o\">-</span><span class=\"n\">x64</span><span class=\"p\">.</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>yes, that looks wrong</p>",
        "id": 471339059,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726689852
    },
    {
        "content": "<p>FWIW I use the debian WSL distro</p>",
        "id": 471339211,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726689916
    },
    {
        "content": "<p><code>dotnet add package runtime.linux-x64.Microsoft.DotNet.ILCompiler.LLVM --prerelease</code> did the trick.</p>",
        "id": 471339843,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726690167
    },
    {
        "content": "<p>I did produce this on my ubuntu machine that is not wsl</p>",
        "id": 471340023,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726690225
    },
    {
        "content": "<p>Sigh. Yet another reason to switch back to native Ubuntu</p>",
        "id": 471340088,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726690252
    },
    {
        "content": "<p>Thanks everyone.</p>",
        "id": 471340098,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726690255
    },
    {
        "content": "<p>no sorry, I am reproducing the same error</p>",
        "id": 471340189,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726690295
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">sh</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">tmp</span><span class=\"o\">/</span><span class=\"n\">MSBuildTempjstur</span><span class=\"o\">/</span><span class=\"n\">tmpcbd7e4d2750c427b9e4559c9bbdb1689</span><span class=\"p\">.</span><span class=\"n\">exec</span><span class=\"p\">.</span><span class=\"n\">cmd</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"err\">\\</span><span class=\"n\">tools</span><span class=\"err\">\\</span><span class=\"n\">ilc</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">not</span><span class=\"w\"> </span><span class=\"n\">found</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">jstur</span><span class=\"o\">/</span><span class=\"p\">.</span><span class=\"n\">nuget</span><span class=\"o\">/</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">microsoft</span><span class=\"p\">.</span><span class=\"n\">dotnet</span><span class=\"p\">.</span><span class=\"n\">ilcompiler</span><span class=\"p\">.</span><span class=\"n\">llvm</span><span class=\"o\">/</span><span class=\"mf\">9.0.0</span><span class=\"o\">-</span><span class=\"n\">rc</span><span class=\"p\">.</span><span class=\"mf\">1.24429.1</span><span class=\"o\">/</span><span class=\"n\">build</span><span class=\"o\">/</span><span class=\"n\">Microsoft</span><span class=\"p\">.</span><span class=\"n\">NETCore</span><span class=\"p\">.</span><span class=\"n\">Native</span><span class=\"p\">.</span><span class=\"n\">targets</span><span class=\"p\">(</span><span class=\"mi\">361</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">):</span><span class=\"w\"> </span><span class=\"nc\">error</span><span class=\"w\"> </span><span class=\"n\">MSB3073</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">The</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"s\">\"\"</span><span class=\"err\">\\</span><span class=\"n\">tools</span><span class=\"err\">\\\\</span><span class=\"n\">ilc</span><span class=\"s\">\" @\"</span><span class=\"n\">obj</span><span class=\"o\">/</span><span class=\"n\">Debug</span><span class=\"o\">/</span><span class=\"n\">net8</span><span class=\"p\">.</span><span class=\"mi\">0</span><span class=\"o\">/</span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">native</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">ilc</span><span class=\"p\">.</span><span class=\"n\">rsp</span><span class=\"s\">\"\"</span><span class=\"w\"> </span><span class=\"n\">exited</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">127.</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">jstur</span><span class=\"o\">/</span><span class=\"n\">projects</span><span class=\"o\">/</span><span class=\"n\">components</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"o\">/</span><span class=\"n\">hello</span><span class=\"o\">-</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">csproj</span><span class=\"p\">]</span>\n\n<span class=\"n\">Build</span><span class=\"w\"> </span><span class=\"n\">FAILED</span><span class=\"p\">.</span>\n</code></pre></div>",
        "id": 471340215,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726690306
    },
    {
        "content": "<p>looks like <code>9.0.0-rc.1.24468.1</code> is the version that works...</p>",
        "id": 471340974,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726690574
    },
    {
        "content": "<p>what I don't get is why its working in CI...</p>",
        "id": 471341422,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726690767
    },
    {
        "content": "<p>Indeed. That does seem like an odd discrepancy... What is different in CI than what's available locally?</p>\n<p>Is your machine pulling runtime.win-x64 as well, or something else?</p>",
        "id": 471341723,
        "sender_full_name": "Matt Fisher",
        "timestamp": 1726690884
    },
    {
        "content": "<p>hmmm, maybe it has to do with building on Windows/LInux for the final package</p>",
        "id": 471342165,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726691052
    },
    {
        "content": "<p>Same here, it pulls the windows package</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">info</span><span class=\"w\"> </span><span class=\"p\">:</span><span class=\"w\">   </span><span class=\"nc\">GET</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"c1\">//pkgs.dev.azure.com/dnceng/9ee6d478-d288-47f7-aacc-f6e6d082ae6d/_packaging/fe324174-469a-4296-a9cb-1fd885bb6f2b/nuget/v3/flat2/runtime.win-x64.microsoft.dotnet.ilcompiler.llvm/9.0.0-rc.1.24429.1/runtime.win-x64.microsoft.dotnet.ilcompiler.llvm.9.0.0-rc.1.24429.1.nupkg</span>\n</code></pre></div>",
        "id": 471343316,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726691517
    },
    {
        "content": "<p>for <code>\ndotnet add package BytecodeAlliance.Componentize.DotNet.Wasm.SDK --prerelease</code></p>",
        "id": 471343380,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726691531
    },
    {
        "content": "<p>I think since the final package is built on Windows, it's selecting the wrong package to import at that time</p>",
        "id": 471343656,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726691658
    },
    {
        "content": "<p>these lines: <a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/788fa6a3e94947c12b8e325e3008632b3719c74b/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\">https://github.com/bytecodealliance/componentize-dotnet/blob/788fa6a3e94947c12b8e325e3008632b3719c74b/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/788fa6a3e94947c12b8e325e3008632b3719c74b/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/7168607fa68defa3c75ccd6a63fe8e556ba31fee/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333837636361653532343730373234653263313632656637663830613464393236336663333935613238366263626638613435656534333233663635666664332f62797465636f6465616c6c69616e63652f636f6d706f6e656e74697a652d646f746e6574&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/componentize-dotnet/blob/788fa6a3e94947c12b8e325e3008632b3719c74b/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj#L34-L35\" title=\"componentize-dotnet/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj at 788fa6a3e94947c12b8e325e3008632b3719c74b · bytecodealliance/componentize-dotnet\">componentize-dotnet/src/WasmComponent.Sdk/WasmComponent.Sdk.csproj at 788fa6a3e94947c12b8e325e3008632b3719c74b · bytecodealliance/componentize-dotnet</a></div><div class=\"message_embed_description\">Tooling for creating WebAssembly components from C# - bytecodealliance/componentize-dotnet</div></div></div>",
        "id": 471343833,
        "sender_full_name": "James Sturtevant",
        "timestamp": 1726691738
    },
    {
        "content": "<p>Seems like it, as the nuspec has the windows dependency</p>",
        "id": 471344043,
        "sender_full_name": "Scott Waye",
        "timestamp": 1726691824
    }
]