[
    {
        "content": "<p>Hi!</p>\n<p>I'm pretty invested in seeing <a href=\"https://github.com/bytecodealliance/StarlingMonkey/pull/103\">https://github.com/bytecodealliance/StarlingMonkey/pull/103</a> land and in general making it so we can do more StarlingMonkey work directly in Rust. I'm wondering what I can do to support getting this moving forward. My current priority is getting Node.js and WinterTC stuff landed, and I would much rather we build all those bits of new code on top of Rust instead of having to go back later and rewrite everything.</p>\n<p>/cc <span class=\"user-mention\" data-user-id=\"234973\">@Till Schneidereit</span></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/bytecodealliance/StarlingMonkey/pull/103\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/5d1dc2ab6c0b4e65f82d1a77a6099856f0668eec/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333239336133646334363130323033313237626232363264363836666362383030393165343161653136336437313034323433646637663239616565626466392f62797465636f6465616c6c69616e63652f537461726c696e674d6f6e6b65792f70756c6c2f313033&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/bytecodealliance/StarlingMonkey/pull/103\" title=\"Add Rust bindings for the runtime and the SpiderMonkey engines by tschneidereit · Pull Request #103 · bytecodealliance/StarlingMonkey\">Add Rust bindings for the runtime and the SpiderMonkey engines by tschneidereit · Pull Request #103 · bytecodealliance/StarlingMonkey</a></div><div class=\"message_embed_description\">This PR introduces rust-bindgen generated bindings for the StarlingMonkey runtime itself, as well as generated bindings and higher-level abstractions building on those for the SpiderMonkey engine.\n...</div></div></div>",
        "id": 520741109,
        "sender_full_name": "Kat Marchán (they/she)",
        "timestamp": 1748372048
    },
    {
        "content": "<p>Resurrecting this a bit: I was told someone had actually picked this up recently? Is that right?</p>",
        "id": 573835602,
        "sender_full_name": "Kat Marchán (they/she)",
        "timestamp": 1771020608
    },
    {
        "content": "<p>Yup! <span class=\"user-mention\" data-user-id=\"234973\">@Till Schneidereit</span> is working on it :) </p>\n<p>I might be a bit out of date but you can see the work here, under the working name <code>starlingshell</code>:<br>\n<a href=\"https://github.com/tschneidereit/StarlingMonkey/tree/better-rust-builtins/runtime/crates/starlingshell\">https://github.com/tschneidereit/StarlingMonkey/tree/better-rust-builtins/runtime/crates/starlingshell</a></p>\n<p>Till took the time to integrate and reuse a bunch of upstream implementations which has been great, but IIRC at the last JS meeting he was mentioning how there's a lot more to be done, I'm sure he could use a hand!</p>\n<p>(please feel free to correct me Till!)</p>",
        "id": 573848839,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1771030172
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598440\">Victor Adossi</span> <a href=\"#narrow/channel/459697-StarlingMonkey/topic/Rust.20in.20StarlingMonkey.20path.20forward/near/573848839\">said</a>:</p>\n<blockquote>\n<p>Yup! <span class=\"user-mention silent\" data-user-id=\"234973\">Till Schneidereit</span> is working on it :) </p>\n<p>I might be a bit out of date but you can see the work here, under the working name <code>starlingshell</code>:<br>\n<a href=\"https://github.com/tschneidereit/StarlingMonkey/tree/better-rust-builtins/runtime/crates/starlingshell\">https://github.com/tschneidereit/StarlingMonkey/tree/better-rust-builtins/runtime/crates/starlingshell</a></p>\n<p>Till took the time to integrate and reuse a bunch of upstream implementations which has been great, but IIRC at the last JS meeting he was mentioning how there's a lot more to be done, I'm sure he could use a hand!</p>\n<p>(please feel free to correct me Till!)</p>\n</blockquote>\n<p>Hey, this would be great to get <span class=\"user-mention\" data-user-id=\"431061\">@Kat Marchán (they/she)</span> 's help, and <span class=\"user-mention\" data-user-id=\"763150\">@Tomasz Andrzejak</span> as I understand it is also available to make this work.</p>",
        "id": 574255518,
        "sender_full_name": "Ralph",
        "timestamp": 1771323141
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"234973\">@Till Schneidereit</span> is there a way to break this work up and have all three be productive in parallel? From what i understand, this would be the BOMB to make work properly and would advance quite a bit in several dimensions......</p>",
        "id": 574255688,
        "sender_full_name": "Ralph",
        "timestamp": 1771323197
    },
    {
        "content": "<p>I'm happy to find ways to help as long as I'm not stepping on toes or duplicating work.</p>",
        "id": 574384240,
        "sender_full_name": "Kat Marchán (they/she)",
        "timestamp": 1771362151
    },
    {
        "content": "<p>hey all, I'm very sorry for not giving an update on this in such a long time!</p>\n<p>The tl;dr of the current situation is that I took on more than I should've in trying to port much of Servo to WASI without threads at the same time as trying to understand WASIp3 async, and at some point got too lost to make meaningful progress anymore.</p>\n<p>The idea still seems right to me: instead of reinventing much of what Servo had to invent for good JS bindings support, we'd reuse theirs—and in the process get access to their implementation of many/most of the builtins relevant to WinterTC compatibility. And I think we can still get there—but we can't block progress on, well, anything on it further.</p>\n<p>So, I sort of hit reset on this a couple of weeks ago by asking <span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> to look into the WASIp3 part along with a replacement for ComponentizeJS to support custom WIT interfaces. This work to some degree naturally introduces some amount of Rust support, because it depends on <a href=\"https://docs.rs/wit-dylib/latest/wit_dylib/\">wit-dylib</a>.</p>\n<p>In parallel to this, I'm working on porting the WIT bindings the current C++ implementation relies on to Rust as step one of then porting them from WASIp2 to WASIp3. In doing so, I'm doing the minimal amount of work needed to support both the existing C++ builtins as well as new Rust builtins. We can then iterate on providing better abstractions for writing Rust builtins, but will have the basis for starting to write any at all</p>",
        "id": 574544703,
        "sender_full_name": "Till Schneidereit",
        "timestamp": 1771430467
    },
    {
        "content": "<p>oh, and based on all this I'll return to integrating Servo builtins, with the goal of ultimately replacing the C++ builtins we currently have entirely. But that can be a gradual process, instead of the all-at-once one I took before</p>",
        "id": 574544972,
        "sender_full_name": "Till Schneidereit",
        "timestamp": 1771430537
    },
    {
        "content": "<p>This is what I've done so far: <a href=\"https://github.com/dicej/componentize-js\">https://github.com/dicej/componentize-js</a>.  One test passes <span aria-label=\"partying face\" class=\"emoji emoji-1f973\" role=\"img\" title=\"partying face\">:partying_face:</span> <br>\nI had to pause that work temporarily last week to work on a few more urgent things, but hope to come back to it by the end of this week.  I don't know that it will benefit from more people working on it quite yet, but I expect that will change after a couple of weeks of focused work.</p>",
        "id": 574548763,
        "sender_full_name": "Joel Dice",
        "timestamp": 1771431461
    },
    {
        "content": "<p>as we have plenty of interest, when <span class=\"user-mention\" data-user-id=\"509936\">@Joel Dice</span> you find a thing to fork off for someone else, do ping!!!! And thanks a ton Till, for all the hard work -- it teaches everyone.</p>",
        "id": 574780038,
        "sender_full_name": "Ralph",
        "timestamp": 1771520917
    },
    {
        "content": "<p>I'm getting closer to that point: I have a version of StarlingMonkey working locally that passes the test suite using WASIp3. There are some bugs around concurrent reuse to be worked out and lots of cleanup to be done, but it's progressing well. That port is using Rust for the WIT bindings, instead of going through wit-bindgen's C backend, as described before.</p>\n<p>Once that fully works, I'll port the core of the current runtime over to Rust (which is a smaller task than it'd seem), while still supporting the current C++ builtins.</p>\n<p>And then, I'll provide a recipe for creating new Rust builtins with reasonable abstractions—at which point I think we should be in good shape for others to start writing builtins.</p>",
        "id": 574921268,
        "sender_full_name": "Till Schneidereit",
        "timestamp": 1771587577
    },
    {
        "content": "<p>I'll provide another update on all this early next week</p>",
        "id": 574921288,
        "sender_full_name": "Till Schneidereit",
        "timestamp": 1771587587
    }
]