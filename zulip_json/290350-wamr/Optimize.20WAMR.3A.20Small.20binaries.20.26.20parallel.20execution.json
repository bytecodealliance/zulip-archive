[
    {
        "content": "<p>I'm currently trying to use WAMR in a heavily parallelized application. I have benchmarks running for this application that shows that WAMR is hitting 86% of my native speed in a single thread but that performance drops off significantly with multiple threads.</p>\n<p>I'm looking for advice from WAMR experts on how to build and use WAMR most effectively given my environment.</p>\n<p>To clarify, I am running as many small WebAssembly modules as possible looking to optimize for time rather than space.</p>\n<p>I'm currently building with fast_jit and without hardware bounds checks.</p>",
        "id": 518096635,
        "sender_full_name": "Steve",
        "timestamp": 1747236310
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"o\">------------------------------------------------------------------------------------------------------------------------------------------</span>\n<span class=\"n\">Benchmark</span><span class=\"w\">                                                                                </span><span class=\"n\">Time</span><span class=\"w\">             </span><span class=\"n\">CPU</span><span class=\"w\">   </span><span class=\"n\">Iterations</span><span class=\"w\"> </span><span class=\"n\">UserCounters</span><span class=\"o\">..</span><span class=\"p\">.</span>\n<span class=\"o\">------------------------------------------------------------------------------------------------------------------------------------------</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"w\">          </span><span class=\"mi\">47160</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">46890</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">148459</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">47.1604</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">21.2042</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"w\">          </span><span class=\"mi\">52020</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">49768</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">134234</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">26.0102</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">38.4465</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">4</span><span class=\"w\">          </span><span class=\"mi\">64209</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">57525</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">111384</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">16.0522</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">62.2969</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">8</span><span class=\"w\">         </span><span class=\"mi\">102226</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">83479</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">74656</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">12.7782</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">78.2583</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">16</span><span class=\"w\">        </span><span class=\"mi\">225669</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">156788</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">32352</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">14.1043</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">70.9003</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">32</span><span class=\"w\">        </span><span class=\"mi\">507825</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">141228</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">12896</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">15.8695</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">63.0139</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">64</span><span class=\"w\">        </span><span class=\"mi\">896231</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">154784</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">8448</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">14.0036</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">71.4102</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">128</span><span class=\"w\">      </span><span class=\"mi\">1613972</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">158502</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">4224</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">12.6092</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">79.3074</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">256</span><span class=\"w\">      </span><span class=\"mi\">2915854</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">157127</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">3328</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">11.3901</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">87.7959</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">512</span><span class=\"w\">      </span><span class=\"mi\">6507146</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">183015</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">1536</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">12.7093</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">78.6827</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">1024</span><span class=\"w\">     </span><span class=\"mi\">8599593</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">202500</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">1024</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">8.39804</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">119.075</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">2048</span><span class=\"w\">    </span><span class=\"mi\">24181246</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">233584</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">2048</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">11.8072</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">84.6937</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">4096</span><span class=\"w\">    </span><span class=\"mi\">37847957</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">211060</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">9.24022</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">108.222</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">8192</span><span class=\"w\">    </span><span class=\"mi\">72479376</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">206789</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">8192</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">8.84758</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">113.025</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">token_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">16384</span><span class=\"w\">  </span><span class=\"mi\">142267166</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">208227</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">16384</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">8.6833</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">115.164</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">1</span><span class=\"w\">           </span><span class=\"mi\">42141</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">42085</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">164714</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">42.141</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">23.7299</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"w\">           </span><span class=\"mi\">42439</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">42378</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">165524</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">21.2197</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">47.1261</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">4</span><span class=\"w\">           </span><span class=\"mi\">45792</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">45711</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">150484</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">11.448</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">87.3519</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">8</span><span class=\"w\">           </span><span class=\"mi\">56366</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">56271</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">124280</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">7.04573</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">141.93</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">16</span><span class=\"w\">          </span><span class=\"mi\">83458</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">83232</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">85280</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">5.2161</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">191.714</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">32</span><span class=\"w\">         </span><span class=\"mi\">151053</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">106136</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">41632</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">4.72042</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">211.846</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">64</span><span class=\"w\">         </span><span class=\"mi\">249221</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">114625</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">41408</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">3.89408</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">256.8</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">128</span><span class=\"w\">        </span><span class=\"mi\">457146</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">113368</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">15232</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">3.57146</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">279.998</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">256</span><span class=\"w\">        </span><span class=\"mi\">799427</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">108666</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">9216</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">3.12276</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">320.229</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">512</span><span class=\"w\">       </span><span class=\"mi\">1670683</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">110192</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">3072</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">3.26305</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">306.461</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">1024</span><span class=\"w\">      </span><span class=\"mi\">3584987</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">113055</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">2048</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">3.50096</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">285.636</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">2048</span><span class=\"w\">      </span><span class=\"mi\">9674782</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">127742</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">2048</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">4.72401</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">211.684</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">4096</span><span class=\"w\">     </span><span class=\"mi\">19895501</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">141395</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">4096</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">4.8573</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">205.876</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">8192</span><span class=\"w\">     </span><span class=\"mi\">38847796</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">136568</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">         </span><span class=\"mi\">8192</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">4.74216</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">210.874</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n<span class=\"n\">coin_transactions</span><span class=\"o\">/</span><span class=\"n\">min_time</span><span class=\"p\">:</span><span class=\"mf\">5.000</span><span class=\"o\">/</span><span class=\"n\">min_warmup_time</span><span class=\"p\">:</span><span class=\"mf\">1.000</span><span class=\"o\">/</span><span class=\"n\">real_time</span><span class=\"o\">/</span><span class=\"n\">threads</span><span class=\"p\">:</span><span class=\"mi\">16384</span><span class=\"w\">    </span><span class=\"mi\">79561378</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">       </span><span class=\"mi\">134940</span><span class=\"w\"> </span><span class=\"n\">ns</span><span class=\"w\">        </span><span class=\"mi\">16384</span><span class=\"w\"> </span><span class=\"n\">transaction_time</span><span class=\"o\">=</span><span class=\"mf\">4.85604</span><span class=\"n\">us</span><span class=\"w\"> </span><span class=\"n\">transactions</span><span class=\"o\">=</span><span class=\"mf\">205.929</span><span class=\"n\">k</span><span class=\"o\">/</span><span class=\"n\">s</span>\n</code></pre></div>",
        "id": 518096822,
        "sender_full_name": "Steve",
        "timestamp": 1747236356
    },
    {
        "content": "<p>As you can see here, 21.2042k/s on WASM and 23.7299k/s natively. These numbers are really respectable. However as the threads increase native tops out at 320.223k/s while WAMR tops out at 119.075k/s.</p>\n<p>Token = WASM<br>\nCoin = Native</p>",
        "id": 518097235,
        "sender_full_name": "Steve",
        "timestamp": 1747236454
    },
    {
        "content": "<p>I am not sure if my advice will fit your cases until I learn more details. Here are some common suggestions:</p>\n<ul>\n<li>Usually, llvm-jit and aot are better choices than fast-jit. You might want to give them a try if you haven't already.</li>\n<li>WAMR was used in Envoy as one of the wasm runtimes to execute wasm plugins for filtering incoming messages. You might also want to refer to it: <a href=\"https://github.com/proxy-wasm/proxy-wasm-cpp-host/blob/main/src/wamr/wamr.cc\">https://github.com/proxy-wasm/proxy-wasm-cpp-host/blob/main/src/wamr/wamr.cc</a></li>\n<li>Software bounds checking is also a slow operation.</li>\n</ul>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/proxy-wasm/proxy-wasm-cpp-host/blob/main/src/wamr/wamr.cc\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/554f2c4e600d902793338ea0554e8beac5525c12/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f396431303062616462356561353663363639326532383433613230303962383532323263313265376236356461656366373138653034313237656264646130372f70726f78792d7761736d2f70726f78792d7761736d2d6370702d686f7374&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/proxy-wasm/proxy-wasm-cpp-host/blob/main/src/wamr/wamr.cc\" title=\"proxy-wasm-cpp-host/src/wamr/wamr.cc at main · proxy-wasm/proxy-wasm-cpp-host\">proxy-wasm-cpp-host/src/wamr/wamr.cc at main · proxy-wasm/proxy-wasm-cpp-host</a></div><div class=\"message_embed_description\">WebAssembly for Proxies (C++ host implementation). Contribute to proxy-wasm/proxy-wasm-cpp-host development by creating an account on GitHub.</div></div></div>",
        "id": 520341661,
        "sender_full_name": "lum1n0us",
        "timestamp": 1748222043
    },
    {
        "content": "<p>It seems like there hasn't been any activity on this issue for a while. If you have any further questions or updates, please feel free to share them with us.</p>\n<p>To keep our project organized, we plan to close this issue soon if there are no new developments. Of course, you can always reopen it or start a new thread if needed.</p>\n<p>Thank you for your understanding and cooperation!</p>",
        "id": 525240800,
        "sender_full_name": "lum1n0us",
        "timestamp": 1750637437
    }
]