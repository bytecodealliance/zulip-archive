[
    {
        "content": "<p>Hey, how do I get jco to work with wasip3 ?</p>\n<p>I just checked out jco:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"c1\">//github.com/bytecodealliance/jco</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">jco</span>\n<span class=\"n\">npm</span><span class=\"w\"> </span><span class=\"n\">install</span><span class=\"w\"> </span><span class=\"n\">typescript</span>\n<span class=\"n\">npm</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"n\">build</span>\n</code></pre></div>\n<p>Then from another dir I am trying:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">npx</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">prefix</span><span class=\"o\">=~/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">wasip3</span><span class=\"o\">/</span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"err\">\\</span>\n<span class=\"w\">  </span><span class=\"n\">wasi</span><span class=\"o\">-</span><span class=\"n\">testsuite</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">rust</span><span class=\"o\">/</span><span class=\"n\">testsuite</span><span class=\"o\">/</span><span class=\"n\">wasm32</span><span class=\"o\">-</span><span class=\"n\">wasip3</span><span class=\"o\">/</span><span class=\"n\">multi</span><span class=\"o\">-</span><span class=\"n\">clock</span><span class=\"o\">-</span><span class=\"n\">wait</span><span class=\"p\">.</span><span class=\"n\">wasm</span>\n</code></pre></div>\n<p>You can get that file here: <a href=\"https://github.com/WebAssembly/wasi-testsuite/blob/prod/testsuite-base/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm\">https://github.com/WebAssembly/wasi-testsuite/blob/prod/testsuite-base/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm</a></p>\n<p>Anyway, the result is a backtrace:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">thread</span><span class=\"w\"> </span><span class=\"o\">'&lt;</span><span class=\"n\">unnamed</span><span class=\"o\">&gt;'</span><span class=\"w\"> </span><span class=\"n\">panicked</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"o\">/</span><span class=\"n\">js</span><span class=\"o\">-</span><span class=\"n\">component</span><span class=\"o\">-</span><span class=\"n\">bindgen</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">transpile_bindgen</span><span class=\"p\">.</span><span class=\"n\">rs</span><span class=\"p\">:</span><span class=\"mi\">2388</span><span class=\"p\">:</span><span class=\"mi\">17</span><span class=\"p\">:</span>\n<span class=\"nc\">not</span><span class=\"w\"> </span><span class=\"n\">yet</span><span class=\"w\"> </span><span class=\"n\">implemented</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">lower_import</span><span class=\"p\">()]</span><span class=\"w\"> </span><span class=\"n\">FunctionKind</span><span class=\"p\">::</span><span class=\"n\">AsyncFreeStanding</span>\n<span class=\"n\">note</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">run</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">RUST_BACKTRACE</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">environment</span><span class=\"w\"> </span><span class=\"n\">variable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">display</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">backtrace</span>\n<span class=\"p\">(</span><span class=\"n\">jco</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">Error</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">Unable</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">transpile</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">execution</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">runComponent</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///home/wingo/src/wasip3/jco/packages/jco/src/cmd/run.js:101:19)</span>\n<span class=\"w\">    </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"k\">async</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"p\">:</span><span class=\"sd\">///home/wingo/src/wasip3/jco/packages/jco/src/jco.js:485:17 {</span>\n<span class=\"w\">  </span><span class=\"p\">[</span><span class=\"n\">cause</span><span class=\"p\">]:</span><span class=\"w\"> </span><span class=\"nc\">RuntimeError</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"nc\">unreachable</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">abort</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66816]:0x16cdd59)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_ZN3std3sys3pal4wasi7helpers14abort_internal17ha5c7c7f137dfd2a7E</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66680]:0x16c1e45)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_ZN3std7process5abort17h1f0c5bda232b5244E</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66617]:0x16bc5df)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_RNvCsj4CZ6flxxfE_7___rustc12___rust_abort</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66616]:0x16bc5d5)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_RNvCsj4CZ6flxxfE_7___rustc18___rust_start_panic</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66567]:0x16bb105)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_RNvCsj4CZ6flxxfE_7___rustc10rust_panic</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66713]:0x16c376d)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_ZN3std9panicking20rust_panic_with_hook17h0680752b21c39de3E</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66709]:0x16c3634)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_ZN3std9panicking19begin_panic_handler28_</span><span class=\"cp\">$u7b$$u7b$closure$u7d$$u7d$</span><span class=\"mi\">17</span><span class=\"n\">hd0cc751148985cc7E</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66689]:0x16c2462)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_ZN3std3sys9backtrace26__rust_end_short_backtrace17h8dfda85cca241a2aE</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66688]:0x16c239c)</span>\n<span class=\"w\">      </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">js_component_bindgen_component</span><span class=\"p\">.</span><span class=\"n\">wasm</span><span class=\"p\">.</span><span class=\"n\">_RNvCsj4CZ6flxxfE_7___rustc17rust_begin_unwind</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">wasm</span><span class=\"p\">:</span><span class=\"c1\">//wasm/js_component_bindgen_component.wasm-2157550e:wasm-function[66701]:0x16c301b)</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Any ideas?  <span class=\"user-mention\" data-user-id=\"598440\">@Victor Adossi</span> are you the jco wizard? :)</p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/WebAssembly/wasi-testsuite/blob/prod/testsuite-base/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/e31b1d9b492d1cb76966ee933549dfa70f90a67b/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663466643437663764373337373937643339653261613633653838383530323866646538316565343739363430666261323136313661363433336632323236652f576562417373656d626c792f776173692d746573747375697465&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/WebAssembly/wasi-testsuite/blob/prod/testsuite-base/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm\" title=\"wasi-testsuite/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm at prod/testsuite-base · WebAssembly/wasi-testsuite\">wasi-testsuite/tests/rust/testsuite/wasm32-wasip3/multi-clock-wait.wasm at prod/testsuite-base · WebAssembly/wasi-testsuite</a></div><div class=\"message_embed_description\">WASI Testsuite. Contribute to WebAssembly/wasi-testsuite development by creating an account on GitHub.</div></div></div>",
        "id": 541414999,
        "sender_full_name": "Andy Wingo",
        "timestamp": 1758793577
    },
    {
        "content": "<p>Hey so unfortunately Jco is not yet ready for use with P3 eyt! I'm working on it <span aria-label=\"bow\" class=\"emoji emoji-1f647\" role=\"img\" title=\"bow\">:bow:</span></p>",
        "id": 541428244,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1758797847
    },
    {
        "content": "<p>we have some components that work right now, but not all the functionality is implemented just yet</p>\n<blockquote>\n<p><code>not yet implemented: [lower_import()] FunctionKind::AsyncFreeStanding</code></p>\n</blockquote>\n<p>Yeah that bit right there</p>",
        "id": 541428381,
        "sender_full_name": "Victor Adossi",
        "timestamp": 1758797883
    }
]