[
    {
        "content": "<p>Hi, I wonder if there's any docs about adding/removing members from enum/variant break binary compatibility? And if so, what's the best/safe way to change an existing enum?</p>",
        "id": 558270340,
        "sender_full_name": "anb",
        "timestamp": 1763574973
    },
    {
        "content": "<p>I don't think there is any kind of variant subtyping currently implemented in the component model, so any changes to variant cases would be backward-incompatible. The only \"safe\" ways to migrate would be to create a new variant that is only used by new functions or by updating the package version to indicate the backward-incompatibility.</p>",
        "id": 558275137,
        "sender_full_name": "Lann Martin",
        "timestamp": 1763576583
    },
    {
        "content": "<p>Thanks Lann, how about enum? Is it backed by integers? Any way to safely change it without breaking anything?</p>",
        "id": 558279615,
        "sender_full_name": "anb",
        "timestamp": 1763578058
    },
    {
        "content": "<p>Same for enums and all other value types. The ABI does indeed use integers but components have self-describing interfaces that include most of what is specified in WIT; see the spec here: <a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/Binary.md#type-definitions\">https://github.com/WebAssembly/component-model/blob/main/design/mvp/Binary.md#type-definitions</a></p>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/Binary.md#type-definitions\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/0206aaa5aa2025def503a8bbaafc25eac922a37d/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f313236363438653932343539396634376264343935666564316636393034366365303433343139653461616265643661303137373165666530333331316531342f576562417373656d626c792f636f6d706f6e656e742d6d6f64656c&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://github.com/WebAssembly/component-model/blob/main/design/mvp/Binary.md#type-definitions\" title=\"component-model/design/mvp/Binary.md at main Â· WebAssembly/component-model\">component-model/design/mvp/Binary.md at main Â· WebAssembly/component-model</a></div><div class=\"message_embed_description\">Repository for design and specification of the Component Model - WebAssembly/component-model</div></div></div>",
        "id": 558280886,
        "sender_full_name": "Lann Martin",
        "timestamp": 1763578509
    },
    {
        "content": "<p>In the specific case of <code>enum</code> you can see that the binary type information includes <code>&lt;label&gt;</code> strings.</p>",
        "id": 558281300,
        "sender_full_name": "Lann Martin",
        "timestamp": 1763578625
    },
    {
        "content": "<p>That feels like a pain :-/</p>",
        "id": 558286205,
        "sender_full_name": "anb",
        "timestamp": 1763580453
    },
    {
        "content": "<p>There was a rough outline of subtyping prior to the 0.2 release but it was removed. You can see some discussion of why here: <a href=\"#narrow/channel/219900-wasi/topic/.60.40since.60.20gates.20on.20variant.20and.20enum.20members.3F/near/441081505\">#wasi &gt; &#96;@since&#96; gates on variant and enum members? @ ðŸ’¬</a></p>",
        "id": 558302820,
        "sender_full_name": "Lann Martin",
        "timestamp": 1763586390
    }
]