<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11782 c-api: Fix CMakeLists to work proper... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html">wasmtime / PR #11782 c-api: Fix CMakeLists to work proper...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="542823680"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542823680" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542823680">(Oct 02 2025 at 20:13)</a>:</h4>
<p>josephg opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a> from <code>josephg:main</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>The <code>WASMTIME_TARGET</code> check in cmake looks to see if the .dylib path is used. This is used on all apple platforms - including macos ("darwin"), ios and visionos and so on.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">print</span><span class="w"> </span><span class="n">target</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">apple</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">darwin</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span><span class="o">-</span><span class="n">macabi</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">tvos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">tvos</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">visionos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">visionos</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">watchos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">watchos</span><span class="o">-</span><span class="n">sim</span>
<span class="o">..</span><span class="p">.</span>
</code></pre></div>
<p>The test currently only checks for <code>darwin</code>, so it only works correctly on macos.</p>
<p>This change fixes the test to support all apple platforms.</p>
</blockquote>



<a name="542823681"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542823681" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542823681">(Oct 02 2025 at 20:13)</a>:</h4>
<p><strong>josephg</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>.</p>



<a name="542823682"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542823682" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542823682">(Oct 02 2025 at 20:13)</a>:</h4>
<p><strong>josephg</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>.</p>



<a name="542823771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542823771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542823771">(Oct 02 2025 at 20:14)</a>:</h4>
<p>josephg edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>:</p>
<blockquote>
<p>The <code>WASMTIME_TARGET</code> check in cmake looks to see if the .dylib path is used. This is used on all apple platforms - including macos ("darwin"), ios and visionos and so on.</p>
<p>Fixes #11759</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">print</span><span class="w"> </span><span class="n">target</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">apple</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">darwin</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span><span class="o">-</span><span class="n">macabi</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">ios</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">tvos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">tvos</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">visionos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">visionos</span><span class="o">-</span><span class="n">sim</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">watchos</span>
<span class="n">aarch64</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">watchos</span><span class="o">-</span><span class="n">sim</span>
<span class="o">..</span><span class="p">.</span>
</code></pre></div>
<p>The test currently only checks for <code>darwin</code>, so it only works correctly on macos.</p>
<p>This change fixes the test to support all apple platforms.</p>
</blockquote>



<a name="542828408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542828408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542828408">(Oct 02 2025 at 20:45)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11782#issuecomment-3362944333">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>:</p>
<blockquote>
<p>Thanks! There's a few other places in this CMakeLists.txt file that mention "darwin" too, should those change to "apple" as well?</p>
</blockquote>



<a name="542857817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542857817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542857817">(Oct 03 2025 at 02:19)</a>:</h4>
<p>josephg <a href="https://github.com/bytecodealliance/wasmtime/pull/11782#issuecomment-3363908689">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>:</p>
<blockquote>
<p>I think so. Essentially Darwin = macOS and Apple includes all other Apple platforms. But at a glance, I’m not sure how necessary those other configuration changes are on other Apple platforms.</p>
<p>But I doubt anyone is currently building Wasmtime for any other Apple platforms at the moment either. There’s also a bug right now building wasmtime with default features on iOS because of a bug in zstd, which is used for the cache feature.</p>
<p>Unfortunately I can’t test it more at the moment because I’m about to get on a cruise ship for a few weeks of vacation. I’d be happy to merge this PR as is. Or if you feel like it, change all of them to <code>apple</code> and we can tweak as needed once I have time to do some more test builds. I think that’s the right choice, I just can’t test it for the next few weeks. When I get back I want to put together an example app integrating wasmtime into a native Swift app - and that’ll shake out any other problems.</p>
</blockquote>



<a name="542975768"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542975768" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542975768">(Oct 03 2025 at 15:51)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11782#pullrequestreview-3299682719">PR review</a>:</p>
<blockquote>
<p>Ok sounds reasonable! I'll send a follow-up and if you can test when you get back that'd be much appreciated!</p>
</blockquote>



<a name="542980203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311782%20c-api%3A%20Fix%20CMakeLists%20to%20work%20proper.../near/542980203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311782.20c-api.3A.20Fix.20CMakeLists.20to.20work.20proper.2E.2E.2E.html#542980203">(Oct 03 2025 at 16:13)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11782">PR #11782</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>