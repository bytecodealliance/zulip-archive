<html>
<head><meta charset="utf-8"><title>wasmtime / issue #11520 Unlike the exit code of other run... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html">wasmtime / issue #11520 Unlike the exit code of other run...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="535895095"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/535895095" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#535895095">(Aug 24 2025 at 10:48)</a>:</h4>
<p>gaaraw opened <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<h3>Phenomenon description</h3>
<p>Hello, when I use multiple runtime tools in the terminal, I notice different behavior for the same wasm program. The specific performance is as follows:</p>
<p><strong>wasmtime:</strong><br>
Output：</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">work</span><span class="p">.</span><span class="n">wasm</span><span class="err">`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">default</span>
<span class="w">    </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nc">error</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">backtrace</span><span class="p">:</span>
<span class="w">           </span><span class="mi">0</span><span class="p">:</span><span class="w">     </span><span class="mh">0xd8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;!&lt;</span><span class="n">wasm</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="mi">4</span><span class="o">&gt;</span>
<span class="w">           </span><span class="mi">1</span><span class="p">:</span><span class="w">     </span><span class="mh">0xb6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;!&lt;</span><span class="n">wasm</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="mi">3</span><span class="o">&gt;</span>
<span class="w">    </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="nc">Pointer</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">aligned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="nc">Region</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">start</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>exit code: 1</p>
<p><strong>wasmer / wasmedge / wamr:</strong><br>
No output<br>
exit code: 0</p>
<h3>Test Case</h3>
<p><a href="https://github.com/user-attachments/files/21956524/test_case.zip">test_case.zip</a></p>
<h3>Steps to Reproduce</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">file</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmtime</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmer</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmedge</span><span class="w"> </span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">jit</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">iwasm</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>The runtime tools are all built on release and use JIT mode.</p>
<ul>
<li>wasmtime: 35.0.0 (9c2e6f17c 2025-06-17)</li>
<li>wasmer: 6.0.1</li>
<li>wasmedge: 0.14.1</li>
<li>WAMR: iwasm 2.4.0</li>
<li>Host OS: Ubuntu 22.04.5 LTS x64</li>
<li>CPU: 11th Gen Intel® Core™ i7-11700 @ 2.50GHz × 16</li>
</ul>
<h3>Extra Info</h3>
<p>If you need any other relevant information, please let me know and I will do my best to provide it. Looking forward to your reply! Thank you!</p>
</blockquote>



<a name="535895161"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/535895161" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#535895161">(Aug 24 2025 at 10:50)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/11520#issuecomment-3218013558">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<p>Wasmer, wasmedge and wamr are probably just more lenient around unaligned pointers. Wasmtime does check that pointers passed to wasi that should be aligned are actually aligned.</p>
</blockquote>



<a name="535895809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/535895809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#535895809">(Aug 24 2025 at 11:08)</a>:</h4>
<p>gaaraw <a href="https://github.com/bytecodealliance/wasmtime/issues/11520#issuecomment-3218023741">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<p>So the reason is that other runtime tools don't strictly do alignment checks. Is this kind of leniency of them allowed?</p>
</blockquote>



<a name="535895936"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/535895936" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#535895936">(Aug 24 2025 at 11:11)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/11520#issuecomment-3218025719">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<p>wasip1 doesn't have a good specification, so whether or not it is allowed to not check for alignment is kind of undefined I think.</p>
</blockquote>



<a name="536036449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/536036449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#536036449">(Aug 25 2025 at 14:22)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<h3>Phenomenon description</h3>
<p>Hello, when I use multiple runtime tools in the terminal, I notice different behavior for the same wasm program. The specific performance is as follows:</p>
<p><strong>wasmtime:</strong><br>
Output：</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">work</span><span class="p">.</span><span class="n">wasm</span><span class="err">`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">default</span>
<span class="w">    </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="nc">error</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">backtrace</span><span class="p">:</span>
<span class="w">           </span><span class="mi">0</span><span class="p">:</span><span class="w">     </span><span class="mh">0xd8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;!&lt;</span><span class="n">wasm</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="mi">4</span><span class="o">&gt;</span>
<span class="w">           </span><span class="mi">1</span><span class="p">:</span><span class="w">     </span><span class="mh">0xb6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;!&lt;</span><span class="n">wasm</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="mi">3</span><span class="o">&gt;</span>
<span class="w">    </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="nc">Pointer</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">aligned</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="nc">Region</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">start</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>exit code: 1</p>
<p><strong>wasmer / wasmedge / wamr:</strong><br>
No output<br>
exit code: 0</p>
<h3>Test Case</h3>
<p><a href="https://github.com/user-attachments/files/21956524/test_case.zip">test_case.zip</a></p>
<h3>Steps to Reproduce</h3>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">file</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmtime</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmer</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">wasmedge</span><span class="w"> </span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">jit</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
<span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">iwasm</span><span class="w"> </span><span class="n">test_case</span><span class="p">.</span><span class="n">wasm</span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>The runtime tools are all built on release and use JIT mode.</p>
<ul>
<li>wasmtime: 35.0.0 (9c2e6f17c 2025-06-17)</li>
<li>wasmer: 6.0.1</li>
<li>wasmedge: 0.14.1</li>
<li>WAMR: iwasm 2.4.0</li>
<li>Host OS: Ubuntu 22.04.5 LTS x64</li>
<li>CPU: 11th Gen Intel® Core™ i7-11700 @ 2.50GHz × 16</li>
</ul>
<h3>Extra Info</h3>
<p>If you need any other relevant information, please let me know and I will do my best to provide it. Looking forward to your reply! Thank you!</p>
</blockquote>



<a name="536036452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311520%20Unlike%20the%20exit%20code%20of%20other%20run.../near/536036452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311520.20Unlike.20the.20exit.20code.20of.20other.20run.2E.2E.2E.html#536036452">(Aug 25 2025 at 14:22)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11520#issuecomment-3220507334">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11520">issue #11520</a>:</p>
<blockquote>
<p>Yes as @bjorn3 mentioned this is expected behavior. If you're fuzzing WASIp1 we recommend <a href="https://docs.wasmtime.dev/contributing-fuzzing.html#divergent-webassembly-behavior-across-runtimes">not doing so</a></p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>