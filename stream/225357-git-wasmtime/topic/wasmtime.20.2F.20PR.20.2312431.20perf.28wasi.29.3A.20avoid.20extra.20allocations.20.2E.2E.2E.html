<html>
<head><meta charset="utf-8"><title>wasmtime / PR #12431 perf(wasi): avoid extra allocations ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html">wasmtime / PR #12431 perf(wasi): avoid extra allocations ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="570027195"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570027195" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570027195">(Jan 26 2026 at 07:55)</a>:</h4>
<p>MoNyAvA opened <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431</a> from <code>MoNyAvA:perf/wasi-inherit-env-args</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p><code>WasiCtxBuilder::inherit_env</code> and <code>inherit_args</code> were doing redundant work: they first collected <code>std::env::vars()</code> / <code>std::env::args()</code> into a <code>Vec</code>, and then <code>envs/args</code> cloned every string again via <code>to_owned().</code> This caused two allocations per environment variable or argument plus an extra temporary vector, without any semantic benefit<br>
</p>
</blockquote>



<a name="570027197"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570027197" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570027197">(Jan 26 2026 at 07:55)</a>:</h4>
<p><strong>MoNyAvA</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-wasi-reviewers">wasmtime-wasi-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431</a>.</p>



<a name="570027216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570027216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570027216">(Jan 26 2026 at 07:55)</a>:</h4>
<p>MoNyAvA edited <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431</a>:</p>
<blockquote>
<p><code>WasiCtxBuilder::inherit_env</code> and <code>inherit_args</code> were doing redundant work: they first collected <code>std::env::vars()</code> / <code>std::env::args()</code> into a <code>Vec</code>, and then <code>envs/args</code> cloned every string again via <code>to_owned().</code> This caused two allocations per environment variable or argument plus an extra temporary vector, without any benefit<br>
</p>
</blockquote>



<a name="570048858"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570048858" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570048858">(Jan 26 2026 at 09:51)</a>:</h4>
<p>github-actions[bot] added the label <code>wasi</code> on <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431</a>.</p>



<a name="570090780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570090780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570090780">(Jan 26 2026 at 13:25)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/12431#pullrequestreview-3706025043">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="570090823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570090823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570090823">(Jan 26 2026 at 13:25)</a>:</h4>
<p>alexcrichton added <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431 perf(wasi): avoid extra allocations in inherit_env/args</a> to the merge queue.</p>



<a name="570096409"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570096409" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570096409">(Jan 26 2026 at 13:49)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431</a>.</p>



<a name="570096413"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312431%20perf%28wasi%29%3A%20avoid%20extra%20allocations%20.../near/570096413" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312431.20perf.28wasi.29.3A.20avoid.20extra.20allocations.20.2E.2E.2E.html#570096413">(Jan 26 2026 at 13:49)</a>:</h4>
<p>alexcrichton removed <a href="https://github.com/bytecodealliance/wasmtime/pull/12431">PR #12431 perf(wasi): avoid extra allocations in inherit_env/args</a> from the merge queue.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>