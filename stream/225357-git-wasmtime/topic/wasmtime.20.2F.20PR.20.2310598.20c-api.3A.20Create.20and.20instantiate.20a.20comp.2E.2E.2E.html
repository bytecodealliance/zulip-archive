<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10598 c-api: Create and instantiate a comp... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html">wasmtime / PR #10598 c-api: Create and instantiate a comp...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="512660825"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512660825" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512660825">(Apr 16 2025 at 19:20)</a>:</h4>
<p>MangoPeachGrape opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a> from <code>MangoPeachGrape:c-api/component-model/instance</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Next small chunk of #9812.</p>
<p>I'm not sure about the lifetime requirements of <code>wasmtime_component_linker_instance()</code>, is there any better way to express this?<br>
See previous discussion: <a href="https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884466077">https://github.com/bytecodealliance/wasmtime/pull/9812#discussion_r1884466077</a></p>
</blockquote>



<a name="512660827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512660827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512660827">(Apr 16 2025 at 19:20)</a>:</h4>
<p><strong>MangoPeachGrape</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512660828"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512660828" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512660828">(Apr 16 2025 at 19:20)</a>:</h4>
<p><strong>MangoPeachGrape</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512662691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512662691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512662691">(Apr 16 2025 at 19:25)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512666354"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512666354" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512666354">(Apr 16 2025 at 19:34)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#pullrequestreview-2773644205">PR review</a>:</p>
<blockquote>
<p>Thanks! Would you be up for additionally writing tests now that we've got that set up? Ideally through a new C++ API but also optionally through the C API.</p>
</blockquote>



<a name="512678092"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512678092" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512678092">(Apr 16 2025 at 20:12)</a>:</h4>
<p>MangoPeachGrape <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#issuecomment-2810653162">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>:</p>
<blockquote>
<p>Yes! I would like to write tests, but I'm not sure on some things:</p>
<p>I tested this locally by writing a "example" host using these functions, and running it with a guest component which doesn't import anything.<br>
How would this be represented as test in the repo?<br>
Would this kind of E2E test go the <code>c-api/tests</code>?<br>
How would the guest component get compiled?</p>
<p>Also, I'm not sure if I would want to update the C++ API as well in these PRs. Would it make more sense to add tests for the C API now, and if later - when the same functionality gets exposed to C++ API, and a test written for it - made the C test obsolete, remove it?</p>
</blockquote>



<a name="512678301"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512678301" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512678301">(Apr 16 2025 at 20:13)</a>:</h4>
<p>MangoPeachGrape edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#issuecomment-2810653162">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>:</p>
<blockquote>
<p>Yes! I would like to write tests, but I'm not sure on some things:</p>
<p>I tested this locally by writing an "example" host using these functions, and running it with a guest component which doesn't import anything.<br>
How would this be represented as a test in the repo?<br>
Would this kind of E2E test go into the <code>c-api/tests</code>?<br>
How would the guest component get compiled?</p>
<p>Also, I'm not sure if I would want to update the C++ API as well in these PRs. Would it make more sense to add tests for the C API now, and if later - when the same functionality gets exposed to C++ API, and a test written for it - made the C test obsolete, remove it?</p>
</blockquote>



<a name="512679074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512679074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512679074">(Apr 16 2025 at 20:19)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#issuecomment-2810667504">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>:</p>
<blockquote>
<p>My thinking is that most of the tests could use the text format of WebAssembly, meaning the test wasm file would be in-line with the test itself (this is used a lot on the Rust side for testing too). Orchestrating native-language binaries compiled to wasm to be available in the tests is possible but will be a bit of a pain.</p>
<p>For location, yeah I'm thinking we'd drop things in <code>crates/c-api/tests/*.cc</code>. And yeah if you'd prefer to start by testing the C API I think that's reasonable.</p>
</blockquote>



<a name="512695129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512695129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512695129">(Apr 16 2025 at 22:01)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512695425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512695425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512695425">(Apr 16 2025 at 22:03)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512699371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512699371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512699371">(Apr 16 2025 at 22:32)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512703160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512703160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512703160">(Apr 16 2025 at 23:07)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#pullrequestreview-2774080335">PR review</a>.</p>



<a name="512703161"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512703161" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512703161">(Apr 16 2025 at 23:07)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#discussion_r2047905874">PR review comment</a>:</p>
<blockquote>
<p>I may have missed this on other headers, but I think for this to work reliably you'll want to <code>#include &lt;wasmtime/conf.h&gt;</code> in these headers too? (basically fix the case where this header, and just this header, are included)</p>
</blockquote>



<a name="512703162"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512703162" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512703162">(Apr 16 2025 at 23:07)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#discussion_r2047907624">PR review comment</a>:</p>
<blockquote>
<p>Mind deferring this type to later? I think there's going to be some tricky ownership questions we'll want to grapple with for this (e.g. handling the lifetime parameter in the Rust side of things)</p>
</blockquote>



<a name="512703163"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512703163" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512703163">(Apr 16 2025 at 23:07)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#discussion_r2047908436">PR review comment</a>:</p>
<blockquote>
<p>I think we'll want this to be similar to <code>wasmtime_instance_t</code> where it's not an opaque struct but instead it's a known sturct of two integers (although embeddings won't use the integers much). That'll also obviate the need for deletion of this structure too</p>
</blockquote>



<a name="512707127"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512707127" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512707127">(Apr 16 2025 at 23:47)</a>:</h4>
<p>MangoPeachGrape submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#pullrequestreview-2774138857">PR review</a>.</p>



<a name="512707128"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512707128" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512707128">(Apr 16 2025 at 23:47)</a>:</h4>
<p>MangoPeachGrape created <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#discussion_r2047943140">PR review comment</a>:</p>
<blockquote>
<p>Do you mean not adding this and <code>wasmtime_component_linker_instance()</code> in this PR?</p>
</blockquote>



<a name="512708193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512708193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512708193">(Apr 16 2025 at 23:59)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512841111"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512841111" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512841111">(Apr 17 2025 at 14:30)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#pullrequestreview-2775990293">PR review</a>.</p>



<a name="512841113"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512841113" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512841113">(Apr 17 2025 at 14:30)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#discussion_r2049090819">PR review comment</a>:</p>
<blockquote>
<p>Yeah I think it'd be best to defer that to a future PR to discuss possible directions for that API</p>
</blockquote>



<a name="512930527"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512930527" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512930527">(Apr 17 2025 at 23:04)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="512931165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/512931165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#512931165">(Apr 17 2025 at 23:11)</a>:</h4>
<p>MangoPeachGrape updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="513042673"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/513042673" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#513042673">(Apr 18 2025 at 14:31)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#pullrequestreview-2778721704">PR review</a>.</p>



<a name="513046615"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/513046615" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#513046615">(Apr 18 2025 at 14:56)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>.</p>



<a name="513100440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/513100440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#513100440">(Apr 18 2025 at 21:32)</a>:</h4>
<p>MangoPeachGrape <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#issuecomment-2816225689">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>:</p>
<blockquote>
<p>@alexcrichton What do you want in the next PR?</p>
</blockquote>



<a name="513415950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310598%20c-api%3A%20Create%20and%20instantiate%20a%20comp.../near/513415950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310598.20c-api.3A.20Create.20and.20instantiate.20a.20comp.2E.2E.2E.html#513415950">(Apr 21 2025 at 15:05)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10598#issuecomment-2818696550">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10598">PR #10598</a>:</p>
<blockquote>
<p>How about sketching out the <code>Linker</code> API? Basically being able to create recursive instances/etc. Perhaps hooking up the <code>wasmtime_module_t</code> type where you can supply a core module to a component? (in lieu of defining functions which I think is a bit harder to do as a single step)</p>
<p>My main concern there is that the <code>Linker</code> API in Rust has a lot of borrowed lifetimes which makes it nontrivial to map to other languages. Clear ownership semantics tend to work out best IMO, and it's also the case that performance is not of the utmost concern when creating a <code>Linker</code>. In that sense I think we may want to design this in such a way such that separate pointers in the C API aren't intrinsically linked but instead perhaps define an item-at-a-time where there's no intermediately-owned structures?</p>
<p>One example could be that the entire "path" to an item is passed to the C API, where each element in the path is an exported instance layer. That would then call <code>.instance(..)</code> as necessary in the Rust API and define the requested item at the leaf when the path is iterated over. Or... something like that, just some vague ideas.</p>
<p>It's not that we can't have inter-related objects in the C API, it's mostly just that I'd prefer to avoid it if possible.</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>