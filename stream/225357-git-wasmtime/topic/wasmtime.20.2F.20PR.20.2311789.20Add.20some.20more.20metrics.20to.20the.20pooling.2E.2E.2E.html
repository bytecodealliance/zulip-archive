<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11789 Add some more metrics to the pooling... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html">wasmtime / PR #11789 Add some more metrics to the pooling...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="543035613"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543035613" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543035613">(Oct 03 2025 at 22:15)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a> from <code>alexcrichton:more-pooling-allocator-metrics</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit adds a few more metrics to the <code>PoolingAllocatorMetrics</code> type along the lines of accounting for more items as well as the unused slots in the pooling allocator. Notably the count of unused memory and table slots is exposed along with the number of bytes which are kept resident in these slots despite them not being in use. This involved a bit of plumbing to thread around the number of bytes that are actually kept resident to some more locations but is otherwise a pretty straightforward plumbing of accounting information we already had internally.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="543035614"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543035614" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543035614">(Oct 03 2025 at 22:15)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543035615"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543035615" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543035615">(Oct 03 2025 at 22:15)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543038349"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543038349" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543038349">(Oct 03 2025 at 22:57)</a>:</h4>
<p>pchickey submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#pullrequestreview-3301226505">PR review</a>.</p>



<a name="543038350"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543038350" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543038350">(Oct 03 2025 at 22:57)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2403529925">PR review comment</a>:</p>
<blockquote>
<p>I assume the cfg feature here vs at the use site is causing the current CI breakage</p>
</blockquote>



<a name="543038351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543038351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543038351">(Oct 03 2025 at 22:57)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2403531259">PR review comment</a>:</p>
<blockquote>
<p>this needs cfg(feature = "gc"), and #[cfg(not(feature = "gc"))] 0</p>
</blockquote>



<a name="543038352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543038352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543038352">(Oct 03 2025 at 22:57)</a>:</h4>
<p>pchickey created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2403528851">PR review comment</a>:</p>
<blockquote>
<p>Looks like unnecessary <code>return</code> and <code>;</code> at end of this match block - the inner change should have been sufficient?</p>
</blockquote>



<a name="543040763"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543040763" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543040763">(Oct 03 2025 at 23:35)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543321822"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543321822" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543321822">(Oct 06 2025 at 13:54)</a>:</h4>
<p>lann created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2406473449">PR review comment</a>:</p>
<blockquote>
<p>I avoided this iteration + locking out of a (I guess probably irrational) fear of contention under heavy parallel load. Is that a pretty negligible concern here? If not, should we make a note about it in the pub method docs?</p>
</blockquote>



<a name="543321823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543321823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543321823">(Oct 06 2025 at 13:54)</a>:</h4>
<p>lann submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#pullrequestreview-3304830784">PR review</a>.</p>



<a name="543341039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341039">(Oct 06 2025 at 15:03)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#pullrequestreview-3305300388">PR review</a>.</p>



<a name="543341042"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341042" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341042">(Oct 06 2025 at 15:03)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2406866673">PR review comment</a>:</p>
<blockquote>
<p>I'll make a note yeah. My prediction is that it won't be too costly, but if it ends up causing problems we can probably work around it with atomic counters.</p>
</blockquote>



<a name="543341203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341203">(Oct 06 2025 at 15:04)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#pullrequestreview-3305303582">PR review</a>.</p>



<a name="543341206"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341206" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341206">(Oct 06 2025 at 15:04)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11789#discussion_r2406869456">PR review comment</a>:</p>
<blockquote>
<p>Oh this was needed due to the trailing impls/types/items after this so otherwise this wouldn't compile</p>
</blockquote>



<a name="543341626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341626">(Oct 06 2025 at 15:05)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543341657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543341657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543341657">(Oct 06 2025 at 15:06)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543386388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543386388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543386388">(Oct 06 2025 at 18:43)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543386405"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543386405" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543386405">(Oct 06 2025 at 18:44)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543418604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543418604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543418604">(Oct 06 2025 at 22:40)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543418612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543418612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543418612">(Oct 06 2025 at 22:40)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543423024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543423024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543423024">(Oct 06 2025 at 23:35)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<a name="543443199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311789%20Add%20some%20more%20metrics%20to%20the%20pooling.../near/543443199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311789.20Add.20some.20more.20metrics.20to.20the.20pooling.2E.2E.2E.html#543443199">(Oct 07 2025 at 04:37)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11789">PR #11789</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>