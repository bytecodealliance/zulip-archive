<html>
<head><meta charset="utf-8"><title>wasmtime / issue #10291 Unable to run wasmtime component ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html">wasmtime / issue #10291 Unable to run wasmtime component ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="501795618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501795618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501795618">(Feb 25 2025 at 12:36)</a>:</h4>
<p>tpmccallum opened <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>I am compiling using the following command:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>component<span class="w"> </span>build<span class="w"> </span>--target<span class="w"> </span>wasm32-wasip2
<span class="w">  </span>Generating<span class="w"> </span>bindings<span class="w"> </span><span class="k">for</span><span class="w"> </span>compress<span class="w"> </span><span class="o">(</span>src/bindings.rs<span class="o">)</span>
<span class="w">    </span>Finished<span class="w"> </span><span class="sb">`</span>dev<span class="sb">`</span><span class="w"> </span>profile<span class="w"> </span><span class="o">[</span>unoptimized<span class="w"> </span>+<span class="w"> </span>debuginfo<span class="o">]</span><span class="w"> </span>target<span class="o">(</span>s<span class="o">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.07s
</code></pre></div>
<p>But when I use wasmtime I get an error:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>component<span class="w"> </span>run<span class="w"> </span>--env<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span><span class="w"> </span>--dir<span class="w"> </span>.<span class="w"> </span>--invoke<span class="w"> </span>compress<span class="w"> </span>target/wasm32-wasip2/debug/compress.wasm
Error:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>I put the source code and config in a repo so you can see everything. Super stumped on this one, would appreciate some assistance.</p>
<p><a href="https://github.com/tpmccallum/testing_components/blob/main/README.md">https://github.com/tpmccallum/testing_components/blob/main/README.md</a></p>
</blockquote>



<a name="501797568"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501797568" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501797568">(Feb 25 2025 at 12:47)</a>:</h4>
<p>tpmccallum <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681874110">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Here are some details of my system/setup that might help with the diagnosis:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>rustc<span class="w"> </span>--version
rustc<span class="w"> </span><span class="m">1</span>.87.0-nightly<span class="w"> </span><span class="o">(</span>f8a913b13<span class="w"> </span><span class="m">2025</span>-02-23<span class="o">)</span>
</code></pre></div>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>component<span class="w"> </span>--version
cargo-component-component<span class="w"> </span><span class="m">0</span>.20.0
</code></pre></div>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>--version
wasmtime<span class="w"> </span><span class="m">30</span>.0.1
</code></pre></div>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>uname<span class="w"> </span>-a
Darwin<span class="w"> </span>Kernel<span class="w"> </span>Version<span class="w"> </span><span class="m">24</span>.3.0:<span class="w"> </span>X86_64
</code></pre></div>
<p>The <code>target/wasm32-wasip2</code> file exists.<br>
I tried updating <code>cargo-component</code>, forcing <code>wasip2</code> in config but output in the CLI still says <code>wasip1</code>.<br>
Is <code>wasmtime 30.0.1</code> mishandling <code>wasip2</code> components?<br>
The auto-generated <code>bindings.rs</code> mention <code>wit-bindgen:0.36.0</code> and I am not sure if the bindings being generated are correct.<br>
<a href="https://github.com/tpmccallum/testing_components/blob/main/compress/src/bindings.rs#L93">wit-bindgen:0.36.0</a></p>
</blockquote>



<a name="501799517"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501799517" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501799517">(Feb 25 2025 at 12:56)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681899867">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Does the <code>target/wasm32-wasip2/debug/compress.wasm</code> file exist?</p>
</blockquote>



<a name="501805227"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501805227" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501805227">(Feb 25 2025 at 13:24)</a>:</h4>
<p>tpmccallum <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2681973730">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Yes, the <code>target/wasm32-wasip2/debug/compress.wasm</code> does exist.</p>
</blockquote>



<a name="501838464"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501838464" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501838464">(Feb 25 2025 at 15:44)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682439283">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Thanks for the report! (and <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span>)</p>
<p>I think the problem here is that <code>wasmtime component run</code> isn't a subcommand of the <code>wasmtime</code> executable. Coupled with Wasmtime's bad error message (which is improved at <a href="https://github.com/bytecodealliance/wasmtime/pull/10292">https://github.com/bytecodealliance/wasmtime/pull/10292</a> now) I think that led to the confusion here.</p>
<p>When removing <code>component</code> I then get:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">wasmtime</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">env</span><span class="w"> </span><span class="n">PATH</span><span class="o">=</span><span class="cp">$PATH</span><span class="w"> </span><span class="o">--</span><span class="n">dir</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">--</span><span class="n">invoke</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="n">target</span><span class="o">/</span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasip2</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">compress</span><span class="p">.</span><span class="n">wasm</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">target</span><span class="o">/</span><span class="n">wasm32</span><span class="o">-</span><span class="n">wasip2</span><span class="o">/</span><span class="n">debug</span><span class="o">/</span><span class="n">compress</span><span class="p">.</span><span class="n">wasm</span><span class="err">`</span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span><span class="p">:</span>
<span class="w">    </span><span class="nc">using</span><span class="w"> </span><span class="err">`</span><span class="o">--</span><span class="n">invoke</span><span class="err">`</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">components</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">supported</span>
</code></pre></div>
<p>which is expected in that <code>--invoke</code> isn't supported for components just yet.</p>
</blockquote>



<a name="501881097"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501881097" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501881097">(Feb 25 2025 at 18:17)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682909348">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<blockquote>
<p>expected in that --invoke isn't supported for components just yet.<br>
Its not that far off but I haven't had the time or energy to get it over the finish line. If someone else wants to pick it up, ping me on the PR or zulip <a href="https://github.com/bytecodealliance/wasmtime/pull/10054">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>
</blockquote>
</blockquote>



<a name="501881115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501881115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501881115">(Feb 25 2025 at 18:17)</a>:</h4>
<p>pchickey edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2682909348">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<blockquote>
<p>expected in that --invoke isn't supported for components just yet.</p>
</blockquote>
<p>Its not that far off but I haven't had the time or energy to get it over the finish line. If someone else wants to pick it up, ping me on the PR or zulip <a href="https://github.com/bytecodealliance/wasmtime/pull/10054">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>
</blockquote>



<a name="501959235"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/501959235" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#501959235">(Feb 26 2025 at 04:23)</a>:</h4>
<p>tpmccallum <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2683859920">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Thanks for the reply @bjorn3, @pchickey.<br>
Thanks, @alexcrichton (and <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> back). </p>
<p>This is super helpful and appreciated. </p>
<p><strong>wasip1/wasip2</strong><br>
Some of the confusion (not <code>wasmtime</code> related specifically) was because I thought the <code>cargo component</code> command supported <code>wasip2</code>. I have since learned that <a href="https://github.com/bytecodealliance/cargo-component/issues/364#issuecomment-2683673580">it does not</a>. Based on the output I was getting when generating the bindings I  thought that something was off with my config or toolchain and I chased my own tail for quite a while.</p>
<p><strong>Error: No such file or directory (os error 2)</strong><br>
Thanks for the improved error message, that makes sense now.</p>
<p><strong>Invoke Functionality</strong><br>
I went ahead and fetched @pchickey's PR to test the --invoke out locally. Here's the results:</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">cd /Users/tpmccallum</span>
<span class="go">git clone https://github.com/bytecodealliance/wasmtime.git</span>
<span class="go">cd wasmtime</span>
<span class="go">git checkout main</span>
<span class="go">git pull origin main</span>
<span class="go">git checkout pch/invoke_wave</span>
<span class="go">git merge main</span>
<span class="go">cargo clean</span>
<span class="go">cargo build --release</span>
</code></pre></div>
<p>I then tried to run the component and got the following result (hopefully useful feedback for the continuation of the work on <a href="https://github.com/bytecodealliance/wasmtime/pull/10054">https://github.com/bytecodealliance/wasmtime/pull/10054</a>):</p>
<div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="gp">tpmccallum@192-168-1-17 compress % </span>/Users/tpmccallum/wasmtime/target/release/wasmtime<span class="w"> </span>run<span class="w"> </span>--invoke<span class="w"> </span>compress<span class="w"> </span>target/wasm32-wasip1/debug/compress.wasm

<span class="go">Error: failed to run main module `target/wasm32-wasip1/debug/compress.wasm`</span>

<span class="go">Caused by:</span>
<span class="go">    0: parsing invoke "compress"</span>
<span class="go">    1: unexpected end of input at 8..8</span>
</code></pre></div>
</blockquote>



<a name="509634496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/509634496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#509634496">(Apr 02 2025 at 08:36)</a>:</h4>
<p>tpmccallum <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2771819133">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Update at <a href="https://github.com/bytecodealliance/wasmtime/pull/10511">https://github.com/bytecodealliance/wasmtime/pull/10511</a></p>
</blockquote>



<a name="511755639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/511755639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#511755639">(Apr 12 2025 at 00:19)</a>:</h4>
<p>tpmccallum closed <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>I am compiling using the following command:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>component<span class="w"> </span>build<span class="w"> </span>--target<span class="w"> </span>wasm32-wasip2
<span class="w">  </span>Generating<span class="w"> </span>bindings<span class="w"> </span><span class="k">for</span><span class="w"> </span>compress<span class="w"> </span><span class="o">(</span>src/bindings.rs<span class="o">)</span>
<span class="w">    </span>Finished<span class="w"> </span><span class="sb">`</span>dev<span class="sb">`</span><span class="w"> </span>profile<span class="w"> </span><span class="o">[</span>unoptimized<span class="w"> </span>+<span class="w"> </span>debuginfo<span class="o">]</span><span class="w"> </span>target<span class="o">(</span>s<span class="o">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.07s
</code></pre></div>
<p>But when I use wasmtime I get an error:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$<span class="w"> </span>wasmtime<span class="w"> </span>component<span class="w"> </span>run<span class="w"> </span>--env<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span><span class="w"> </span>--dir<span class="w"> </span>.<span class="w"> </span>--invoke<span class="w"> </span>compress<span class="w"> </span>target/wasm32-wasip2/debug/compress.wasm
Error:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory<span class="w"> </span><span class="o">(</span>os<span class="w"> </span>error<span class="w"> </span><span class="m">2</span><span class="o">)</span>
</code></pre></div>
<p>I put the source code and config in a repo so you can see everything. Super stumped on this one, would appreciate some assistance.</p>
<p><a href="https://github.com/tpmccallum/testing_components/blob/main/README.md">https://github.com/tpmccallum/testing_components/blob/main/README.md</a></p>
</blockquote>



<a name="511755641"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310291%20Unable%20to%20run%20wasmtime%20component%20.../near/511755641" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310291.20Unable.20to.20run.20wasmtime.20component.20.2E.2E.2E.html#511755641">(Apr 12 2025 at 00:19)</a>:</h4>
<p>tpmccallum <a href="https://github.com/bytecodealliance/wasmtime/issues/10291#issuecomment-2798249248">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10291">issue #10291</a>:</p>
<blockquote>
<p>Congrats @pchickey and @alexcrichton on getting this work done and merging <a href="https://github.com/bytecodealliance/wasmtime/pull/10054">https://github.com/bytecodealliance/wasmtime/pull/10054</a></p>
<p>For others reading this, please note that the docs at <a href="https://docs.wasmtime.dev/cli-options.html#run">https://docs.wasmtime.dev/cli-options.html#run</a> show examples of invoking a component's exported functions.</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>