<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11470  Make table/memory creation async fu... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html">wasmtime / PR #11470  Make table/memory creation async fu...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="535217286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217286">(Aug 19 2025 at 23:52)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a> from <code>alexcrichton:table-memory-creation-async</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit is a large-ish refactor which is made possible by the many<br>
previous refactorings to internals w.r.t. async-in-Wasmtime. The end<br>
goal of this change is that table and memory allocation are both <code>async</code><br>
functions. Achieving this, however, required some refactoring to enable<br>
it to work:</p>
<ul>
<li>
<p>To work with <code>Send</code> neither function can close over <code>dyn VMStore</code>.<br>
  This required changing their <code>Option&lt;&amp;mut dyn VMStore&gt;</code> arugment to<br>
<code>Option&lt;&amp;mut StoreResourceLimiter&lt;'_&gt;&gt;</code></p>
</li>
<li>
<p>Somehow a <code>StoreResourceLimiter</code> needed to be acquired from an<br>
<code>InstanceAllocationRequest</code>. Previously the store was stored here as<br>
  an unsafe raw pointer, but I've refactored this now so<br>
<code>InstanceAllocationRequest</code> directly stores <code>&amp;StoreOpaque</code> and<br>
<code>Option&lt;&amp;mut StoreResourceLimiter&gt;</code> meaning it's trivial to acquire<br>
  them. This additionally means no more <code>unsafe</code> access of the store<br>
  during instance allocation (yay!).</p>
</li>
<li>
<p>Now-redundant fields of <code>InstanceAllocationRequest</code> were removed since<br>
  they can be safely inferred from <code>&amp;StoreOpaque</code>. For example passing<br>
  around <code>&amp;Tunables</code> is now all gone.</p>
</li>
<li>
<p>Methods upwards from table/memory allocation to the<br>
<code>InstanceAllocator</code> trait needed to be made <code>async</code>. This includes new<br>
<code>#[async_trait]</code> methods for example.</p>
</li>
<li>
<p><code>StoreOpaque::ensure_gc_store</code> is now an <code>async</code> function. This<br>
  internally carries a new <code>unsafe</code> block carried over from before with<br>
  the raw point passed around in <code>InstanceAllocationRequest</code>. A future<br>
  PR will delete this <code>unsafe</code> block, it's just temporary.</p>
</li>
</ul>
<p>I attempted a few times to split this PR up into separate commits but<br>
everything is relatively intertwined here so this is the smallest<br>
"atomic" unit I could manage to land these changes and refactorings.</p>
</blockquote>



<a name="535217289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217289">(Aug 19 2025 at 23:52)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/dicej">dicej</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535217290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217290">(Aug 19 2025 at 23:52)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535217392"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217392" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217392">(Aug 19 2025 at 23:53)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#issuecomment-3203149335">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<p>I'll note that I've split this into two commits, the first of which is <a href="https://github.com/bytecodealliance/wasmtime/pull/11456">https://github.com/bytecodealliance/wasmtime/pull/11456</a> resurrected here. That commit cannot be split out to a second PR due to all the various constraints in play unfortunately, so this is a bit larger than I would have otherwise anticipated.</p>
</blockquote>



<a name="535217489"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217489" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217489">(Aug 19 2025 at 23:55)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#issuecomment-3203166461">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<p>Oh, I should also note, this is a 5% performance penalty overhead to instance instantiation. Benchmarking makes me think it's primarily related to the <code>Box</code>-cost of <code>#[async_trait]</code>. We can burn down that cost I think if we really need from allocation-per-table-and-memory to once-per-module (aka two for most modules to one), but I don't know how to get away from it entirely. I subjectively concluded a few extra allocations is fine, but others can reasonably differ.</p>
</blockquote>



<a name="535217548"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217548" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217548">(Aug 19 2025 at 23:56)</a>:</h4>
<p>alexcrichton edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<p>This commit is a large-ish refactor which is made possible by the many<br>
previous refactorings to internals w.r.t. async-in-Wasmtime. The end<br>
goal of this change is that table and memory allocation are both <code>async</code><br>
functions. Achieving this, however, required some refactoring to enable<br>
it to work:</p>
<ul>
<li>
<p>To work with <code>Send</code> neither function can close over <code>dyn VMStore</code>.<br>
  This required changing their <code>Option&lt;&amp;mut dyn VMStore&gt;</code> arugment to<br>
<code>Option&lt;&amp;mut StoreResourceLimiter&lt;'_&gt;&gt;</code></p>
</li>
<li>
<p>Somehow a <code>StoreResourceLimiter</code> needed to be acquired from an<br>
<code>InstanceAllocationRequest</code>. Previously the store was stored here as<br>
  an unsafe raw pointer, but I've refactored this now so<br>
<code>InstanceAllocationRequest</code> directly stores <code>&amp;StoreOpaque</code> and<br>
<code>Option&lt;&amp;mut StoreResourceLimiter&gt;</code> meaning it's trivial to acquire<br>
  them. This additionally means no more <code>unsafe</code> access of the store<br>
  during instance allocation (yay!).</p>
</li>
<li>
<p>Now-redundant fields of <code>InstanceAllocationRequest</code> were removed since<br>
  they can be safely inferred from <code>&amp;StoreOpaque</code>. For example passing<br>
  around <code>&amp;Tunables</code> is now all gone.</p>
</li>
<li>
<p>Methods upwards from table/memory allocation to the<br>
<code>InstanceAllocator</code> trait needed to be made <code>async</code>. This includes new<br>
<code>#[async_trait]</code> methods for example.</p>
</li>
<li>
<p><code>StoreOpaque::ensure_gc_store</code> is now an <code>async</code> function. This<br>
  internally carries a new <code>unsafe</code> block carried over from before with<br>
  the raw point passed around in <code>InstanceAllocationRequest</code>. A future<br>
  PR will delete this <code>unsafe</code> block, it's just temporary.</p>
</li>
</ul>
<p>I attempted a few times to split this PR up into separate commits but<br>
everything is relatively intertwined here so this is the smallest<br>
"atomic" unit I could manage to land these changes and refactorings.</p>
<p>cc #11430</p>
</blockquote>



<a name="535217751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535217751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535217751">(Aug 19 2025 at 23:59)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535221592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535221592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535221592">(Aug 20 2025 at 00:53)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#issuecomment-3203629587">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<p>I was a bit afraid of this, but tests here will fail until I rebase this on top of #11468. So ready for review, but won't pass tests until #11468 lands first.</p>
</blockquote>



<a name="535364228"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535364228" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535364228">(Aug 20 2025 at 17:54)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535364344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535364344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535364344">(Aug 20 2025 at 17:55)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535370689"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535370689" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535370689">(Aug 20 2025 at 18:39)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535371041"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535371041" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535371041">(Aug 20 2025 at 18:42)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#pullrequestreview-3137786599">PR review</a>.</p>



<a name="535371043"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535371043" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535371043">(Aug 20 2025 at 18:42)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2288971332">PR review comment</a>:</p>
<blockquote>
<p>And similarly assert that the config is async here?</p>
</blockquote>



<a name="535371044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535371044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535371044">(Aug 20 2025 at 18:42)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2288970238">PR review comment</a>:</p>
<blockquote>
<p>Should we not assert that this is a non-async config before the <code>.expect(..)</code> to catch mismatches a little earlier?</p>
</blockquote>



<a name="535371045"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535371045" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535371045">(Aug 20 2025 at 18:42)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2288975763">PR review comment</a>:</p>
<blockquote>
<p>Add a note for this to our items to discuss with the lang team, if we don't have one already?</p>
</blockquote>



<a name="535371046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535371046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535371046">(Aug 20 2025 at 18:42)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2288977391">PR review comment</a>:</p>
<blockquote>
<p>This is so nice to clean up</p>
</blockquote>



<a name="535372414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372414">(Aug 20 2025 at 18:52)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#pullrequestreview-3137844459">PR review</a>.</p>



<a name="535372415"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372415" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372415">(Aug 20 2025 at 18:52)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2289012425">PR review comment</a>:</p>
<blockquote>
<p>Oh this one's technically <a href="https://github.com/rust-lang/rust/pull/143545">already fixed</a> and just waiting on stabilization, and browsing <a href="https://github.com/rust-lang/rust/issues/110338">https://github.com/rust-lang/rust/issues/110338</a> shows this is pretty well-known, so not a major issue.</p>
</blockquote>



<a name="535372607"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372607" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372607">(Aug 20 2025 at 18:53)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#pullrequestreview-3137847967">PR review</a>.</p>



<a name="535372609"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372609" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372609">(Aug 20 2025 at 18:53)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2289015173">PR review comment</a>:</p>
<blockquote>
<p>Oh this is actually replicating the documented behavior where this works with <code>async_support</code> so long as an async resource limiter isn't used. In that sense to avoid breaking the semantics here <code>one_poll</code> is what's required as opposed to an <code>assert!(!async_support)</code> plus <code>vm::assert_ready</code>.</p>
</blockquote>



<a name="535372735"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372735" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372735">(Aug 20 2025 at 18:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#pullrequestreview-3137850584">PR review</a>.</p>



<a name="535372739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372739">(Aug 20 2025 at 18:54)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#discussion_r2289017121">PR review comment</a>:</p>
<blockquote>
<p>As I've been making these changes I've actually been undoing a lot of <code>assert!(async_support)</code>-style assertions. Previously that was required because <code>on_fiber</code> was immediately used which required <code>async_support</code> to be turned on, but now it's just normal Rust async functions so there's no reason to prevent usage when <code>async_support</code> is disabled. In that sense it's intentional that the assert here is lost, but how's that sound to you?</p>
</blockquote>



<a name="535372850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535372850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535372850">(Aug 20 2025 at 18:55)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535406690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535406690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535406690">(Aug 21 2025 at 00:02)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#issuecomment-3208496655">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<p>I'm going to go ahead and land this, but @fitzgen if you have follow up comments I'm happy to address them.</p>
</blockquote>



<a name="535408023"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535408023" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535408023">(Aug 21 2025 at 00:25)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>.</p>



<a name="535543188"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311470%20%20Make%20table/memory%20creation%20async%20fu.../near/535543188" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311470.20.20Make.20table.2Fmemory.20creation.20async.20fu.2E.2E.2E.html#535543188">(Aug 21 2025 at 16:51)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/11470#issuecomment-3211390147">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11470">PR #11470</a>:</p>
<blockquote>
<blockquote>
<p>I'm going to go ahead and land this, but @fitzgen if you have follow up comments I'm happy to address them.</p>
</blockquote>
<p>Nope, looks good</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>