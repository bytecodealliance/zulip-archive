<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11751 Cooperative Multithreading · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html">wasmtime / PR #11751 Cooperative Multithreading</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="541979880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/541979880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#541979880">(Sep 29 2025 at 09:06)</a>:</h4>
<p>TartanLlama opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a> from <code>TartanLlama:sy/coop_threading</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[ ] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Testing</li>
<li>[ ] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
<p>Requires building against <a href="https://github.com/TartanLlama/wit-bindgen/tree/sy/coop_threading">this branch</a> of <code>wit-bindgen</code>  </p>
</blockquote>



<a name="542002155"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542002155" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542002155">(Sep 29 2025 at 10:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3346271162">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "fuzzing", "wasmtime:api", "wasmtime:config"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: fuzzing</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="542014897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542014897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542014897">(Sep 29 2025 at 11:45)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3346500227">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<h4>Label Messager: wasmtime:config</h4>
<p>It looks like you are changing Wasmtime's configuration options. Make sure to<br>
complete this check list:</p>
<ul>
<li>
<p>[ ] If you added a new <code>Config</code> method, you wrote extensive documentation for<br>
      it.</p>
<p>&lt;details&gt;</p>
<p>Our documentation should be of the following form:</p>
<p>```text<br>
Short, simple summary sentence.</p>
<p>More details. These details can be multiple paragraphs. There should be<br>
information about not just the method, but its parameters and results as<br>
well.</p>
<p>Is this method fallible? If so, when can it return an error?</p>
<p>Can this method panic? If so, when does it panic?</p>
<h1>Example</h1>
<p>Optional example here.<br>
```</p>
<p>&lt;/details&gt;</p>
</li>
<li>
<p>[ ] If you added a new <code>Config</code> method, or modified an existing one, you<br>
  ensured that this configuration is exercised by the fuzz targets.</p>
<p>&lt;details&gt;</p>
<p>For example, if you expose a new strategy for allocating the next instance<br>
slot inside the pooling allocator, you should ensure that at least one of our<br>
fuzz targets exercises that new strategy.</p>
<p>Often, all that is required of you is to ensure that there is a knob for this<br>
configuration option in [<code>wasmtime_fuzzing::Config</code>][fuzzing-config] (or one<br>
of its nested <code>struct</code>s).</p>
<p>Rarely, this may require authoring a new fuzz target to specifically test this<br>
configuration. See [our docs on fuzzing][fuzzing-docs] for more details.</p>
<p>&lt;/details&gt;</p>
</li>
<li>
<p>[ ] If you are enabling a configuration option by default, make sure that it<br>
  has been fuzzed for at least two weeks before turning it on by default.</p>
</li>
</ul>
<p>[fuzzing-config]: <a href="https://github.com/bytecodealliance/wasmtime/blob/ca0e8d0a1d8cefc0496dba2f77a670571d8fdcab/crates/fuzzing/src/generators.rs#L182-L194">https://github.com/bytecodealliance/wasmtime/blob/ca0e8d0a1d8cefc0496dba2f77a670571d8fdcab/crates/fuzzing/src/generators.rs#L182-L194</a><br>
[fuzzing-docs]: <a href="https://docs.wasmtime.dev/contributing-fuzzing.html">https://docs.wasmtime.dev/contributing-fuzzing.html</a></p>
<hr>
<p>&lt;details&gt;</p>
<p>To modify this label's message, edit the &lt;code&gt;.github/label-messager/wasmtime-config.md&lt;/code&gt; file.</p>
<p>To add new label messages or remove existing label messages, edit the<br>
&lt;code&gt;.github/label-messager.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/label-messager-action">Learn more.</a></p>
<p>&lt;/details&gt;</p>
</blockquote>



<a name="542207140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542207140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542207140">(Sep 30 2025 at 08:00)</a>:</h4>
<p>cpetig submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3283107801">PR review</a>.</p>



<a name="542207141"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542207141" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542207141">(Sep 30 2025 at 08:00)</a>:</h4>
<p>cpetig created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2390230981">PR review comment</a>:</p>
<blockquote>
<p>This logic looks wrong (not using p for filter_map)</p>
</blockquote>



<a name="542216428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542216428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542216428">(Sep 30 2025 at 08:44)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3283304011">PR review</a>.</p>



<a name="542216430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542216430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542216430">(Sep 30 2025 at 08:44)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2390371450">PR review comment</a>:</p>
<blockquote>
<p>Indeed, that's going to be fixed when I merge in the latest changes</p>
</blockquote>



<a name="542228062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542228062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542228062">(Sep 30 2025 at 09:39)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542228175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542228175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542228175">(Sep 30 2025 at 09:39)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[ ] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
<p>Requires building against <a href="https://github.com/TartanLlama/wit-bindgen/tree/sy/coop_threading">this branch</a> of <code>wit-bindgen</code>  </p>
</blockquote>



<a name="542252274"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542252274" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542252274">(Sep 30 2025 at 11:42)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542252418"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542252418" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542252418">(Sep 30 2025 at 11:42)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[ ] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="542252687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542252687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542252687">(Sep 30 2025 at 11:44)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542472930"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542472930" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542472930">(Oct 01 2025 at 11:41)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542478561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542478561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542478561">(Oct 01 2025 at 12:10)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542896937"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542896937" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542896937">(Oct 03 2025 at 08:45)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="542944090"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542944090" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542944090">(Oct 03 2025 at 13:16)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="542979230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/542979230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#542979230">(Oct 03 2025 at 16:08)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543014661"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543014661" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543014661">(Oct 03 2025 at 19:18)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[ ] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543084755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543084755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543084755">(Oct 04 2025 at 12:40)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543084757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543084757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543084757">(Oct 04 2025 at 12:40)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543084838"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543084838" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543084838">(Oct 04 2025 at 12:41)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[ ] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543084840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543084840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543084840">(Oct 04 2025 at 12:41)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[ ] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543086196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543086196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543086196">(Oct 04 2025 at 13:04)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543086201"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543086201" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543086201">(Oct 04 2025 at 13:04)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543086204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543086204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543086204">(Oct 04 2025 at 13:04)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543309065"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543309065" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543309065">(Oct 06 2025 at 13:05)</a>:</h4>
<p>cpetig submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3304482685">PR review</a>.</p>



<a name="543309068"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543309068" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543309068">(Oct 06 2025 at 13:05)</a>:</h4>
<p>cpetig created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2406174749">PR review comment</a>:</p>
<blockquote>
<p>resolved. (I don't seem to be able to close this thread)</p>
</blockquote>



<a name="543364530"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543364530" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543364530">(Oct 06 2025 at 16:37)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[ ] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Match trap conditions with the spec</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543546044"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543546044" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543546044">(Oct 07 2025 at 14:24)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543556019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543556019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543556019">(Oct 07 2025 at 15:04)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543556297"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543556297" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543556297">(Oct 07 2025 at 15:05)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[x] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Match trap conditions with the spec</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
</blockquote>



<a name="543904948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543904948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543904948">(Oct 09 2025 at 08:55)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543907747"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543907747" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543907747">(Oct 09 2025 at 09:08)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543971790"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543971790" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543971790">(Oct 09 2025 at 14:13)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543972526"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543972526" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543972526">(Oct 09 2025 at 14:15)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543973524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543973524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543973524">(Oct 09 2025 at 14:18)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543976710"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543976710" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543976710">(Oct 09 2025 at 14:30)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="543990221"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/543990221" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#543990221">(Oct 09 2025 at 15:26)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544202777"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544202777" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544202777">(Oct 10 2025 at 15:53)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544203167"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544203167" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544203167">(Oct 10 2025 at 15:55)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544203390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544203390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544203390">(Oct 10 2025 at 15:56)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544203537"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544203537" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544203537">(Oct 10 2025 at 15:57)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544210037"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544210037" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544210037">(Oct 10 2025 at 16:33)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544214286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544214286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544214286">(Oct 10 2025 at 17:01)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544215375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544215375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544215375">(Oct 10 2025 at 17:08)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544216459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544216459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544216459">(Oct 10 2025 at 17:15)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544217233"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544217233" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544217233">(Oct 10 2025 at 17:20)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544217802"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544217802" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544217802">(Oct 10 2025 at 17:25)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544231496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544231496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544231496">(Oct 10 2025 at 19:05)</a>:</h4>
<p><strong>TartanLlama</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a> as ready for review.</p>



<a name="544231499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544231499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544231499">(Oct 10 2025 at 19:05)</a>:</h4>
<p><strong>TartanLlama</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544231500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544231500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544231500">(Oct 10 2025 at 19:05)</a>:</h4>
<p><strong>TartanLlama</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers">wasmtime-fuzz-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544231501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544231501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544231501">(Oct 10 2025 at 19:05)</a>:</h4>
<p><strong>TartanLlama</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544231502"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544231502" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544231502">(Oct 10 2025 at 19:05)</a>:</h4>
<p><strong>TartanLlama</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="544816648"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816648" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816648">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3332310338">PR review</a>:</p>
<blockquote>
<p>Some initial comments from review, mostly pretty minor. I'm ccing @dicej on this as well as he's the main author of <code>concurrent.rs</code>, the meat of the changes here, so he'll be taking a look at that</p>
</blockquote>



<a name="544816649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816649">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426834427">PR review comment</a>:</p>
<blockquote>
<p>I think this, and a few updates above, may not be necessary any more? (maybe once were but may no longer be)</p>
</blockquote>



<a name="544816650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816650">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426838777">PR review comment</a>:</p>
<blockquote>
<p>I realize that this is preexisting (my comment here applies to other tests in this file too) and so you can defer this to later if you desire, but these tests are perfect for adding to <code>tests/misc_testsuite/**/*.wast</code> vs in-Rust tests here. Should be able to <code>(assert_trap (invoke ...) "the message")</code> and that makes the tests much easier to run and avoids compiling more Rust code for tests</p>
</blockquote>



<a name="544816651"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816651" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816651">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426835183">PR review comment</a>:</p>
<blockquote>
<p>This might be an accidental update? (assuming based on the removed test)</p>
</blockquote>



<a name="544816652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816652">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426833723">PR review comment</a>:</p>
<blockquote>
<p>In <a href="https://github.com/bytecodealliance/wasmtime/pull/11818">https://github.com/bytecodealliance/wasmtime/pull/11818</a> I'm hoping to split tests apart based on features rather than having everything in one large test, so mind adding the updated version of this test to a new test instead of updating the one here?</p>
</blockquote>



<a name="544816654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816654">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426842536">PR review comment</a>:</p>
<blockquote>
<p>This might be another victim of a mass rename (unrelated to components here)</p>
</blockquote>



<a name="544816655"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816655" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816655">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426847647">PR review comment</a>:</p>
<blockquote>
<p>If you'd like it should be possible to reduce the number of functions here to correspond to just the <code>suspension_intrinsic</code> function. There's no need for the libcalls here to be 1:1 with component model libcalls as the compiler could translate, for example, the <code>thread_suspend</code> call here into a <code>suspension_intrinsic</code> libcall which would bake in <code>false</code> as a runtime argument in the trampoline and this function itself would take the boolean an an argument.</p>
<p>Mostly a stylistic preference one way or another and I don't mind either way myself. Just wanted to note the possibility in case you didn't like having so many intrinsics.</p>
</blockquote>



<a name="544816656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816656">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426836535">PR review comment</a>:</p>
<blockquote>
<p>This might be an unrelated victim of "mass rename yield to thread-yield" (it's core modules not components)</p>
</blockquote>



<a name="544816657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816657">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426841793">PR review comment</a>:</p>
<blockquote>
<p>Similar to my comment below, but this would also be a good test to add to the <code>*.wast</code>-based testing. It might be a little more verbose there but I think it'd be worth it (ideally all tests are <code>*.wast</code>).</p>
<p>Feel free to defer this to a future PR though</p>
</blockquote>



<a name="544816658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/544816658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#544816658">(Oct 14 2025 at 18:49)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2426843207">PR review comment</a>:</p>
<blockquote>
<p>This is technically I think a victim of the mass renabme and while this is related to components it's host-level yielding as opposed to component-level yielding.</p>
</blockquote>



<a name="545011056"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011056" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011056">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3341092019">PR review</a>:</p>
<blockquote>
<p>Looks great; thanks for doing this!</p>
<p>I've only looked closely at the <code>concurrent.rs</code> changes; Alex said the rest looked fine.  It all looks reasonable to me; just a few inline comments here and there.  I appreciate the tweaks you made to the existing code to make it more readable.</p>
</blockquote>



<a name="545011057"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011057" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011057">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433079832">PR review comment</a>:</p>
<blockquote>
<p><code>self</code> doesn't appear to be used here; perhaps this function should be moved to <code>impl ConcurrentState</code>?</p>
</blockquote>



<a name="545011058"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011058" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011058">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433161058">PR review comment</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    /// The "high priority" work queue for this store's event loop.
</code></pre></div>
<p>Not related to your changes, but I should have updated these docs when I moved <code>ConcurrentState</code> to <code>StoreOpaque</code>.</p>
</blockquote>



<a name="545011060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011060">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433083945">PR review comment</a>:</p>
<blockquote>
<p>There's a lot of <code>unsafe</code> code here that I don't have enough context for.  @alexcrichton would you mind talking a look?</p>
</blockquote>



<a name="545011061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011061">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433220283">PR review comment</a>:</p>
<blockquote>
<p>This leaks information "non-determinstically" about how many table indexes have been allocated across all (sub)components by returning the rep directly.  We should translate the rep to a (sub)component-specific handle using a <code>RuntimeComponentInstanceIndex</code>-specific table like we do for <code>subtask</code>, <code>stream</code>, <code>future</code>, <code>resource</code>, etc. handles.</p>
</blockquote>



<a name="545011062"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011062" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011062">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433230835">PR review comment</a>:</p>
<blockquote>
<p>Optional nit: <code>task.have_lowered_parameters()</code> feels a bit ungrammatical.  Perhaps change this to <code>has_*</code> instead?</p>
</blockquote>



<a name="545011063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545011063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545011063">(Oct 15 2025 at 16:23)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433162229">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>    /// The "low priority" work queue for this store's event loop.
</code></pre></div><br>
</p>
</blockquote>



<a name="545135284"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545135284" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545135284">(Oct 15 2025 at 22:11)</a>:</h4>
<p>dicej edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2433220283">PR review comment</a>.</p>



<a name="545520626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545520626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545520626">(Oct 17 2025 at 09:13)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545520700"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545520700" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545520700">(Oct 17 2025 at 09:13)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3349043823">PR review</a>.</p>



<a name="545520703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545520703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545520703">(Oct 17 2025 at 09:13)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2438968822">PR review comment</a>:</p>
<blockquote>
<p>Change was unnecessary now, reverted</p>
</blockquote>



<a name="545521098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545521098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545521098">(Oct 17 2025 at 09:15)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545522479"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545522479" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545522479">(Oct 17 2025 at 09:23)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545522842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545522842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545522842">(Oct 17 2025 at 09:25)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545528646"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545528646" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545528646">(Oct 17 2025 at 09:53)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545529237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545529237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545529237">(Oct 17 2025 at 09:56)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3349193541">PR review</a>.</p>



<a name="545529238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545529238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545529238">(Oct 17 2025 at 09:56)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2439086363">PR review comment</a>:</p>
<blockquote>
<p>Yeah, this is mostly an artifact of how the code developed, but I think it's okay to have the 1:1 correspondence as it keeps the libcalls easily searchable</p>
</blockquote>



<a name="545529330"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545529330" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545529330">(Oct 17 2025 at 09:57)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3349195242">PR review</a>.</p>



<a name="545529331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545529331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545529331">(Oct 17 2025 at 09:57)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2439087671">PR review comment</a>:</p>
<blockquote>
<p>Makes sense, I'll defer for now and can address in a future PR</p>
</blockquote>



<a name="545530322"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545530322" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545530322">(Oct 17 2025 at 10:02)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545531024"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545531024" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545531024">(Oct 17 2025 at 10:05)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="545531237"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545531237" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545531237">(Oct 17 2025 at 10:06)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3349238095">PR review</a>.</p>



<a name="545531238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545531238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545531238">(Oct 17 2025 at 10:06)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2439129409">PR review comment</a>:</p>
<blockquote>
<p>I renamed it to <code>already_lowered_parameters</code> because otherwise it could be interpreted as "currently owns lowered parameters", which doesn't really make sense, but I think this is less ambiguous</p>
</blockquote>



<a name="545555905"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545555905" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545555905">(Oct 17 2025 at 12:25)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350035324">PR review</a>.</p>



<a name="545555908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545555908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545555908">(Oct 17 2025 at 12:25)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2439754419">PR review comment</a>:</p>
<blockquote>
<p>Ah yeah, makes sense. I've made this change, but it breaks a bunch of the existing tests that check the value of handles, e.g. <a href="https://github.com/bytecodealliance/wasmtime/blob/main/tests/misc_testsuite/component-model/async/partial-stream-copies.wast#L164">https://github.com/bytecodealliance/wasmtime/blob/main/tests/misc_testsuite/component-model/async/partial-stream-copies.wast#L164</a></p>
<p>Do we consider stability of those handles part of the ABI? </p>
</blockquote>



<a name="545572536"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545572536" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545572536">(Oct 17 2025 at 13:46)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350447941">PR review</a>.</p>



<a name="545572541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545572541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545572541">(Oct 17 2025 at 13:46)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440087654">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>Do we consider stability of those handles part of the ABI?</p>
</blockquote>
<p>The values of the handles should be a deterministic function of the specific instance's history (i.e. how many waitables, resources, etc. it creates, where some of those handles might be created implicitly).  The important thing is that the history of _other_ instances (e.g. instances the original instance is composed with) should not have any effect.</p>
<p>Whether that deterministic function must be stable across revisions of the component model specification is an interesting question.  In this case, we've added a feature that implicitly creates new handles, IIUC; in that case, it seems like we must update the deterministic function to account for that and not worry about maintaining stability before vs. after the feature was added.  @lukewagner may have thoughts.</p>
</blockquote>



<a name="545576669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545576669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545576669">(Oct 17 2025 at 14:05)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350531993">PR review</a>.</p>



<a name="545576670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545576670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545576670">(Oct 17 2025 at 14:05)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440150984">PR review comment</a>:</p>
<blockquote>
<p>That makes sense, although my understanding is that the handle value function cannot be entirely deterministic as elements of a specific instance's execution may be non-deterministic (e.g. scheduling of yielded threads), which may affect the order in which items are added to the instance table. But that's unrelated to your main point of other instances not affecting a specific instance's execution.</p>
<p>As a related question, I've seen movement elsewhere to move a lot of testing up into the component model specification testing suite, but things like this are testing for implementation details of wasmtime. Is the idea that we'll still have tests that ensure observable parts of the wasmtime implementation don't change, even if the spec doesn't have an opinion on them?</p>
</blockquote>



<a name="545579053"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545579053" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545579053">(Oct 17 2025 at 14:17)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350583919">PR review</a>.</p>



<a name="545579054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545579054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545579054">(Oct 17 2025 at 14:17)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440190932">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>my understanding is that the handle value function cannot be entirely deterministic as elements of a specific instance's execution may be non-deterministic (e.g. scheduling of yielded threads),</p>
</blockquote>
<p>Yes, good point.  I think <code>partial-stream-copies.wast</code> is an example of avoiding such non-determinism in order to reliably predict the values of handles, but you're right that that can't be done in general.</p>
<blockquote>
<p>Is the idea that we'll still have tests that ensure observable parts of the wasmtime implementation don't change, even if the spec doesn't have an opinion on them?</p>
</blockquote>
<p>Per <a href="https://github.com/WebAssembly/component-model/pull/513">https://github.com/WebAssembly/component-model/pull/513</a>, I think the spec _does_ have opinions about how handles are allocated, and I'd interpret e.g. <code>partial-stream-copies.wast</code> as testing behavior that's _not_ expected to vary across implementations.  I could be wrong about that, though.</p>
</blockquote>



<a name="545580214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545580214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545580214">(Oct 17 2025 at 14:22)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350604870">PR review</a>.</p>



<a name="545580215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545580215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545580215">(Oct 17 2025 at 14:22)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440206448">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>I think the spec does have opinions about how handles are allocated...</p>
</blockquote>
<p>Yep, I think you're right. I'll go ahead and update those tests, thanks!</p>
</blockquote>



<a name="545592669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545592669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545592669">(Oct 17 2025 at 15:16)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350802012">PR review</a>.</p>



<a name="545592671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545592671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545592671">(Oct 17 2025 at 15:16)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440358565">PR review comment</a>:</p>
<blockquote>
<p>@TartanLlama mind moving this function to <code>VMComponentConetxt</code> since that's generally where our <code>unsafe</code>-frobbing bits live? Also, would it be possible to return a <code>Func</code> from this function instead fo a <code>NonNull&lt;VMFuncRef&gt;</code>? That'd improve the safety of this function in the sense that it's more difficult to mis-use the return value too.</p>
<p>Otherwise though this function should itself be safe because there's no unsafe (e.g. raw pointer) parameters and the indices should all be checked internally.</p>
</blockquote>



<a name="545602351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545602351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545602351">(Oct 17 2025 at 15:50)</a>:</h4>
<p>lukewagner submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3350921799">PR review</a>.</p>



<a name="545602353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/545602353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#545602353">(Oct 17 2025 at 15:50)</a>:</h4>
<p>lukewagner created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2440449041">PR review comment</a>:</p>
<blockquote>
<p>It's a good question (and one that we should probably consider again as we move toward 1.0, b/c there's pros/cons each way) of if and how much nondeterminism the spec should allow regarding the allocation of handles.  But for now, yes, if you hold all the other nondeterministic (scheduling, et al) choices constant, handle allocation is indeed currently fully deterministic as specified by the Python "operational semantics" <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/CanonicalABI.md#table-state">here</a>.  That does mean that <a href="https://github.com/WebAssembly/component-model/pull/557">CM/#557</a> is technically a "breaking" change since it adds a new element (for the implicit thread created for each export call) to the instance's table even for existing code, but I expect it won't break anything in practice so I think we're fine.</p>
</blockquote>



<a name="546000644"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546000644" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546000644">(Oct 20 2025 at 14:49)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546000797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546000797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546000797">(Oct 20 2025 at 14:50)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3356782492">PR review</a>.</p>



<a name="546000801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546000801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546000801">(Oct 20 2025 at 14:50)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2445252718">PR review comment</a>:</p>
<blockquote>
<p>I've addressed this with this commit: <a href="https://github.com/bytecodealliance/wasmtime/pull/11751/commits/d01a51d1f8114e9d19aad82fd100f4e5d528f0d1">https://github.com/bytecodealliance/wasmtime/pull/11751/commits/d01a51d1f8114e9d19aad82fd100f4e5d528f0d1</a></p>
</blockquote>



<a name="546167376"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546167376" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546167376">(Oct 21 2025 at 08:06)</a>:</h4>
<p>TartanLlama <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3425317544">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>PR to update component model tests: <a href="https://github.com/WebAssembly/component-model/pull/570">https://github.com/WebAssembly/component-model/pull/570</a></p>
</blockquote>



<a name="546168242"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546168242" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546168242">(Oct 21 2025 at 08:10)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546174706"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546174706" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546174706">(Oct 21 2025 at 08:41)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546208579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546208579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546208579">(Oct 21 2025 at 11:30)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546210467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546210467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546210467">(Oct 21 2025 at 11:39)</a>:</h4>
<p>TartanLlama <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3426160201">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Test failures for upstream component model tests are awaiting this PR: <a href="https://github.com/WebAssembly/component-model/pull/570">https://github.com/WebAssembly/component-model/pull/570</a></p>
</blockquote>



<a name="546212374"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546212374" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546212374">(Oct 21 2025 at 11:46)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546212847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546212847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546212847">(Oct 21 2025 at 11:48)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<p>Submitting as a draft PR for now to share progress.</p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[x] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Match trap conditions with the spec</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
<p>prtest:full</p>
</blockquote>



<a name="546215308"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546215308" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546215308">(Oct 21 2025 at 11:58)</a>:</h4>
<p>TartanLlama deleted a <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3425317544">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>PR to update component model tests: <a href="https://github.com/WebAssembly/component-model/pull/570">https://github.com/WebAssembly/component-model/pull/570</a></p>
</blockquote>



<a name="546216751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546216751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546216751">(Oct 21 2025 at 12:03)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546233943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546233943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546233943">(Oct 21 2025 at 13:16)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546234444"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546234444" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546234444">(Oct 21 2025 at 13:18)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3360683072">PR review</a>.</p>



<a name="546234447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546234447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546234447">(Oct 21 2025 at 13:18)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2448239552">PR review comment</a>:</p>
<blockquote>
<p>I've moved it to <code>ComponentInstance</code> in <code>runtime/vm/component.rs</code>, as that seemed a better fit that <code>VMComponentContext</code>, but can move it there if you think that's wrong. I've also made it return a <code>Func</code> and be safe.</p>
</blockquote>



<a name="546234704"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546234704" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546234704">(Oct 21 2025 at 13:18)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546235219"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546235219" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546235219">(Oct 21 2025 at 13:20)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546270948"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546270948" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546270948">(Oct 21 2025 at 15:44)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361472481">PR review</a>.</p>



<a name="546270949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546270949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546270949">(Oct 21 2025 at 15:44)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2448828657">PR review comment</a>:</p>
<blockquote>
<p>This could be reverted to the old structure</p>
</blockquote>



<a name="546279702"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546279702" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546279702">(Oct 21 2025 at 16:25)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361642837">PR review</a>.</p>



<a name="546279715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546279715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546279715">(Oct 21 2025 at 16:25)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2448951962">PR review comment</a>:</p>
<blockquote>
<p>Rename <code>RemoveOnDrop</code> to something better</p>
</blockquote>



<a name="546280772"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546280772" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546280772">(Oct 21 2025 at 16:30)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361663559">PR review</a>.</p>



<a name="546280773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546280773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546280773">(Oct 21 2025 at 16:30)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2448966328">PR review comment</a>:</p>
<blockquote>
<p>Maybe change to <code>sync/async stackful</code></p>
</blockquote>



<a name="546283109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283109">(Oct 21 2025 at 16:42)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361715504">PR review</a>.</p>



<a name="546283112"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283112" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283112">(Oct 21 2025 at 16:42)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2448998718">PR review comment</a>:</p>
<blockquote>
<p>Factor out</p>
</blockquote>



<a name="546283330"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283330" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283330">(Oct 21 2025 at 16:43)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361721948">PR review</a>.</p>



<a name="546283331"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283331" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283331">(Oct 21 2025 at 16:43)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449004313">PR review comment</a>:</p>
<blockquote>
<p>Store this in case the func ref changes</p>
</blockquote>



<a name="546283368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283368">(Oct 21 2025 at 16:43)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361722967">PR review</a>.</p>



<a name="546283369"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546283369" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546283369">(Oct 21 2025 at 16:43)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449005002">PR review comment</a>:</p>
<blockquote>
<p>Use cached version</p>
</blockquote>



<a name="546284926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546284926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546284926">(Oct 21 2025 at 16:50)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361760619">PR review</a>.</p>



<a name="546284927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546284927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546284927">(Oct 21 2025 at 16:50)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449031504">PR review comment</a>:</p>
<blockquote>
<p>Create this closure inside <code>thread_new_indirect</code></p>
</blockquote>



<a name="546285368"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546285368" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546285368">(Oct 21 2025 at 16:52)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361770071">PR review</a>.</p>



<a name="546285370"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546285370" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546285370">(Oct 21 2025 at 16:52)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449038683">PR review comment</a>:</p>
<blockquote>
<p>Maybe factor out high_priority check as it's duplicated with above</p>
</blockquote>



<a name="546285953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546285953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546285953">(Oct 21 2025 at 16:55)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361782208">PR review</a>.</p>



<a name="546285955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546285955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546285955">(Oct 21 2025 at 16:55)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449047664">PR review comment</a>:</p>
<blockquote>
<p>Change to a <code>Result&lt;Something&gt;</code> where <code>Something</code> represents <code>Cancelled</code> or <code>NotCancelled</code></p>
</blockquote>



<a name="546287129"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546287129" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546287129">(Oct 21 2025 at 17:01)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361805156">PR review</a>.</p>



<a name="546287132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546287132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546287132">(Oct 21 2025 at 17:01)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449066434">PR review comment</a>:</p>
<blockquote>
<p>Maybe iterate once and check if the length has changed</p>
</blockquote>



<a name="546288604"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546288604" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546288604">(Oct 21 2025 at 17:08)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361833057">PR review</a>.</p>



<a name="546288606"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546288606" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546288606">(Oct 21 2025 at 17:08)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449088881">PR review comment</a>:</p>
<blockquote>
<p>Replace with an assertion</p>
</blockquote>



<a name="546288946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546288946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546288946">(Oct 21 2025 at 17:10)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3361840188">PR review</a>.</p>



<a name="546288949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546288949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546288949">(Oct 21 2025 at 17:10)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2449094590">PR review comment</a>:</p>
<blockquote>
<p>Change to <code>take_pending_cancellation</code></p>
</blockquote>



<a name="546407582"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546407582" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546407582">(Oct 22 2025 at 09:30)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3364656828">PR review</a>.</p>



<a name="546407584"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546407584" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546407584">(Oct 22 2025 at 09:30)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2451187049">PR review comment</a>:</p>
<blockquote>
<p>Converted to issue: <a href="https://github.com/bytecodealliance/wasmtime/issues/11908">https://github.com/bytecodealliance/wasmtime/issues/11908</a></p>
</blockquote>



<a name="546408140"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546408140" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546408140">(Oct 22 2025 at 09:33)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546408918"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546408918" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546408918">(Oct 22 2025 at 09:37)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546417352"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546417352" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546417352">(Oct 22 2025 at 10:19)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546420700"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546420700" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546420700">(Oct 22 2025 at 10:35)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546421318"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546421318" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546421318">(Oct 22 2025 at 10:38)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3365125333">PR review</a>.</p>



<a name="546421319"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546421319" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546421319">(Oct 22 2025 at 10:38)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2451570344">PR review comment</a>:</p>
<blockquote>
<p>@alexcrichton I forgot to go over this function in the call, but this is to where I moved that funcref extraction</p>
</blockquote>



<a name="546429453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546429453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546429453">(Oct 22 2025 at 11:17)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546430180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546430180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546430180">(Oct 22 2025 at 11:19)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546435039"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546435039" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546435039">(Oct 22 2025 at 11:40)</a>:</h4>
<p>TartanLlama <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3431950506">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Created issues #11910 #11909 #11908 to track deferred work </p>
</blockquote>



<a name="546435447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546435447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546435447">(Oct 22 2025 at 11:42)</a>:</h4>
<p>TartanLlama <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3431955979">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>@alexcrichton @dicej I think we're good to go. For CI to go green, we'd need to have <a href="https://github.com/WebAssembly/component-model/pull/570">https://github.com/WebAssembly/component-model/pull/570</a> and <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a> merged into the component model repo. What do we think about getting them merged soon @lukewagner ?</p>
</blockquote>



<a name="546479954"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479954" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479954">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452392533">PR review comment</a>:</p>
<blockquote>
<p>For these two errors, the error message will want to be updated silghtly -- <code>Ok(None)</code> means that a null funcref was loaded, which technically should be plumbed to the caller as a <code>Result&lt;Option&lt;Func&gt;&gt;</code> return value from this function. (or document the function as "returns an error on null funcref values"). The second error, <code>Err(e)</code>, is the out-of-bounds error and it should be fine to use <code>?</code> on the <code>get_func</code> expression to avoid having to deal with it in the <code>match</code></p>
</blockquote>



<a name="546479955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479955">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452385947">PR review comment</a>:</p>
<blockquote>
<p>Mind using <code>Instance::from_vmctx</code> instead of a manual <code>byte_sub</code>? (that function came into existence after you wrote this I suspect)</p>
</blockquote>



<a name="546479956"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479956" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479956">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452381626">PR review comment</a>:</p>
<blockquote>
<p>For some style here, instead of using <code>?</code> and/or <code>Err(anyhow!(...))</code> you can use <code>bail!(...)</code> in the error cases</p>
</blockquote>



<a name="546479958"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479958" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479958">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3366188744">PR review</a>:</p>
<blockquote>
<p>You can also feel free to update this function -- <a href="https://github.com/bytecodealliance/wasmtime/blob/710ba4bbf33e02f681eeada012ffa081b8d20588/crates/test-util/src/wast.rs#L404">https://github.com/bytecodealliance/wasmtime/blob/710ba4bbf33e02f681eeada012ffa081b8d20588/crates/test-util/src/wast.rs#L404</a> -- to avoid blocking on PRs and go ahead and land this with known-failing tests</p>
</blockquote>



<a name="546479961"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479961" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479961">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452383676">PR review comment</a>:</p>
<blockquote>
<p>Instead of passing in <code>&amp;VMTableImport</code> could this pass in a <code>RuntimeTableIndex</code> or similar? Otherwise this function needs to be <code>unsafe</code> because any table value could be passed in with invalid pointers.</p>
</blockquote>



<a name="546479962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546479962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546479962">(Oct 22 2025 at 14:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452395823">PR review comment</a>:</p>
<blockquote>
<p>I might recommend using <code>offsets.ptr.vmtable_import_{vmctx,from}()</code> here to avoid the clippy lint</p>
</blockquote>



<a name="546499778"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546499778" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546499778">(Oct 22 2025 at 16:14)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3366540192">PR review</a>.</p>



<a name="546502007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546502007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546502007">(Oct 22 2025 at 16:25)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3366577398">PR review</a>.</p>



<a name="546502010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546502010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546502010">(Oct 22 2025 at 16:25)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452656485">PR review comment</a>:</p>
<blockquote>
<p>In that case is the documentation of <code>get_func</code> wrong? Current:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="sd">/// Get reference to the specified element.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// Returns `None` if the index is out of bounds.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// Panics if this is a table of GC references and `gc_store` is `None`.</span>
</code></pre></div>
<p>Should this instead be: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="sd">/// Get reference to the specified element.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// Returns `Ok(None)` if the element is null.</span>
<span class="w">    </span><span class="sd">/// Returns `Err` if the index is out of bounds.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// Panics if this is a table of GC references and `gc_store` is `None`.</span>
</code></pre></div>
</blockquote>



<a name="546505560"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546505560" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546505560">(Oct 22 2025 at 16:44)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452703956">PR review comment</a>:</p>
<blockquote>
<p>Ah yes good point! That is indeed outdated documentation, and your proposed docs are more accurate. The only other thing we should add is:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="sd">/// Returns `Ok(None)` if the element is null or uninitialized.</span>
</code></pre></div>
<p>Since <code>Ok(None)</code> happens for lazy-init tables where the elem hasn't been init'd yet</p>
</blockquote>



<a name="546505563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546505563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546505563">(Oct 22 2025 at 16:44)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3366640395">PR review</a>.</p>



<a name="546507178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546507178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546507178">(Oct 22 2025 at 16:54)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3366671571">PR review</a>.</p>



<a name="546507180"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546507180" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546507180">(Oct 22 2025 at 16:54)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2452728618">PR review comment</a>:</p>
<blockquote>
<p>Cool cool, I'll roll that into this PR</p>
</blockquote>



<a name="546623100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546623100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546623100">(Oct 23 2025 at 08:49)</a>:</h4>
<p>TartanLlama submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3368864402">PR review</a>.</p>



<a name="546623101"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546623101" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546623101">(Oct 23 2025 at 08:49)</a>:</h4>
<p>TartanLlama created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2454391659">PR review comment</a>:</p>
<blockquote>
<p>Hm, that seems to be a function on <code>VMOffsets</code> rather than <code>PtrSize</code>, and I think I'd need to pick a module to create a <code>VMOffsets</code></p>
</blockquote>



<a name="546624051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546624051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546624051">(Oct 23 2025 at 08:53)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546625494"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546625494" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546625494">(Oct 23 2025 at 09:00)</a>:</h4>
<p>TartanLlama updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>.</p>



<a name="546627787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546627787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546627787">(Oct 23 2025 at 09:10)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3435877960">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>@TartanLlama That is fantastic to hear!  I merged CM/#557.  Do you suppose you could post a note on CM/#570 noting that it has been implemented and you think it's good to merge?</p>
</blockquote>



<a name="546628031"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546628031" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546628031">(Oct 23 2025 at 09:11)</a>:</h4>
<p>lukewagner edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#issuecomment-3435877960">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>@TartanLlama That is fantastic to hear!  I merged <a href="https://github.com/WebAssembly/component-model/pull/570">CM/#570</a>.  Do you suppose you could post a note on <a href="https://github.com/WebAssembly/component-model/pull/557">CM/#557</a> noting that it has been implemented and you think it's good to merge?</p>
</blockquote>



<a name="546628632"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546628632" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546628632">(Oct 23 2025 at 09:14)</a>:</h4>
<p>TartanLlama edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11751">PR #11751</a>:</p>
<blockquote>
<p>Implements <a href="https://github.com/WebAssembly/component-model/pull/557">https://github.com/WebAssembly/component-model/pull/557</a></p>
<ul>
<li>[x] Pass through all new builtins</li>
<li>[x] Basic implementations of new builtins</li>
<li>[x] Cancellation support</li>
<li>[x] Support for explicit threads continuing after the implicit thread has exited</li>
<li>[ ] Match trap conditions with the spec (deferred)</li>
<li>[x] Insert threads into the instance table rather than holding them inside <code>GuestTask</code></li>
<li>[x] Don't reuse the existing <code>GuestCall</code> functionality for new threads</li>
<li>[ ] Testing (partially implemented, further testing deferred)</li>
<li>[X] Revert changes to the <code>component_model_async_builtins</code> and <code>component_model_async_stackful</code> features</li>
</ul>
<p>prtest:full</p>
</blockquote>



<a name="546700132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546700132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546700132">(Oct 23 2025 at 14:45)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3370339988">PR review</a>.</p>



<a name="546700137"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546700137" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546700137">(Oct 23 2025 at 14:45)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2455401700">PR review comment</a>:</p>
<blockquote>
<p>Ah ok good point!</p>
</blockquote>



<a name="546753641"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546753641" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546753641">(Oct 23 2025 at 19:20)</a>:</h4>
<p>posborne submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3372153291">PR review</a>.</p>



<a name="546753643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546753643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546753643">(Oct 23 2025 at 19:20)</a>:</h4>
<p>posborne created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2456891791">PR review comment</a>:</p>
<blockquote>
<p>Looks like <a href="https://github.com/WebAssembly/component-model/pull/570">https://github.com/WebAssembly/component-model/pull/570</a> has now merged.</p>
</blockquote>



<a name="546755787"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546755787" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546755787">(Oct 23 2025 at 19:33)</a>:</h4>
<p>posborne submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3372217773">PR review</a>.</p>



<a name="546755788"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546755788" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546755788">(Oct 23 2025 at 19:33)</a>:</h4>
<p>posborne created <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#discussion_r2456952368">PR review comment</a>:</p>
<blockquote>
<p>In other callsites here, access to thread state (e.g. <code>state.get_mut(t.thread)</code>) is done fallibly.  May be worth making this consistent unless we are more confident of state presence for this specific case.</p>
<p>E.g.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">ot</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">old_thread</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">state</span><span class="p">.</span><span class="n">get_mut</span><span class="p">(</span><span class="n">ot</span><span class="p">.</span><span class="n">thread</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GuestThreadState</span><span class="p">::</span><span class="n">Running</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="546758899"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311751%20Cooperative%20Multithreading/near/546758899" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311751.20Cooperative.20Multithreading.html#546758899">(Oct 23 2025 at 19:53)</a>:</h4>
<p>posborne submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11751#pullrequestreview-3372322823">PR review</a>:</p>
<blockquote>
<p>Left a couple freestanding comments, but they are minor and can probably be deferred if relevant.</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>