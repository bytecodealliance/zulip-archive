<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10249 Initial implementation of Wasi-tls (... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html">wasmtime / PR #10249 Initial implementation of Wasi-tls (...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="500764342"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500764342" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500764342">(Feb 19 2025 at 23:40)</a>:</h4>
<p>jsturtevant opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a> from <code>jsturtevant:wasi-tls-initial</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
fixes: <a href="https://github.com/bytecodealliance/wasmtime/issues/10089">https://github.com/bytecodealliance/wasmtime/issues/10089</a></p>
<p>This adds a crate that provides the Wasmtime host implementation for the <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> API.<br>
The <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> world allows WebAssembly modules to perform SSL/TLS operations,<br>
such as establishing secure connections to servers. </p>
<p>This initially implements it with rustls which was already included in the repository.</p>
<p>There are a few items that still need to be resolved but are not specially related to the implementation but wanted to start the review to make sure things moving in the correct direction.</p>
<ul>
<li>add a <code>close-notify</code> function to the wasi-tls wit in the proposal to properly close down the </li>
<li>resolve importing stable types into unstable features (<a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a>). Write now I have a workaround on a branch that is being used in rust cargo patch.</li>
</ul>
<p>Thanks goes out to @badeend  and @dicej as much of this was based on their prior work.  </p>
</blockquote>



<a name="500764344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500764344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500764344">(Feb 19 2025 at 23:40)</a>:</h4>
<p><strong>jsturtevant</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="500764345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500764345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500764345">(Feb 19 2025 at 23:40)</a>:</h4>
<p><strong>jsturtevant</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="500764346"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500764346" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500764346">(Feb 19 2025 at 23:40)</a>:</h4>
<p><strong>jsturtevant</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="500772019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500772019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500772019">(Feb 20 2025 at 00:54)</a>:</h4>
<p>jsturtevant edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
fixes: <a href="https://github.com/bytecodealliance/wasmtime/issues/10089">https://github.com/bytecodealliance/wasmtime/issues/10089</a></p>
<p>This adds a crate that provides the Wasmtime host implementation for the <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> API.<br>
The <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> world allows WebAssembly modules to perform SSL/TLS operations,<br>
such as establishing secure connections to servers. </p>
<p>This initially implements it with rustls which was already included in the repository.</p>
<p>There are a few items that still need to be resolved but are not specially related to the implementation but wanted to start the review to make sure things moving in the correct direction.</p>
<ul>
<li>add a <code>close-notify</code> function to the wasi-tls wit in the proposal to properly close down the <a href="https://github.com/WebAssembly/wasi-tls/pull/5">https://github.com/WebAssembly/wasi-tls/pull/5</a> </li>
<li>resolve importing stable types into unstable features (<a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a>). Write now I have a workaround on a branch that is being used in rust cargo patch.</li>
</ul>
<p>Thanks goes out to @badeend  and @dicej as much of this was based on their prior work.  </p>
</blockquote>



<a name="500828337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828337">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2670879920">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>Looking great!</p>
<p>CI fails because Clippy being Clippy, and I suspect the build fails because there's some missing conditional compilation.</p>
<p>Aside from that, I;ve left behind some remarks:<br>
</p>
</blockquote>



<a name="500828379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828379">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2629062784">PR review</a>.</p>



<a name="500828380"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828380" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828380">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1963123232">PR review comment</a>:</p>
<blockquote>
<p>Looks like left-over test code</p>
</blockquote>



<a name="500828381"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828381" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828381">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1963106552">PR review comment</a>:</p>
<blockquote>
<p>Regarding this <code>impl AsyncWrite for TcpStreams</code> block and the <code>impl AsyncRead for TcpStreams</code> block below: I'm fine with them existing here, but AFAIK these have nothing to do with TLS right? If so, we could move them into the <a href="https://github.com/bytecodealliance/wasmtime/tree/main/crates/wasi-io/src">wasi-io</a> subcrate at some point.</p>
</blockquote>



<a name="500828382"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828382" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828382">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1963075276">PR review comment</a>:</p>
<blockquote>
<p>Might be nice to rename references to the term "TCP" within this file to something more generic. Since this TLS implementation doesn't actually depend on TCP, and the inner streams may come from anywhere.</p>
</blockquote>



<a name="500828383"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500828383" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500828383">(Feb 20 2025 at 09:10)</a>:</h4>
<p>badeend created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1963088490">PR review comment</a>:</p>
<blockquote>
<p>I don't think this is cancel-safe. If the <code>.await</code> is canceled, the streamState will be left behind in the <code>Closed</code> state forever. Cancellation may happen when waiting for <a href="https://github.com/WebAssembly/wasi-io/blob/main/wit/poll.wit#L46">multiple Pollables</a> at once.</p>
</blockquote>



<a name="500931610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500931610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500931610">(Feb 20 2025 at 17:15)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2630641585">PR review</a>.</p>



<a name="500931611"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500931611" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500931611">(Feb 20 2025 at 17:15)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964040334">PR review comment</a>:</p>
<blockquote>
<p>The reason for this being the wit file directly is <a href="https://github.com/bytecodealliance/wasm-tools/issues/1996#issuecomment-2640748051">https://github.com/bytecodealliance/wasm-tools/issues/1996#issuecomment-2640748051</a></p>
</blockquote>



<a name="500931875"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500931875" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500931875">(Feb 20 2025 at 17:16)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2630643585">PR review</a>.</p>



<a name="500931876"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500931876" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500931876">(Feb 20 2025 at 17:16)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964041510">PR review comment</a>:</p>
<blockquote>
<p>this branch contains the temp fix for <a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a></p>
</blockquote>



<a name="500934810"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500934810" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500934810">(Feb 20 2025 at 17:31)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2630680688">PR review</a>.</p>



<a name="500934812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500934812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500934812">(Feb 20 2025 at 17:31)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964063083">PR review comment</a>:</p>
<blockquote>
<p>correct, not specific to TLS it just enables passing wasi-io streams to libraries that require those traits (i.e. in this case the <code>connect()</code> method for rustls)</p>
</blockquote>



<a name="500936434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500936434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500936434">(Feb 20 2025 at 17:41)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2630701964">PR review</a>.</p>



<a name="500936435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500936435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500936435">(Feb 20 2025 at 17:41)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964075830">PR review comment</a>:</p>
<blockquote>
<p>Will take a look, is there an example of how to test that?</p>
</blockquote>



<a name="500940282"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500940282" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500940282">(Feb 20 2025 at 18:02)</a>:</h4>
<p>badeend submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2630751228">PR review</a>.</p>



<a name="500940285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500940285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500940285">(Feb 20 2025 at 18:02)</a>:</h4>
<p>badeend created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964105631">PR review comment</a>:</p>
<blockquote>
<p>To reproduce, you could try adjusting the timeout of <code>blocking_finish</code> in <code>crates/test-programs/src/tls.rs</code> to something non-0, but very small, so that both pollables are polled at least once, but the monotonic_clock pollable will finish first. After that, I suspect that the ClientHandshake::finish pollable will never resolve.</p>
</blockquote>



<a name="500983451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500983451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500983451">(Feb 20 2025 at 22:42)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="500983503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500983503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500983503">(Feb 20 2025 at 22:43)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2631339354">PR review</a>.</p>



<a name="500983504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500983504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500983504">(Feb 20 2025 at 22:43)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964449294">PR review comment</a>:</p>
<blockquote>
<p>updated</p>
</blockquote>



<a name="500985683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500985683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500985683">(Feb 20 2025 at 22:59)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2631378244">PR review</a>.</p>



<a name="500985684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/500985684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#500985684">(Feb 20 2025 at 22:59)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964474634">PR review comment</a>:</p>
<blockquote>
<p>you are indeed correct.  </p>
</blockquote>



<a name="501001465"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501001465" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501001465">(Feb 21 2025 at 01:16)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="501001562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501001562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501001562">(Feb 21 2025 at 01:17)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2631592353">PR review</a>.</p>



<a name="501001563"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501001563" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501001563">(Feb 21 2025 at 01:17)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964601955">PR review comment</a>:</p>
<blockquote>
<p>I've pushed an update for this, I tested it locally but working getting a test written for this scenario</p>
</blockquote>



<a name="501001652"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501001652" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501001652">(Feb 21 2025 at 01:18)</a>:</h4>
<p>jsturtevant edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1964601955">PR review comment</a>.</p>



<a name="501187051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501187051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501187051">(Feb 21 2025 at 21:06)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="501188483"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501188483" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501188483">(Feb 21 2025 at 21:17)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="501191962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501191962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501191962">(Feb 21 2025 at 21:44)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2634336938">PR review</a>.</p>



<a name="501191963"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501191963" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501191963">(Feb 21 2025 at 21:44)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1966238652">PR review comment</a>:</p>
<blockquote>
<p>added test that covers this in <a href="https://github.com/bytecodealliance/wasmtime/pull/10249/commits/f13938ee922ef11f1893957d77465d46ae442c14">https://github.com/bytecodealliance/wasmtime/pull/10249/commits/f13938ee922ef11f1893957d77465d46ae442c14</a></p>
</blockquote>



<a name="501658540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501658540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501658540">(Feb 24 2025 at 22:09)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2638543243">PR review</a>:</p>
<blockquote>
<p>This looks great to me <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
<p>In terms of testing, would it be possible to also add a test (or multiple) that deal with the server-side as well. Ideally there'd either be a pre-generated cert check-in to the repo that they use or something generated at test-time perhaps per-test. That might help enable removing the dependency on <code>example.com</code> as well which has been flaky in the past, and while it's not the end of the world to have some flakiness it'd be best to insulate ourselves and have all the networking be purely local. Although I realize it's also good to test "is the system cert store actually used?" which necessarily requires external communication basially.</p>
<p>It might also be interesting, if local certs work, to test a variety of configurations related to invalid certificates to ensure that they do indeed all return an error instead of succeeding the authentication and such.</p>
</blockquote>



<a name="501658541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501658541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501658541">(Feb 24 2025 at 22:09)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1968477633">PR review comment</a>:</p>
<blockquote>
<p>For this I might recommend adding a commit with <code>prtest:full</code> somewhere in the commit message to ensure that this can get past CI. I vaguely recall that rustls and/or ring and/or something doesn't compile on riscv64/s390x, hence the conditional here. That'll make the integration of <code>wasmtime-wasi-tls</code> into the CLI a bit hairier if so, but probably still workable.</p>
</blockquote>



<a name="501886815"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501886815" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501886815">(Feb 25 2025 at 18:51)</a>:</h4>
<p>jsturtevant <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2682979493">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<blockquote>
<p>In terms of testing, would it be possible to also add a test (or multiple) that deal with the server-side as well.</p>
</blockquote>
<p>Just to clarify, you mean to implement a server similar to what is done on <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/wasi-http/tests/all/http_server.rs">wasi-http</a> but with certs?  We are going to need this for more advance scenarios later so works for me.  I'll get started on it here</p>
</blockquote>



<a name="501887840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501887840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501887840">(Feb 25 2025 at 18:57)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2682991289">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>That's one route yeah, another being something similar to <a href="https://github.com/bytecodealliance/wasmtime/blob/2ad3bea6ae1762eb5491051a425fcb8ff881811e/crates/test-programs/src/bin/preview2_tcp_streams.rs#L134-L157">what wasi-sockets does</a> where the client/server are both purely in-wasm and doens't require any external integration. The latter is a bit nicer from a "share this test suite in more places" perspective as well, but regardless I think either way is fine in the long run</p>
</blockquote>



<a name="501918138"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501918138" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501918138">(Feb 25 2025 at 22:03)</a>:</h4>
<p>jsturtevant <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2683396053">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>sounds good. We didn't add the server side parts to the wasi-tls spec yet but it shouldn't be to hard to do a minimal version as well now that the client side is done.  @badeend wdyt?</p>
</blockquote>



<a name="501918453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/501918453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#501918453">(Feb 25 2025 at 22:05)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2683400135">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>Oh I didn't look too closely at the tls bits here but if the server parts aren't implemented yet I don't mean to add more work here, so I think it's totally reasonable to land without that and plan to add more tests later too.</p>
</blockquote>



<a name="502089098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502089098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502089098">(Feb 26 2025 at 16:24)</a>:</h4>
<p>badeend <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2685561717">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>I'd prefer not to block this PR on the creation of server TLS connections from within a WASI guest. Creating server TLS connections brings along additional design complexity surrounding the handling of certificates &amp; private keys from within a WASI guest.</p>
<p>If the goal is to reduce CI flakiness, we could also spin up a local TCP/TLS listener socket outside the guest, just before calling the test, and then connect to that from within the guest test.</p>
</blockquote>



<a name="502132800"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502132800" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502132800">(Feb 26 2025 at 19:58)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2686059075">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>I think let's focus on getting this initial set landed in-tree for now (aka landing the wasm-tools fixes and integrating that here). This'll be a bit flaky without a local server but that can be a follow-up item to do after landing.</p>
</blockquote>



<a name="502676665"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502676665" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502676665">(Feb 28 2025 at 22:18)</a>:</h4>
<p>jsturtevant edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
fixes: <a href="https://github.com/bytecodealliance/wasmtime/issues/10089">https://github.com/bytecodealliance/wasmtime/issues/10089</a></p>
<p>This adds a crate that provides the Wasmtime host implementation for the <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> API.<br>
The <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> world allows WebAssembly modules to perform SSL/TLS operations,<br>
such as establishing secure connections to servers. </p>
<p>This initially implements it with rustls which was already included in the repository.</p>
<p>There are a few items that still need to be resolved but are not specially related to the implementation but wanted to start the review to make sure things moving in the correct direction.</p>
<ul>
<li>[ ] add a <code>close-notify</code> function to the wasi-tls wit in the proposal to properly close down the <a href="https://github.com/WebAssembly/wasi-tls/pull/5">https://github.com/WebAssembly/wasi-tls/pull/5</a> </li>
<li>[ ] resolve importing stable types into unstable features (<a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a>). Write now I have a workaround on a branch that is being used in rust cargo patch.</li>
</ul>
<p>Thanks goes out to @badeend  and @dicej as much of this was based on their prior work.  </p>
</blockquote>



<a name="502676670"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502676670" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502676670">(Feb 28 2025 at 22:18)</a>:</h4>
<p>jsturtevant edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
fixes: <a href="https://github.com/bytecodealliance/wasmtime/issues/10089">https://github.com/bytecodealliance/wasmtime/issues/10089</a></p>
<p>This adds a crate that provides the Wasmtime host implementation for the <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> API.<br>
The <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> world allows WebAssembly modules to perform SSL/TLS operations,<br>
such as establishing secure connections to servers. </p>
<p>This initially implements it with rustls which was already included in the repository.</p>
<p>There are a few items that still need to be resolved but are not specially related to the implementation but wanted to start the review to make sure things moving in the correct direction.</p>
<ul>
<li>[ ] add a <code>close-notify</code> function to the wasi-tls wit in the proposal to properly close down the <a href="https://github.com/WebAssembly/wasi-tls/pull/5">https://github.com/WebAssembly/wasi-tls/pull/5</a> </li>
<li>[x] resolve importing stable types into unstable features (<a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a>). Write now I have a workaround on a branch that is being used in rust cargo patch.</li>
</ul>
<p>Thanks goes out to @badeend  and @dicej as much of this was based on their prior work.  </p>
</blockquote>



<a name="502678125"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502678125" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502678125">(Feb 28 2025 at 22:30)</a>:</h4>
<p>jsturtevant <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2691656005">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<blockquote>
<p>(aka landing the wasm-tools fixes and integrating that here).</p>
</blockquote>
<p>I tried pulling the fix  (<a href="https://github.com/bytecodealliance/wasm-tools/pull/2076">https://github.com/bytecodealliance/wasm-tools/pull/2076</a>) in from the main branch but looks like due to <a href="https://github.com/bytecodealliance/wasm-tools/pull/2073">https://github.com/bytecodealliance/wasm-tools/pull/2073</a>, there were a few missing cases that need to be added to wit-bindgen and here.  Would it be helpful to open PR's to stub those out or is there work being done on them?  No rush/pressure, just want to be helpful if I can.</p>
</blockquote>



<a name="502678945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502678945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502678945">(Feb 28 2025 at 22:37)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="502679701"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502679701" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502679701">(Feb 28 2025 at 22:44)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2691670574">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>Good point! I started the update a few days ago but didn't publish it -- <a href="https://github.com/bytecodealliance/wasmtime/pull/10314">https://github.com/bytecodealliance/wasmtime/pull/10314</a> -- I'll work on landing that once all the wasm-tools changes are in, but if you want to rebase on that it can give a preview of what things are likely to look like</p>
</blockquote>



<a name="502688270"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502688270" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502688270">(Mar 01 2025 at 00:07)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="502690193"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502690193" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502690193">(Mar 01 2025 at 00:27)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="502690799"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502690799" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502690799">(Mar 01 2025 at 00:34)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="502691980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502691980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502691980">(Mar 01 2025 at 00:48)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="502693897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502693897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502693897">(Mar 01 2025 at 01:08)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2652070275">PR review</a>.</p>



<a name="502693898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/502693898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#502693898">(Mar 01 2025 at 01:08)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1976194190">PR review comment</a>:</p>
<blockquote>
<p>made some updates to address this.  but now getting <code>register mapping is currently only implemented for x86_64</code> on some of the other platforms which I were working previously.  I am not sure what this means yet, as I wouldn't have expected the changes to make a difference.</p>
</blockquote>



<a name="503121839"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503121839" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503121839">(Mar 03 2025 at 20:56)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503130435"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503130435" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503130435">(Mar 03 2025 at 21:49)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503134860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503134860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503134860">(Mar 03 2025 at 22:17)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503136986"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503136986" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503136986">(Mar 03 2025 at 22:32)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2655501577">PR review</a>.</p>



<a name="503136987"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503136987" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503136987">(Mar 03 2025 at 22:32)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1978335235">PR review comment</a>:</p>
<blockquote>
<p>Looked a bit more at this. It wasn't passing prior to my changes.  I am not sure what causes this, if it is expected, or how to debug it.</p>
<p>@alexcrichton could you give me a pointer to what might be going wrong here?</p>
</blockquote>



<a name="503298436"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503298436" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503298436">(Mar 04 2025 at 15:34)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2658026040">PR review</a>.</p>



<a name="503298437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503298437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503298437">(Mar 04 2025 at 15:34)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1979701463">PR review comment</a>:</p>
<blockquote>
<p>Ah that's a bad error, but it bottoms out in <code>config.debug_info(true);</code> which isn't supported on Pulley. I'll go try and improve that error.</p>
</blockquote>



<a name="503352791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503352791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503352791">(Mar 04 2025 at 19:59)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503357285"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503357285" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503357285">(Mar 04 2025 at 20:23)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2658905004">PR review</a>.</p>



<a name="503357286"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503357286" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503357286">(Mar 04 2025 at 20:23)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1980178123">PR review comment</a>:</p>
<blockquote>
<p>Thanks! Removing that line fixed the issue.  </p>
</blockquote>



<a name="503357590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503357590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503357590">(Mar 04 2025 at 20:25)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503903351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503903351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503903351">(Mar 06 2025 at 22:28)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="503903505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503903505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503903505">(Mar 06 2025 at 22:29)</a>:</h4>
<p>jsturtevant submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2665776886">PR review</a>.</p>



<a name="503903506"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503903506" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503903506">(Mar 06 2025 at 22:29)</a>:</h4>
<p>jsturtevant created <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#discussion_r1984137987">PR review comment</a>:</p>
<blockquote>
<p>fixed in <a href="https://github.com/bytecodealliance/wasm-tools/releases/tag/v1.227.0">https://github.com/bytecodealliance/wasm-tools/releases/tag/v1.227.0</a></p>
</blockquote>



<a name="503904016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/503904016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#503904016">(Mar 06 2025 at 22:32)</a>:</h4>
<p>jsturtevant edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
fixes: <a href="https://github.com/bytecodealliance/wasmtime/issues/10089">https://github.com/bytecodealliance/wasmtime/issues/10089</a></p>
<p>This adds a crate that provides the Wasmtime host implementation for the <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> API.<br>
The <a href="https://github.com/WebAssembly/wasi-tls">wasi-tls</a> world allows WebAssembly modules to perform SSL/TLS operations,<br>
such as establishing secure connections to servers. </p>
<p>This initially implements it with rustls which was already included in the repository.</p>
<p>There are a few items that still need to be resolved but are not specially related to the implementation but wanted to start the review to make sure things moving in the correct direction.</p>
<ul>
<li>[x] add a <code>close-notify</code> function to the wasi-tls wit in the proposal to properly close down the <a href="https://github.com/WebAssembly/wasi-tls/pull/5">https://github.com/WebAssembly/wasi-tls/pull/5</a> </li>
<li>[x] resolve importing stable types into unstable features (<a href="https://github.com/bytecodealliance/wasm-tools/issues/1995">https://github.com/bytecodealliance/wasm-tools/issues/1995</a>). Write now I have a workaround on a branch that is being used in rust cargo patch.</li>
</ul>
<p>Thanks goes out to @badeend  and @dicej as much of this was based on their prior work.  </p>
</blockquote>



<a name="504140132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504140132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504140132">(Mar 07 2025 at 16:55)</a>:</h4>
<p>jsturtevant updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504151002"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504151002" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504151002">(Mar 07 2025 at 17:54)</a>:</h4>
<p>jsturtevant <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#issuecomment-2707063554">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>:</p>
<blockquote>
<p>@badeend @alexcrichton We've merged all the outstand issues and I've rebased to bring in all the changes.  I think this is ready for a final review. Thanks!</p>
</blockquote>



<a name="504155101"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504155101" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504155101">(Mar 07 2025 at 18:15)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504155268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504155268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504155268">(Mar 07 2025 at 18:16)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10249#pullrequestreview-2667993651">PR review</a>:</p>
<blockquote>
<p>I pushed a fix for the CI failure, and I double-checked and it looks like everything might actually work on s390x/riscv64 nowadays so I've updated to drop all the #[cfg] related to that. Otherwise looks good <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> </p>
</blockquote>



<a name="504155288"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504155288" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504155288">(Mar 07 2025 at 18:16)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504159625"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504159625" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504159625">(Mar 07 2025 at 18:38)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504165855"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504165855" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504165855">(Mar 07 2025 at 19:10)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504165871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504165871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504165871">(Mar 07 2025 at 19:10)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<a name="504172762"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310249%20Initial%20implementation%20of%20Wasi-tls%20%28.../near/504172762" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310249.20Initial.20implementation.20of.20Wasi-tls.20.28.2E.2E.2E.html#504172762">(Mar 07 2025 at 19:50)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10249">PR #10249</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>