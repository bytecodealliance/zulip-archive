<html>
<head><meta charset="utf-8"><title>wasmtime / issue #11849 Build via C/API via cargo fails t... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html">wasmtime / issue #11849 Build via C/API via cargo fails t...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="544693856"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544693856" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544693856">(Oct 14 2025 at 08:55)</a>:</h4>
<p>adv-sw edited <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Could build the host project in here, but it's not necessary - issue is build system missing an entry.<br>
<a href="http://advance-software.com/misc/test_breakpoint.zip">http://advance-software.com/misc/test_breakpoint.zip</a></p>
<h3>Steps to Reproduce</h3>
<p>Pull clear tree or delete target directory from your current one.<br>
cargo build -p wasmtime-c-api --release</p>
<h3>Expected Results</h3>
<p>wasm C API apps build</p>
<h3>Actual Results</h3>
<p>wasmtime\crates\c-api\include\wasi.h(12,10): error C1083: Cannot open include file: 'wasmtime/conf.h': No such file or directory</p>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: trunk</p>
<p>Operating system: Windows</p>
<p>Architecture: x86-64</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?</p>
<p>Expect this is generated correctly when cmake is used as <a href="http://conf.h.in">conf.h.in</a> file is present.</p>
</blockquote>



<a name="544795473"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544795473" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544795473">(Oct 14 2025 at 16:36)</a>:</h4>
<p>cfallin closed <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<h3>Test Case</h3>
<p>Could build the host project in here, but it's not necessary - issue is build system missing an entry.<br>
<a href="http://advance-software.com/misc/test_breakpoint.zip">http://advance-software.com/misc/test_breakpoint.zip</a></p>
<h3>Steps to Reproduce</h3>
<p>Pull clear tree or delete target directory from your current one.<br>
cargo build -p wasmtime-c-api --release</p>
<h3>Expected Results</h3>
<p>wasm C API apps build</p>
<h3>Actual Results</h3>
<p>wasmtime\crates\c-api\include\wasi.h(12,10): error C1083: Cannot open include file: 'wasmtime/conf.h': No such file or directory</p>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: trunk</p>
<p>Operating system: Windows</p>
<p>Architecture: x86-64</p>
<h3>Extra Info</h3>
<p>Anything else you'd like to add?</p>
<p>Expect this is generated correctly when cmake is used as <a href="http://conf.h.in">conf.h.in</a> file is present.</p>
</blockquote>



<a name="544795475"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544795475" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544795475">(Oct 14 2025 at 16:36)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/11849#issuecomment-3402745266">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<p>Please see the documentation <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/c-api/README.md#building-wasmtimes-cc-api-from-source">here</a> in the README for c-api, which is also linked from our <a href="https://docs.wasmtime.dev/contributing-building.html">documentation on building Wasmtime</a>:</p>
<blockquote>
<p>To use Wasmtime from a C or C++ project, you must have <a href="https://cmake.org/">CMake</a> and <a href="https://www.rust-lang.org/tools/install">a Rust toolchain</a> installed.</p>
<p>From the root of the Wasmtime repository, run the following commands:<br>
<code>
$ cmake -S crates/c-api -B target/c-api --install-prefix "$(pwd)/artifacts"
$ cmake --build target/c-api
$ cmake --install target/c-api
</code></p>
</blockquote>
<p>In other words, using the C API requires building with CMake. Thus, this is working as intended, and I will close the issue.<br>
</p>
</blockquote>



<a name="544819387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544819387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544819387">(Oct 14 2025 at 19:08)</a>:</h4>
<p>adv-sw <a href="https://github.com/bytecodealliance/wasmtime/issues/11849#issuecomment-3403222053">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<p>Seems unnecessarily complex. cmake to convert a whole 1 header file which could just be shipped as is with sensible defaults.</p>
</blockquote>



<a name="544819955"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544819955" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544819955">(Oct 14 2025 at 19:12)</a>:</h4>
<p>adv-sw edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/11849#issuecomment-3403222053">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<p>Seems unnecessarily complex. cmake to convert a whole 1 header file which could just be shipped as is with sensible defaults.</p>
<p>from the root : cargo build -p wasmtime-c-api</p>
<p>works fine with the exception of that one header file.</p>
</blockquote>



<a name="544820250"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544820250" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544820250">(Oct 14 2025 at 19:14)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/11849#issuecomment-3403238867">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<p>Cmake isn't just used for the header file, but also to build a proper C dynamic library with rpath on ELF, correct install name on macOS, and in case of building it a static library it helps with telling the linker to link all necessary system libraries. </p>
</blockquote>



<a name="544821549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311849%20Build%20via%20C/API%20via%20cargo%20fails%20t.../near/544821549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311849.20Build.20via.20C.2FAPI.20via.20cargo.20fails.20t.2E.2E.2E.html#544821549">(Oct 14 2025 at 19:22)</a>:</h4>
<p>adv-sw <a href="https://github.com/bytecodealliance/wasmtime/issues/11849#issuecomment-3403274232">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11849">issue #11849</a>:</p>
<blockquote>
<p>thanks bjorn3, so how to build static lib the official way, please. we digress, but essentially this is the how to build c-api properly issue.</p>
<p>Docs state : </p>
<p>These commands will produce the following files:<br>
    artifacts/lib/libwasmtime.{a,lib}: Static Wasmtime library. Exact extension depends on your operating system.<br>
    artifacts/lib/libwasmtime.{so,dylib,dll}: Dynamic Wasmtime library. Exact extension depends on your operating system.<br>
    artifacts/include/**.{h,hh}: Header files for working with Wasmtime.</p>
<p>On Windows, we get wasmtime.lib (static) or wasmtime.dll &amp; wasmtime.dll.lib (dynamic)<br>
depending on whether building statically or dynamically.</p>
<p>I figured out to build static by setting these env vars before building but unsure that's the official way or even if complete.<br>
set WASMTIME_STATIC_LIB=1<br>
set WASMTIME_STATIC=1</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>