<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11533 Pull in new regalloc2 with fastalloc... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html">wasmtime / PR #11533 Pull in new regalloc2 with fastalloc...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="536086589"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086589" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086589">(Aug 25 2025 at 18:50)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a> from <code>cfallin:regalloc2-0.13.1-fastalloc</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Thanks to @d-sonuga in <a href="https://github.com/bytecodealliance/regalloc2/issues/233">bytecodealliance/regalloc2#233</a>, the fastalloc (single-pass) register allocator now supports arbitrary numbers of non-register-constrained defs, which we use on call instructions after #10502. This should be sufficient to resolve the issues that had led us to disable fastalloc temporarily in #10554.</p>
<p>This PR reverts that disabling step; adds Cranelift-with-single-pass as a new compiler strategy (alongside Cranelift, Winch, and Cranelift/Pulley) to all of our wast/spec tests and fuzzing; and pulls in the new RA2.</p>
<p>Adding to our compiler strategy list is perhaps the most controversial thing here, but I believe it's probably appropriate to add the extra dimension here to ensure fastalloc stays working (it's a great feature to have!). Note that this surfaces as a new compiler strategy rather than a separate config dimension (like GC backend is currently) because it applies only to Cranelift, not Winch.</p>
</blockquote>



<a name="536086590"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086590" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086590">(Aug 25 2025 at 18:50)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536086591"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086591" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086591">(Aug 25 2025 at 18:50)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536086592"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086592" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086592">(Aug 25 2025 at 18:50)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-fuzz-reviewers">wasmtime-fuzz-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536086593"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086593" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086593">(Aug 25 2025 at 18:50)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536086595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536086595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536086595">(Aug 25 2025 at 18:50)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536087366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536087366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536087366">(Aug 25 2025 at 18:54)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536087761"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536087761" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536087761">(Aug 25 2025 at 18:56)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11533#pullrequestreview-3152660822">PR review</a>:</p>
<blockquote>
<p>Nice! </p>
<p>Personally though I'd say we can ignore the new compiler strategy part. Fuzzing will already run all <code>*.wast</code> tests will all various options in addition to all the other fuzz targets we have. Given that I feel that's sufficient coverage worth the tradeoff in CI time from running the whole suite with another compiler. Another example is that Pulley for example in theory would want the single-pass option too but that's not modeled here yet (but I think that's niche enough it's definitely not worth spending lots of CI time making sure that works)</p>
</blockquote>



<a name="536088359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536088359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536088359">(Aug 25 2025 at 19:00)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536088437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536088437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536088437">(Aug 25 2025 at 19:00)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/11533#issuecomment-3221400107">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>:</p>
<blockquote>
<p>Fair enough! Removed that commit, so now it's just a clean update of RA2 + revert of #10554.</p>
</blockquote>



<a name="536088476"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536088476" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536088476">(Aug 25 2025 at 19:00)</a>:</h4>
<p>cfallin has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536090982"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536090982" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536090982">(Aug 25 2025 at 19:16)</a>:</h4>
<p>cfallin has disabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536090996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536090996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536090996">(Aug 25 2025 at 19:16)</a>:</h4>
<p>cfallin has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536091414"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536091414" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536091414">(Aug 25 2025 at 19:18)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/11533#issuecomment-3221457015">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>:</p>
<blockquote>
<p>The <code>cargo vet</code> CI job failed with a bad download (more Internet weather) and I'm not seeing an option to re-run it; CI itself also appears wedged in that it can't cancel and the "Record the result" job is queued but not starting.</p>
</blockquote>



<a name="536091691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536091691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536091691">(Aug 25 2025 at 19:20)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11533#issuecomment-3221466485">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>:</p>
<blockquote>
<p>The retry button doesn't show up until everything finishes, and CI is overflowing with jobs right now due to a <a href="https://github.com/bytecodealliance/wasmtime/queue/main">very large queue</a> due to the network failures.</p>
</blockquote>



<a name="536105063"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536105063" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536105063">(Aug 25 2025 at 20:42)</a>:</h4>
<p>cfallin has disabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<a name="536105726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311533%20Pull%20in%20new%20regalloc2%20with%20fastalloc.../near/536105726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311533.20Pull.20in.20new.20regalloc2.20with.20fastalloc.2E.2E.2E.html#536105726">(Aug 25 2025 at 20:46)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11533">PR #11533</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>