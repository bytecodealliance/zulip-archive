<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10652 Add inital support for `f16` without... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html">wasmtime / PR #10652 Add inital support for `f16` without...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="513874773"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513874773" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513874773">(Apr 23 2025 at 13:38)</a>:</h4>
<p>beetrees opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a> from <code>beetrees:f16-f128-riscv64-mvp</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>On the riscv64 backend, this PR adds initial support for using <code>f16</code> without the <code>Zfh</code> extension being enabled, as well as initial support for <code>f128</code>. Support is added for the <code>load</code>, <code>store</code>, <code>bitcast</code>, <code>select</code>, <code>f16const</code>, <code>f128const</code>, <code>bnot</code>, <code>band</code>, <code>bor</code> and <code>bxor</code> CLIF instructions, as well as adding the <code>zfhmin</code> and <code>zvfh</code> target features (alongside the pre-existing <code>zfh</code> target feature).</p>
<p>cc @afonso360 who previously added initial <code>f16</code> support in #9135</p>
<p><code>f16</code>/<code>f128</code> issue: #8312</p>
</blockquote>



<a name="513874776"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513874776" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513874776">(Apr 23 2025 at 13:38)</a>:</h4>
<p><strong>beetrees</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513874778"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513874778" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513874778">(Apr 23 2025 at 13:38)</a>:</h4>
<p><strong>beetrees</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513874779"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513874779" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513874779">(Apr 23 2025 at 13:38)</a>:</h4>
<p><strong>beetrees</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513876218"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513876218" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513876218">(Apr 23 2025 at 13:45)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2787389186">PR review</a>.</p>



<a name="513876226"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513876226" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513876226">(Apr 23 2025 at 13:45)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056097396">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        "Zfhmin: Minimal Half-Precision Floating-Point",
</code></pre></div><br>
</p>
</blockquote>



<a name="513876241"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513876241" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513876241">(Apr 23 2025 at 13:45)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2787389788">PR review</a>.</p>



<a name="513876243"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513876243" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513876243">(Apr 23 2025 at 13:45)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056097620">PR review comment</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="suggestion"><pre><span></span><code>        "Zvfh: Vector Extension for Half-Precision Floating-Point",
</code></pre></div><br>
</p>
</blockquote>



<a name="513884830"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513884830" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513884830">(Apr 23 2025 at 14:20)</a>:</h4>
<p>beetrees updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513884883"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513884883" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513884883">(Apr 23 2025 at 14:20)</a>:</h4>
<p>beetrees submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2787530476">PR review</a>.</p>



<a name="513884884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513884884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513884884">(Apr 23 2025 at 14:20)</a>:</h4>
<p>beetrees created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056179275">PR review comment</a>:</p>
<blockquote>
<p>Done</p>
</blockquote>



<a name="513884924"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513884924" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513884924">(Apr 23 2025 at 14:20)</a>:</h4>
<p>beetrees submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2787531057">PR review</a>.</p>



<a name="513884926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513884926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513884926">(Apr 23 2025 at 14:20)</a>:</h4>
<p>beetrees created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056179631">PR review comment</a>:</p>
<blockquote>
<p>Done</p>
</blockquote>



<a name="513906835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513906835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513906835">(Apr 23 2025 at 15:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#issuecomment-2824750081">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @cfallin, @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "cranelift:meta", "isle"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>cfallin: isle</li>
<li>fitzgen: isle</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="513968765"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513968765" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513968765">(Apr 23 2025 at 21:36)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2788721159">PR review</a>:</p>
<blockquote>
<p>A few nits but overall this looks plausible to me -- thanks for working through the tedious details!</p>
</blockquote>



<a name="513968766"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513968766" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513968766">(Apr 23 2025 at 21:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056895530">PR review comment</a>:</p>
<blockquote>
<p>Could we add a comment here describing why we're OR'ing in all ones in the high bits? I'm not sure if I understand why myself -- does this allow more immediates to fit into better/smaller codegen patterns for <code>imm</code> perhaps?</p>
</blockquote>



<a name="513968767"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513968767" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513968767">(Apr 23 2025 at 21:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056895913">PR review comment</a>:</p>
<blockquote>
<p>Likewise here as above -- where does the constant come from?</p>
</blockquote>



<a name="513968768"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513968768" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513968768">(Apr 23 2025 at 21:36)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2056902429">PR review comment</a>:</p>
<blockquote>
<p>Is there any particular reason that we remove <code>aarch64 has_fp16</code> from the list of targets tested by this runtest and those below? Can we keep that while adding <code>riscv64</code> below it?</p>
</blockquote>



<a name="513978570"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513978570" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513978570">(Apr 23 2025 at 23:08)</a>:</h4>
<p>beetrees updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513979088"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513979088" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513979088">(Apr 23 2025 at 23:14)</a>:</h4>
<p>beetrees submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2788897287">PR review</a>.</p>



<a name="513979089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513979089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513979089">(Apr 23 2025 at 23:14)</a>:</h4>
<p>beetrees created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2057017700">PR review comment</a>:</p>
<blockquote>
<p>I've added a comment. RISC-V stores smaller floats inside larger floating-point registers using NaN-boxing, meaning that the smaller float will be stored in the lower bits and all the other bits will be set to 1 (see section 21.2 of the <a href="https://drive.usercontent.google.com/download?id=1uviu1nH-tScFfgrovvFCrj7Omv8tFtkp&amp;export=download">RISC-V ISA manual</a> for details). The correctly-sized <code>fmv</code> instructions do this automatically, but when using a 32-bit <code>fmv</code> for a 16-bit float the NaN-boxing has to be done manually.</p>
</blockquote>



<a name="513979199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513979199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513979199">(Apr 23 2025 at 23:15)</a>:</h4>
<p>beetrees updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<a name="513979835"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513979835" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513979835">(Apr 23 2025 at 23:23)</a>:</h4>
<p>beetrees submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2788905195">PR review</a>.</p>



<a name="513979837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/513979837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#513979837">(Apr 23 2025 at 23:23)</a>:</h4>
<p>beetrees created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2057023514">PR review comment</a>:</p>
<blockquote>
<p>This was a leftover from when <code>bitcast-f16-f128.clif</code> was split into <code>f16-bitcast.clif</code> and <code>f128-bitcast.clif</code> in #9135. The <code>aarch64</code> directives were just moved to <code>f128-bitcast.clif</code>, with <code>f16-bitcast.clif</code> only being tested on x86_64 and riscv64. This PR adds <code>aarch64</code> (both with and without <code>has_fp16</code>) to <code>f16-bitcast.clif</code> and removes the <code>has_fp16</code> case from <code>f128-bitcast.clif</code> as <code>has_fp16</code> is only relevant to testing <code>f16</code>, not <code>f128</code>.</p>
</blockquote>



<a name="514065769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514065769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514065769">(Apr 24 2025 at 09:26)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2790403232">PR review</a>.</p>



<a name="514065771"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514065771" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514065771">(Apr 24 2025 at 09:26)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2057954084">PR review comment</a>:</p>
<blockquote>
<p>Does this rule only applies when 16bit float instructions are not supported? If so I think we could get away with only NaN-boxing on the ABI boundary and within the function leaving the high bits undefined. I don't know if that will be faster though.</p>
</blockquote>



<a name="514117889"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514117889" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514117889">(Apr 24 2025 at 12:55)</a>:</h4>
<p>beetrees submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2791063524">PR review</a>.</p>



<a name="514117892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514117892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514117892">(Apr 24 2025 at 12:55)</a>:</h4>
<p>beetrees created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2058363160">PR review comment</a>:</p>
<blockquote>
<p>When the <code>Zfhmin</code> extension is not enabled (which is the only case where NaN-boxing is done manually), the only place NaN-boxing is required is at the ABI boundary. However, I doubt it would be beneficial to move NaN-boxing from bitcasts to the ABI boundary as I expect that most uses of <code>f16</code> are going to be calls to other functions (such as <code>__extendhfsf2</code> from <code>compiler_builtins</code>). It would be faster to NaN-box the value at most once (the value will already be NaN-boxed if it is an argument to the function or return value from another function) rather than every time it is used.</p>
</blockquote>



<a name="514118015"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514118015" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514118015">(Apr 24 2025 at 12:55)</a>:</h4>
<p>beetrees edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2058363160">PR review comment</a>.</p>



<a name="514173659"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514173659" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514173659">(Apr 24 2025 at 16:38)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2791857245">PR review</a>.</p>



<a name="514173660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514173660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514173660">(Apr 24 2025 at 16:38)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#discussion_r2058847086">PR review comment</a>:</p>
<blockquote>
<p>Ah, right, of course -- saw the seemingly unrelated change but that cleanup makes sense, thanks.</p>
</blockquote>



<a name="514173898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514173898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514173898">(Apr 24 2025 at 16:40)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10652#pullrequestreview-2791859918">PR review</a>:</p>
<blockquote>
<p>Thanks, LGTM!</p>
</blockquote>



<a name="514178338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310652%20Add%20inital%20support%20for%20%60f16%60%20without.../near/514178338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310652.20Add.20inital.20support.20for.20.60f16.60.20without.2E.2E.2E.html#514178338">(Apr 24 2025 at 17:01)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10652">PR #10652</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>