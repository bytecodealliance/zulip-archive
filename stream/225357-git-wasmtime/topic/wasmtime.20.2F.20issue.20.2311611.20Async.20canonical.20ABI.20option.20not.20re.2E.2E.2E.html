<html>
<head><meta charset="utf-8"><title>wasmtime / issue #11611 Async canonical ABI option not re... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html">wasmtime / issue #11611 Async canonical ABI option not re...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="537768970"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537768970" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537768970">(Sep 04 2025 at 23:14)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>This is an implementation TODO that still needs to be resolved for full component-model async support:</p>
<ul>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L2895-L2897">future/stream reads currently require <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L2652-L2654">future/stream writes currently require <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L3290">cancelling future/stream writes ignores <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L3316">cancelling future/stream reads ignores <code>async</code></a></li>
</ul>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent.rs#L2921-L2934">Subtask cancellation</a>, however, does handle it.</p>
<p>@lukewagner would you be up for writing some <code>*.wast</code> spec tests for these behaviors in parallel? I'm also not sure if there's tests for <code>async</code> in lift/lower options yet as well (e.g. mixing/matching async lifts/lowers) which would also be good to test.</p>
</blockquote>



<a name="537768971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537768971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537768971">(Sep 04 2025 at 23:14)</a>:</h4>
<p><a href="https://github.com/alexcrichton">alexcrichton</a> added the wasm-proposal:component-model-async label to <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">Issue #11611</a>.</p>



<a name="537768980"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537768980" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537768980">(Sep 04 2025 at 23:14)</a>:</h4>
<p>alexcrichton assigned dicej to <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>.</p>



<a name="537892620"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537892620" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537892620">(Sep 05 2025 at 15:12)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3258716210">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Yep, will do</p>
</blockquote>



<a name="537906480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537906480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537906480">(Sep 05 2025 at 16:27)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3258956407">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Oh, also, to this part:</p>
<blockquote>
<p>I'm also not sure if there's tests for async in lift/lower options yet as well (e.g. mixing/matching async lifts/lowers) which would also be good to test.</p>
</blockquote>
<p><a href="https://github.com/WebAssembly/component-model/blob/main/test/async/async-calls-sync.wast"><code>async-calls-sync.wast</code></a> has an (async, sync, async) hamburger that tests a number of the interesting/hard cases and a number of the other tests have sync calling async in other combinations.</p>
</blockquote>



<a name="537910146"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537910146" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537910146">(Sep 05 2025 at 16:51)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259083930">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Based on <a href="https://github.com/WebAssembly/component-model/blob/tests/test/async/reject-gated-features.wast">this test</a>, it looks like validation does currently reject <code>async</code> on <code>{stream,future}.cancel-{read,write}</code> and <code>subtask.cancel</code> and <code>async</code> is also rejected on <code>resource.drop</code> as a parsing error.</p>
</blockquote>



<a name="537911030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537911030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537911030">(Sep 05 2025 at 16:56)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259126699">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<blockquote>
<p>Based on <a href="https://github.com/WebAssembly/component-model/blob/tests/test/async/reject-gated-features.wast">this test</a>, it looks like validation does currently reject <code>async</code> on <code>{stream,future}.cancel-{read,write}</code> and <code>subtask.cancel</code> and <code>async</code> is also rejected on <code>resource.drop</code> as a parsing error.</p>
</blockquote>
<p>Yeah, that does ring a bell now; I think we punted on a few variations.  So it sounds like we only need to support synchronous <code>{stream,future}.cancel-{read,write}</code>.  Do we need to support synchronous <code>{stream,future}.{read,write}</code>, or did we punt on that for now, also?</p>
</blockquote>



<a name="537911776"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537911776" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537911776">(Sep 05 2025 at 17:01)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259143068">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>For the intrinsics in Wasmtime you'll need <code>-Wcomponent-model-async-builtins</code> since it's separately gated from <code>-Wcomponent-model-async</code>, and that should get the intrinsics passing validation. One of the main blind spots we have right now in the implementation is that for non-<code>async</code> intrinsics they read/write cancellation ones aren't correctly handling the case that blocking should happen. So one major thing that I think is worthwhile to test is cancelling a read/write in a way that needs to block the calling task and ensuring that <code>BLOCKED</code> doesn't get returned.</p>
<p>For <code>resource.drop</code> async bits Wasmtime doesn't currently have any support for that IIRC, so that can be split out to a separate file for now that we'll need to implement later.</p>
<blockquote>
<p>Yeah, that does ring a bell now; I think we punted on a few variations</p>
</blockquote>
<p>To be clear, we punted on the <code>async</code> versions, not the versions that should handle <code>BLOCKED</code>. The <code>BLOCKED</code> code should never be returned AFAIK (which it currently does).</p>
<p>Also, IMO we should either rip out everything from Wasmtime that doesn't match the spec or we should match the spec. I don't want to be in a situation where we half-implement a historical snapshot of the spec. Basically if we try to support <code>async</code> then we should, even if it's a separate feature gate, or we should remove the support that we have. (I know this is a point you and I differ on @dicej historically so we can talk more about this too)</p>
</blockquote>



<a name="537911974"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537911974" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537911974">(Sep 05 2025 at 17:02)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259147568">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<blockquote>
<p>To be clear, we punted on the <code>async</code> versions, not the versions that should handle <code>BLOCKED</code>. The <code>BLOCKED</code> code should never be returned AFAIK (which it currently does).</p>
</blockquote>
<p>Right, that's what I mean, and I'm working on fixing that now.</p>
</blockquote>



<a name="537912178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537912178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537912178">(Sep 05 2025 at 17:03)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259151421">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Ok yeah my reading comprehension is lacking today as it does many days...</p>
<blockquote>
<p>Do we need to support synchronous {stream,future}.{read,write}, or did we punt on that for now, also?</p>
</blockquote>
<p>Yes, we need to support this. We didn't punt on this.</p>
</blockquote>



<a name="537912848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537912848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537912848">(Sep 05 2025 at 17:08)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259161400">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>For posterity <a href="https://github.com/bytecodealliance/wasmtime/pull/11623">https://github.com/bytecodealliance/wasmtime/pull/11623</a> is an example test that is failing due to this issue</p>
</blockquote>



<a name="537919686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537919686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537919686">(Sep 05 2025 at 17:45)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259256858">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Making progress: <a href="https://github.com/bytecodealliance/wasmtime/pull/11625">https://github.com/bytecodealliance/wasmtime/pull/11625</a></p>
</blockquote>



<a name="537920683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/537920683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#537920683">(Sep 05 2025 at 17:52)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3259272248">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>It just remembered (after Alex pointed it out to me yesterday) that a pure WAST test for <code>{stream,future}.cancel-{read,write}</code> won't exercise my fix here anyway, since it only applies when the other end is owned by the host.  I'll work on adding some tests to <code>component-async-tests</code>.</p>
</blockquote>



<a name="538026109"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538026109" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538026109">(Sep 06 2025 at 19:34)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3263128986">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Alright, <a href="https://github.com/WebAssembly/component-model/blob/main/test/async/sync-streams.wast">here's</a> a test for sync <code>stream.{read,write}</code> that blocks, switches, switches back and then completes (but currently fails with "synchronous stream and future writes not yet supported").</p>
</blockquote>



<a name="538304434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538304434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538304434">(Sep 08 2025 at 19:52)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3267725409">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>#11625 Addresses the <code>cancel-{read,write}</code> part of this issue.  I'll work on the <code>{read,write}</code> part next.</p>
</blockquote>



<a name="538323248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538323248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538323248">(Sep 08 2025 at 22:22)</a>:</h4>
<p>lukewagner <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3268219396">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>Just as a interesting side note, thinking about what it would take to be able to write a pure <code>.wast</code> test that exercised the <code>BLOCKED</code> case of sync <code>cancel-{read,write}</code>, it'd just be this <code>stream.read-{data,complete}</code> feature we already discussed adding at some point in the future in the <a href="https://github.com/WebAssembly/wasi-cli/issues/65#issuecomment-3180774959">stdio issue</a>.</p>
</blockquote>



<a name="538448699"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538448699" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538448699">(Sep 09 2025 at 14:14)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3270942792">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/11645">https://github.com/bytecodealliance/wasmtime/pull/11645</a> adds support for synchronous <code>{stream,future}.{read,write}</code> calls, but I'm hitting a new issue when running Luke's <code>sync-streams.wast</code> test, so I'm going to debug that before I close this issue.</p>
</blockquote>



<a name="538474412"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538474412" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538474412">(Sep 09 2025 at 16:06)</a>:</h4>
<p>dicej <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3271371403">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/11655">https://github.com/bytecodealliance/wasmtime/pull/11655</a> should finish this up, finally (and extends my streak of only posting PRs ending in 5 for this issue).</p>
</blockquote>



<a name="538474657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538474657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538474657">(Sep 09 2025 at 16:07)</a>:</h4>
<p>dicej edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/11611#issuecomment-3271371403">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/11655">https://github.com/bytecodealliance/wasmtime/pull/11655</a> should finish this up, finally (and extends my streak of only posting PRs ending in 5 for this issue: #11625, #11645, and #11655).</p>
</blockquote>



<a name="538494379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311611%20Async%20canonical%20ABI%20option%20not%20re.../near/538494379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311611.20Async.20canonical.20ABI.20option.20not.20re.2E.2E.2E.html#538494379">(Sep 09 2025 at 17:37)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/11611">issue #11611</a>:</p>
<blockquote>
<p>This is an implementation TODO that still needs to be resolved for full component-model async support:</p>
<ul>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L2895-L2897">future/stream reads currently require <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L2652-L2654">future/stream writes currently require <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L3290">cancelling future/stream writes ignores <code>async</code></a></li>
<li><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent/futures_and_streams.rs#L3316">cancelling future/stream reads ignores <code>async</code></a></li>
</ul>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/a631d20afa7a0154e63c2b8aa34a979864518991/crates/wasmtime/src/runtime/component/concurrent.rs#L2921-L2934">Subtask cancellation</a>, however, does handle it.</p>
<p>@lukewagner would you be up for writing some <code>*.wast</code> spec tests for these behaviors in parallel? I'm also not sure if there's tests for <code>async</code> in lift/lower options yet as well (e.g. mixing/matching async lifts/lowers) which would also be good to test.</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>