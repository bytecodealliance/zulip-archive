<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10537 Run CI tests through AddressSanitizer · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html">wasmtime / PR #10537 Run CI tests through AddressSanitizer</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="510705345"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510705345" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510705345">(Apr 07 2025 at 15:36)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a> from <code>alexcrichton:asan</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This is similar to running tests in Valgrind (which we should perhaps also do...) but can be useful for catching use-after-free style bugs faster than when a process crashes. Given the unsafe nature of Wasmtime this is something we should have probably enabled awhile back but otherwise so long as it doesn't take too long to run on CI seems like an easy win of a boost-of-confidence.</p>
<p>prtest:asan</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="510705626"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510705626" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510705626">(Apr 07 2025 at 15:38)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#issuecomment-2783792875">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>:</p>
<blockquote>
<p>This contains <a href="https://github.com/bytecodealliance/wasmtime/pull/10534">https://github.com/bytecodealliance/wasmtime/pull/10534</a> and <a href="https://github.com/bytecodealliance/wasmtime/pull/10535">https://github.com/bytecodealliance/wasmtime/pull/10535</a> so the diff isn't purely asan-specific, but I'm otherwise keeping this as a draft for now while CI is evaluated.</p>
</blockquote>



<a name="510722814"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510722814" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510722814">(Apr 07 2025 at 16:56)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510722952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510722952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510722952">(Apr 07 2025 at 16:57)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#issuecomment-2784006328">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>:</p>
<blockquote>
<p>Looks like un-optimized this takes <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/14313411386/job/40113786700">over an hour in CI</a>.</p>
<p>Trying optimized next.</p>
</blockquote>



<a name="510723061"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510723061" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510723061">(Apr 07 2025 at 16:57)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510739638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510739638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510739638">(Apr 07 2025 at 18:26)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#issuecomment-2784205640">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>:</p>
<blockquote>
<p>Ok 25 minutes much more reasonable, I might look into sharding this test suite though like we do all the others</p>
</blockquote>



<a name="510747643"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510747643" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510747643">(Apr 07 2025 at 19:10)</a>:</h4>
<p>fitzgen <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#issuecomment-2784304445">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>:</p>
<blockquote>
<blockquote>
<p>This is similar to running tests in Valgrind (which we should perhaps also do...) but can be useful for catching use-after-free style bugs faster than when a process crashes. Given the unsafe nature of Wasmtime this is something we should have probably enabled awhile back but otherwise so long as it doesn't take too long to run on CI seems like an easy win of a boost-of-confidence.</p>
</blockquote>
<p>A note for anyone following along at home: this comment isn't <em>quite</em> as scary as it might otherwise seem, since we already run as many tests under <a href="https://github.com/rust-lang/miri">MIRI</a> (an undefined behavior-detecting interpreter for Rust's MIR internal representation) as we can, which gives us many of the same (although not fully overlapping) benefits that asan and valgrind give. That said, more coverage with more tools is always welcome! See also <a href="https://bytecodealliance.org/articles/security-and-correctness-in-wasmtime">https://bytecodealliance.org/articles/security-and-correctness-in-wasmtime</a> for more details on our various approaches to security and correctness in Wasmtime.</p>
</blockquote>



<a name="510973214"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510973214" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510973214">(Apr 08 2025 at 16:06)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510973600"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510973600" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510973600">(Apr 08 2025 at 16:07)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510979402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979402">(Apr 08 2025 at 16:34)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510979423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979423">(Apr 08 2025 at 16:35)</a>:</h4>
<p><strong>alexcrichton</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a> as ready for review.</p>



<a name="510979425"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979425" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979425">(Apr 08 2025 at 16:35)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510979427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979427">(Apr 08 2025 at 16:35)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510979428"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979428" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979428">(Apr 08 2025 at 16:35)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<a name="510979499"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/510979499" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#510979499">(Apr 08 2025 at 16:35)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#issuecomment-2787041216">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>:</p>
<blockquote>
<p>Ok I've rebased this and gone with sharding. Un-sharded tests are 25 minutes and with sharded tests wasmtime-cli takes the longest and clocks in at ~17m which is below our current longest time I believe.</p>
</blockquote>



<a name="511439647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/511439647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#511439647">(Apr 10 2025 at 15:19)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10537#pullrequestreview-2757259363">PR review</a>.</p>



<a name="511449028"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310537%20Run%20CI%20tests%20through%20AddressSanitizer/near/511449028" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310537.20Run.20CI.20tests.20through.20AddressSanitizer.html#511449028">(Apr 10 2025 at 15:56)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10537">PR #10537</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>