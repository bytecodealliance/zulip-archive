<html>
<head><meta charset="utf-8"><title>wasmtime / issue #12588 [QUESTION] Is it mandatory in `li... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html">wasmtime / issue #12588 [QUESTION] Is it mandatory in `li...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="573704457"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2312588%20%5BQUESTION%5D%20Is%20it%20mandatory%20in%20%60li.../near/573704457" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html#573704457">(Feb 13 2026 at 09:56)</a>:</h4>
<p>if0ne opened <a href="https://github.com/bytecodealliance/wasmtime/issues/12588">issue #12588</a>:</p>
<blockquote>
<p>Hi there!</p>
<p>I want to do something like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">store</span><span class="p">.</span><span class="n">limiter_async</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">memory_limiter</span><span class="p">);</span>
</code></pre></div>
<p>The memory limiter is created and configured outside of the store creation.</p>
<p>However, this is currently impossible:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>store.limiter_async<span class="o">(</span>move<span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">&amp;</span>mut<span class="w"> </span>memory_limiter<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span>--------<span class="w"> </span>^^^^^^^^^^^^^^^^^^^<span class="w"> </span>closure<span class="w"> </span>was<span class="w"> </span>supposed<span class="w"> </span>to<span class="w"> </span><span class="k">return</span><span class="w"> </span>data<span class="w"> </span>with<span class="w"> </span>lifetime<span class="w"> </span><span class="sb">`</span><span class="s1">'2` but it is returning data with lifetime `'</span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span><span class="p">|</span><span class="w">     </span><span class="p">|</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span><span class="p">|</span><span class="w">     </span>has<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="sb">`</span><span class="p">&amp;</span><span class="s1">'2 mut SharedCtx`</span>
<span class="s1">    |                                     lifetime `'</span><span class="m">1</span><span class="sb">`</span><span class="w"> </span>represents<span class="w"> </span>this<span class="w"> </span>closure<span class="s1">'s body</span>
<span class="s1">    |</span>
<span class="s1">    = note: closure implements `FnMut`, so references to captured variables can'</span>t<span class="w"> </span>escape<span class="w"> </span>the<span class="w"> </span>closure
</code></pre></div>
<p>Should I move the limiter into the store’s data, or is this something that could be fixed in future releases?</p>
</blockquote>



<a name="573775459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2312588%20%5BQUESTION%5D%20Is%20it%20mandatory%20in%20%60li.../near/573775459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html#573775459">(Feb 13 2026 at 15:54)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/12588#issuecomment-3897945354">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/12588">issue #12588</a>:</p>
<blockquote>
<p>Yes for now you'll need to place the limiter in the store's data itself, as Rust's closures don't allow this style of borrowing where you return a borrow of the captured data itself. As for fixing this and/or supporting this, it's in theory possible yeah and would likely require adjusting bounds here. For now does moving into the store work for you?</p>
</blockquote>



<a name="573808230"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2312588%20%5BQUESTION%5D%20Is%20it%20mandatory%20in%20%60li.../near/573808230" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html#573808230">(Feb 13 2026 at 18:39)</a>:</h4>
<p>if0ne <a href="https://github.com/bytecodealliance/wasmtime/issues/12588#issuecomment-3898745122">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/12588">issue #12588</a>:</p>
<blockquote>
<p>Yes, moving the limiter into the Store works fine for me. Thanks you</p>
</blockquote>



<a name="573927519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2312588%20%5BQUESTION%5D%20Is%20it%20mandatory%20in%20%60li.../near/573927519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html#573927519">(Feb 14 2026 at 21:23)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/12588">issue #12588</a>:</p>
<blockquote>
<p>Hi there!</p>
<p>I want to do something like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">store</span><span class="p">.</span><span class="n">limiter_async</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">memory_limiter</span><span class="p">);</span>
</code></pre></div>
<p>The memory limiter is created and configured outside of the store creation.</p>
<p>However, this is currently impossible:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>store.limiter_async<span class="o">(</span>move<span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">&amp;</span>mut<span class="w"> </span>memory_limiter<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span>--------<span class="w"> </span>^^^^^^^^^^^^^^^^^^^<span class="w"> </span>closure<span class="w"> </span>was<span class="w"> </span>supposed<span class="w"> </span>to<span class="w"> </span><span class="k">return</span><span class="w"> </span>data<span class="w"> </span>with<span class="w"> </span>lifetime<span class="w"> </span><span class="sb">`</span><span class="s1">'2` but it is returning data with lifetime `'</span><span class="m">1</span><span class="sb">`</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span><span class="p">|</span><span class="w">     </span><span class="p">|</span>
<span class="w">    </span><span class="p">|</span><span class="w">                                     </span><span class="p">|</span><span class="w">     </span>has<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="sb">`</span><span class="p">&amp;</span><span class="s1">'2 mut SharedCtx`</span>
<span class="s1">    |                                     lifetime `'</span><span class="m">1</span><span class="sb">`</span><span class="w"> </span>represents<span class="w"> </span>this<span class="w"> </span>closure<span class="s1">'s body</span>
<span class="s1">    |</span>
<span class="s1">    = note: closure implements `FnMut`, so references to captured variables can'</span>t<span class="w"> </span>escape<span class="w"> </span>the<span class="w"> </span>closure
</code></pre></div>
<p>Should I move the limiter into the store’s data, or is this something that could be fixed in future releases?</p>
</blockquote>



<a name="573927521"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2312588%20%5BQUESTION%5D%20Is%20it%20mandatory%20in%20%60li.../near/573927521" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2312588.20.5BQUESTION.5D.20Is.20it.20mandatory.20in.20.60li.2E.2E.2E.html#573927521">(Feb 14 2026 at 21:23)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/12588#issuecomment-3902546010">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/12588">issue #12588</a>:</p>
<blockquote>
<p>Ok great! In that case I'll close this for now, but if that becomes problematic I can also reopen for a future feature to update the siganture of this function.</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>