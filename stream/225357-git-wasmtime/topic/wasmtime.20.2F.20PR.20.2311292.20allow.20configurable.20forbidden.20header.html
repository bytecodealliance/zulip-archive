<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11292 allow configurable forbidden header · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html">wasmtime / PR #11292 allow configurable forbidden header</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="529986690"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/529986690" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#529986690">(Jul 22 2025 at 01:22)</a>:</h4>
<p><strong>xofyarg</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-wasi-reviewers">wasmtime-wasi-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="529986691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/529986691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#529986691">(Jul 22 2025 at 01:22)</a>:</h4>
<p>xofyarg opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a> from <code>xofyarg:wasi-http-configurable-forbidden-header</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>When the HTTP library is not used as a proxy, removing of the forbidden headers by default may not make sense. This change makes it configurable via the <code>WasiHttpView</code>, which keeps the default behavior.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="529991268"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/529991268" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#529991268">(Jul 22 2025 at 02:31)</a>:</h4>
<p>xofyarg updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="529991573"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/529991573" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#529991573">(Jul 22 2025 at 02:35)</a>:</h4>
<p>xofyarg <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3100542819">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>Not sure which is better: <a href="https://github.com/bytecodealliance/wasmtime/pull/11292/commits/3c9f4c15ad4a88ba2ff2f4ee2a30e7940cba9c2d">3c9f4c1</a> looks clean to me, but it changes previous behavior if user has implemented <code>is_forbidden_header</code>; <a href="https://github.com/bytecodealliance/wasmtime/pull/11292/commits/d183effc402266006cabc6efbcccb1b4f738a64e">d183eff</a> adds an extra method.</p>
</blockquote>



<a name="530086086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530086086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530086086">(Jul 22 2025 at 07:42)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#pullrequestreview-3041577609">PR review</a>:</p>
<blockquote>
<p>In p3 I've fixed this in the following manner: <a href="https://github.com/bytecodealliance/wasip3-prototyping/blob/main/crates%2Fwasi-http%2Fsrc%2Fp3%2Fmod.rs#L381-L387">https://github.com/bytecodealliance/wasip3-prototyping/blob/main/crates%2Fwasi-http%2Fsrc%2Fp3%2Fmod.rs#L381-L387</a></p>
<p>This way users can choose the headers to deny with no breaking changes to the API</p>
<p>That said, IMO this diff is already an improvement</p>
</blockquote>



<a name="530174022"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530174022" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530174022">(Jul 22 2025 at 15:40)</a>:</h4>
<p>xofyarg <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3103476613">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>Should I adjust the change close to p3 then? There are two commits in the PR, I can either drop the 2nd, or squash them together. Please let me know what you think. Thanks.</p>
</blockquote>



<a name="530178184"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530178184" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530178184">(Jul 22 2025 at 16:01)</a>:</h4>
<p>xofyarg edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3103476613">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>Should I adjust the change close to p3 then? There are two commits in the PR, I can either drop the 2nd, or squash them together. Please let me know what you think. Thanks.</p>
<p>Edit:</p>
<blockquote>
<p>choose the headers to deny with no breaking changes to the API</p>
</blockquote>
<p>The way it works in p2 is, when user override this trait method, the new customized headers as well as the default forbidden headers are denied: <a href="https://github.com/bytecodealliance/wasmtime/blob/v34.0.2/crates/wasi-http/src/types.rs#L287">https://github.com/bytecodealliance/wasmtime/blob/v34.0.2/crates/wasi-http/src/types.rs#L287</a></p>
<p>I prefer the way how p3 is implemented, but it means a break change to the current API. Otherwise we have to introduce something new, which will then be dropped when the user upgrade to p3, which also not nice.</p>
</blockquote>



<a name="530251465"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530251465" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530251465">(Jul 23 2025 at 02:25)</a>:</h4>
<p>xofyarg updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="530252912"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530252912" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530252912">(Jul 23 2025 at 02:45)</a>:</h4>
<p>xofyarg <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3105481985">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>I updated the PR to follow the p3 API, that should give the users a smooth path forward. Although it has a break change for people who override the trait method. The PR is ready to be merged.</p>
</blockquote>



<a name="530300533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530300533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530300533">(Jul 23 2025 at 09:28)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#pullrequestreview-3046501503">PR review</a>:</p>
<blockquote>
<p>LGTM, thank you!<br>
As you correctly point out, this is actually <em>is</em> a breaking change for users providing an implementation of the method. Should we record this in release notes? I'm not actually sure about the expectations/procedure here<br>
cc @bytecodealliance/wasmtime-wasi-reviewers</p>
</blockquote>



<a name="530364927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530364927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530364927">(Jul 23 2025 at 14:48)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3108975475">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>Breaking changes are fine yeah, and if you're able to write a note in the release notes that'd be appreciated, but it's not required. When I go back and review merged PRs for the release notes I try to catch issues like this and write them in.</p>
</blockquote>



<a name="530370404"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370404" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370404">(Jul 23 2025 at 15:09)</a>:</h4>
<p><strong>xofyarg</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="530370406"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370406" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370406">(Jul 23 2025 at 15:09)</a>:</h4>
<p>xofyarg updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="530370407"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370407" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370407">(Jul 23 2025 at 15:09)</a>:</h4>
<p><strong>xofyarg</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="530370656"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370656" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370656">(Jul 23 2025 at 15:10)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#pullrequestreview-3047887238">PR review</a>.</p>



<a name="530370731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370731">(Jul 23 2025 at 15:10)</a>:</h4>
<p>rvolosatovs has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<a name="530370739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530370739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530370739">(Jul 23 2025 at 15:10)</a>:</h4>
<p>xofyarg <a href="https://github.com/bytecodealliance/wasmtime/pull/11292#issuecomment-3109052086">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>:</p>
<blockquote>
<p>I put a note in the RELEASES.md file, please take another look.</p>
</blockquote>



<a name="530379394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311292%20allow%20configurable%20forbidden%20header/near/530379394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311292.20allow.20configurable.20forbidden.20header.html#530379394">(Jul 23 2025 at 15:47)</a>:</h4>
<p>rvolosatovs merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11292">PR #11292</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>