<html>
<head><meta charset="utf-8"><title>wasmtime / PR #12613 Cranelift: update ValueDataPacked to... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html">wasmtime / PR #12613 Cranelift: update ValueDataPacked to...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="574407725"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574407725" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574407725">(Feb 18 2026 at 00:07)</a>:</h4>
<p>cfallin opened <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a> from <code>cfallin:bigger-valuedata</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This updates the <code>ValueDataPacked</code> scheme from the old</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">            </span><span class="p">(</span><span class="k">enum</span><span class="w"> </span><span class="nc">tag</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="n">CLIF</span><span class="w"> </span><span class="k">type</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">     </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="sd">///        | tag:2 |  type:14        |    x:24       | y:24          |</span>
</code></pre></div>
<p>encoding in a <code>u64</code> to a new</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">///        | tag:2 |  type:14        |    x:32       | y:32</span>
<span class="o">|</span>
</code></pre></div>
<p>encoding, with a <code>packed</code> tag attribute to ensure the struct fits in 10 bytes. This permits the full range of <code>Value</code> (a <code>u32</code> entity index) to be encoded, removing the remaining major limit on function body size after the work in #12611 to address #12229.</p>
<p>Curiously, this appears to be a <em>speedup</em> in compile time of 3-5% on bz2 and 3% on spidermonkey-json (Sightglass, 50 data points each). My best guess as to why is that putting the value fields in their own <code>u32</code>s allows for quick access without shifts/masks, which is actually better than the unaligned accesses (caused by 10-byte size) -- which have no penalty on modern mainstream CPUs -- and 25% size inflation of the value-definitions array.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="574407726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574407726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574407726">(Feb 18 2026 at 00:07)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a>.</p>



<a name="574407729"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574407729" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574407729">(Feb 18 2026 at 00:07)</a>:</h4>
<p><strong>cfallin</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a>.</p>



<a name="574408431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574408431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574408431">(Feb 18 2026 at 00:15)</a>:</h4>
<p>cfallin updated <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a>.</p>



<a name="574424553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574424553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574424553">(Feb 18 2026 at 03:34)</a>:</h4>
<p>github-actions[bot] added the label <code>cranelift</code> on <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a>.</p>



<a name="574542547"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574542547" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574542547">(Feb 18 2026 at 15:52)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/12613#pullrequestreview-3820724782">PR review</a>.</p>



<a name="574542576"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574542576" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574542576">(Feb 18 2026 at 15:52)</a>:</h4>
<p>fitzgen added <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613 Cranelift: update ValueDataPacked to support full Value range.</a> to the merge queue</p>



<a name="574550973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574550973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574550973">(Feb 18 2026 at 16:26)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613</a>.</p>



<a name="574550976"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312613%20Cranelift%3A%20update%20ValueDataPacked%20to.../near/574550976" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312613.20Cranelift.3A.20update.20ValueDataPacked.20to.2E.2E.2E.html#574550976">(Feb 18 2026 at 16:26)</a>:</h4>
<p>fitzgen removed <a href="https://github.com/bytecodealliance/wasmtime/pull/12613">PR #12613 Cranelift: update ValueDataPacked to support full Value range.</a> from the merge queue</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>