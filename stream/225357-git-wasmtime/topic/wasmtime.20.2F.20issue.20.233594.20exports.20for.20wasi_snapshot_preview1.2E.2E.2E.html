<html>
<head><meta charset="utf-8"><title>wasmtime / issue #3594 exports for wasi_snapshot_preview1... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html">wasmtime / issue #3594 exports for wasi_snapshot_preview1...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="264315119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264315119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264315119">(Dec 09 2021 at 15:15)</a>:</h4>
<p>yowl labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>Wasm file uploaded</p>
<h3>Steps to Reproduce</h3>
<p>Run with <code>wasmtime --wasm-features memory64</code></p>
<h3>Expected Results</h3>
<p>It runs</p>
<h3>Actual Results</h3>
<p>Fails with</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">ScottWaye</span><span class="err">\</span><span class="n">OneDrive</span><span class="err">\</span><span class="n">wasm64</span><span class="err">\</span><span class="mf">1.</span><span class="n">wasm</span><span class="err">`</span><span class="w"></span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">instantiate</span><span class="w"> </span><span class="s">"C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">ScottWaye</span><span class="se">\\</span><span class="s">OneDrive</span><span class="se">\\</span><span class="s">wasm64</span><span class="se">\\</span><span class="s">1.wasm"</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span>: <span class="nc">incompatible</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="k">type</span> <span class="nc">for</span><span class="w"> </span><span class="err">`</span><span class="n">wasi_snapshot_preview1</span>::<span class="n">fd_write</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span>: <span class="nc">function</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">incompatible</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime 0.31.0</p>
<p>Operating system: Win10</p>
<p>Architecture: x64?</p>
<h3>Extra Info</h3>
<p>Looks like the wasi export is using 32 bit pointers when for memory64 shouldn't it be 64 bit?</p>
<p>Anything else you'd like to add?<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7686227/1.zip">1.zip</a></p>
</blockquote>



<a name="264315120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264315120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264315120">(Dec 09 2021 at 15:15)</a>:</h4>
<p>yowl opened <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>Wasm file uploaded</p>
<h3>Steps to Reproduce</h3>
<p>Run with <code>wasmtime --wasm-features memory64</code></p>
<h3>Expected Results</h3>
<p>It runs</p>
<h3>Actual Results</h3>
<p>Fails with</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">ScottWaye</span><span class="err">\</span><span class="n">OneDrive</span><span class="err">\</span><span class="n">wasm64</span><span class="err">\</span><span class="mf">1.</span><span class="n">wasm</span><span class="err">`</span><span class="w"></span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">instantiate</span><span class="w"> </span><span class="s">"C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">ScottWaye</span><span class="se">\\</span><span class="s">OneDrive</span><span class="se">\\</span><span class="s">wasm64</span><span class="se">\\</span><span class="s">1.wasm"</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span>: <span class="nc">incompatible</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="k">type</span> <span class="nc">for</span><span class="w"> </span><span class="err">`</span><span class="n">wasi_snapshot_preview1</span>::<span class="n">fd_write</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span>: <span class="nc">function</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">incompatible</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime 0.31.0</p>
<p>Operating system: Win10</p>
<p>Architecture: x64?</p>
<h3>Extra Info</h3>
<p>Looks like the wasi export is using 32 bit pointers when for memory64 shouldn't it be 64 bit?</p>
<p>Anything else you'd like to add?<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7686227/1.zip">1.zip</a></p>
</blockquote>



<a name="264315992"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264315992" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264315992">(Dec 09 2021 at 15:21)</a>:</h4>
<p>yowl <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-989951759">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>To be honest the error message is not clear and it could be that wasmtime is right and my import is wrong.  Unfortuantely wabt's wasm2wat doesn't work for memory64 so not sure how to check that.</p>
</blockquote>



<a name="264316098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264316098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264316098">(Dec 09 2021 at 15:22)</a>:</h4>
<p>yowl edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-989951759">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>The error message is not clear and it could be that wasmtime is right and my import is wrong.  Unfortuantely wabt's wasm2wat doesn't work for memory64 so not sure how to check that.</p>
</blockquote>



<a name="264721994"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264721994" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264721994">(Dec 13 2021 at 15:25)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-992590383">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>The support for memory64 is not complete and it's still experimental, this is one of the reasons why. Our WASI support currently does not work on memory64, not because it's a fundamental issue but rather because it's just not supported yet, it's something we need to implement and design.</p>
</blockquote>



<a name="264722488"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264722488" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264722488">(Dec 13 2021 at 15:29)</a>:</h4>
<p>yowl <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-992593579">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>Thanks, its not a big deal for me.  I was just looking for a way to test my own 64 support!</p>
</blockquote>



<a name="264723103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264723103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264723103">(Dec 13 2021 at 15:33)</a>:</h4>
<p>alexcrichton unlabeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>Wasm file uploaded</p>
<h3>Steps to Reproduce</h3>
<p>Run with <code>wasmtime --wasm-features memory64</code></p>
<h3>Expected Results</h3>
<p>It runs</p>
<h3>Actual Results</h3>
<p>Fails with</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">ScottWaye</span><span class="err">\</span><span class="n">OneDrive</span><span class="err">\</span><span class="n">wasm64</span><span class="err">\</span><span class="mf">1.</span><span class="n">wasm</span><span class="err">`</span><span class="w"></span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">instantiate</span><span class="w"> </span><span class="s">"C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">ScottWaye</span><span class="se">\\</span><span class="s">OneDrive</span><span class="se">\\</span><span class="s">wasm64</span><span class="se">\\</span><span class="s">1.wasm"</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span>: <span class="nc">incompatible</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="k">type</span> <span class="nc">for</span><span class="w"> </span><span class="err">`</span><span class="n">wasi_snapshot_preview1</span>::<span class="n">fd_write</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span>: <span class="nc">function</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">incompatible</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime 0.31.0</p>
<p>Operating system: Win10</p>
<p>Architecture: x64?</p>
<h3>Extra Info</h3>
<p>Looks like the wasi export is using 32 bit pointers when for memory64 shouldn't it be 64 bit?</p>
<p>Anything else you'd like to add?<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7686227/1.zip">1.zip</a></p>
</blockquote>



<a name="264723104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/264723104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#264723104">(Dec 13 2021 at 15:33)</a>:</h4>
<p>alexcrichton labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>Thanks for filing a bug report! Please fill out the TODOs below.</p>
<p><strong>Note: if you want to report a security issue, please read our <a href="https://bytecodealliance.org/security">security policy</a>!</strong></p>
<h3>Test Case</h3>
<p>Wasm file uploaded</p>
<h3>Steps to Reproduce</h3>
<p>Run with <code>wasmtime --wasm-features memory64</code></p>
<h3>Expected Results</h3>
<p>It runs</p>
<h3>Actual Results</h3>
<p>Fails with</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Error</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="err">`</span><span class="n">C</span>:<span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">ScottWaye</span><span class="err">\</span><span class="n">OneDrive</span><span class="err">\</span><span class="n">wasm64</span><span class="err">\</span><span class="mf">1.</span><span class="n">wasm</span><span class="err">`</span><span class="w"></span>

<span class="n">Caused</span><span class="w"> </span><span class="n">by</span>:
    <span class="mi">0</span>: <span class="nc">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">instantiate</span><span class="w"> </span><span class="s">"C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">ScottWaye</span><span class="se">\\</span><span class="s">OneDrive</span><span class="se">\\</span><span class="s">wasm64</span><span class="se">\\</span><span class="s">1.wasm"</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span>: <span class="nc">incompatible</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="k">type</span> <span class="nc">for</span><span class="w"> </span><span class="err">`</span><span class="n">wasi_snapshot_preview1</span>::<span class="n">fd_write</span><span class="err">`</span><span class="w"></span>
<span class="w">    </span><span class="mi">2</span>: <span class="nc">function</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">incompatible</span>: <span class="nc">expected</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">,</span><span class="w"> </span><span class="kt">i64</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
</code></pre></div>
<h3>Versions and Environment</h3>
<p>Wasmtime version or commit: wasmtime 0.31.0</p>
<p>Operating system: Win10</p>
<p>Architecture: x64?</p>
<h3>Extra Info</h3>
<p>Looks like the wasi export is using 32 bit pointers when for memory64 shouldn't it be 64 bit?</p>
<p>Anything else you'd like to add?<br>
<a href="https://github.com/bytecodealliance/wasmtime/files/7686227/1.zip">1.zip</a></p>
</blockquote>



<a name="561283808"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/561283808" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#561283808">(Dec 01 2025 at 22:01)</a>:</h4>
<p>yagehu <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-3599146738">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>@alexcrichton I hacked together wasm64-wasip1 support for my research needs: <a href="https://github.com/yagehu/wasmtime">https://github.com/yagehu/wasmtime</a></p>
<p>Currently, it largely duplicates <code>wasmtime-wasi</code>'s <code>p1.rs</code> module, so it's not ideal. I attempted a more elegant solution by parameterizing the memory size in wiggle's generated types but stopped because that requires intrusive changes to <code>wasi-common</code>, wiggle, and <code>wasmtime-wasi</code>.</p>
<p>Does the team have any interest in upstreaming this ABI along with the wasi-libc changes? People have expressed interest (e.g. <a href="https://github.com/WebAssembly/wasi-sdk/issues/212">https://github.com/WebAssembly/wasi-sdk/issues/212</a>).</p>
</blockquote>



<a name="561287459"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/561287459" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#561287459">(Dec 01 2025 at 22:27)</a>:</h4>
<p>pchickey <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-3599229004">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>We will not be upstreaming anything into wasmtime that is not standards-compliant. Adding a 64-bit memory ABI to wasip1 will have to be approved by the WASI subgroup before adding it to wasmtime, and in prior discussions in the WASI subgroup there were numerous strong objections to adding wasm64 to wasip1, because wasip1 is already subsumed by the wasip2 (and soon wasip3) revisions.</p>
<p>The last time this came up the action items to move forward in the standards and wasmtime were to add 64-bit memory support to the component model spec, then to wasmtime's component model implementation: <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">https://github.com/bytecodealliance/wasmtime/issues/4311</a> <a href="https://github.com/WebAssembly/component-model/issues/22">https://github.com/WebAssembly/component-model/issues/22</a> . These action items are still looking for someone to work on them</p>
</blockquote>



<a name="561287498"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/561287498" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#561287498">(Dec 01 2025 at 22:27)</a>:</h4>
<p>pchickey edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-3599229004">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>We will not be upstreaming anything into wasmtime that is not standards-compliant. Adding a 64-bit memory ABI to wasip1 will have to be approved by the WASI subgroup before adding it to wasmtime, and in prior discussions in the WASI subgroup there were numerous strong objections to adding wasm64 to wasip1, because wasip1 is already subsumed by the wasip2 (and soon wasip3) revisions.</p>
<p>The last time this came up the action items to move forward in the standards and wasmtime were to add 64-bit memory support to the component model spec, then to wasmtime's component model implementation: <a href="https://github.com/bytecodealliance/wasmtime/issues/4311">https://github.com/bytecodealliance/wasmtime/issues/4311</a> <a href="https://github.com/WebAssembly/component-model/issues/22">https://github.com/WebAssembly/component-model/issues/22</a> . These action items still need someone to work on them.</p>
</blockquote>



<a name="561510669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%233594%20exports%20for%20wasi_snapshot_preview1.../near/561510669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.233594.20exports.20for.20wasi_snapshot_preview1.2E.2E.2E.html#561510669">(Dec 02 2025 at 20:16)</a>:</h4>
<p>yagehu <a href="https://github.com/bytecodealliance/wasmtime/issues/3594#issuecomment-3603801383">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/3594">issue #3594</a>:</p>
<blockquote>
<p>That's totally reasonable. Thanks for the context.</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>