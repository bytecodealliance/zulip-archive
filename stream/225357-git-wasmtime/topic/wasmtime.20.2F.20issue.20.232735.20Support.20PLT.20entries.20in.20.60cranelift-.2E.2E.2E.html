<html>
<head><meta charset="utf-8"><title>wasmtime / issue #2735 Support PLT entries in `cranelift-... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html">wasmtime / issue #2735 Support PLT entries in `cranelift-...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="255809737"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/255809737" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#255809737">(Oct 01 2021 at 21:25)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>JIT for arm64</p>
<h4>Benefit</h4>
<p>x86 works and it would be nice to be able to use it on M1 mac as well</p>
<h4>Implementation</h4>
<p>it currently panics here: <a href="https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195">https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195</a> I'm unsure what needs to change/ whats blocking it</p>
<h4>Alternatives</h4>
<p>only make JIT available on x86<br>
</p>
</blockquote>



<a name="255810332"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/255810332" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#255810332">(Oct 01 2021 at 21:31)</a>:</h4>
<p>akirilov-arm labeled <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>JIT for arm64</p>
<h4>Benefit</h4>
<p>x86 works and it would be nice to be able to use it on M1 mac as well</p>
<h4>Implementation</h4>
<p>it currently panics here: <a href="https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195">https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195</a> I'm unsure what needs to change/ whats blocking it</p>
<h4>Alternatives</h4>
<p>only make JIT available on x86<br>
</p>
</blockquote>



<a name="255811078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/255811078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#255811078">(Oct 01 2021 at 21:38)</a>:</h4>
<p>akirilov-arm <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-932591629">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>Issue #2907 is related to this.</p>
</blockquote>



<a name="502651079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/502651079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#502651079">(Feb 28 2025 at 19:24)</a>:</h4>
<p>Somfic <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2691391402">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>hi, are there any updates on this?  i’m running into</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">PLT</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">x86_64</span>
</code></pre></div>
<p>with <code>use_colocated_libcalls</code> and <code>is_pic</code> flags in my isa set to <code>false</code></p>
</blockquote>



<a name="502654361"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/502654361" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#502654361">(Feb 28 2025 at 19:45)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2691424744">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>@Somfic no, this issue hasn't been worked on. PRs welcome if you're interested in tackling it!</p>
</blockquote>



<a name="502654886"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/502654886" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#502654886">(Feb 28 2025 at 19:49)</a>:</h4>
<p>Somfic <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2691431508">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<blockquote>
<p>@Somfic no, this issue hasn't been worked on. PRs welcome if you're interested in tackling it!</p>
</blockquote>
<p>@cfallin I wish I had the technical knowledge to contribute.</p>
<p>As mentioned earlier in this issue thread, setting <code>is_pic</code> to <code>false</code> should disable PLT entries for aarch64, but it doesn't? Is this a bug or intented behaviour?</p>
</blockquote>



<a name="502655561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/502655561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#502655561">(Feb 28 2025 at 19:54)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2691438489">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>cc @bjorn3 -- I don't know the PLT functionality well enough to say, sorry.</p>
</blockquote>



<a name="503618009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/503618009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#503618009">(Mar 05 2025 at 19:45)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2701907537">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>It is used for the hot code swapping functionality of cranelift-jit that I introduced for cg_clif. I've removed hot code swapping support in <a href="https://github.com/rust-lang/rustc_codegen_cranelift/commit/5d03df9431833ad992c1507fedc7daee3e232443">https://github.com/rust-lang/rustc_codegen_cranelift/commit/5d03df9431833ad992c1507fedc7daee3e232443</a>. I might reintroduce it at some point, but will likely do so by replacing cranelift-jit usage entirely. Because of this and the fact that it reduces portability of cranelift-jit I did propose removing the hot code swapping support from cranelift-jit.</p>
</blockquote>



<a name="503832914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/503832914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#503832914">(Mar 06 2025 at 16:09)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2704294793">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>With <a href="https://github.com/bytecodealliance/wasmtime/pull/10345">https://github.com/bytecodealliance/wasmtime/pull/10345</a> cranelift-jit should work if you set <code>is_pic=false</code> in your <code>TargetIsa</code>. In a future PR I plan to enforce <code>is_pic=false</code> and remove all the PIC handling code that doesn't work on non-x86_64 targets.</p>
</blockquote>



<a name="503834514"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/503834514" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#503834514">(Mar 06 2025 at 16:16)</a>:</h4>
<p>bjorn3 edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/2735#issuecomment-2704294793">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<p>With <a href="https://github.com/bytecodealliance/wasmtime/pull/10345">https://github.com/bytecodealliance/wasmtime/pull/10345</a> cranelift-jit should work if you set <code>is_pic=false</code> in your <code>TargetIsa</code>. In a future PR I plan to enforce <code>is_pic=false</code> and remove all the PIC handling code that doesn't work on non-x86_64 targets. I've already created a branch remove_cranelift_jit_pic_handling for that.</p>
</blockquote>



<a name="507058312"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%232735%20Support%20PLT%20entries%20in%20%60cranelift-.../near/507058312" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.232735.20Support.20PLT.20entries.20in.20.60cranelift-.2E.2E.2E.html#507058312">(Mar 20 2025 at 19:25)</a>:</h4>
<p>abrown closed <a href="https://github.com/bytecodealliance/wasmtime/issues/2735">issue #2735</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>JIT for arm64</p>
<h4>Benefit</h4>
<p>x86 works and it would be nice to be able to use it on M1 mac as well</p>
<h4>Implementation</h4>
<p>it currently panics here: <a href="https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195">https://github.com/bytecodealliance/wasmtime/blob/5fecdfa49150e3304c1b949aab73bd4a0a02dbac/cranelift/jit/src/backend.rs#L183-L195</a> I'm unsure what needs to change/ whats blocking it</p>
<h4>Alternatives</h4>
<p>only make JIT available on x86<br>
</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>