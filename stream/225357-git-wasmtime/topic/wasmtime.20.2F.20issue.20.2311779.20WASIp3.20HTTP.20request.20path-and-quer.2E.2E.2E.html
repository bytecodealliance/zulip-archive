<html>
<head><meta charset="utf-8"><title>wasmtime / issue #11779 WASIp3 HTTP request path-and-quer... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html">wasmtime / issue #11779 WASIp3 HTTP request path-and-quer...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="542698205"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542698205" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542698205">(Oct 02 2025 at 09:38)</a>:</h4>
<p>wingo opened <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>According to <a href="https://www.rfc-editor.org/rfc/rfc3986#section-3.3">RFC 3986 §3.3</a>, the following predicate should define the valid characters in a path:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">is_valid_path_char</span><span class="p">(</span><span class="n">ch</span><span class="p">:</span><span class="w"> </span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"</span>
<span class="w">    </span><span class="n">ch</span><span class="p">.</span><span class="n">is_ascii_alphanumeric</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s">"-._~"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// unreserved</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">'%'</span><span class="w">                                  </span><span class="c1">// pct-encoded</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">"!$&amp;'()*+,;="</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w">                 </span><span class="c1">// sub-delims</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">":@"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>However, the following paths are accepted via <code>request.set_path_and_query</code>:</p>
<ul>
<li><code>/"</code></li>
<li><code>/{</code></li>
<li><code>/|</code></li>
<li><code>/}</code></li>
<li><code>/^</code></li>
<li><code>/[</code></li>
<li><code>/]</code></li>
<li><code>/\</code></li>
<li><code>/#</code></li>
</ul>
<p>What should change here, the spec or Wasmtime?</p>
<p>Relatedly, Wasmtime accepts non-absolute paths, which I am not sure are valid; <a href="https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132">https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132</a>.</p>
</blockquote>



<a name="542698206"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542698206" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542698206">(Oct 02 2025 at 09:38)</a>:</h4>
<p><a href="https://github.com/wingo">wingo</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">Issue #11779</a>.</p>



<a name="542698633"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542698633" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542698633">(Oct 02 2025 at 09:41)</a>:</h4>
<p>wingo edited <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>According to <a href="https://www.rfc-editor.org/rfc/rfc3986#section-3.3">RFC 3986 §3.3</a>, the following predicate should define the valid characters in a path component (besides the <code>/</code> and <code>?</code> delimiters):</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">is_valid_path_char</span><span class="p">(</span><span class="n">ch</span><span class="p">:</span><span class="w"> </span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"</span>
<span class="w">    </span><span class="n">ch</span><span class="p">.</span><span class="n">is_ascii_alphanumeric</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s">"-._~"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// unreserved</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">'%'</span><span class="w">                                  </span><span class="c1">// pct-encoded</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">"!$&amp;'()*+,;="</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w">                 </span><span class="c1">// sub-delims</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">":@"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>However, the following paths are accepted via <code>request.set_path_and_query</code>:</p>
<ul>
<li><code>/"</code></li>
<li><code>/{</code></li>
<li><code>/|</code></li>
<li><code>/}</code></li>
<li><code>/^</code></li>
<li><code>/[</code></li>
<li><code>/]</code></li>
<li><code>/\</code></li>
<li><code>/#</code></li>
</ul>
<p>What should change here, the spec or Wasmtime?</p>
<p>Relatedly, Wasmtime accepts non-absolute paths, which I am not sure are valid; <a href="https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132">https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132</a>.</p>
</blockquote>



<a name="542699176"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542699176" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542699176">(Oct 02 2025 at 09:44)</a>:</h4>
<p>wingo edited <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>According to <a href="https://www.rfc-editor.org/rfc/rfc3986#section-3.3">RFC 3986 §3.3</a>, the following predicate should define the valid characters in a path component (besides the <code>/</code> and <code>?</code> delimiters):</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">is_valid_path_char</span><span class="p">(</span><span class="n">ch</span><span class="p">:</span><span class="w"> </span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// pchar         = unreserved / pct-encoded / sub-delims / ":" / "@"</span>
<span class="w">    </span><span class="n">ch</span><span class="p">.</span><span class="n">is_ascii_alphanumeric</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s">"-._~"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w"> </span><span class="c1">// unreserved</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">'%'</span><span class="w">                                  </span><span class="c1">// pct-encoded</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">"!$&amp;'()*+,;="</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="w">                 </span><span class="c1">// sub-delims</span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="s">":@"</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>However, the following paths are accepted via <code>request.set_path_and_query</code>:</p>
<ul>
<li><code>/"</code></li>
<li><code>/{</code></li>
<li><code>/|</code></li>
<li><code>/}</code></li>
<li><code>/^</code></li>
<li><code>/[</code></li>
<li><code>/]</code></li>
<li><code>/\</code></li>
<li><code>/#</code></li>
</ul>
<p>What should change here, the spec or Wasmtime?</p>
<p>Relatedly, Wasmtime accepts non-absolute paths, which I am not sure are valid; <a href="https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132">https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132</a>.</p>
</blockquote>



<a name="542702739"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542702739" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542702739">(Oct 02 2025 at 10:02)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360267571">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>I think the http crate is following <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>, which is a formalization of how actual browsers behave in practice. Also for <code>"</code>, <code>{</code> and <code>}</code> see:</p>
<p><a href="https://github.com/hyperium/http/blob/439d1c50d71e3be3204b6c4a1bf2255ed78e1f93/src/uri/path.rs#L62-L73">https://github.com/hyperium/http/blob/439d1c50d71e3be3204b6c4a1bf2255ed78e1f93/src/uri/path.rs#L62-L73</a></p>
</blockquote>



<a name="542705083"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542705083" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542705083">(Oct 02 2025 at 10:15)</a>:</h4>
<p>tschneidereit <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360325070">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>As @bjorn3 says, this follows what browsers do, because the RFC isn't web compatible.</p>
<blockquote>
<p>Relatedly, Wasmtime accepts non-absolute paths, which I am not sure are valid; <a href="https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3359974132">WebAssembly/wasi-http#178 (comment)</a>.</p>
</blockquote>
<p>I think this is a bit underspecified, yeah. It's useful in practice for hosts that route traffic based on patterns that don't just include the host, but also other aspects of the URL: in such a case, it can make sense to interpret relative URLs as relative to the incoming request's URL. At the very least, changing this might be a breaking change at this point (though I'm not certain it is.)</p>
</blockquote>



<a name="542723769"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542723769" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542723769">(Oct 02 2025 at 12:02)</a>:</h4>
<p>wingo <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360858733">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>FWIW, @lukewagner is saying in <a href="https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3238221648">https://github.com/WebAssembly/wasi-http/issues/178#issuecomment-3238221648</a> that at least some parts of RFC 9110 are web-compatible.  I don't have a horse in this race, I just want things to be specified somewhere.  Could be an RFC, could be a whatwg spec, could have some WASI-specific exceptions, but they should be written down.</p>
</blockquote>



<a name="542726654"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542726654" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542726654">(Oct 02 2025 at 12:16)</a>:</h4>
<p>wingo <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360926237">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>that comment in the http crate is delightful :)</p>
</blockquote>



<a name="542727467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542727467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542727467">(Oct 02 2025 at 12:20)</a>:</h4>
<p>wingo <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360945643">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>Regarding the URL WhatWG spec -- I don't think it's the right reference for WASI.  Otherwise <code>wasi:http</code> would allow spaces in URIs and perform percent-encoding/decoding, but it does not, and that is fine.</p>
</blockquote>



<a name="542727610"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542727610" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542727610">(Oct 02 2025 at 12:21)</a>:</h4>
<p>wingo edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/11779#issuecomment-3360945643">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">issue #11779</a>:</p>
<blockquote>
<p>Regarding the URL WhatWG spec -- I don't think it's the right reference for WASI.  Otherwise <code>wasi:http</code> would allow spaces in URIs and perform percent-encoding/decoding, but it does not, and that is fine.  I am happy to be corrected of course :)</p>
</blockquote>



<a name="542756060"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311779%20WASIp3%20HTTP%20request%20path-and-quer.../near/542756060" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311779.20WASIp3.20HTTP.20request.20path-and-quer.2E.2E.2E.html#542756060">(Oct 02 2025 at 14:26)</a>:</h4>
<p><a href="https://github.com/alexcrichton">alexcrichton</a> added the wasi:impl label to <a href="https://github.com/bytecodealliance/wasmtime/issues/11779">Issue #11779</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>