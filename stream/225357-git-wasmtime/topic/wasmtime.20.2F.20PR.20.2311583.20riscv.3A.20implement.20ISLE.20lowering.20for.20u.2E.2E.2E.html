<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11583 riscv: implement ISLE lowering for u... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html">wasmtime / PR #11583 riscv: implement ISLE lowering for u...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="537188015"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537188015" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537188015">(Sep 02 2025 at 00:29)</a>:</h4>
<p>thatrajeevkr opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a> from <code>thatrajeevkr:fix/riscv-uadd-overflow</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Implements ISLE lowering for uadd_overflow.i64 in the RISC-V backend, enabling Cranelift to handle unsigned addition with overflow for 64-bit, sub-64-bit, and 128-bit types.</p>
<p>i64: add + sltu to detect overflow</p>
<p>Sub-64-bit types: zero-extend, then add + sltu</p>
<p>i128: multiword add with carry propagation</p>
<p>Fixes unsupported feature error when compiling Wasm modules with large address offsets</p>
<p>Fix <a href="https://github.com/bytecodealliance/wasmtime/issues/11540">#11540</a></p>
</blockquote>



<a name="537188019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537188019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537188019">(Sep 02 2025 at 00:29)</a>:</h4>
<p><strong>thatrajeevkr</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537188020"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537188020" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537188020">(Sep 02 2025 at 00:29)</a>:</h4>
<p><strong>thatrajeevkr</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537243094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537243094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537243094">(Sep 02 2025 at 09:17)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3175625712">PR review</a>.</p>



<a name="537243095"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537243095" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537243095">(Sep 02 2025 at 09:17)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2315455402">PR review comment</a>:</p>
<blockquote>
<p>I don't think this would work. rv_sltu does a 64bit unsigned less than comparison, but if you add two 32bit integers into a 64bit register you will never overflow the full 64bit and thus <code>tmp_x + tmp_y</code> will never be less than <code>tmp_x</code>. What LLVM does instead is to use a 32bit add (<code>addw</code>), in which case <code>sltu</code> would work just fine. That way also only <code>x</code> would need to be zero extended I think. <a href="https://rust.godbolt.org/z/zz5avj33h">https://rust.godbolt.org/z/zz5avj33h</a></p>
</blockquote>



<a name="537251671"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537251671" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537251671">(Sep 02 2025 at 10:05)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537251840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537251840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537251840">(Sep 02 2025 at 10:06)</a>:</h4>
<p>thatrajeevkr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3175838118">PR review</a>.</p>



<a name="537251842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537251842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537251842">(Sep 02 2025 at 10:06)</a>:</h4>
<p>thatrajeevkr created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2315601833">PR review comment</a>:</p>
<blockquote>
<p>Thanks for the input, I have put in a small fix for this.</p>
</blockquote>



<a name="537255078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537255078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537255078">(Sep 02 2025 at 10:29)</a>:</h4>
<p><strong>thatrajeevkr</strong> requested <a href="https://github.com/bjorn3">bjorn3</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537323677"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537323677" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537323677">(Sep 02 2025 at 16:26)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3177320128">PR review</a>:</p>
<blockquote>
<p>This looks good -- thanks!</p>
<p>In addition to the little formatting nit below, could you update <a href="https://github.com/bytecodealliance/wasmtime/blob/main/cranelift/filetests/filetests/runtests/uadd_overflow.clif">our runtest</a> for this instruction so that it tests riscv64 too?</p>
</blockquote>



<a name="537323683"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537323683" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537323683">(Sep 02 2025 at 16:26)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2316596176">PR review comment</a>:</p>
<blockquote>
<p>Tiny nit, but let's have a blank line between the section header comment and the <code>;; For i64 ...</code> start of this rule.</p>
</blockquote>



<a name="537326657"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537326657" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537326657">(Sep 02 2025 at 16:42)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537326745"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537326745" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537326745">(Sep 02 2025 at 16:43)</a>:</h4>
<p>thatrajeevkr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3177373333">PR review</a>.</p>



<a name="537326746"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537326746" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537326746">(Sep 02 2025 at 16:43)</a>:</h4>
<p>thatrajeevkr created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2316637068">PR review comment</a>:</p>
<blockquote>
<p>just made this change now!</p>
</blockquote>



<a name="537328278"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537328278" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537328278">(Sep 02 2025 at 16:53)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537329738"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537329738" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537329738">(Sep 02 2025 at 17:01)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3177425352">PR review</a>:</p>
<blockquote>
<p>Thanks!</p>
</blockquote>



<a name="537329755"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537329755" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537329755">(Sep 02 2025 at 17:01)</a>:</h4>
<p>cfallin has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537332885"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537332885" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537332885">(Sep 02 2025 at 17:20)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#issuecomment-3246180308">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>:</p>
<blockquote>
<p>@thatrajeevkr it looks like the runtest <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/17410416652/job/49425967217?pr=11583">failed</a> because it also contains narrower-than-32-bit cases; in theory you could implement those as well, but probably the easier fix is to split the runtest file into two (keep the preamble and split the test functions and expectations), with 64/32-bit cases separate from 16/8-bit cases (perhaps in a file called <code>uadd_overflow_narrow.clif</code>)?</p>
</blockquote>



<a name="537332957"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537332957" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537332957">(Sep 02 2025 at 17:20)</a>:</h4>
<p>cfallin edited a <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#issuecomment-3246180308">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>:</p>
<blockquote>
<p>@thatrajeevkr it looks like the runtest <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/17410416652/job/49425967217?pr=11583">failed</a> because it also contains narrower-than-32-bit cases; in theory you could implement those as well, but probably the easier fix is to split the runtest file into two (keep the preamble and split the test functions and expectations), with 128/64/32-bit cases separate from 16/8-bit cases (perhaps in a file called <code>uadd_overflow_narrow.clif</code>) and then enable riscv64 only for 128/64/32 bits?</p>
</blockquote>



<a name="537359846"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537359846" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537359846">(Sep 02 2025 at 20:32)</a>:</h4>
<p>cfallin has disabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537359848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537359848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537359848">(Sep 02 2025 at 20:32)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537364114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537364114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537364114">(Sep 02 2025 at 21:04)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#issuecomment-3246785261">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>:</p>
<blockquote>
<p>@thatrajeevkr It looks like an <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/17415282801/job/49442153710?pr=11583#step:19:576">i128 test</a> is failing now, showing overflow when there is none -- mind taking a look?</p>
</blockquote>



<a name="537365797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537365797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537365797">(Sep 02 2025 at 21:18)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537366477"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537366477" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537366477">(Sep 02 2025 at 21:24)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3178174524">PR review</a>.</p>



<a name="537366481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537366481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537366481">(Sep 02 2025 at 21:24)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2317205463">PR review comment</a>:</p>
<blockquote>
<p>Thinking about this tweak -- I suspect that the second arm of the OR was supposed to cover the case where the high-half sum wraps around back to the original value when carry is set?</p>
<p>That is, normally we can see if <code>x + y</code> overflows by checking if the sum is less than <code>x</code> (has wrapped around). The closest it can get is if <code>y</code> is all-ones (<code>-1</code>), then we get to <code>x - 1</code>; so strict less than (<code>sltu</code>, i.e., set-less-than unsigned) is appropriate.</p>
<p>But for <code>x + y + carry</code>, it's possible that the sum wraps around all the way back to <code>x</code>, so <code>carry &amp;&amp; (x + y + carry == x)</code> is the appropriate second case, I think? So overall <code>sum_hi_with_carry &lt; x_hi || (carry &amp;&amp; sum_high_with_carry == x_hi)</code>?</p>
</blockquote>



<a name="537367050"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537367050" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537367050">(Sep 02 2025 at 21:29)</a>:</h4>
<p>thatrajeevkr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3178184147">PR review</a>.</p>



<a name="537367051"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537367051" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537367051">(Sep 02 2025 at 21:29)</a>:</h4>
<p>thatrajeevkr created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2317212745">PR review comment</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">overflow</span><span class="w"> </span><span class="n">XReg</span><span class="w"> </span><span class="p">(</span><span class="n">rv_or</span><span class="w"> </span><span class="p">(</span><span class="n">rv_sltu</span><span class="w"> </span><span class="n">sum_hi_with_carry</span><span class="w"> </span><span class="n">x_hi</span><span class="p">)</span>
<span class="w">                     </span><span class="p">(</span><span class="n">rv_and</span><span class="w"> </span><span class="n">carry</span><span class="w"> </span><span class="p">(</span><span class="n">rv_eq</span><span class="w"> </span><span class="n">sum_hi_with_carry</span><span class="w"> </span><span class="n">x_hi</span><span class="p">)))</span>
</code></pre></div>
<p>how about this method? <br>
</p>
</blockquote>



<a name="537370434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537370434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537370434">(Sep 02 2025 at 22:01)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3178255265">PR review</a>.</p>



<a name="537370436"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537370436" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537370436">(Sep 02 2025 at 22:01)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2317263657">PR review comment</a>:</p>
<blockquote>
<p>That looks right; and I think the <a href="https://github.com/bytecodealliance/wasmtime/actions/runs/17416248333/job/49445312095?pr=11583">remaining failure</a> should cover the case that this handles!</p>
</blockquote>



<a name="537371917"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537371917" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537371917">(Sep 02 2025 at 22:15)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537373134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537373134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537373134">(Sep 02 2025 at 22:27)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3178337343">PR review</a>.</p>



<a name="537373135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537373135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537373135">(Sep 02 2025 at 22:27)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2317314039">PR review comment</a>:</p>
<blockquote>
<p>@thatrajeevkr actually it appears that <code>rv_eq</code> isn't a defined constructor -- see the latest test failures. You should be able to <code>cargo check</code> locally (as that error message states) to iterate until it builds at least, before going through a CI roundtrip. (We also have docs on cross-compiling and testing with qemu if you want to iterate on the runtest locally, but that's much more involved...)</p>
</blockquote>



<a name="537473637"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537473637" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537473637">(Sep 03 2025 at 13:14)</a>:</h4>
<p>thatrajeevkr submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#pullrequestreview-3180624750">PR review</a>.</p>



<a name="537473639"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537473639" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537473639">(Sep 03 2025 at 13:14)</a>:</h4>
<p>thatrajeevkr created <a href="https://github.com/bytecodealliance/wasmtime/pull/11583#discussion_r2318945479">PR review comment</a>:</p>
<blockquote>
<p>I found a fix for this which builds fine in my local, I will commit those changes.</p>
</blockquote>



<a name="537514266"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537514266" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537514266">(Sep 03 2025 at 16:29)</a>:</h4>
<p>thatrajeevkr updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<a name="537523676"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311583%20riscv%3A%20implement%20ISLE%20lowering%20for%20u.../near/537523676" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311583.20riscv.3A.20implement.20ISLE.20lowering.20for.20u.2E.2E.2E.html#537523676">(Sep 03 2025 at 17:25)</a>:</h4>
<p>cfallin merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11583">PR #11583</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>