<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11777 CI: Add SDE (emulator) to CI · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html">wasmtime / PR #11777 CI: Add SDE (emulator) to CI</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="542630983"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542630983" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542630983">(Oct 01 2025 at 23:50)</a>:</h4>
<p>rahulchaphalkar opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a> from <code>rahulchaphalkar:sde-emulator-pr</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Adds <a href="https://www.intel.com/content/www/us/en/developer/articles/tool/software-development-emulator.html">Intel SDE</a> to the CI in preparation of testing new instructions like APX, which are not available in QEMU.<br>
SDE only tests <code>wasmtime-tools</code> for now, via <code>crate</code> field in <code>config</code>. <br>
Have disabled sharding when <code>crate</code> field is present, assumption for now is this would only list few crates (1 in this case).<br>
Uses following action to setup SDE - <a href="https://github.com/petarpetrovt/setup-sde">https://github.com/petarpetrovt/setup-sde</a></p>
<p>SDE Tests get triggered with a <code>prtest:sde</code> commit message, similar to some other components.</p>
<ul>
<li><code>prtest:sde</code> will only run sde tests</li>
<li><code>prtest:full</code> will run everything _except_ sde tests</li>
<li><code>prtest:full</code> + <code>prtest:sde</code> will run all tests including sde tests</li>
</ul>
<p>The env variables like <code>WASMTIME_TEST_NO_SDE</code> are introduced (similar to Qemu) to provide a clean way to disable any tests that are problematic, but are not being used right now. Can remove them if needed.</p>
<p>@jlb6740 @abrown </p>
</blockquote>



<a name="542630988"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542630988" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542630988">(Oct 01 2025 at 23:50)</a>:</h4>
<p><strong>rahulchaphalkar</strong> requested <a href="https://github.com/pchickey">pchickey</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>.</p>



<a name="542630990"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542630990" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542630990">(Oct 01 2025 at 23:50)</a>:</h4>
<p><strong>rahulchaphalkar</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>.</p>



<a name="542757554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542757554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542757554">(Oct 02 2025 at 14:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#discussion_r2399039946">PR review comment</a>:</p>
<blockquote>
<p>For this we have enough concurrency that it's ok to omit this. Basically it's fine to run by default on CI, and I'm at least personally otherwise wary of not running it by default as it means it would likely  bitrot pretty quickly.</p>
</blockquote>



<a name="542757555"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542757555" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542757555">(Oct 02 2025 at 14:32)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#pullrequestreview-3294935922">PR review</a>:</p>
<blockquote>
<p>Thanks! One thing this might be useful for is the avx512 lowerings which probably aren't tested much on CI right now. Could you confirm that our avx512 runtests are running in the SDE?</p>
</blockquote>



<a name="542757559"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/542757559" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#542757559">(Oct 02 2025 at 14:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#discussion_r2399042970">PR review comment</a>:</p>
<blockquote>
<p>Does this do much more than a curl + tar command? If so could this be manually done instead of using a 3rd-party action?</p>
</blockquote>



<a name="543001126"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543001126" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543001126">(Oct 03 2025 at 18:17)</a>:</h4>
<p>rahulchaphalkar <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#issuecomment-3366752862">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>:</p>
<blockquote>
<blockquote>
<p>Thanks! One thing this might be useful for is the avx512 lowerings which probably aren't tested much on CI right now. Could you confirm that our avx512 runtests are running in the SDE?</p>
</blockquote>
<p>@alexcrichton I was looking into this to have a definite answer, and here's where I am thus far - </p>
<ul>
<li>There are 4 runtests which include some variant of avx512 like <code>has_avx512f</code>, <code>has_avx512vl</code> etc.</li>
<li>I am testing these out locally on a system with AVX512 present (ICX) with <code>RUST_LOG=trace</code>, just natively without SDE</li>
<li>I see SSE and AVX instructions in the log, but not AVX512. I tested by modifying a clif test (simd-shuffle.clif) to only include <code>has_avx512vl</code> and variants (and remove <code>sse</code>, <code>avx</code> etc) and I don't see any <code>vshufps</code> instructions. When I include <code>has_avx</code> then I do see <code>vshufps</code>.</li>
</ul>
<p>With SDE -</p>
<ul>
<li>I tested in a similar way with SDE, and have same results. When I configure SDE with a platform without AVX support, then I see just <code>shufps</code> as expected from SSE, and configured with AVX capable platform, I see <code>vshufps</code>.</li>
</ul>
<p>I also checked this with the python script that CI uses to kick things off, <code>./ci/run-tests.py</code> with and without SDE.<br>
To summarize, I do think AVX512 tests from runtests are being run, and the results match with and without SDE, but I am not sure if AVX512 instructions are being generated or not (doesn't look like it) for either case.<br>
</p>
</blockquote>



<a name="543002213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543002213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543002213">(Oct 03 2025 at 18:23)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#issuecomment-3366772701">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>:</p>
<blockquote>
<p>Thanks for investigating! That matches what my rough expectations would be, so I think it's safe to conclude "yep working as intended"</p>
</blockquote>



<a name="543007301"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543007301" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543007301">(Oct 03 2025 at 18:55)</a>:</h4>
<p>rahulchaphalkar updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>.</p>



<a name="543008079"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543008079" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543008079">(Oct 03 2025 at 19:01)</a>:</h4>
<p>rahulchaphalkar submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#pullrequestreview-3300489910">PR review</a>.</p>



<a name="543008082"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543008082" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543008082">(Oct 03 2025 at 19:01)</a>:</h4>
<p>rahulchaphalkar created <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#discussion_r2403051842">PR review comment</a>:</p>
<blockquote>
<p>Done, doing it manually similar to qemu now.</p>
</blockquote>



<a name="543008146"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543008146" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543008146">(Oct 03 2025 at 19:01)</a>:</h4>
<p>rahulchaphalkar submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#pullrequestreview-3300491692">PR review</a>.</p>



<a name="543008148"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543008148" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543008148">(Oct 03 2025 at 19:01)</a>:</h4>
<p>rahulchaphalkar created <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#discussion_r2403053332">PR review comment</a>:</p>
<blockquote>
<p>Sure, removed it, now sde tests should run with full ci run</p>
</blockquote>



<a name="543008326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543008326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543008326">(Oct 03 2025 at 19:02)</a>:</h4>
<p>rahulchaphalkar edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>:</p>
<blockquote>
<p>Adds <a href="https://www.intel.com/content/www/us/en/developer/articles/tool/software-development-emulator.html">Intel SDE</a> to the CI in preparation of testing new instructions like APX, which are not available in QEMU.<br>
SDE only tests <code>wasmtime-tools</code> for now, via <code>crate</code> field in <code>config</code>. <br>
Have disabled sharding when <code>crate</code> field is present, assumption for now is this would only list few crates (1 in this case).<br>
Uses following action to setup SDE - <a href="https://github.com/petarpetrovt/setup-sde">https://github.com/petarpetrovt/setup-sde</a></p>
<p>SDE Tests get triggered with a <code>prtest:sde</code> commit message, similar to some other components.</p>
<ul>
<li><code>prtest:sde</code> will only run sde tests</li>
<li><code>prtest:full</code> will run everything _except_ sde tests</li>
<li><code>prtest:full</code> + <code>prtest:sde</code> will run all tests including sde tests</li>
</ul>
<p>The env variables like <code>WASMTIME_TEST_NO_SDE</code> are introduced (similar to Qemu) to provide a clean way to disable any tests that are problematic, but are not being used right now. Can remove them if needed.</p>
<p>@jlb6740 @abrown <br>
Edit -<br>
Based off feedback below, SDE tests now run with a full CI run as well, previously they were filtered out and only ran for <code>prtest:sde</code>. Now they run for <code>prtest:sde</code> as well as <code>prtest:full</code>.<br>
</p>
</blockquote>



<a name="543014618"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543014618" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543014618">(Oct 03 2025 at 19:18)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11777#pullrequestreview-3300564563">PR review</a>.</p>



<a name="543018831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311777%20CI%3A%20Add%20SDE%20%28emulator%29%20to%20CI/near/543018831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311777.20CI.3A.20Add.20SDE.20.28emulator.29.20to.20CI.html#543018831">(Oct 03 2025 at 19:41)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11777">PR #11777</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>