<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11213 Add option to use regalloc3 as the r... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html">wasmtime / PR #11213 Add option to use regalloc3 as the r...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="528124360"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124360" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124360">(Jul 10 2025 at 16:52)</a>:</h4>
<p>Amanieu opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a> from <code>Amanieu:regalloc3</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This is based on <a href="https://github.com/bytecodealliance/regalloc2/pull/230">https://github.com/bytecodealliance/regalloc2/pull/230</a> which adds regalloc3 as a back-end to regalloc2.</p>
<p>Only one change had to be made to codegen: tail calls were reserving <code>r11</code> as a scratch register by making it a def on the return instruction. This is not supported by regalloc3, which allows it extends all live ranges to the end of <code>ret</code> instruction so that the live range segment can merge with the next one. Since a def on a return instruction is meaningless, I've changed it to a hard-coded register in the emit stage instead.</p>
</blockquote>



<a name="528124362"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124362" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124362">(Jul 10 2025 at 16:52)</a>:</h4>
<p><strong>Amanieu</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528124363"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124363" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124363">(Jul 10 2025 at 16:52)</a>:</h4>
<p><strong>Amanieu</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528124364"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124364" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124364">(Jul 10 2025 at 16:52)</a>:</h4>
<p><strong>Amanieu</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528124365"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124365" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124365">(Jul 10 2025 at 16:52)</a>:</h4>
<p><strong>Amanieu</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528124366"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124366" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124366">(Jul 10 2025 at 16:52)</a>:</h4>
<p><strong>Amanieu</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528124907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528124907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528124907">(Jul 10 2025 at 16:55)</a>:</h4>
<p>Amanieu updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528135907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528135907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528135907">(Jul 10 2025 at 18:07)</a>:</h4>
<p>Amanieu updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528156770"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528156770" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528156770">(Jul 10 2025 at 20:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#issuecomment-3059017657">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @cfallin, @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "cranelift", "cranelift:area:machinst", "cranelift:area:x64", "cranelift:meta", "isle", "wasmtime:api", "wasmtime:config"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>cfallin: isle</li>
<li>fitzgen: isle</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="528163716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528163716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528163716">(Jul 10 2025 at 21:46)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#issuecomment-3059204384">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>:</p>
<blockquote>
<h4>Label Messager: wasmtime:config</h4>
<p>It looks like you are changing Wasmtime's configuration options. Make sure to<br>
complete this check list:</p>
<ul>
<li>
<p>[ ] If you added a new <code>Config</code> method, you wrote extensive documentation for<br>
      it.</p>
<p>&lt;details&gt;</p>
<p>Our documentation should be of the following form:</p>
<p>```text<br>
Short, simple summary sentence.</p>
<p>More details. These details can be multiple paragraphs. There should be<br>
information about not just the method, but its parameters and results as<br>
well.</p>
<p>Is this method fallible? If so, when can it return an error?</p>
<p>Can this method panic? If so, when does it panic?</p>
<h1>Example</h1>
<p>Optional example here.<br>
```</p>
<p>&lt;/details&gt;</p>
</li>
<li>
<p>[ ] If you added a new <code>Config</code> method, or modified an existing one, you<br>
  ensured that this configuration is exercised by the fuzz targets.</p>
<p>&lt;details&gt;</p>
<p>For example, if you expose a new strategy for allocating the next instance<br>
slot inside the pooling allocator, you should ensure that at least one of our<br>
fuzz targets exercises that new strategy.</p>
<p>Often, all that is required of you is to ensure that there is a knob for this<br>
configuration option in [<code>wasmtime_fuzzing::Config</code>][fuzzing-config] (or one<br>
of its nested <code>struct</code>s).</p>
<p>Rarely, this may require authoring a new fuzz target to specifically test this<br>
configuration. See [our docs on fuzzing][fuzzing-docs] for more details.</p>
<p>&lt;/details&gt;</p>
</li>
<li>
<p>[ ] If you are enabling a configuration option by default, make sure that it<br>
  has been fuzzed for at least two weeks before turning it on by default.</p>
</li>
</ul>
<p>[fuzzing-config]: <a href="https://github.com/bytecodealliance/wasmtime/blob/ca0e8d0a1d8cefc0496dba2f77a670571d8fdcab/crates/fuzzing/src/generators.rs#L182-L194">https://github.com/bytecodealliance/wasmtime/blob/ca0e8d0a1d8cefc0496dba2f77a670571d8fdcab/crates/fuzzing/src/generators.rs#L182-L194</a><br>
[fuzzing-docs]: <a href="https://docs.wasmtime.dev/contributing-fuzzing.html">https://docs.wasmtime.dev/contributing-fuzzing.html</a></p>
<hr>
<p>&lt;details&gt;</p>
<p>To modify this label's message, edit the &lt;code&gt;.github/label-messager/wasmtime-config.md&lt;/code&gt; file.</p>
<p>To add new label messages or remove existing label messages, edit the<br>
&lt;code&gt;.github/label-messager.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/label-messager-action">Learn more.</a></p>
<p>&lt;/details&gt;</p>
</blockquote>



<a name="528175927"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528175927" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528175927">(Jul 10 2025 at 23:58)</a>:</h4>
<p>Amanieu updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="528189512"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528189512" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528189512">(Jul 11 2025 at 03:17)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#issuecomment-3060186495">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "fuzzing"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: fuzzing</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="528721998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528721998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528721998">(Jul 14 2025 at 18:55)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#pullrequestreview-3017430892">PR review</a>:</p>
<blockquote>
<p>LGTM modulo comment below, removing the <code>[patch.crates-io]</code> bits when upstream is ready, and getting CI passing.</p>
</blockquote>



<a name="528722000"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528722000" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528722000">(Jul 14 2025 at 18:55)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#discussion_r2205598713">PR review comment</a>:</p>
<blockquote>
<p>This might be true for our current calling conventions, but is not guaranteed to continue to hold true in the future. As such, could you assert that <code>call_info.uses</code> doesn't contain any uses of <code>r11</code> to future proof this code?</p>
</blockquote>



<a name="528755549"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528755549" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528755549">(Jul 14 2025 at 23:15)</a>:</h4>
<p>Amanieu submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#pullrequestreview-3018055338">PR review</a>.</p>



<a name="528755550"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/528755550" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#528755550">(Jul 14 2025 at 23:15)</a>:</h4>
<p>Amanieu created <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#discussion_r2205974385">PR review comment</a>:</p>
<blockquote>
<p>Actually, I've been over-thinking this. We can keep the existing code and just change it to an early-def, which <em>is</em> allowed by regalloc3 on return instructions. It could even be changed to an arbitrary register constraint in the future once regalloc2 support is dropped.</p>
</blockquote>



<a name="529084748"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/529084748" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#529084748">(Jul 16 2025 at 15:20)</a>:</h4>
<p>Amanieu updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="529084934"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/529084934" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#529084934">(Jul 16 2025 at 15:21)</a>:</h4>
<p>Amanieu updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="529085005"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/529085005" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#529085005">(Jul 16 2025 at 15:21)</a>:</h4>
<p>Amanieu submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#pullrequestreview-3025553142">PR review</a>.</p>



<a name="529085006"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/529085006" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#529085006">(Jul 16 2025 at 15:21)</a>:</h4>
<p>Amanieu created <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#discussion_r2210753566">PR review comment</a>:</p>
<blockquote>
<p>Actually an arbitrary register wouldn't work since it could conflict with callee-saved registers. I've added the assert as you suggested.</p>
</blockquote>



<a name="529085542"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/529085542" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#529085542">(Jul 16 2025 at 15:24)</a>:</h4>
<p>Amanieu <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#issuecomment-3079133776">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>:</p>
<blockquote>
<p>Regarding CI, there are currently 3 issues:</p>
<ul>
<li>regalloc3 depends on brie-tree (fast B-Tree implementation) which has an MSRV of 1.88.</li>
<li>brie-tree uses allocator-api 0.3 but other dependencies of wasmtime use allocator-api 0.2. This fails cargo deny due to the duplicate dependency.</li>
<li>regalloc3/brie-tree probably need to be vetted. But this can wait until the crate is actually published.</li>
</ul>
</blockquote>



<a name="530365603"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/530365603" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#530365603">(Jul 23 2025 at 14:51)</a>:</h4>
<p>cfallin closed without merge <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>.</p>



<a name="530365616"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311213%20Add%20option%20to%20use%20regalloc3%20as%20the%20r.../near/530365616" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311213.20Add.20option.20to.20use.20regalloc3.20as.20the.20r.2E.2E.2E.html#530365616">(Jul 23 2025 at 14:51)</a>:</h4>
<p>cfallin <a href="https://github.com/bytecodealliance/wasmtime/pull/11213#issuecomment-3108985524">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11213">PR #11213</a>:</p>
<blockquote>
<p>As noted in <a href="https://github.com/bytecodealliance/regalloc2/issues/230">bytecodealliance/regalloc2#230</a>, Cranelift maintainers have decided not to take regalloc3 at this time due to maintenance-burden concerns, so I'll go ahead and close this. Thank you for all the effort regardless!</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>