<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11096 Add CI job to verify static library ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html">wasmtime / PR #11096 Add CI job to verify static library ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="525154359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525154359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525154359">(Jun 21 2025 at 11:52)</a>:</h4>
<p>thedevyashsaini opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a> from <code>thedevyashsaini:main</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This PR introduces a dedicated CI job (<code>build-static-lib</code>) that verifies the static library build of Wasmtime by passing <code>-DWASMEDGE_BUILD_STATIC_LIB=ON</code> to CMake.</p>
<h3>Changes:</h3>
<ul>
<li>Added a standalone <code>build-static-lib</code> job in <code>.github/workflows/main.yml</code>, triggered alongside regular builds.</li>
<li>This job uses a fixed Rust toolchain (<code>stable</code>) and target (<code>x86_64-unknown-linux-gnu</code>).</li>
<li>It runs independently of the main matrix-based <code>build</code> job to avoid cache conflicts or artifact overrides.</li>
<li>Static build logic is activated via <code>static=true</code> passed to <code>ci/build-release-artifacts.sh</code>.</li>
</ul>
<h3>Motivation:</h3>
<p>Static library builds can fail due to symbol collisions or source file name conflicts. CI coverage ensures we catch such regressions early.</p>
<h3>Related:</h3>
<p>Fixes <a href="https://github.com/WasmEdge/WasmEdge/issues/3608">#3608</a><br>
Refs <a href="https://github.com/WasmEdge/WasmEdge/pull/3607#issuecomment-2254381977">this comment</a> suggesting the need for a <code>STATIC_LIB=ON</code> build in CI.<br>
</p>
</blockquote>



<a name="525154361"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525154361" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525154361">(Jun 21 2025 at 11:52)</a>:</h4>
<p><strong>thedevyashsaini</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>.</p>



<a name="525154362"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525154362" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525154362">(Jun 21 2025 at 11:52)</a>:</h4>
<p><strong>thedevyashsaini</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>.</p>



<a name="525174669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525174669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525174669">(Jun 21 2025 at 19:11)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993728989">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>@thedevyashsaini did you mean to send this PR to the WasmEdge project instead of Wasmtime?</p>
</blockquote>



<a name="525175367"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525175367" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525175367">(Jun 21 2025 at 19:31)</a>:</h4>
<p>thedevyashsaini <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993736379">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>@alexcrichton yeaah, this started as a fix for WasmEdge and somewhere down the rabbit hole I ended up static linking Wasmtime by instinct <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span><br>
That said - the CI test might still be useful here, but feel free to shut it down if it's out of scope...</p>
</blockquote>



<a name="525182523"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525182523" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525182523">(Jun 21 2025 at 23:05)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993810153">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>Ok, in that case I'm going to close this beacuse I don't think this does what you think it does in terms of testing. AFAIK this doesn't actually do anything on CI as the cmake option you specify here isn't read anywhere. As a result I'm going to close this.</p>
</blockquote>



<a name="525182524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525182524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525182524">(Jun 21 2025 at 23:05)</a>:</h4>
<p>alexcrichton closed without merge <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>.</p>



<a name="525196059"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525196059" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525196059">(Jun 22 2025 at 05:47)</a>:</h4>
<p>thedevyashsaini <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993954301">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>@alexcrichton </p>
<blockquote>
<p>Totally understand closing this — thanks for reviewing!</p>
<p>Just wanted to clarify one point you mentioned:</p>
<blockquote>
<p>“the cmake option you specify here isn’t read anywhere…”</p>
</blockquote>
<p>I believe it <em>is</em> wired through the CI scripts. Here’s the flow I followed:</p>
<ul>
<li>
<p>In <code>.github/workflows/main.yml</code> (line \~1115), the job runs:</p>
<p><code>bash
static=true ./ci/build-release-artifacts.sh release x86_64-unknown-linux-gnu
</code></p>
</li>
<li>
<p>Then inside <code>ci/build-release-artifacts.sh</code> the "static" option is checked, around line 69:</p>
<p><code>bash
if [[ "$static" == "true" ]]; then
  cmake_flags="$cmake_flags -DWASMEDGE_BUILD_STATIC_LIB=ON"
fi
</code></p>
</li>
<li>
<p>These <code>$cmake_flags</code> are passed into the <code>cmake</code> command at line \~82:</p>
<p><code>bash
cmake \
  -G Ninja \
  ../../crates/c-api \
  $cmake_flags \
  ...
</code></p>
</li>
<li>
<p>So <code>-DWASMEDGE_BUILD_STATIC_LIB=ON</code> <em>should</em> be included in the build, unless I’ve misunderstood something else upstream (like the flag not being handled in the actual CMakeLists).</p>
</li>
</ul>
<p>In any case, totally fair to close this if it's not useful — just thought I'd clarify in case this ends up being worth revisiting later. Cheers! </p>
</blockquote>
</blockquote>



<a name="525196136"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525196136" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525196136">(Jun 22 2025 at 05:48)</a>:</h4>
<p>thedevyashsaini deleted a <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993954301">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>@alexcrichton </p>
<blockquote>
<p>Totally understand closing this — thanks for reviewing!</p>
<p>Just wanted to clarify one point you mentioned:</p>
<blockquote>
<p>“the cmake option you specify here isn’t read anywhere…”</p>
</blockquote>
<p>I believe it <em>is</em> wired through the CI scripts. Here’s the flow I followed:</p>
<ul>
<li>
<p>In <code>.github/workflows/main.yml</code> (line \~1115), the job runs:</p>
<p><code>bash
static=true ./ci/build-release-artifacts.sh release x86_64-unknown-linux-gnu
</code></p>
</li>
<li>
<p>Then inside <code>ci/build-release-artifacts.sh</code> the "static" option is checked, around line 69:</p>
<p><code>bash
if [[ "$static" == "true" ]]; then
  cmake_flags="$cmake_flags -DWASMEDGE_BUILD_STATIC_LIB=ON"
fi
</code></p>
</li>
<li>
<p>These <code>$cmake_flags</code> are passed into the <code>cmake</code> command at line \~82:</p>
<p><code>bash
cmake \
  -G Ninja \
  ../../crates/c-api \
  $cmake_flags \
  ...
</code></p>
</li>
<li>
<p>So <code>-DWASMEDGE_BUILD_STATIC_LIB=ON</code> <em>should</em> be included in the build, unless I’ve misunderstood something else upstream (like the flag not being handled in the actual CMakeLists).</p>
</li>
</ul>
<p>In any case, totally fair to close this if it's not useful — just thought I'd clarify in case this ends up being worth revisiting later. Cheers! </p>
</blockquote>
</blockquote>



<a name="525196228"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311096%20Add%20CI%20job%20to%20verify%20static%20library%20.../near/525196228" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311096.20Add.20CI.20job.20to.20verify.20static.20library.20.2E.2E.2E.html#525196228">(Jun 22 2025 at 05:51)</a>:</h4>
<p>thedevyashsaini <a href="https://github.com/bytecodealliance/wasmtime/pull/11096#issuecomment-2993955700">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11096">PR #11096</a>:</p>
<blockquote>
<p>Thanks for the review! Yep, just realized <code>-DWASMEDGE_BUILD_STATIC_LIB</code> isn’t defined in Wasmtime’s CMake. Appreciate the clarification!<br>
</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>