<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11175 Remove hash tables and bump chunk fr... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html">wasmtime / PR #11175 Remove hash tables and bump chunk fr...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="526872287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872287">(Jul 02 2025 at 20:09)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a> from <code>fitzgen:issue-11162-no-hash-sets-in-drc</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This removes the explicit <code>HashSet</code>s used to represent the over-approximated-stack-roots and precise-stack-roots sets and replaces them with an intrusive, singly-linked list and a mark bit in the object headers respectively. The new list implementation also subsumes the old bump chunk that sat in front of the old over-approximated-stack-roots hash set.</p>
<p>This shaves off about 25% of the time it takes to run the test case in <a href="https://github.com/bytecodealliance/wasmtime/issues/11141">https://github.com/bytecodealliance/wasmtime/issues/11141</a> for me locally.</p>
<p>This also ended up being a nice simplification of the DRC collector, which in turn allowed us to further simplify the <code>GcHeap</code> trait, since we no longer ever need to GC before passing GC refs into Wasm.</p>
<p>Fixes <a href="https://github.com/bytecodealliance/wasmtime/issues/11162">https://github.com/bytecodealliance/wasmtime/issues/11162</a></p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="526872290"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872290" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872290">(Jul 02 2025 at 20:09)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526872291"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872291" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872291">(Jul 02 2025 at 20:09)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526872294"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872294" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872294">(Jul 02 2025 at 20:09)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526872295"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872295" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872295">(Jul 02 2025 at 20:09)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526872371"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872371" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872371">(Jul 02 2025 at 20:09)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526872500"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872500" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872500">(Jul 02 2025 at 20:10)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#pullrequestreview-2980492293">PR review</a>.</p>



<a name="526872501"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526872501" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526872501">(Jul 02 2025 at 20:10)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180890055">PR review comment</a>:</p>
<blockquote>
<p>This was such a silly bug but it made me feel like I was losing my mind :facepalm: </p>
</blockquote>



<a name="526875007"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875007" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875007">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180908751">PR review comment</a>:</p>
<blockquote>
<p>s/table/list/</p>
</blockquote>



<a name="526875008"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875008" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875008">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#pullrequestreview-2980516748">PR review</a>:</p>
<blockquote>
<p>This looks generally good to me -- nice speedups too! Just a few thoughts below.</p>
</blockquote>



<a name="526875009"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875009" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875009">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180900643">PR review comment</a>:</p>
<blockquote>
<p>Do we want to defer this list-head update until after the code below sets up the object at the head? Otherwise there's a risk the intermediate state is visible -- perhaps fine (we're not a concurrent mutator) but if e.g. a trap occurs or we add some kind of observability mechanism it might present an edge case, especially as we delegate the setup to helpers. Basically it seems cleaner to me to keep the "making it live is the last store" pattern here.</p>
</blockquote>



<a name="526875010"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875010" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875010">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180907223">PR review comment</a>:</p>
<blockquote>
<p>s/approximized/approximated/</p>
</blockquote>



<a name="526875011"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875011" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875011">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180908605">PR review comment</a>:</p>
<blockquote>
<p>s/logivally/logically/</p>
</blockquote>



<a name="526875012"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875012" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875012">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180908364">PR review comment</a>:</p>
<blockquote>
<p>s/table/list/ ?</p>
</blockquote>



<a name="526875013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875013">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180920061">PR review comment</a>:</p>
<blockquote>
<p>The function name here says <code>u26</code> but the comment, and the function above as well, say <code>u27</code> / <code>27-bit</code> -- they should match I think?</p>
</blockquote>



<a name="526875014"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875014" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875014">(Jul 02 2025 at 20:31)</a>:</h4>
<p>cfallin created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180916140">PR review comment</a>:</p>
<blockquote>
<p>I'm not sure I see why we load this value twice -- can we use <code>next</code> below when we patch the prev link?</p>
</blockquote>



<a name="526875132"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875132" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875132">(Jul 02 2025 at 20:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180919951">PR review comment</a>:</p>
<blockquote>
<p>Could this method be removed entirely in favor taking a <code>bit: bool</code> parameter in <code>set_in_over_approximated_stack_roots</code> above? That way the callers would inherit the comment of "no need to update the over approximated set" which I think would make more sense in the context of callers than here.</p>
</blockquote>



<a name="526875133"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875133" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875133">(Jul 02 2025 at 20:32)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#pullrequestreview-2980523815">PR review</a>:</p>
<blockquote>
<p>Really like how this worked out, especially how it simplifies passing GC references into wasm</p>
</blockquote>



<a name="526875134"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526875134" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526875134">(Jul 02 2025 at 20:32)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2180905282">PR review comment</a>:</p>
<blockquote>
<p>Could this expand on what's being marked?</p>
</blockquote>



<a name="526885351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526885351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526885351">(Jul 02 2025 at 21:55)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#pullrequestreview-2980744406">PR review</a>.</p>



<a name="526885353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526885353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526885353">(Jul 02 2025 at 21:55)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2181041732">PR review comment</a>:</p>
<blockquote>
<p>It shouldn't matter either way -- as you mention, there isn't any concurrency here -- but happy to swap things around.</p>
</blockquote>



<a name="526887437"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526887437" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526887437">(Jul 02 2025 at 22:17)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#pullrequestreview-2980791297">PR review</a>.</p>



<a name="526887440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526887440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526887440">(Jul 02 2025 at 22:17)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#discussion_r2181071470">PR review comment</a>:</p>
<blockquote>
<p><code>VMGcRef</code> doesn't implement <code>Clone</code> since cloning a <code>VMGcRef</code> potentially needs to run barriers, so we have dedicated methods to clone with those barriers if necessary. However, inside the GC implementation that isn't really a concern so we have <code>unchecked_copy</code> for these cases that don't need barriers. That said, when the GC ref is wrapped in an <code>Option</code> like it is here, it can be a bit of a mouthful, and we would have to do <code>next.as_ref().map(|r| r.unchecked_copy())</code>. So I figured I'd just grab it from the header twice and let LLVM clean things up.</p>
</blockquote>



<a name="526888379"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526888379" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526888379">(Jul 02 2025 at 22:26)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526888797"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526888797" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526888797">(Jul 02 2025 at 22:30)</a>:</h4>
<p>fitzgen has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="526900431"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/526900431" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#526900431">(Jul 03 2025 at 01:05)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/11175#issuecomment-3029966494">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api", "wasmtime:ref-types"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: wasmtime:ref-types</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="527024600"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/527024600" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#527024600">(Jul 03 2025 at 15:28)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="527024757"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/527024757" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#527024757">(Jul 03 2025 at 15:29)</a>:</h4>
<p>fitzgen has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="527041945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/527041945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#527041945">(Jul 03 2025 at 17:07)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<a name="527046961"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311175%20Remove%20hash%20tables%20and%20bump%20chunk%20fr.../near/527046961" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311175.20Remove.20hash.20tables.20and.20bump.20chunk.20fr.2E.2E.2E.html#527046961">(Jul 03 2025 at 17:43)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11175">PR #11175</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>