<html>
<head><meta charset="utf-8"><title>wasmtime / issue #11685 LTS version of wasmtime does not ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html">wasmtime / issue #11685 LTS version of wasmtime does not ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="538918895"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/538918895" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#538918895">(Sep 11 2025 at 18:13)</a>:</h4>
<p>simongdavies opened <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>We are embedding wasmtime in hyperlight-wasm. We do not support being able to compile wasm in hyperlight-wasm so we compile to cwasm offline and load those compiled versions at runtime.</p>
<p>This creates a problem when we want to upgrade from one version of wasmtime to another in that we need to create and keep/distribute a cwasm version for each version of wasmtime that is in use.</p>
<p>We had hoped to be able to use LTS versions of wasmtime to reduce the need to recompile but it would seem that LTS versions have the same behaviour as other versions in this regard. </p>
<p>Is this intentional? <br>
Is it something that would be open to changing?</p>
<p>The following demonstrates this issue:</p>
<p><div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">wasmtime --version</span>
<span class="go">wasmtime 36.0.1</span>

<span class="go">wasmtime run --invoke add add.wasm 1 2</span>
<span class="go">warning: using `--invoke` with a function that takes arguments is experimental and may break in the future</span>
<span class="go">warning: using `--invoke` with a function that returns values is experimental and may break in the future</span>
<span class="go">3</span>

<span class="go">wasmtime compile add.wasm</span>

<span class="go">wasmtime run --invoke add --allow-precompiled add.cwasm 1 2</span>
<span class="go">warning: using `--invoke` with a function that takes arguments is experimental and may break in the future</span>
<span class="go">warning: using `--invoke` with a function that returns values is experimental and may break in the future</span>
<span class="go">3</span>

<span class="go">cargo install wasmtime-cli --locked --version 36.0.2</span>

<span class="go">wasmtime run --invoke add --allow-precompiled add.cwasm 1 2</span>
<span class="go">Error: failed deserialization for: add.cwasm</span>

<span class="go">Caused by:</span>
<span class="go">    Module was compiled with incompatible Wasmtime version '36.0.1'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="538923941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/538923941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#538923941">(Sep 11 2025 at 18:49)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11685#issuecomment-3282236237">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>This is intentional insofar as we bake the version string into cwasms and ensure that the loaded version string matches. It's less intentional in the sense that this decision was made in the context of major versions of wasmtime, not patch versions. In that sense I'd personally agree that this is probably a guarantee that we should provide. I'll look to make a PR, thanks for opening the issue!</p>
</blockquote>



<a name="538924684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/538924684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#538924684">(Sep 11 2025 at 18:54)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/11685#issuecomment-3282253298">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>Allowing this would restrict the kind of changes patch releases can make, right? And if the patch is on the Cranelift side, then you necessarily have to recompile to get the security fix.</p>
</blockquote>



<a name="538925096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/538925096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#538925096">(Sep 11 2025 at 18:57)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11685#issuecomment-3282261315">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>Correct yeah, and indeed if the bug is in Cranelift's output a recompile would be necessary. We also have the escape hatch of updating the version string matching manually in case a conscious break is actually needed.</p>
</blockquote>



<a name="540140908"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/540140908" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#540140908">(Sep 18 2025 at 03:48)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>We are embedding wasmtime in hyperlight-wasm. We do not support being able to compile wasm in hyperlight-wasm so we compile to cwasm offline and load those compiled versions at runtime.</p>
<p>This creates a problem when we want to upgrade from one version of wasmtime to another in that we need to create and keep/distribute a cwasm version for each version of wasmtime that is in use.</p>
<p>We had hoped to be able to use LTS versions of wasmtime to reduce the need to recompile but it would seem that LTS versions have the same behaviour as other versions in this regard. </p>
<p>Is this intentional? <br>
Is it something that would be open to changing?</p>
<p>The following demonstrates this issue:</p>
<p><div class="codehilite" data-code-language="Bash Session"><pre><span></span><code><span class="go">wasmtime --version</span>
<span class="go">wasmtime 36.0.1</span>

<span class="go">wasmtime run --invoke add add.wasm 1 2</span>
<span class="go">warning: using `--invoke` with a function that takes arguments is experimental and may break in the future</span>
<span class="go">warning: using `--invoke` with a function that returns values is experimental and may break in the future</span>
<span class="go">3</span>

<span class="go">wasmtime compile add.wasm</span>

<span class="go">wasmtime run --invoke add --allow-precompiled add.cwasm 1 2</span>
<span class="go">warning: using `--invoke` with a function that takes arguments is experimental and may break in the future</span>
<span class="go">warning: using `--invoke` with a function that returns values is experimental and may break in the future</span>
<span class="go">3</span>

<span class="go">cargo install wasmtime-cli --locked --version 36.0.2</span>

<span class="go">wasmtime run --invoke add --allow-precompiled add.cwasm 1 2</span>
<span class="go">Error: failed deserialization for: add.cwasm</span>

<span class="go">Caused by:</span>
<span class="go">    Module was compiled with incompatible Wasmtime version '36.0.1'</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="540140909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2311685%20LTS%20version%20of%20wasmtime%20does%20not%20.../near/540140909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2311685.20LTS.20version.20of.20wasmtime.20does.20not.20.2E.2E.2E.html#540140909">(Sep 18 2025 at 03:48)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/11685#issuecomment-3305318629">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/11685">issue #11685</a>:</p>
<blockquote>
<p>Fixed in <a href="https://github.com/bytecodealliance/wasmtime/pull/11687">https://github.com/bytecodealliance/wasmtime/pull/11687</a></p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>