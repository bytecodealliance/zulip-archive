<html>
<head><meta charset="utf-8"><title>wasmtime / PR #12600 wasi-sockets: Align stream tests wit... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html">wasmtime / PR #12600 wasi-sockets: Align stream tests wit...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="574172939"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574172939" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574172939">(Feb 16 2026 at 19:32)</a>:</h4>
<p><strong>badeend</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-wasi-reviewers">wasmtime-wasi-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574172941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574172941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574172941">(Feb 16 2026 at 19:32)</a>:</h4>
<p>badeend opened <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a> from <code>badeend:tcp-streams-once</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Aside from <code>test_tcp_read_cancellation</code>, all other P3 TCP stream tests were transliterated from their P2 counterpart. Some of those ex-P2 tests were testing the interaction between the old <code>tcp-socket::shutdown</code> method and its effect of the input/output streams. In P3, <code>shutdown</code> is called automatically when the stream is dropped, so that test code is not really relevant in P3.</p>
<p>This PR:</p>
<ul>
<li>Rewrites/renames/removes some existing tests.</li>
<li>Adds <code>test_tcp_send_drops_stream_when_remote_shutdown</code>: The <code>SendStreamConsumer</code> did not handle <code>EPIPE</code> correctly yet.</li>
<li>Adds <code>test_tcp_stream_lifetimes</code> to test the new behavior from <a href="https://github.com/WebAssembly/WASI/pull/870">https://github.com/WebAssembly/WASI/pull/870</a></li>
<li>Adds <code>test_tcp_receive_once</code> &amp; <code>test_tcp_send_once</code>. Because <code>tcp-socket::send/receive</code> may be called successfully at most once.<ul>
<li>To make this work, I've refactored the <code>Connected</code>, <code>Receiving</code> &amp; <code>P2Streaming</code> states into one.</li>
</ul>
</li>
</ul>
</blockquote>



<a name="574172942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574172942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574172942">(Feb 16 2026 at 19:32)</a>:</h4>
<p><strong>badeend</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574172943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574172943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574172943">(Feb 16 2026 at 19:32)</a>:</h4>
<p><strong>badeend</strong> requested <a href="https://github.com/alexcrichton">alexcrichton</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574182026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574182026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574182026">(Feb 16 2026 at 20:51)</a>:</h4>
<p>github-actions[bot] added the label <code>wasi</code> on <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574395130"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574395130" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574395130">(Feb 17 2026 at 22:12)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/12600#pullrequestreview-3816563998">PR review</a>.</p>



<a name="574395168"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574395168" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574395168">(Feb 17 2026 at 22:12)</a>:</h4>
<p>alexcrichton added <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600 wasi-sockets: Align stream tests with current P3 spec</a> to the merge queue.</p>



<a name="574397817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574397817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574397817">(Feb 17 2026 at 22:33)</a>:</h4>
<p>github-merge-queue[bot] removed <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600 wasi-sockets: Align stream tests with current P3 spec</a> from the merge queue.</p>



<a name="574823783"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574823783" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574823783">(Feb 19 2026 at 21:19)</a>:</h4>
<p>badeend updated <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574823938"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574823938" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574823938">(Feb 19 2026 at 21:20)</a>:</h4>
<p>badeend <a href="https://github.com/bytecodealliance/wasmtime/pull/12600#issuecomment-3930132131">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>:</p>
<blockquote>
<p>@alexcrichton Could you try again?</p>
</blockquote>



<a name="574824515"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574824515" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574824515">(Feb 19 2026 at 21:23)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574825938"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574825938" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574825938">(Feb 19 2026 at 21:32)</a>:</h4>
<p>alexcrichton added <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600 wasi-sockets: Align stream tests with current P3 spec</a> to the merge queue.</p>



<a name="574831480"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574831480" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574831480">(Feb 19 2026 at 22:11)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600</a>.</p>



<a name="574831481"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2312600%20wasi-sockets%3A%20Align%20stream%20tests%20wit.../near/574831481" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2312600.20wasi-sockets.3A.20Align.20stream.20tests.20wit.2E.2E.2E.html#574831481">(Feb 19 2026 at 22:11)</a>:</h4>
<p>alexcrichton removed <a href="https://github.com/bytecodealliance/wasmtime/pull/12600">PR #12600 wasi-sockets: Align stream tests with current P3 spec</a> from the merge queue.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>