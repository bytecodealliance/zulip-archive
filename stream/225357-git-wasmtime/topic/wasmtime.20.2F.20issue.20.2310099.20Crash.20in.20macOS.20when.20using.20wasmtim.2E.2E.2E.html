<html>
<head><meta charset="utf-8"><title>wasmtime / issue #10099 Crash in macOS when using wasmtim... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html">wasmtime / issue #10099 Crash in macOS when using wasmtim...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="495690871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495690871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495690871">(Jan 24 2025 at 11:18)</a>:</h4>
<p><a href="https://github.com/plusvic">plusvic</a> added the bug label to <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">Issue #10099</a>.</p>



<a name="495690873"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495690873" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495690873">(Jan 24 2025 at 11:19)</a>:</h4>
<p>plusvic opened <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>This is a very esoteric issue related to the use of Mach ports for exception handling when <code>wasmtime</code> is running inside a Python 3.9 process.  I'm the author of a multi-platform Rust library that embeds <code>wasmtime</code> for running WASM code, the library supports Linux, Windows and macOS. This library also have Python bindings that allow using the library from Python.</p>
<p>A user of the library reported a crash that was happening in a very specific environment: macOS 15.2 (both Intel and ARM are affected, and probably other macOS versions too), with Python 3.9.6 (the version that comes pre-installed in macOS). The process was being SIGKILLed when executing code deep inside <code>wasmtime</code>, the same code worked fine in other platforms, or in the same macOS machine with Python 3.11.</p>
<p>After some investigation everything pointed to the Mach ports exception handling mechanism when <code>wasmtime</code> is run inside Python 3.9. In fact, if I turn off the use of Mach ports in wasmtime everything works fine.</p>
<p>I don't have a clue on why this is happening only with Python 3.9. My guess is that it is related to Python's exception handling mechanism that somewhat is interfering with wasmtime's exception handling, and perhaps something changed in later Python versions. It could be a Python's bug that was fixed, it could a design change. For the time being I can turn off Mach ports as a workaround, but I would like to understand what's happening here.</p>
<p><a href="https://github.com/user-attachments/files/18534657/wasmtime-python.zip">wasmtime-python.zip</a></p>
<h3>Test Case</h3>
<p>As my library is a quite complicated project, I've created a simple Rust project that reproduces the issue (attached to this issue). It consists in a Python extension written in Rust using <a href="https://github.com/PyO3/pyo3">PyO3</a>, this extension exports a function that </p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Decompress the Rust project attached to this issue</li>
<li>Build the python extension using <a href="https://github.com/PyO3/maturin">maturin</a>: <code>maturin build --release</code></li>
<li>Install the Python extension: <code>/usr/bin/python3 -m pip install &lt;path to the .whl file produced by maturin&gt;</code></li>
<li>Run the <code>crash.py</code> file included in the project: <code>/usr/bin/python3 crash.py</code></li>
</ul>
<h3>Expected Results</h3>
<p>The process should finish without crashes. </p>
<h3>Actual Results</h3>
<p>The process gets killed:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span><span class="w">                                                                                                                   </span><span class="err"></span><span class="w"> </span><span class="err">✔</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">    </span><span class="mi">34279</span><span class="w"> </span><span class="n">killed</span><span class="w">     </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
<p>The crash log is included below, notice that the exception type is <code>EXC_GUARD</code> and the code is <code>GUARD_TYPE_MACH_PORT</code>. According to Apple's <a href="https://developer.apple.com/documentation/xcode/exc_guard">documentation</a>, the process is killed with <code>EXC_GUARD</code> when it detects a violation in some guarded resourced, usually a file descriptor or Mach port.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">-------------------------------------</span>
<span class="n">Translated</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="p">(</span><span class="n">Full</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="n">Below</span><span class="p">)</span>
<span class="o">-------------------------------------</span>

<span class="n">Process</span><span class="p">:</span><span class="w">               </span><span class="nc">Python</span><span class="w"> </span><span class="p">[</span><span class="mi">34279</span><span class="p">]</span>
<span class="n">Path</span><span class="p">:</span><span class="w">                  </span><span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Xcode</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python3</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">Python</span>
<span class="n">Identifier</span><span class="p">:</span><span class="w">            </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">python3</span>
<span class="n">Version</span><span class="p">:</span><span class="w">               </span><span class="mf">3.9.6</span><span class="w"> </span><span class="p">(</span><span class="mf">3.9.6</span><span class="p">)</span>
<span class="n">Build</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w">            </span><span class="nc">python3</span><span class="o">-</span><span class="mi">141000000000000</span><span class="o">~</span><span class="mi">2583</span>
<span class="n">Code</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">             </span><span class="nc">X86</span><span class="o">-</span><span class="mi">64</span><span class="w"> </span><span class="p">(</span><span class="n">Native</span><span class="p">)</span>
<span class="n">Parent</span><span class="w"> </span><span class="n">Process</span><span class="p">:</span><span class="w">        </span><span class="nc">zsh</span><span class="w"> </span><span class="p">[</span><span class="mi">1143</span><span class="p">]</span>
<span class="n">Responsible</span><span class="p">:</span><span class="w">           </span><span class="nc">iTerm2</span><span class="w"> </span><span class="p">[</span><span class="mi">911</span><span class="p">]</span>
<span class="n">User</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w">               </span><span class="mi">178948</span>

<span class="n">Date</span><span class="o">/</span><span class="n">Time</span><span class="p">:</span><span class="w">             </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">24</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">27.1988</span><span class="w"> </span><span class="o">+</span><span class="mi">0100</span>
<span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">            </span><span class="nc">macOS</span><span class="w"> </span><span class="mf">15.2</span><span class="w"> </span><span class="p">(</span><span class="mi">24</span><span class="n">C101</span><span class="p">)</span>
<span class="n">Report</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">        </span><span class="mi">12</span>
<span class="n">Bridge</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">     </span><span class="mf">9.2</span><span class="w"> </span><span class="p">(</span><span class="mi">22</span><span class="n">P2093</span><span class="p">)</span>
<span class="n">Anonymous</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">        </span><span class="mi">5</span><span class="n">FA73C73</span><span class="o">-</span><span class="mi">360</span><span class="n">A</span><span class="o">-</span><span class="n">C399</span><span class="o">-</span><span class="n">E0CC</span><span class="o">-</span><span class="mi">3</span><span class="n">B9EAB5492D0</span>

<span class="n">Sleep</span><span class="o">/</span><span class="n">Wake</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">       </span><span class="nc">CA017020</span><span class="o">-</span><span class="mi">8</span><span class="n">C6C</span><span class="o">-</span><span class="mi">41</span><span class="n">A1</span><span class="o">-</span><span class="n">AE24</span><span class="o">-</span><span class="n">D06480AE16DB</span>

<span class="n">Time</span><span class="w"> </span><span class="n">Awake</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Boot</span><span class="p">:</span><span class="w"> </span><span class="mi">80000</span><span class="w"> </span><span class="n">seconds</span>
<span class="n">Time</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Wake</span><span class="p">:</span><span class="w">       </span><span class="mi">5718</span><span class="w"> </span><span class="n">seconds</span>

<span class="n">System</span><span class="w"> </span><span class="n">Integrity</span><span class="w"> </span><span class="n">Protection</span><span class="p">:</span><span class="w"> </span><span class="nc">enabled</span>

<span class="n">Crashed</span><span class="w"> </span><span class="n">Thread</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>

<span class="n">Exception</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">        </span><span class="nc">EXC_GUARD</span><span class="w"> </span><span class="p">(</span><span class="n">SIGKILL</span><span class="p">)</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="nc">GUARD_TYPE_MACH_PORT</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="mh">0x0000000000000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0000000000000000</span>

<span class="n">Termination</span><span class="w"> </span><span class="n">Reason</span><span class="p">:</span><span class="w">    </span><span class="nc">Namespace</span><span class="w"> </span><span class="n">GUARD</span><span class="p">,</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="mi">2305843034983497728</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">Crashed</span><span class="p">::</span><span class="w">  </span><span class="nc">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5dfffb</span><span class="w"> </span><span class="n">thread_set_exception_ports</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">134</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d421005</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">lazy_per_thread_init</span><span class="p">::</span><span class="n">h995e1f3306bad314</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">69</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce54cd5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">tls</span><span class="p">::</span><span class="n">raw</span><span class="p">::</span><span class="n">replace</span><span class="p">::</span><span class="n">h7b1ea496b7d61dcd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">85</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6cc95</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">catch_traps</span><span class="p">::</span><span class="n">haad6173518c65209</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">213</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd66c62</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">func</span><span class="p">::</span><span class="n">typed</span><span class="p">::</span><span class="n">TypedFunc</span><span class="cp">$LT$Params$C$Results$GT$</span><span class="p">::</span><span class="n">call</span><span class="p">::</span><span class="n">h4ad4a8810ccdb7a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">354</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6e575</span><span class="w"> </span><span class="n">wasmtime_python</span><span class="p">::</span><span class="n">_</span><span class="cp">$LT$impl$u20$wasmtime_python</span><span class="o">..</span><span class="n">sum</span><span class="o">..</span><span class="n">MakeDef</span><span class="cp">$GT$</span><span class="p">::</span><span class="n">_PYO3_DEF</span><span class="p">::</span><span class="n">trampoline</span><span class="p">::</span><span class="n">hfe78f2643f499858</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1077</span>
<span class="mi">8</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c0a6ae8</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">535272</span>
<span class="mi">9</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c066830</span><span class="w"> </span><span class="n">_PyObject_MakeTpCall</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">384</span>
<span class="mi">10</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c143850</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1177680</span>
<span class="mi">11</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c140557</span><span class="w"> </span><span class="n">_PyEval_EvalFrameDefault</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">23527</span>
<span class="mi">12</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c144693</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1181331</span>
<span class="mi">13</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c13a871</span><span class="w"> </span><span class="n">PyEval_EvalCode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">81</span>
<span class="mi">14</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c181ea1</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433249</span>
<span class="mi">15</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c182013</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433619</span>
<span class="mi">16</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c1802a4</span><span class="w"> </span><span class="n">PyRun_SimpleFileExFlags</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">708</span>
<span class="mi">17</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19d6f0</span><span class="w"> </span><span class="n">Py_RunMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1840</span>
<span class="mi">18</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19db80</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1547136</span>
<span class="mi">19</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19dbdb</span><span class="w"> </span><span class="n">Py_BytesMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">20</span><span class="w">  </span><span class="n">dyld</span><span class="w">                                </span><span class="mh">0x7ff80b28d2cd</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1805</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e2016</span><span class="w"> </span><span class="n">mach_msg_overwrite</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">649</span>
<span class="mi">3</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5db1ff</span><span class="w"> </span><span class="n">mach_msg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">19</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce55ef5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">handler_thread</span><span class="p">::</span><span class="n">hbfc195b7bc426a10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">277</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce08da9</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h9512e42a7b3024a7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cdec98a</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">hd93b48b54e95ca2f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">138</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e</span>
<span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">truncated</span><span class="p">]</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="495691120"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495691120" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495691120">(Jan 24 2025 at 11:20)</a>:</h4>
<p>plusvic edited <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>This is a very esoteric issue related to the use of Mach ports for exception handling when <code>wasmtime</code> is running inside a Python 3.9 process.  I'm the author of a multi-platform Rust library that embeds <code>wasmtime</code> for running WASM code, the library supports Linux, Windows and macOS. This library also have Python bindings that allow using the library from Python.</p>
<p>A user of the library reported a crash that was happening in a very specific environment: macOS 15.2 (both Intel and ARM are affected, and probably other macOS versions too), with Python 3.9.6 (the version that comes pre-installed in macOS). The process was being SIGKILLed when executing code deep inside <code>wasmtime</code>, the same code worked fine in other platforms, or in the same macOS machine with Python 3.11.</p>
<p>After some investigation everything pointed to the Mach ports exception handling mechanism when <code>wasmtime</code> is run inside Python 3.9. In fact, if I turn off the use of Mach ports in wasmtime everything works fine.</p>
<p>I don't have a clue on why this is happening only with Python 3.9. My guess is that it is related to Python's exception handling mechanism that somewhat is interfering with wasmtime's exception handling, and perhaps something changed in later Python versions. It could be a Python's bug that was fixed, it could a design change. For the time being I can turn off Mach ports as a workaround, but I would like to understand what's happening here.</p>
<p><a href="https://github.com/user-attachments/files/18534657/wasmtime-python.zip">wasmtime-python.zip</a></p>
<h3>Test Case</h3>
<p>As my library is a quite complicated project, I've created a simple Rust project that reproduces the issue (attached to this issue). It consists in a Python extension written in Rust using <a href="https://github.com/PyO3/pyo3">PyO3</a>.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Decompress the Rust project attached to this issue</li>
<li>Build the python extension using <a href="https://github.com/PyO3/maturin">maturin</a>: <code>maturin build --release</code></li>
<li>Install the Python extension: <code>/usr/bin/python3 -m pip install &lt;path to the .whl file produced by maturin&gt;</code></li>
<li>Run the <code>crash.py</code> file included in the project: <code>/usr/bin/python3 crash.py</code></li>
</ul>
<h3>Expected Results</h3>
<p>The process should finish without crashes. </p>
<h3>Actual Results</h3>
<p>The process gets killed:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span><span class="w">                                                                                                                   </span><span class="err"></span><span class="w"> </span><span class="err">✔</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">    </span><span class="mi">34279</span><span class="w"> </span><span class="n">killed</span><span class="w">     </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
<p>The crash log is included below, notice that the exception type is <code>EXC_GUARD</code> and the code is <code>GUARD_TYPE_MACH_PORT</code>. According to Apple's <a href="https://developer.apple.com/documentation/xcode/exc_guard">documentation</a>, the process is killed with <code>EXC_GUARD</code> when it detects a violation in some guarded resourced, usually a file descriptor or Mach port.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">-------------------------------------</span>
<span class="n">Translated</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="p">(</span><span class="n">Full</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="n">Below</span><span class="p">)</span>
<span class="o">-------------------------------------</span>

<span class="n">Process</span><span class="p">:</span><span class="w">               </span><span class="nc">Python</span><span class="w"> </span><span class="p">[</span><span class="mi">34279</span><span class="p">]</span>
<span class="n">Path</span><span class="p">:</span><span class="w">                  </span><span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Xcode</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python3</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">Python</span>
<span class="n">Identifier</span><span class="p">:</span><span class="w">            </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">python3</span>
<span class="n">Version</span><span class="p">:</span><span class="w">               </span><span class="mf">3.9.6</span><span class="w"> </span><span class="p">(</span><span class="mf">3.9.6</span><span class="p">)</span>
<span class="n">Build</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w">            </span><span class="nc">python3</span><span class="o">-</span><span class="mi">141000000000000</span><span class="o">~</span><span class="mi">2583</span>
<span class="n">Code</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">             </span><span class="nc">X86</span><span class="o">-</span><span class="mi">64</span><span class="w"> </span><span class="p">(</span><span class="n">Native</span><span class="p">)</span>
<span class="n">Parent</span><span class="w"> </span><span class="n">Process</span><span class="p">:</span><span class="w">        </span><span class="nc">zsh</span><span class="w"> </span><span class="p">[</span><span class="mi">1143</span><span class="p">]</span>
<span class="n">Responsible</span><span class="p">:</span><span class="w">           </span><span class="nc">iTerm2</span><span class="w"> </span><span class="p">[</span><span class="mi">911</span><span class="p">]</span>
<span class="n">User</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w">               </span><span class="mi">178948</span>

<span class="n">Date</span><span class="o">/</span><span class="n">Time</span><span class="p">:</span><span class="w">             </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">24</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">27.1988</span><span class="w"> </span><span class="o">+</span><span class="mi">0100</span>
<span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">            </span><span class="nc">macOS</span><span class="w"> </span><span class="mf">15.2</span><span class="w"> </span><span class="p">(</span><span class="mi">24</span><span class="n">C101</span><span class="p">)</span>
<span class="n">Report</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">        </span><span class="mi">12</span>
<span class="n">Bridge</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">     </span><span class="mf">9.2</span><span class="w"> </span><span class="p">(</span><span class="mi">22</span><span class="n">P2093</span><span class="p">)</span>
<span class="n">Anonymous</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">        </span><span class="mi">5</span><span class="n">FA73C73</span><span class="o">-</span><span class="mi">360</span><span class="n">A</span><span class="o">-</span><span class="n">C399</span><span class="o">-</span><span class="n">E0CC</span><span class="o">-</span><span class="mi">3</span><span class="n">B9EAB5492D0</span>

<span class="n">Sleep</span><span class="o">/</span><span class="n">Wake</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">       </span><span class="nc">CA017020</span><span class="o">-</span><span class="mi">8</span><span class="n">C6C</span><span class="o">-</span><span class="mi">41</span><span class="n">A1</span><span class="o">-</span><span class="n">AE24</span><span class="o">-</span><span class="n">D06480AE16DB</span>

<span class="n">Time</span><span class="w"> </span><span class="n">Awake</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Boot</span><span class="p">:</span><span class="w"> </span><span class="mi">80000</span><span class="w"> </span><span class="n">seconds</span>
<span class="n">Time</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Wake</span><span class="p">:</span><span class="w">       </span><span class="mi">5718</span><span class="w"> </span><span class="n">seconds</span>

<span class="n">System</span><span class="w"> </span><span class="n">Integrity</span><span class="w"> </span><span class="n">Protection</span><span class="p">:</span><span class="w"> </span><span class="nc">enabled</span>

<span class="n">Crashed</span><span class="w"> </span><span class="n">Thread</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>

<span class="n">Exception</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">        </span><span class="nc">EXC_GUARD</span><span class="w"> </span><span class="p">(</span><span class="n">SIGKILL</span><span class="p">)</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="nc">GUARD_TYPE_MACH_PORT</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="mh">0x0000000000000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0000000000000000</span>

<span class="n">Termination</span><span class="w"> </span><span class="n">Reason</span><span class="p">:</span><span class="w">    </span><span class="nc">Namespace</span><span class="w"> </span><span class="n">GUARD</span><span class="p">,</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="mi">2305843034983497728</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">Crashed</span><span class="p">::</span><span class="w">  </span><span class="nc">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5dfffb</span><span class="w"> </span><span class="n">thread_set_exception_ports</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">134</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d421005</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">lazy_per_thread_init</span><span class="p">::</span><span class="n">h995e1f3306bad314</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">69</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce54cd5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">tls</span><span class="p">::</span><span class="n">raw</span><span class="p">::</span><span class="n">replace</span><span class="p">::</span><span class="n">h7b1ea496b7d61dcd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">85</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6cc95</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">catch_traps</span><span class="p">::</span><span class="n">haad6173518c65209</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">213</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd66c62</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">func</span><span class="p">::</span><span class="n">typed</span><span class="p">::</span><span class="n">TypedFunc</span><span class="cp">$LT$Params$C$Results$GT$</span><span class="p">::</span><span class="n">call</span><span class="p">::</span><span class="n">h4ad4a8810ccdb7a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">354</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6e575</span><span class="w"> </span><span class="n">wasmtime_python</span><span class="p">::</span><span class="n">_</span><span class="cp">$LT$impl$u20$wasmtime_python</span><span class="o">..</span><span class="n">sum</span><span class="o">..</span><span class="n">MakeDef</span><span class="cp">$GT$</span><span class="p">::</span><span class="n">_PYO3_DEF</span><span class="p">::</span><span class="n">trampoline</span><span class="p">::</span><span class="n">hfe78f2643f499858</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1077</span>
<span class="mi">8</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c0a6ae8</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">535272</span>
<span class="mi">9</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c066830</span><span class="w"> </span><span class="n">_PyObject_MakeTpCall</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">384</span>
<span class="mi">10</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c143850</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1177680</span>
<span class="mi">11</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c140557</span><span class="w"> </span><span class="n">_PyEval_EvalFrameDefault</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">23527</span>
<span class="mi">12</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c144693</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1181331</span>
<span class="mi">13</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c13a871</span><span class="w"> </span><span class="n">PyEval_EvalCode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">81</span>
<span class="mi">14</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c181ea1</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433249</span>
<span class="mi">15</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c182013</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433619</span>
<span class="mi">16</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c1802a4</span><span class="w"> </span><span class="n">PyRun_SimpleFileExFlags</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">708</span>
<span class="mi">17</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19d6f0</span><span class="w"> </span><span class="n">Py_RunMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1840</span>
<span class="mi">18</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19db80</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1547136</span>
<span class="mi">19</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19dbdb</span><span class="w"> </span><span class="n">Py_BytesMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">20</span><span class="w">  </span><span class="n">dyld</span><span class="w">                                </span><span class="mh">0x7ff80b28d2cd</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1805</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e2016</span><span class="w"> </span><span class="n">mach_msg_overwrite</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">649</span>
<span class="mi">3</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5db1ff</span><span class="w"> </span><span class="n">mach_msg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">19</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce55ef5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">handler_thread</span><span class="p">::</span><span class="n">hbfc195b7bc426a10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">277</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce08da9</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h9512e42a7b3024a7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cdec98a</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">hd93b48b54e95ca2f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">138</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_s</span>
<span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">truncated</span><span class="p">]</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="495692608"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495692608" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495692608">(Jan 24 2025 at 11:30)</a>:</h4>
<p>plusvic <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2612301332">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>I added the <code>bug</code> label and can't remove it now. This is may not be a <code>wasmtime</code>.</p>
</blockquote>



<a name="495692687"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495692687" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495692687">(Jan 24 2025 at 11:30)</a>:</h4>
<p>plusvic edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2612301332">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>I added the <code>bug</code> label and can't remove it now. This is may not be a <code>wasmtime</code> bug.</p>
</blockquote>



<a name="495693519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495693519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495693519">(Jan 24 2025 at 11:35)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2612310739">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>The crash happens when <code>thread_set_exception_ports</code> is called by Wasmtime: <a href="https://github.com/bytecodealliance/wasmtime/blob/887e5c93500c6f85e2570046788761a9f4498123/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs#L483">https://github.com/bytecodealliance/wasmtime/blob/887e5c93500c6f85e2570046788761a9f4498123/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs#L483</a></p>
<blockquote>
<p>with Python 3.9.6 (the version that comes pre-installed in macOS)</p>
</blockquote>
<p>Do you happen to know the exact set of entitlements this executable was compiled with? Maybe one of the hardening entitlements prevents using exception ports?</p>
</blockquote>



<a name="495704653"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495704653" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495704653">(Jan 24 2025 at 12:38)</a>:</h4>
<p>plusvic <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2612435498">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<blockquote>
<p>The crash happens when <code>thread_set_exception_ports</code> is called by Wasmtime:</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/887e5c93500c6f85e2570046788761a9f4498123/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs#L483">wasmtime/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs</a></p>
<p>Line 483 in <a href="/bytecodealliance/wasmtime/commit/887e5c93500c6f85e2570046788761a9f4498123">887e5c9</a></p>
<p>let kret = thread_set_exception_ports( </p>
<blockquote>
<p>with Python 3.9.6 (the version that comes pre-installed in macOS)</p>
</blockquote>
<p>Do you happen to know the exact set of entitlements this executable was compiled with? Maybe one of the hardening entitlements prevents using exception ports?</p>
</blockquote>
<p>The Python interpreter executable doesn't seem to specify any entitlement:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">codesign</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">--</span><span class="n">entitlements</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span>
<span class="n">Executable</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="495708457"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495708457" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495708457">(Jan 24 2025 at 12:59)</a>:</h4>
<p>plusvic <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2612476112">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<blockquote>
<blockquote>
<p>The crash happens when <code>thread_set_exception_ports</code> is called by Wasmtime:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/887e5c93500c6f85e2570046788761a9f4498123/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs#L483">wasmtime/crates/wasmtime/src/runtime/vm/sys/unix/machports.rs</a><br>
Line 483 in <a href="/bytecodealliance/wasmtime/commit/887e5c93500c6f85e2570046788761a9f4498123">887e5c9</a><br>
let kret = thread_set_exception_ports(</p>
<blockquote>
<p>with Python 3.9.6 (the version that comes pre-installed in macOS)</p>
</blockquote>
<p>Do you happen to know the exact set of entitlements this executable was compiled with? Maybe one of the hardening entitlements prevents using exception ports?</p>
</blockquote>
<p>The Python interpreter executable doesn't seem to specify any entitlement:</p>
<p><code>
codesign -d --entitlements - /usr/bin/python3
Executable=/usr/bin/python3
</code></p>
</blockquote>
<p>With this other path I get a different result, but nothing that prevents the use of exception ports.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">codesign</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">--</span><span class="n">entitlements</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Xcode</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python3</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">Python</span>
<span class="n">Executable</span><span class="o">=/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Xcode</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python3</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">Python</span>
<span class="p">[</span><span class="n">Dict</span><span class="p">]</span>
<span class="w">    </span><span class="p">[</span><span class="n">Key</span><span class="p">]</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">application</span><span class="o">-</span><span class="n">identifier</span>
<span class="w">    </span><span class="p">[</span><span class="n">Value</span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="nb">String</span><span class="p">]</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">python3</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="495780962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/495780962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#495780962">(Jan 24 2025 at 19:41)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2613257136">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>Thanks for the thorough report and reproduction steps! I took a look at this but alas don't have much to add. It deifnitely seems like macOS doesn't like the call to <code>thread_set_exception_ports</code> but I'm not really sure why. Searching around isn't turning up much that seems relevant, and I'm definitely no macOS expert myself to know what's going on here...</p>
</blockquote>



<a name="496119417"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/496119417" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#496119417">(Jan 27 2025 at 13:13)</a>:</h4>
<p>plusvic <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2615732282">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>To make this issue even more strange, everything is OK with a Python binary downloaded from <a href="http://python.org">python.org</a>. Exactly the same version (Python 3.9.6), it crashes with the Python binary provided by Apple, but works correctly with the one from <a href="http://python.org">python.org</a>. </p>
<p>It looks like Apple is making some modifications to the Python binary they distribute.</p>
</blockquote>



<a name="516496248"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/516496248" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#516496248">(May 06 2025 at 17:16)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/10099#issuecomment-2855352109">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>I'm going to close this since it sounds like this is perhaps an issue with the macOS-specific Python and possible alterations they've made to it, but if there's something we can help with on the Wasmtime side of things definitely let us know</p>
</blockquote>



<a name="516496249"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310099%20Crash%20in%20macOS%20when%20using%20wasmtim.../near/516496249" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310099.20Crash.20in.20macOS.20when.20using.20wasmtim.2E.2E.2E.html#516496249">(May 06 2025 at 17:16)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/10099">issue #10099</a>:</p>
<blockquote>
<p>This is a very esoteric issue related to the use of Mach ports for exception handling when <code>wasmtime</code> is running inside a Python 3.9 process.  I'm the author of a multi-platform Rust library that embeds <code>wasmtime</code> for running WASM code, the library supports Linux, Windows and macOS. This library also have Python bindings that allow using the library from Python.</p>
<p>A user of the library reported a crash that was happening in a very specific environment: macOS 15.2 (both Intel and ARM are affected, and probably other macOS versions too), with Python 3.9.6 (the version that comes pre-installed in macOS). The process was being SIGKILLed when executing code deep inside <code>wasmtime</code>, the same code worked fine in other platforms, or in the same macOS machine with Python 3.11.</p>
<p>After some investigation everything pointed to the Mach ports exception handling mechanism when <code>wasmtime</code> is run inside Python 3.9. In fact, if I turn off the use of Mach ports in wasmtime everything works fine.</p>
<p>I don't have a clue on why this is happening only with Python 3.9. My guess is that it is related to Python's exception handling mechanism that somewhat is interfering with wasmtime's exception handling, and perhaps something changed in later Python versions. It could be a Python's bug that was fixed, it could a design change. For the time being I can turn off Mach ports as a workaround, but I would like to understand what's happening here.</p>
<p><a href="https://github.com/user-attachments/files/18534657/wasmtime-python.zip">wasmtime-python.zip</a></p>
<h3>Test Case</h3>
<p>As my library is a quite complicated project, I've created a simple Rust project that reproduces the issue (attached to this issue). It consists in a Python extension written in Rust using <a href="https://github.com/PyO3/pyo3">PyO3</a>.</p>
<h3>Steps to Reproduce</h3>
<ul>
<li>Decompress the Rust project attached to this issue</li>
<li>Build the python extension using <a href="https://github.com/PyO3/maturin">maturin</a>: <code>maturin build --release</code></li>
<li>Install the Python extension: <code>/usr/bin/python3 -m pip install &lt;path to the .whl file produced by maturin&gt;</code></li>
<li>Run the <code>crash.py</code> file included in the project: <code>/usr/bin/python3 crash.py</code></li>
</ul>
<h3>Expected Results</h3>
<p>The process should finish without crashes. </p>
<h3>Actual Results</h3>
<p>The process gets killed:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span><span class="w">                                                                                                                   </span><span class="err"></span><span class="w"> </span><span class="err">✔</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w">    </span><span class="mi">34279</span><span class="w"> </span><span class="n">killed</span><span class="w">     </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span><span class="w"> </span><span class="n">crash</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
<p>The crash log is included below, notice that the exception type is <code>EXC_GUARD</code> and the code is <code>GUARD_TYPE_MACH_PORT</code>. According to Apple's <a href="https://developer.apple.com/documentation/xcode/exc_guard">documentation</a>, the process is killed with <code>EXC_GUARD</code> when it detects a violation in some guarded resourced, usually a file descriptor or Mach port.</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">-------------------------------------</span>
<span class="n">Translated</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="p">(</span><span class="n">Full</span><span class="w"> </span><span class="n">Report</span><span class="w"> </span><span class="n">Below</span><span class="p">)</span>
<span class="o">-------------------------------------</span>

<span class="n">Process</span><span class="p">:</span><span class="w">               </span><span class="nc">Python</span><span class="w"> </span><span class="p">[</span><span class="mi">34279</span><span class="p">]</span>
<span class="n">Path</span><span class="p">:</span><span class="w">                  </span><span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Xcode</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python3</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.9</span><span class="o">/</span><span class="n">Resources</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">Python</span>
<span class="n">Identifier</span><span class="p">:</span><span class="w">            </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">python3</span>
<span class="n">Version</span><span class="p">:</span><span class="w">               </span><span class="mf">3.9.6</span><span class="w"> </span><span class="p">(</span><span class="mf">3.9.6</span><span class="p">)</span>
<span class="n">Build</span><span class="w"> </span><span class="n">Info</span><span class="p">:</span><span class="w">            </span><span class="nc">python3</span><span class="o">-</span><span class="mi">141000000000000</span><span class="o">~</span><span class="mi">2583</span>
<span class="n">Code</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">             </span><span class="nc">X86</span><span class="o">-</span><span class="mi">64</span><span class="w"> </span><span class="p">(</span><span class="n">Native</span><span class="p">)</span>
<span class="n">Parent</span><span class="w"> </span><span class="n">Process</span><span class="p">:</span><span class="w">        </span><span class="nc">zsh</span><span class="w"> </span><span class="p">[</span><span class="mi">1143</span><span class="p">]</span>
<span class="n">Responsible</span><span class="p">:</span><span class="w">           </span><span class="nc">iTerm2</span><span class="w"> </span><span class="p">[</span><span class="mi">911</span><span class="p">]</span>
<span class="n">User</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w">               </span><span class="mi">178948</span>

<span class="n">Date</span><span class="o">/</span><span class="n">Time</span><span class="p">:</span><span class="w">             </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">24</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">27.1988</span><span class="w"> </span><span class="o">+</span><span class="mi">0100</span>
<span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">            </span><span class="nc">macOS</span><span class="w"> </span><span class="mf">15.2</span><span class="w"> </span><span class="p">(</span><span class="mi">24</span><span class="n">C101</span><span class="p">)</span>
<span class="n">Report</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">        </span><span class="mi">12</span>
<span class="n">Bridge</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w">     </span><span class="mf">9.2</span><span class="w"> </span><span class="p">(</span><span class="mi">22</span><span class="n">P2093</span><span class="p">)</span>
<span class="n">Anonymous</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">        </span><span class="mi">5</span><span class="n">FA73C73</span><span class="o">-</span><span class="mi">360</span><span class="n">A</span><span class="o">-</span><span class="n">C399</span><span class="o">-</span><span class="n">E0CC</span><span class="o">-</span><span class="mi">3</span><span class="n">B9EAB5492D0</span>

<span class="n">Sleep</span><span class="o">/</span><span class="n">Wake</span><span class="w"> </span><span class="n">UUID</span><span class="p">:</span><span class="w">       </span><span class="nc">CA017020</span><span class="o">-</span><span class="mi">8</span><span class="n">C6C</span><span class="o">-</span><span class="mi">41</span><span class="n">A1</span><span class="o">-</span><span class="n">AE24</span><span class="o">-</span><span class="n">D06480AE16DB</span>

<span class="n">Time</span><span class="w"> </span><span class="n">Awake</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Boot</span><span class="p">:</span><span class="w"> </span><span class="mi">80000</span><span class="w"> </span><span class="n">seconds</span>
<span class="n">Time</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">Wake</span><span class="p">:</span><span class="w">       </span><span class="mi">5718</span><span class="w"> </span><span class="n">seconds</span>

<span class="n">System</span><span class="w"> </span><span class="n">Integrity</span><span class="w"> </span><span class="n">Protection</span><span class="p">:</span><span class="w"> </span><span class="nc">enabled</span>

<span class="n">Crashed</span><span class="w"> </span><span class="n">Thread</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>

<span class="n">Exception</span><span class="w"> </span><span class="n">Type</span><span class="p">:</span><span class="w">        </span><span class="nc">EXC_GUARD</span><span class="w"> </span><span class="p">(</span><span class="n">SIGKILL</span><span class="p">)</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="nc">GUARD_TYPE_MACH_PORT</span>
<span class="n">Exception</span><span class="w"> </span><span class="n">Codes</span><span class="p">:</span><span class="w">       </span><span class="mh">0x0000000000000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0000000000000000</span>

<span class="n">Termination</span><span class="w"> </span><span class="n">Reason</span><span class="p">:</span><span class="w">    </span><span class="nc">Namespace</span><span class="w"> </span><span class="n">GUARD</span><span class="p">,</span><span class="w"> </span><span class="n">Code</span><span class="w"> </span><span class="mi">2305843034983497728</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">Crashed</span><span class="p">::</span><span class="w">  </span><span class="nc">Dispatch</span><span class="w"> </span><span class="n">queue</span><span class="p">:</span><span class="w"> </span><span class="nc">com</span><span class="p">.</span><span class="n">apple</span><span class="p">.</span><span class="n">main</span><span class="o">-</span><span class="n">thread</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5dfffb</span><span class="w"> </span><span class="n">thread_set_exception_ports</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">134</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d421005</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">lazy_per_thread_init</span><span class="p">::</span><span class="n">h995e1f3306bad314</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">69</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce54cd5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">tls</span><span class="p">::</span><span class="n">raw</span><span class="p">::</span><span class="n">replace</span><span class="p">::</span><span class="n">h7b1ea496b7d61dcd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">85</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6cc95</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">traphandlers</span><span class="p">::</span><span class="n">catch_traps</span><span class="p">::</span><span class="n">haad6173518c65209</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">213</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd66c62</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">func</span><span class="p">::</span><span class="n">typed</span><span class="p">::</span><span class="n">TypedFunc</span><span class="cp">$LT$Params$C$Results$GT$</span><span class="p">::</span><span class="n">call</span><span class="p">::</span><span class="n">h4ad4a8810ccdb7a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">354</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cd6e575</span><span class="w"> </span><span class="n">wasmtime_python</span><span class="p">::</span><span class="n">_</span><span class="cp">$LT$impl$u20$wasmtime_python</span><span class="o">..</span><span class="n">sum</span><span class="o">..</span><span class="n">MakeDef</span><span class="cp">$GT$</span><span class="p">::</span><span class="n">_PYO3_DEF</span><span class="p">::</span><span class="n">trampoline</span><span class="p">::</span><span class="n">hfe78f2643f499858</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1077</span>
<span class="mi">8</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c0a6ae8</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">535272</span>
<span class="mi">9</span><span class="w">   </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c066830</span><span class="w"> </span><span class="n">_PyObject_MakeTpCall</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">384</span>
<span class="mi">10</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c143850</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1177680</span>
<span class="mi">11</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c140557</span><span class="w"> </span><span class="n">_PyEval_EvalFrameDefault</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">23527</span>
<span class="mi">12</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c144693</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1181331</span>
<span class="mi">13</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c13a871</span><span class="w"> </span><span class="n">PyEval_EvalCode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">81</span>
<span class="mi">14</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c181ea1</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433249</span>
<span class="mi">15</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c182013</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1433619</span>
<span class="mi">16</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c1802a4</span><span class="w"> </span><span class="n">PyRun_SimpleFileExFlags</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">708</span>
<span class="mi">17</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19d6f0</span><span class="w"> </span><span class="n">Py_RunMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1840</span>
<span class="mi">18</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19db80</span><span class="w"> </span><span class="mh">0x10c024000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1547136</span>
<span class="mi">19</span><span class="w">  </span><span class="n">Python3</span><span class="w">                                </span><span class="mh">0x10c19dbdb</span><span class="w"> </span><span class="n">Py_BytesMain</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">20</span><span class="w">  </span><span class="n">dyld</span><span class="w">                                </span><span class="mh">0x7ff80b28d2cd</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1805</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5daf0e</span><span class="w"> </span><span class="n">mach_msg2_trap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e95fa</span><span class="w"> </span><span class="n">mach_msg2_internal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">84</span>
<span class="mi">2</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5e2016</span><span class="w"> </span><span class="n">mach_msg_overwrite</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">649</span>
<span class="mi">3</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5db1ff</span><span class="w"> </span><span class="n">mach_msg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">19</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce55ef5</span><span class="w"> </span><span class="n">wasmtime</span><span class="p">::</span><span class="n">runtime</span><span class="p">::</span><span class="n">vm</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">machports</span><span class="p">::</span><span class="n">handler_thread</span><span class="p">::</span><span class="n">hbfc195b7bc426a10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">277</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10ce08da9</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h9512e42a7b3024a7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10cdec98a</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">hd93b48b54e95ca2f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">138</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_begin_short_backtrace</span><span class="p">::</span><span class="n">h84248f773d70d50b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">34</span>
<span class="mi">6</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ea2e5</span><span class="w"> </span><span class="n">core</span><span class="p">::</span><span class="n">ops</span><span class="p">::</span><span class="n">function</span><span class="p">::</span><span class="nb">FnOnce</span><span class="p">::</span><span class="n">call_once</span><span class="cp">$u7b$$u7b$vtable</span><span class="p">.</span><span class="n">shim</span><span class="cp">$u7d$$u7d$</span><span class="p">::</span><span class="n">h2bcc168af3d264f4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">373</span>
<span class="mi">7</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d3f5c5b</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">pal</span><span class="p">::</span><span class="n">unix</span><span class="p">::</span><span class="n">thread</span><span class="p">::</span><span class="n">Thread</span><span class="p">::</span><span class="n">new</span><span class="p">::</span><span class="n">thread_start</span><span class="p">::</span><span class="n">hcfbe36d5799581a6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">43</span>
<span class="mi">8</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c253</span><span class="w"> </span><span class="n">_pthread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">99</span>
<span class="mi">9</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b617bef</span><span class="w"> </span><span class="n">thread_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">15</span>

<span class="n">Thread</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span>
<span class="mi">0</span><span class="w">   </span><span class="n">libsystem_kernel</span><span class="p">.</span><span class="n">dylib</span><span class="w">              </span><span class="mh">0x7ff80b5ddaaa</span><span class="w"> </span><span class="n">__psynch_cvwait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span>
<span class="mi">1</span><span class="w">   </span><span class="n">libsystem_pthread</span><span class="p">.</span><span class="n">dylib</span><span class="w">             </span><span class="mh">0x7ff80b61c7a8</span><span class="w"> </span><span class="n">_pthread_cond_wait</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1193</span>
<span class="mi">2</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d44518f</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">Sleep</span><span class="p">::</span><span class="n">sleep</span><span class="p">::</span><span class="n">h0f8e31d6649cc8dc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">511</span>
<span class="mi">3</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d444b54</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">WorkerThread</span><span class="p">::</span><span class="n">wait_until_cold</span><span class="p">::</span><span class="n">h5e480e7580c0b42b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">276</span>
<span class="mi">4</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1e5d14</span><span class="w"> </span><span class="n">rayon_core</span><span class="p">::</span><span class="n">registry</span><span class="p">::</span><span class="n">ThreadBuilder</span><span class="p">::</span><span class="n">run</span><span class="p">::</span><span class="n">h1666e03950a6d606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">5</span><span class="w">   </span><span class="n">wasmtime_python</span><span class="p">.</span><span class="n">abi3</span><span class="p">.</span><span class="n">so</span><span class="w">                </span><span class="mh">0x10d1ebbf2</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">sys</span><span class="p">::</span><span class="n">backtrace</span><span class="p">::</span><span class="n">__rust_be</span>
<span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">truncated</span><span class="p">]</span>
</code></pre></div><br>
</p>
</blockquote>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>