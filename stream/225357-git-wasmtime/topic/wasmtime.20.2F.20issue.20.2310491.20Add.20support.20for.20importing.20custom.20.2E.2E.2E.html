<html>
<head><meta charset="utf-8"><title>wasmtime / issue #10491 Add support for importing custom ... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html">wasmtime / issue #10491 Add support for importing custom ...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="509037115"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509037115" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509037115">(Mar 30 2025 at 15:27)</a>:</h4>
<p>PPakalns opened <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Support adding SharedMemory defines to ?Linker? for use in components in Component Model.</p>
<h4>Benefit</h4>
<p>Wasm on web supports threaded execution. Wasmtime supports threaded execution. WIT (Component model) simplifies host - guest interface definition a lot.</p>
<p>It would be very useful to add some kind of (experimental) support for threaded execution in Component model. Threaded execution requires SharedMemory.</p>
<h4>Use case</h4>
<p>This would allow to execute Wasm component in multi-threaded program. For example in multi threaded game engines the same Wasm component can be called from multiple threads to process/generate data.</p>
<p>Related discussion and collection of blog posts:<br>
<a href="#narrow/channel/206238-general/topic/Calling.20Wasm.20logic.20from.20multiple.20threads.20with.20shared.20memory">#general &gt; Calling Wasm logic from multiple threads with shared memory</a></p>
<h4>Implementation</h4>
<p>Allow to define shared memory imports in wasmtime::component::Linker?</p>
<p>Component linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103">https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103</a></p>
<p>Wasmtime main linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119">https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119</a></p>
<p>Maybe this can be added as experimental feature under feature flag.</p>
<h4>Alternatives</h4>
<p>Avoid using WIT and try to reimplement the same functionality using wasmtime without Component Model.</p>
</blockquote>



<a name="509037262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509037262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509037262">(Mar 30 2025 at 15:28)</a>:</h4>
<p>PPakalns edited <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Support SharedMemory for use in component in Component Model (WIT).</p>
<h4>Benefit</h4>
<p>Wasm on web supports threaded execution. Wasmtime supports threaded execution. WIT (Component model) simplifies host - guest interface definition a lot.</p>
<p>It would be very useful to add some kind of (experimental) support for threaded execution in Component model. Threaded execution requires SharedMemory.</p>
<h4>Use case</h4>
<p>This would allow to execute Wasm component in multi-threaded program. For example in multi threaded game engines the same Wasm component can be called from multiple threads to process/generate data.</p>
<p>Related discussion and collection of blog posts:<br>
<a href="#narrow/channel/206238-general/topic/Calling.20Wasm.20logic.20from.20multiple.20threads.20with.20shared.20memory">#general &gt; Calling Wasm logic from multiple threads with shared memory</a></p>
<h4>Implementation</h4>
<p>Allow to define shared memory imports in wasmtime::component::Linker?</p>
<p>Component linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103">https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103</a></p>
<p>Wasmtime main linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119">https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119</a></p>
<p>Maybe this can be added as experimental feature under feature flag.</p>
<h4>Alternatives</h4>
<p>Avoid using WIT and try to reimplement the same functionality using wasmtime without Component Model.</p>
</blockquote>



<a name="509038764"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509038764" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509038764">(Mar 30 2025 at 15:39)</a>:</h4>
<p>PPakalns <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2764618346">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Sadly I don't know in detail how Component model is implemented. </p>
<p>Would like to call wasm component from multiple threads. And with WIT (Component model) Wasm is very easy to integrate in projects.  </p>
<p>I hope that there aren't major problems of using Shared Memory inside Wasm Instance in Component model context.</p>
<p>Thank you for this great project, looking forward to how wasmtime will improve in future.</p>
</blockquote>



<a name="509041026"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509041026" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509041026">(Mar 30 2025 at 15:55)</a>:</h4>
<p>bjorn3 <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2764623826">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Threading support for the component model will use the <a href="https://github.com/WebAssembly/shared-everything-threads/blob/main/proposals/shared-everything-threads/Overview.md">shared-everything threads</a> proposal, which Wasmtime doesn't support yet. As opposed to the instance-per-thread pattern as commonly used in the browser that requires importing shared memories.</p>
</blockquote>



<a name="509048198"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509048198" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509048198">(Mar 30 2025 at 17:23)</a>:</h4>
<p>PPakalns <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2764656603">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Related issue: <a href="https://github.com/bytecodealliance/wasmtime/issues/9466">https://github.com/bytecodealliance/wasmtime/issues/9466</a></p>
</blockquote>



<a name="509048208"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509048208" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509048208">(Mar 30 2025 at 17:23)</a>:</h4>
<p>PPakalns edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2764656603">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Related shared-everything-threads issue: <a href="https://github.com/bytecodealliance/wasmtime/issues/9466">https://github.com/bytecodealliance/wasmtime/issues/9466</a></p>
</blockquote>



<a name="509163446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509163446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509163446">(Mar 31 2025 at 10:49)</a>:</h4>
<p>PPakalns <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2765859002">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Maybe someone with knowledge can answer if there are major problems with "highly experimental temporary" approach until shared-everything-threads is implemented.</p>
<p>Theoretically, If I fork wasmtime and I modify wasmtime so that SharedMemory is passed to Instance (and I initialize multiple Instances with the same shared memory and correctly initialize stack/TLS for each instance), is there obvious problems why it might not work and would conflict with Component model.</p>
</blockquote>



<a name="509163722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509163722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509163722">(Mar 31 2025 at 10:50)</a>:</h4>
<p>PPakalns edited a <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2765859002">comment</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Maybe someone with knowledge can answer if there are major problems with "highly experimental temporary" approach until shared-everything-threads is implemented.</p>
<p>Theoretically, If I fork wasmtime and I modify wasmtime so that SharedMemory is passed to Instance (and I initialize multiple Instances with the same shared memory and correctly initialize stack/TLS for each instance), is there obvious problems why it might not work and would conflict with Component model.</p>
<p>Thank you for your help.</p>
</blockquote>



<a name="509275784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509275784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509275784">(Mar 31 2025 at 18:37)</a>:</h4>
<p>alexcrichton closed <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<h4>Feature</h4>
<p>Support SharedMemory for use in component in Component Model (WIT).</p>
<h4>Benefit</h4>
<p>Wasm on web supports threaded execution. Wasmtime supports threaded execution. WIT (Component model) simplifies host - guest interface definition a lot.</p>
<p>It would be very useful to add some kind of (experimental) support for threaded execution in Component model. Threaded execution requires SharedMemory.</p>
<h4>Use case</h4>
<p>This would allow to execute Wasm component in multi-threaded program. For example in multi threaded game engines the same Wasm component can be called from multiple threads to process/generate data.</p>
<p>Related discussion and collection of blog posts:<br>
<a href="#narrow/channel/206238-general/topic/Calling.20Wasm.20logic.20from.20multiple.20threads.20with.20shared.20memory">#general &gt; Calling Wasm logic from multiple threads with shared memory</a></p>
<h4>Implementation</h4>
<p>Allow to define shared memory imports in wasmtime::component::Linker?</p>
<p>Component linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103">https://docs.wasmtime.dev/api/src/wasmtime/runtime/component/linker.rs.html#103</a></p>
<p>Wasmtime main linker defines:<br>
<a href="https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119">https://docs.wasmtime.dev/api/src/wasmtime/runtime/linker.rs.html#119</a></p>
<p>Maybe this can be added as experimental feature under feature flag.</p>
<h4>Alternatives</h4>
<p>Avoid using WIT and try to reimplement the same functionality using wasmtime without Component Model.</p>
</blockquote>



<a name="509275785"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509275785" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509275785">(Mar 31 2025 at 18:37)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2767085843">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>I'm going to close this in favor of <a href="https://github.com/bytecodealliance/wasmtime/issues/9466">https://github.com/bytecodealliance/wasmtime/issues/9466</a> as that's the tracking issue for now of implementing that proposal. @abrown has been working on this for now, but no demos are ready as of now of everything working end-to-end.</p>
<p>Threads + components is, at this time, a pretty broad topic that spans everything from standards to implementation to toolchains to conventions and such. It's not really in a state of "oh just hack this up here and you can see it all working". Even just understanding why it's not possible to easily tack on threads requires background knowledge of components/wasm/etc. Basically I do not have the time/energy to type up what I feel will be a satisfactory answer to your questions here, and all I can leave you with is that components + threads does not work at this time. You're welcome to check back in in the future, but for now there is no feasible short path to getting this working.</p>
</blockquote>



<a name="509280326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20issue%20%2310491%20Add%20support%20for%20importing%20custom%20.../near/509280326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20issue.20.2310491.20Add.20support.20for.20importing.20custom.20.2E.2E.2E.html#509280326">(Mar 31 2025 at 19:03)</a>:</h4>
<p>PPakalns <a href="https://github.com/bytecodealliance/wasmtime/issues/10491#issuecomment-2767141947">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/issues/10491">issue #10491</a>:</p>
<blockquote>
<p>Thank you for your explanation :)  Looking forward to shared-everything-threads proposal.</p>
</blockquote>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>