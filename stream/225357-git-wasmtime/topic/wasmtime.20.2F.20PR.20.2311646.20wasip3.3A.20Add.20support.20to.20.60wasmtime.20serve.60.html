<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11646 wasip3: Add support to `wasmtime serve` · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html">wasmtime / PR #11646 wasip3: Add support to `wasmtime serve`</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="538322931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538322931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538322931">(Sep 08 2025 at 22:18)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a> from <code>alexcrichton:p3-serve</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit adds support for WASIp3 to <code>wasmtime serve</code> by detecting whether the input component is using a WASIp3 exported interface instead of a WASIp2 exported interface (similar to how <code>wasmtime run</code> detects which is supported).</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="538322950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538322950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538322950">(Sep 08 2025 at 22:18)</a>:</h4>
<p>alexcrichton assigned alexcrichton to <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538323149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538323149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538323149">(Sep 08 2025 at 22:21)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198357156">PR review</a>.</p>



<a name="538323150"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538323150" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538323150">(Sep 08 2025 at 22:21)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331499323">PR review comment</a>:</p>
<blockquote>
<p>I've opened this as a draft PR because of this, and here I have one question and one statement:</p>
<ul>
<li>@rvolosatovs the origin of this code looks <a href="https://github.com/bytecodealliance/wasip3-prototyping/blob/68389f75e28468576fb5aa88d6ec173cb21fc603/src/commands/serve.rs#L865-L889">like this</a> and notably has the "I/O driver" task associated with it to await on. Here, however, it's not present. That's a problem, right? Would you take this to mean that <a href="https://github.com/bytecodealliance/wasmtime/issues/11600">https://github.com/bytecodealliance/wasmtime/issues/11600</a> is required to implement this correctly? Or should I insert something else here?</li>
<li>@dicej we'll eventually want to re-benchmark this given all the big changes that have happened around the intenrals of streams and the internals of wasi-http. Notably <a href="https://github.com/bytecodealliance/wasip3-prototyping/blob/68389f75e28468576fb5aa88d6ec173cb21fc603/src/commands/serve.rs#L873-L881">this optimization</a> is no longer easily possible.</li>
</ul>
</blockquote>



<a name="538323713"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538323713" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538323713">(Sep 08 2025 at 22:28)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198386232">PR review</a>.</p>



<a name="538323715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538323715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538323715">(Sep 08 2025 at 22:28)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331516251">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>Would you take this to mean that <a href="https://github.com/bytecodealliance/wasmtime/issues/11600">https://github.com/bytecodealliance/wasmtime/issues/11600</a> is required to implement this correctly? Or should I insert something else here?</p>
</blockquote>
<p>We don't necessarily need #11600 for this.  I was envisioning something like:</p>
</blockquote>



<a name="538323720"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538323720" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538323720">(Sep 08 2025 at 22:28)</a>:</h4>
<p>dicej deleted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331516251">PR review comment</a>.</p>



<a name="538324390"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324390" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324390">(Sep 08 2025 at 22:36)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198401857">PR review</a>.</p>



<a name="538324391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324391">(Sep 08 2025 at 22:36)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331528495">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>Would you take this to mean that <a href="https://github.com/bytecodealliance/wasmtime/issues/11600">https://github.com/bytecodealliance/wasmtime/issues/11600</a> is required to implement this correctly? Or should I insert something else here?</p>
</blockquote>
<p>Yes, 11600 is probably the best choice here; I can pick that up tomorrow.</p>
<p>A couple of alternatives that would also work, but are not necessarily as elegant:</p>
<ul>
<li>Update Response::into_http to add an impl Future&lt;Output = Result&lt;(), ErrorCode&gt;&gt; as a third part of the tuple it currently returns, which will resolve when the BoxBody has finished producing items (or hits an error).  Then spawn a task which takes ownership of the Store and calls Instance::run_concurrent with that future.</li>
<li>Spawn a task which calls <code>Instance::run_concurrent</code> with <code>std::future::pending()</code> and wait for it to return <code>Err(Trap::Deadlock)</code>, meaning there's nothing left to do (i.e. all tasks have completed).  The problem there is you get the same error whether the tasks all completed or they got stuck before they completed.<br>
</li>
</ul>
</blockquote>



<a name="538324649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324649">(Sep 08 2025 at 22:39)</a>:</h4>
<p>rvolosatovs submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198406450">PR review</a>.</p>



<a name="538324650"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324650" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324650">(Sep 08 2025 at 22:39)</a>:</h4>
<p>rvolosatovs created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331532143">PR review comment</a>:</p>
<blockquote>
<p>This is exactly the problem I was referring to earlier today, which I hoped we could fix by <code>handle</code> returning the "I/O driver" future. My understanding of this so far was that as long as the returned <code>http_body::Body</code> is used within a <code>run_concurrent</code> (which I was, perhaps imprecisely, referring to as "part of host's event loop") everything should "just work". It <em>looks</em> like the existing functionality is sufficient for <code>wasi:http</code> use case, but I think there definitely should be a way for the embedder to "join all" spawned tasks.</p>
<p>Basically, my current understanding is that HTTP implementation works as long as guest is done doing all the work when the host is done reading the response body. If, for example, a guest were to spawn a task <em>after</em> streaming the response body (e.g. doing an async HTTP request after the fact), I am not sure I see a way for the host to drive completion of such tasks. Maybe @dicej could provide some guidance here?</p>
</blockquote>



<a name="538324897"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324897" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324897">(Sep 08 2025 at 22:42)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198410112">PR review</a>.</p>



<a name="538324898"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538324898" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538324898">(Sep 08 2025 at 22:42)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331535079">PR review comment</a>:</p>
<blockquote>
<blockquote>
<ul>
<li>Notably <a href="https://github.com/bytecodealliance/wasip3-prototyping/blob/68389f75e28468576fb5aa88d6ec173cb21fc603/src/commands/serve.rs#L873-L881">this optimization</a> is no longer easily possible.</li>
</ul>
</blockquote>
<p>This is where having an <code>Store::yield_</code> async function could be useful -- i.e. the host equivalent of the <code>yield</code> intrinsic, meaning "let any guest tasks make progress before resolving the returned <code>Future</code>".  Then we'd do a <code>store.yield_().await;</code> before the <code>tx.send(res);</code>, which should have the same effect as the previous optimization.</p>
</blockquote>



<a name="538325634"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538325634" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538325634">(Sep 08 2025 at 22:48)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198418903">PR review</a>.</p>



<a name="538325636"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538325636" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538325636">(Sep 08 2025 at 22:48)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331541823">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>I am not sure I see a way for the host to drive completion of such tasks. Maybe @dicej could provide some guidance here?</p>
</blockquote>
<p>Either #11600 or passing <code>std::future::pending()</code> to <code>Instance::run_concurrent</code> would address that, I believe -- either one would allow the host to wait until the guest task exits completely.  Regarding 11600: we could make the returned future mean "this will resolve when the task has exited _and_ any of its subtasks have also exited".</p>
</blockquote>



<a name="538327923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538327923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538327923">(Sep 08 2025 at 23:17)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2331571813">PR review comment</a>:</p>
<blockquote>
<blockquote>
<p>It looks like the existing functionality is sufficient for wasi:http use case, but I think there definitely should be a way for the embedder to "join all" spawned tasks.</p>
</blockquote>
<p>I'm not actually sure how this tests works because AFAIK it shouldn't, but we don't have sufficient information today because once the guest returns a <code>Response</code> the host has no reason to stay inside of <code>run_concurrent</code> but it needs to stay there so long as the original component model subtask hasn't returned. Avoiding returning is modeled by spawning in Rust currently.</p>
<p>@dicej let's brainstorm tomorrow about what shape #11600 might take? My best idea right now is <code>call_concurrent</code> returning a pair of futures but I feel like we can probably think of something better</p>
</blockquote>



<a name="538327925"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538327925" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538327925">(Sep 08 2025 at 23:17)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3198459048">PR review</a>.</p>



<a name="538450842"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538450842" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538450842">(Sep 09 2025 at 14:24)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2333828872">PR review comment</a>:</p>
<blockquote>
<p>One other nuance to point out here: in the general case of a guest function that returns streams and/or futures, waiting for the task to exit isn't enough -- it could store the write end of each stream or future in memory and hand of responsibility for them to another task (i.e. one that's running concurrently or expected to run later).  In other words, the streams and futures could outlive the task that created them.  Probably not a concern for <code>wasmtime serve</code>, but I thought I'd mention it for completeness.</p>
</blockquote>



<a name="538450853"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538450853" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538450853">(Sep 09 2025 at 14:24)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3201896452">PR review</a>.</p>



<a name="538451966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538451966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538451966">(Sep 09 2025 at 14:29)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3201915337">PR review</a>.</p>



<a name="538451968"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538451968" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538451968">(Sep 09 2025 at 14:29)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2333842342">PR review comment</a>:</p>
<blockquote>
<p>Expanding on the above: what the caller really wants to wait for is three things joined together:</p>
<ul>
<li>the end of the body stream</li>
<li>the resolution of the trailers future</li>
<li>the completion of the <code>handle</code> task<br>
Until all three are finished, we can't consider the request fully handled.</li>
</ul>
</blockquote>



<a name="538452703"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538452703" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538452703">(Sep 09 2025 at 14:32)</a>:</h4>
<p>dicej edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2333842342">PR review comment</a>.</p>



<a name="538453306"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538453306" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538453306">(Sep 09 2025 at 14:34)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3201936828">PR review</a>.</p>



<a name="538453310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538453310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538453310">(Sep 09 2025 at 14:34)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2333857265">PR review comment</a>:</p>
<blockquote>
<p>Err, five things?</p>
<ul>
<li>the request body fully consumed</li>
<li>the request trailers consumed</li>
<li>the response body fully produced</li>
<li>the response trailers delivered</li>
<li>the completion of the <code>handle</code> task</li>
</ul>
<p><span aria-label="dizzy" class="emoji emoji-1f635" role="img" title="dizzy">:dizzy:</span> </p>
</blockquote>



<a name="538453388"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538453388" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538453388">(Sep 09 2025 at 14:34)</a>:</h4>
<p>dicej edited <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2333857265">PR review comment</a>.</p>



<a name="538736923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736923">(Sep 10 2025 at 20:53)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a> (assigned to alexcrichton).</p>



<a name="538736942"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736942" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736942">(Sep 10 2025 at 20:53)</a>:</h4>
<p><strong>alexcrichton</strong> has marked <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a> as ready for review.</p>



<a name="538736949"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736949" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736949">(Sep 10 2025 at 20:53)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-wasi-reviewers">wasmtime-wasi-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538736950"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736950" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736950">(Sep 10 2025 at 20:53)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/dicej">dicej</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538736951"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736951" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736951">(Sep 10 2025 at 20:53)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538736952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538736952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538736952">(Sep 10 2025 at 20:53)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-default-reviewers">wasmtime-default-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538737018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538737018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538737018">(Sep 10 2025 at 20:54)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3207797774">PR review</a>.</p>



<a name="538737019"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538737019" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538737019">(Sep 10 2025 at 20:54)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2337891277">PR review comment</a>:</p>
<blockquote>
<p>Ok with <a href="https://github.com/bytecodealliance/wasmtime/pull/11665">https://github.com/bytecodealliance/wasmtime/pull/11665</a> this should now be ready as this hooks into the task run.</p>
</blockquote>



<a name="538739640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538739640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538739640">(Sep 10 2025 at 21:14)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a> (assigned to alexcrichton).</p>



<a name="538741422"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538741422" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538741422">(Sep 10 2025 at 21:31)</a>:</h4>
<p>dicej submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#pullrequestreview-3207905403">PR review</a>.</p>



<a name="538741423"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538741423" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538741423">(Sep 10 2025 at 21:31)</a>:</h4>
<p>dicej created <a href="https://github.com/bytecodealliance/wasmtime/pull/11646#discussion_r2337964537">PR review comment</a>:</p>
<blockquote>
<p>I'm thinking we should check for an error here and log it before returning it to the caller.  That's what we're doing in the p2 case.</p>
</blockquote>



<a name="538742941"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538742941" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538742941">(Sep 10 2025 at 21:48)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a> (assigned to alexcrichton).</p>



<a name="538742981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538742981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538742981">(Sep 10 2025 at 21:49)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<a name="538747743"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311646%20wasip3%3A%20Add%20support%20to%20%60wasmtime%20serve%60/near/538747743" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311646.20wasip3.3A.20Add.20support.20to.20.60wasmtime.20serve.60.html#538747743">(Sep 10 2025 at 22:43)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11646">PR #11646</a>.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>