<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10082 Winch: Add replace_lane instructions... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html">wasmtime / PR #10082 Winch: Add replace_lane instructions...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="495379441"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495379441" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495379441">(Jan 22 2025 at 21:46)</a>:</h4>
<p>jeffcharles opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a> from <code>jeffcharles:winch-simd-replace-lane</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;<br>
Part of #8093. Implements the <code>*.replace_lane</code> set of instructions.</p>
</blockquote>



<a name="495379446"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495379446" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495379446">(Jan 22 2025 at 21:46)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-compiler-reviewers">wasmtime-compiler-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495379447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495379447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495379447">(Jan 22 2025 at 21:46)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/cfallin">cfallin</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495379452"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495379452" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495379452">(Jan 22 2025 at 21:46)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495379453"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495379453" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495379453">(Jan 22 2025 at 21:46)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495393756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495393756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495393756">(Jan 22 2025 at 23:45)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#issuecomment-2608494071">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @saulecabrera</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "winch"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>saulecabrera: winch</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="495486391"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495486391" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495486391">(Jan 23 2025 at 12:01)</a>:</h4>
<p>saulecabrera <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#issuecomment-2609632001">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>:</p>
<blockquote>
<p>I can take this review. </p>
</blockquote>



<a name="495486409"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495486409" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495486409">(Jan 23 2025 at 12:01)</a>:</h4>
<p><strong>saulecabrera</strong> requested <a href="https://github.com/saulecabrera">saulecabrera</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495519276"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495519276" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495519276">(Jan 23 2025 at 15:00)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495571891"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495571891" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495571891">(Jan 23 2025 at 19:29)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#pullrequestreview-2570820416">PR review</a>:</p>
<blockquote>
<p>LGTM, one minor remark. </p>
</blockquote>



<a name="495571892"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495571892" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495571892">(Jan 23 2025 at 19:29)</a>:</h4>
<p>saulecabrera created <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#discussion_r1927565250">PR review comment</a>:</p>
<blockquote>
<p>I'd like to keep <code>OperandSize</code> as machine independent as possible. Would it be possible to move this to a helper in the x64 masm/asm? </p>
</blockquote>



<a name="495790678"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495790678" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495790678">(Jan 24 2025 at 20:49)</a>:</h4>
<p>jeffcharles submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#pullrequestreview-2573551783">PR review</a>.</p>



<a name="495790679"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495790679" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495790679">(Jan 24 2025 at 20:49)</a>:</h4>
<p>jeffcharles created <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#discussion_r1929216051">PR review comment</a>:</p>
<blockquote>
<p>The <code>vpinsr_opcode</code> method isn't accessible outside of the x86 assembler module and shouldn't show up in autocomplete when using the Rust Analyzer. I can put on a static function instead in any case.</p>
<p>If someone tried to call it outside of that module, say in the macroassembler or code context, they would get the following compiler error:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">error</span><span class="p">[</span><span class="n">E0624</span><span class="p">]:</span><span class="w"> </span><span class="nc">method</span><span class="w"> </span><span class="err">`</span><span class="n">vpinsr_opcode</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">private</span>
<span class="w">    </span><span class="o">-</span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">winch</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">masm</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">1554</span><span class="p">:</span><span class="mi">36</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">1554</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="kd">let</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kind</span><span class="p">.</span><span class="n">lane_size</span><span class="p">().</span><span class="n">vpinsr_opcode</span><span class="p">();</span>
<span class="w">     </span><span class="o">|</span><span class="w">                                    </span><span class="o">^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">method</span>
<span class="w">     </span><span class="o">|</span>
<span class="w">    </span><span class="p">:::</span><span class="w"> </span><span class="nc">winch</span><span class="o">/</span><span class="n">codegen</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isa</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">asm</span><span class="p">.</span><span class="n">rs</span><span class="p">:</span><span class="mi">171</span><span class="p">:</span><span class="mi">5</span>
<span class="w">     </span><span class="o">|</span>
<span class="mi">171</span><span class="w">  </span><span class="o">|</span><span class="w">     </span><span class="k">pub</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">vpinsr_opcode</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">AvxOpcode</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="o">|</span><span class="w">     </span><span class="o">----------------------------------------------</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span>

<span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0624</span><span class="err">`</span>
</code></pre></div><br>
</p>
</blockquote>



<a name="495791353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495791353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495791353">(Jan 24 2025 at 20:54)</a>:</h4>
<p>jeffcharles updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495791624"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495791624" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495791624">(Jan 24 2025 at 20:56)</a>:</h4>
<p><strong>jeffcharles</strong> requested <a href="https://github.com/saulecabrera">saulecabrera</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495793103"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495793103" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495793103">(Jan 24 2025 at 21:07)</a>:</h4>
<p>saulecabrera submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10082#pullrequestreview-2573577065">PR review</a>.</p>



<a name="495793110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495793110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495793110">(Jan 24 2025 at 21:07)</a>:</h4>
<p>saulecabrera has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<a name="495795981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310082%20Winch%3A%20Add%20replace_lane%20instructions.../near/495795981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310082.20Winch.3A.20Add.20replace_lane.20instructions.2E.2E.2E.html#495795981">(Jan 24 2025 at 21:30)</a>:</h4>
<p>saulecabrera merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10082">PR #10082</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>