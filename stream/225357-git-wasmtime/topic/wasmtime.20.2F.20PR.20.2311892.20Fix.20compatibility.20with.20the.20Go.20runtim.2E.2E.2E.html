<html>
<head><meta charset="utf-8"><title>wasmtime / PR #11892 Fix compatibility with the Go runtim... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html">wasmtime / PR #11892 Fix compatibility with the Go runtim...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="546079945"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546079945" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546079945">(Oct 20 2025 at 19:52)</a>:</h4>
<p>alexcrichton opened <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a> from <code>alexcrichton:fix-go</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>This commit fixes some fallout of #11592 where that PR resulted in Wasmtime no longer running within the context of the Go runtime (e.g. <code>wasmtime-go</code>). The reasons for this are quite Windows-specific and I've attempted to document the situation in <code>vectored_exceptions.go</code>. The basic TL;DR; is that by returning from a vectored exception handler (which #11592 introduced) we're now subjecting ourselves to "continue handlers" as well, and Go's continue handlers will abort the process for non-Go exceptions. Some logic is added here to try to bypass Go's continue handlers and get back to wasm.</p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="546079946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546079946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546079946">(Oct 20 2025 at 19:52)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<a name="546079947"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546079947" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546079947">(Oct 20 2025 at 19:52)</a>:</h4>
<p><strong>alexcrichton</strong> requested <a href="https://github.com/fitzgen">fitzgen</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<a name="546080069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546080069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546080069">(Oct 20 2025 at 19:52)</a>:</h4>
<p>alexcrichton <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#issuecomment-3423511485">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>:</p>
<blockquote>
<p>I have, yet again as is the case with wasmtime-go and integrating on various platforms, lost an embarassingly large amount of time debugging this...</p>
</blockquote>



<a name="546092660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546092660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546092660">(Oct 20 2025 at 20:46)</a>:</h4>
<p>bjorn3 submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3357878039">PR review</a>.</p>



<a name="546092664"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546092664" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546092664">(Oct 20 2025 at 20:46)</a>:</h4>
<p>bjorn3 created <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2446084545">PR review comment</a>:</p>
<blockquote>
<p>*list</p>
</blockquote>



<a name="546096216"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546096216" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546096216">(Oct 20 2025 at 21:07)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<a name="546280325"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546280325" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546280325">(Oct 21 2025 at 16:28)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3361619880">PR review</a>:</p>
<blockquote>
<p>Sounds like this one was super fun to track down!</p>
</blockquote>



<a name="546280326"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546280326" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546280326">(Oct 21 2025 at 16:28)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2448958973">PR review comment</a>:</p>
<blockquote>
<div class="codehilite" data-code-language="suggestion"><pre><span></span><code>//
// # Safety
//
// Invoked by Windows' vectored exception system; should
// not be called by anyone else.
unsafe extern "system" fn continue_handler(exception_info: &amp;EXCEPTION_POINTERS) -&gt; i32 {
    let context = &amp;exception_info.ContextRecord;
</code></pre></div>
<p>Perhaps? Yes, it doesn't really actually change anything about the safety here, but it does mean there is one less <code>unsafe</code> block to decide whether it merits a <code>// SAFETY:</code> comment...</p>
</blockquote>



<a name="546280327"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546280327" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546280327">(Oct 21 2025 at 16:28)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2448937109">PR review comment</a>:</p>
<blockquote>
<p>The title of this section suggests that this is an overview of how continue handlers work, and then it proceeds to be a discussion about working around how the go runtime (ab)uses them. I think this comment could be a little more clear if we explicitly had a few different sections:</p>
<ol>
<li>An explanation of how VEH and continue handlers work and are intended to be used.</li>
<li>An explanation of how the go runtime (ab)uses the system, and how this doesn't play nice / compose with other runtimes that need to install handlers, like Wasmtime.</li>
<li>A description of what we are doing to work around (2).</li>
</ol>
<p>All that said, this comment was super helpful for understanding the issues involved. Thanks for writing this stuff up!</p>
</blockquote>



<a name="546312434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546312434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546312434">(Oct 21 2025 at 19:28)</a>:</h4>
<p>alexcrichton updated <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<a name="546312497"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546312497" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546312497">(Oct 21 2025 at 19:28)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#pullrequestreview-3362400762">PR review</a>.</p>



<a name="546312498"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546312498" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546312498">(Oct 21 2025 at 19:28)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/11892#discussion_r2449482304">PR review comment</a>:</p>
<blockquote>
<p>Good point! I reorganized to make it flow better like you suggested, I think I was a bit too frustrated with all of this yesterday to write clearly...</p>
</blockquote>



<a name="546312519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546312519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546312519">(Oct 21 2025 at 19:28)</a>:</h4>
<p>alexcrichton has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<a name="546318110"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2311892%20Fix%20compatibility%20with%20the%20Go%20runtim.../near/546318110" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2311892.20Fix.20compatibility.20with.20the.20Go.20runtim.2E.2E.2E.html#546318110">(Oct 21 2025 at 20:05)</a>:</h4>
<p>alexcrichton merged <a href="https://github.com/bytecodealliance/wasmtime/pull/11892">PR #11892</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>