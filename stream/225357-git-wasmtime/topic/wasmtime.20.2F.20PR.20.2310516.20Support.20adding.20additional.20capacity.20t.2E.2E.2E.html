<html>
<head><meta charset="utf-8"><title>wasmtime / PR #10516 Support adding additional capacity t... · git-wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/index.html">git-wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html">wasmtime / PR #10516 Support adding additional capacity t...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="509792849"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509792849" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509792849">(Apr 02 2025 at 20:59)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/dicej">dicej</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="509792850"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509792850" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509792850">(Apr 02 2025 at 20:59)</a>:</h4>
<p>fitzgen opened <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a> from <code>fitzgen:freelist-add-capacity</code> to <code>bytecodealliance:main</code>:</p>
<blockquote>
<p>Split out from <a href="https://github.com/bytecodealliance/wasmtime/pull/10503">https://github.com/bytecodealliance/wasmtime/pull/10503</a></p>
<p>&lt;!--<br>
Please make sure you include the following information:</p>
<ul>
<li>
<p>If this work has been discussed elsewhere, please include a link to that<br>
  conversation. If it was discussed in an issue, just mention "issue #...".</p>
</li>
<li>
<p>Explain why this change is needed. If the details are in an issue already,<br>
  this can be brief.</p>
</li>
</ul>
<p>Our development process is documented in the Wasmtime book:<br>
<a href="https://docs.wasmtime.dev/contributing-development-process.html">https://docs.wasmtime.dev/contributing-development-process.html</a></p>
<p>Please ensure all communication follows the code of conduct:<br>
<a href="https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md">https://github.com/bytecodealliance/wasmtime/blob/main/CODE_OF_CONDUCT.md</a><br>
--&gt;</p>
</blockquote>



<a name="509792851"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509792851" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509792851">(Apr 02 2025 at 20:59)</a>:</h4>
<p><strong>fitzgen</strong> requested <a href="https://github.com/orgs/bytecodealliance/teams/wasmtime-core-reviewers">wasmtime-core-reviewers</a> for a review on <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="509795485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509795485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509795485">(Apr 02 2025 at 21:16)</a>:</h4>
<p>FrankReh submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737618694">PR review</a>.</p>



<a name="509795486"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509795486" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509795486">(Apr 02 2025 at 21:16)</a>:</h4>
<p>FrankReh created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025617741">PR review comment</a>:</p>
<blockquote>
<p>"and free_list way we" I was not able to parse.</p>
</blockquote>



<a name="509796524"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509796524" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509796524">(Apr 02 2025 at 21:23)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="509796780"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509796780" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509796780">(Apr 02 2025 at 21:25)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737634126">PR review</a>.</p>



<a name="509796781"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509796781" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509796781">(Apr 02 2025 at 21:25)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025627092">PR review comment</a>:</p>
<blockquote>
<p>I just reversed these changes, so that it still calls <code>reset</code>, since <code>reset</code> can't be removed until the rest of the changes from #10503 are present. Will make sure I don't accidentally remove words from the comment somehow when eventually inlining what used to be <code>reset</code> in that PR.</p>
</blockquote>



<a name="509797093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797093">(Apr 02 2025 at 21:27)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737630035">PR review</a>.</p>



<a name="509797094"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797094" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797094">(Apr 02 2025 at 21:27)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025624330">PR review comment</a>:</p>
<blockquote>
<p>Could the tests below exercise this new method?</p>
</blockquote>



<a name="509797095"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797095" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797095">(Apr 02 2025 at 21:27)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025625054">PR review comment</a>:</p>
<blockquote>
<p>To confirm, there's still a test below testing this behavior and that it fails?</p>
</blockquote>



<a name="509797096"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797096" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797096">(Apr 02 2025 at 21:27)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025627551">PR review comment</a>:</p>
<blockquote>
<p>If allocations could previously go up to <code>old_cap</code>, shouldn't this round up instead of round down?</p>
</blockquote>



<a name="509797579"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797579" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797579">(Apr 02 2025 at 21:30)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737644498">PR review</a>.</p>



<a name="509797580"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509797580" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509797580">(Apr 02 2025 at 21:30)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025632568">PR review comment</a>:</p>
<blockquote>
<p>Correct, we just return an <code>Ok(None)</code> (meaning that the allocation might succeed after growth/gc) instead of <code>Err(_)</code> (meaning that the allocation will never succeed no matter what)</p>
</blockquote>



<a name="509798595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509798595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509798595">(Apr 02 2025 at 21:38)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737657785">PR review</a>.</p>



<a name="509798596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509798596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509798596">(Apr 02 2025 at 21:38)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025640289">PR review comment</a>:</p>
<blockquote>
<p>No, because the old capacity was also rounded down the the alignment (all allocations are also a multiple of the alignment) so the first newly allocatable index for our additional capacity is that old capacity rounded down.</p>
</blockquote>



<a name="509799072"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509799072" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509799072">(Apr 02 2025 at 21:43)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="509799081"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509799081" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509799081">(Apr 02 2025 at 21:43)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737666082">PR review</a>.</p>



<a name="509799083"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509799083" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509799083">(Apr 02 2025 at 21:43)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025644742">PR review comment</a>:</p>
<blockquote>
<p>Done</p>
</blockquote>



<a name="509799310"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509799310" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509799310">(Apr 02 2025 at 21:45)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="509800595"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509800595" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509800595">(Apr 02 2025 at 21:55)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2737683147">PR review</a>.</p>



<a name="509800596"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509800596" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509800596">(Apr 02 2025 at 21:55)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2025656409">PR review comment</a>:</p>
<blockquote>
<p>Should this assert that old_cap is already aligned in that case? It mostly just seems counter-inutitive to me that you'd round down the end to figure out the index of the next block, I'd expect that you'd either round up or assert rounding isn't necessary</p>
</blockquote>



<a name="509812923"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/509812923" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#509812923">(Apr 02 2025 at 23:45)</a>:</h4>
<p>github-actions[bot] <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#issuecomment-2773978709">commented</a> on <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>:</p>
<blockquote>
<h4>Subscribe to Label Action</h4>
<p>cc @fitzgen</p>
<p>&lt;details&gt;<br>
This issue or pull request has been labeled: "wasmtime:api", "wasmtime:ref-types"</p>
<p>Thus the following users have been cc'd because of the following labels:</p>
<ul>
<li>fitzgen: wasmtime:ref-types</li>
</ul>
<p>To subscribe or unsubscribe from this label, edit the &lt;code&gt;.github/subscribe-to-label.json&lt;/code&gt; configuration file.</p>
<p><a href="https://github.com/bytecodealliance/subscribe-to-label-action">Learn more.</a><br>
&lt;/details&gt;</p>
</blockquote>



<a name="510334586"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510334586" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510334586">(Apr 05 2025 at 05:13)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2744622967">PR review</a>.</p>



<a name="510334587"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510334587" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510334587">(Apr 05 2025 at 05:13)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2029704159">PR review comment</a>:</p>
<blockquote>
<p>If we keep <code>self.capacity</code> aligned down to our alignment, then a sequence of 100 <code>add_capacity(1)</code> calls will never actually result in the <code>FreeList</code> thinking it has capacity for an allocation, even though it actually should. That is, <code>self.capacity = round_down_to_align(self.capacity + additional)</code> will always result in <code>self.capacity ==0</code> when <code>self.capacity</code> is initially <code>0</code> and <code>additional</code> is <code>1</code>, even when it is called in a loop.</p>
<p>We have to keep track of the actual capacity, and just do the rounding when adding blocks into the free list.</p>
</blockquote>



<a name="510334631"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510334631" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510334631">(Apr 05 2025 at 05:13)</a>:</h4>
<p>fitzgen edited <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2029704159">PR review comment</a>.</p>



<a name="510692157"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510692157" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510692157">(Apr 07 2025 at 14:43)</a>:</h4>
<p>alexcrichton submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2747104412">PR review</a>.</p>



<a name="510692160"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510692160" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510692160">(Apr 07 2025 at 14:43)</a>:</h4>
<p>alexcrichton created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2031409383">PR review comment</a>:</p>
<blockquote>
<p>Ah ok yeah that makes sense, I was missing that subtelty. Mind adding some comments to that effect to this?</p>
</blockquote>



<a name="510726434"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510726434" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510726434">(Apr 07 2025 at 17:15)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="510726561"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510726561" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510726561">(Apr 07 2025 at 17:15)</a>:</h4>
<p>fitzgen submitted <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#pullrequestreview-2747544942">PR review</a>.</p>



<a name="510726562"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510726562" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510726562">(Apr 07 2025 at 17:15)</a>:</h4>
<p>fitzgen created <a href="https://github.com/bytecodealliance/wasmtime/pull/10516#discussion_r2031675679">PR review comment</a>:</p>
<blockquote>
<p>Added</p>
</blockquote>



<a name="510726638"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510726638" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510726638">(Apr 07 2025 at 17:16)</a>:</h4>
<p>fitzgen has enabled auto merge for <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="510729427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510729427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510729427">(Apr 07 2025 at 17:30)</a>:</h4>
<p>fitzgen updated <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<a name="510735540"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/225357-git-wasmtime/topic/wasmtime%20/%20PR%20%2310516%20Support%20adding%20additional%20capacity%20t.../near/510735540" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wasmtime GitHub notifications bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/225357-git-wasmtime/topic/wasmtime.20.2F.20PR.20.2310516.20Support.20adding.20additional.20capacity.20t.2E.2E.2E.html#510735540">(Apr 07 2025 at 18:03)</a>:</h4>
<p>fitzgen merged <a href="https://github.com/bytecodealliance/wasmtime/pull/10516">PR #10516</a>.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>