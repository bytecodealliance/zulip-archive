<html>
<head><meta charset="utf-8"><title>sys/wait.h not found · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html">sys/wait.h not found</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="547626408"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/547626408" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> guest271314 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#547626408">(Oct 29 2025 at 04:20)</a>:</h4>
<p>I'm working on compiling fail-components/webtransport to WASM for use in the browser as server and client (using Direct Sockets <code>UDPSocket</code>). The original code was written to compile to Node.js Addon, not WASM or WASI. I got to 32% compiled before encounting Google's Protobuf including <code>sys/wait.h</code>. I'm already using wasi-threads. How to get around this?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cmake</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=</span><span class="cp">$</span><span class="p">{</span><span class="n">WASI_SDK_PATH</span><span class="p">}</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">wasi</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">pthread</span><span class="p">.</span><span class="n">cmake</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_LIBRARY_OUTPUT_DIRECTORY</span><span class="o">=</span><span class="s">"/media/user/1/webtransport/transports/http3-quiche/build-wasm/Release"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_JS_INC</span><span class="o">=</span><span class="s">"/media/user/1/webtransport/node_modules/node-api-headers/include;/media/user/1/webtransport/node_modules/node-addon-api"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_MSVC_RUNTIME_LIBRARY</span><span class="o">=</span><span class="s">"MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_JS_INC</span><span class="o">=</span><span class="s">"/media/user/1/webtransport/node_modules/node-api-headers/include;/media/user/1/webtransport/node_modules/node-addon-api"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_JS_SRC</span><span class="o">=</span><span class="s">""</span><span class="w"> </span><span class="o">-</span><span class="n">DNODE_RUNTIME</span><span class="o">=</span><span class="s">"node"</span><span class="w"> </span><span class="o">-</span><span class="n">DNODE_RUNTIMEVERSION</span><span class="o">=</span><span class="s">"26.0.0-nightly20251023f819aec288"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DNODE_ARCH</span><span class="o">=</span><span class="s">"x64"</span><span class="w"> </span><span class="o">-</span><span class="n">Dnapi_build_version</span><span class="o">=</span><span class="s">"6"</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_JS_LIB</span><span class="o">=</span><span class="s">""</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_CXX_FLAGS</span><span class="o">=</span><span class="s">"-DBUILDING_NODE_EXTENSION -D_WASI_EMULATED_SIGNAL -lwasi-emulated-signal"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_JS_VERSION</span><span class="o">=</span><span class="s">"7.3.1"</span><span class="w"> </span><span class="err">\</span>
<span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s">"Release"</span><span class="w"> </span><span class="err">\</span>
<span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">warn</span><span class="o">-</span><span class="n">unused</span><span class="o">-</span><span class="n">cli</span>
</code></pre></div>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">make</span>
<span class="p">#</span><span class="w"> </span><span class="o">..</span><span class="p">.</span>

<span class="n">clang</span><span class="o">++</span><span class="p">:</span><span class="w"> </span><span class="nc">warning</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="n">lwasi</span><span class="o">-</span><span class="n">emulated</span><span class="o">-</span><span class="n">signal</span><span class="p">:</span><span class="w"> </span><span class="o">'</span><span class="na">linker</span><span class="o">'</span><span class="w"> </span><span class="nc">input</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">Wunused</span><span class="o">-</span><span class="n">command</span><span class="o">-</span><span class="n">line</span><span class="o">-</span><span class="n">argument</span><span class="p">]</span>
<span class="p">[</span><span class="w"> </span><span class="mi">32</span><span class="o">%</span><span class="p">]</span><span class="w"> </span><span class="n">Building</span><span class="w"> </span><span class="n">CXX</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">third_party</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">libprotoc</span><span class="p">.</span><span class="n">dir</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">subprocess</span><span class="p">.</span><span class="n">cc</span><span class="p">.</span><span class="n">obj</span>
<span class="n">clang</span><span class="o">++</span><span class="p">:</span><span class="w"> </span><span class="nc">warning</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="n">lwasi</span><span class="o">-</span><span class="n">emulated</span><span class="o">-</span><span class="n">signal</span><span class="p">:</span><span class="w"> </span><span class="o">'</span><span class="na">linker</span><span class="o">'</span><span class="w"> </span><span class="nc">input</span><span class="w"> </span><span class="n">unused</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">Wunused</span><span class="o">-</span><span class="n">command</span><span class="o">-</span><span class="n">line</span><span class="o">-</span><span class="n">argument</span><span class="p">]</span>
<span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">webtransport</span><span class="o">/</span><span class="n">transports</span><span class="o">/</span><span class="n">http3</span><span class="o">-</span><span class="n">quiche</span><span class="o">/</span><span class="n">third_party</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">subprocess</span><span class="p">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="w"> </span><span class="nc">fatal</span><span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="o">'</span><span class="na">sys</span><span class="o">/</span><span class="n">wait</span><span class="p">.</span><span class="n">h</span><span class="o">'</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span>
<span class="w">   </span><span class="mi">43</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">#</span><span class="n">include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">sys</span><span class="o">/</span><span class="n">wait</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;</span>
<span class="w">      </span><span class="o">|</span><span class="w">          </span><span class="o">^~~~~~~~~~~~</span>
<span class="mi">1</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">generated</span><span class="p">.</span>
<span class="n">make</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="p">[</span><span class="n">third_party</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">libprotoc</span><span class="p">.</span><span class="n">dir</span><span class="o">/</span><span class="n">build</span><span class="p">.</span><span class="n">make</span><span class="p">:</span><span class="mi">1213</span><span class="p">:</span><span class="w"> </span><span class="nc">third_party</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">libprotoc</span><span class="p">.</span><span class="n">dir</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">google</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">subprocess</span><span class="p">.</span><span class="n">cc</span><span class="p">.</span><span class="n">obj</span><span class="p">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">1</span>
<span class="n">make</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="p">[</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">Makefile2</span><span class="p">:</span><span class="mi">5416</span><span class="p">:</span><span class="w"> </span><span class="nc">third_party</span><span class="o">/</span><span class="n">protobuf</span><span class="o">/</span><span class="n">CMakeFiles</span><span class="o">/</span><span class="n">libprotoc</span><span class="p">.</span><span class="n">dir</span><span class="o">/</span><span class="n">all</span><span class="p">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">2</span>
<span class="n">make</span><span class="p">:</span><span class="w"> </span><span class="o">***</span><span class="w"> </span><span class="p">[</span><span class="n">Makefile</span><span class="p">:</span><span class="mi">156</span><span class="p">:</span><span class="w"> </span><span class="nc">all</span><span class="p">]</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>



<a name="547651492"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/547651492" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#547651492">(Oct 29 2025 at 08:18)</a>:</h4>
<p>I believe this is intended, wasi-libc doesn't have a <code>sys/wait.h</code> header</p>



<a name="547711884"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/547711884" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> guest271314 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#547711884">(Oct 29 2025 at 13:10)</a>:</h4>
<p>Any thoughts on approaches to proceed in spite of that?</p>



<a name="547720786"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/547720786" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#547720786">(Oct 29 2025 at 13:49)</a>:</h4>
<p>You'll need to patch the code somehow -- unfortunately the WASI platform doesn't have that header because the functionality therein (waitpid, etc) doesn't exist</p>



<a name="547722983"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/547722983" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> guest271314 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#547722983">(Oct 29 2025 at 13:57)</a>:</h4>
<p>Hmm, this got a 'lil further along using Rust <a href="https://github.com/guest271314/quinn-wasm/tree/direct-sockets">https://github.com/guest271314/quinn-wasm/tree/direct-sockets</a>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/guest271314/quinn-wasm/tree/direct-sockets" style="background-image: url(&quot;https://uploads.zulipusercontent.net/b0fc5d944a9345fe443c149823537fb482b28623/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f353034346537616431383435373362636464333838616636373161333863363331633337613762643534343066326333646532346466396535636531613934662f67756573743237313331342f7175696e6e2d7761736d&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/guest271314/quinn-wasm/tree/direct-sockets" title="GitHub - guest271314/quinn-wasm at direct-sockets">GitHub - guest271314/quinn-wasm at direct-sockets</a></div><div class="message_embed_description">Contribute to guest271314/quinn-wasm development by creating an account on GitHub.</div></div></div>



<a name="548265943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/sys/wait.h%20not%20found/near/548265943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> guest271314 <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/sys.2Fwait.2Eh.20not.20found.html#548265943">(Nov 01 2025 at 01:44)</a>:</h4>
<p>From the maintainer, modification of this in CMakeLists.txt targeting WASM/WASI might do something.</p>
<p>I don't know CMake functions, and what to substitute for WASI-SDK</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">IF</span><span class="p">(</span><span class="n">APPLE</span><span class="p">)</span>
<span class="w">    </span><span class="n">set_target_properties</span><span class="p">(</span><span class="n">protoc</span><span class="w"> </span><span class="n">libprotoc</span><span class="w"> </span><span class="n">libprotobuf</span><span class="w"> </span><span class="n">PROPERTIES</span><span class="w"> </span><span class="n">OSX_ARCHITECTURES</span><span class="w"> </span><span class="s">"arm64;x86_64"</span><span class="w"> </span><span class="n">CACHE</span><span class="w"> </span><span class="n">STRING</span><span class="w"> </span><span class="s">"Build architectures for Mac OS X"</span><span class="w"> </span><span class="n">FORCE</span><span class="w"> </span><span class="p">)</span>
<span class="n">ENDIF</span><span class="p">(</span><span class="n">APPLE</span><span class="p">)</span>
</code></pre></div>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>