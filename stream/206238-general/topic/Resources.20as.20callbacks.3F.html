<html>
<head><meta charset="utf-8"><title>Resources as callbacks? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Resources.20as.20callbacks.3F.html">Resources as callbacks?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="573595871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Resources%20as%20callbacks%3F/near/573595871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Resources.20as.20callbacks.3F.html#573595871">(Feb 12 2026 at 18:49)</a>:</h4>
<p>Hello,</p>
<p>Trying to understand if it's possible to use components to achieve a callback/dependency injection pattern between components.</p>
<p>I want to declare a resource in a <code>callee</code> with a particular contract, import it, and then export a function from <code>callee</code> that takes an instance of the resource, and then I want to execute some function on that instance:</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>package callee:component;

interface callbacks {
    resource some-contract {
        constructor();
        run: func(message: string);
    }
}

interface api {
    use callbacks.{some-contract};
    process: func(callback: some-contract);
}

world component {
    export api;
}
</code></pre></div>
<p>The key is, I don't want to implement the callback type in the <code>callee</code>, it should be implemented in a caller. I just want the callee to define:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[allow(warnings)]</span>
<span class="k">mod</span><span class="w"> </span><span class="nn">bindings</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">use</span><span class="w"> </span><span class="k">super</span><span class="p">::</span><span class="n">Callee</span><span class="p">;</span>
<span class="w">    </span><span class="n">wit_bindgen</span><span class="p">::</span><span class="n">generate</span><span class="o">!</span><span class="p">();</span>
<span class="w">    </span><span class="n">export</span><span class="o">!</span><span class="p">(</span><span class="n">Callee</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">use</span><span class="w"> </span><span class="n">bindings</span><span class="p">::</span><span class="n">exports</span><span class="p">::</span><span class="n">callee</span><span class="p">::</span><span class="n">component</span><span class="p">::</span><span class="n">api</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">bindings</span><span class="p">::</span><span class="n">callee</span><span class="p">::</span><span class="n">component</span><span class="p">::</span><span class="n">callbacks</span><span class="p">;</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Callee</span><span class="p">;</span>

<span class="k">impl</span><span class="w"> </span><span class="n">api</span><span class="p">::</span><span class="n">Guest</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Callee</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span><span class="w"> </span><span class="nc">callbacks</span><span class="p">::</span><span class="n">SomeContract</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">callback</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">"Hello, world!"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This seems to compile, but how do I implement a caller component that can define the callback implementation that it then passes to <code>callee:component/api::process</code>?</p>



<a name="573597458"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Resources%20as%20callbacks%3F/near/573597458" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Resources.20as.20callbacks.3F.html#573597458">(Feb 12 2026 at 18:58)</a>:</h4>
<p>You won't be able to implement the caller component due to <a href="https://github.com/WebAssembly/component-model/issues/272">this limitation</a>.  There are unfortunately no good options for callbacks in the component model yet besides rolling your own ad-hoc version using e.g. a function table and u32 indexes into that table.</p>



<a name="573598912"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Resources%20as%20callbacks%3F/near/573598912" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Resources.20as.20callbacks.3F.html#573598912">(Feb 12 2026 at 19:06)</a>:</h4>
<p>Oh, and even the function table approach won't work given that recursive reentrance is disallowed currently (i.e. when the caller calls the callee and the callee tries to call back into the caller, that will trap).</p>
<p>With the new <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/Concurrency.md">concurrency model</a>, you can have the callee export an async function which can yield control to the callee, and they can talk to each other via e.g. <code>stream&lt;T&gt;</code>s, where <code>T</code> could be a type representing a function call and its parameters, but I think that's the best we can do at this point.</p>



<a name="573599485"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/Resources%20as%20callbacks%3F/near/573599485" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/Resources.20as.20callbacks.3F.html#573599485">(Feb 12 2026 at 19:08)</a>:</h4>
<p>Unfortunate answer, but thanks for the quick response!</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>