<html>
<head><meta charset="utf-8"><title>tinygo and pollable · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html">tinygo and pollable</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="545135289"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545135289" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545135289">(Oct 15 2025 at 22:11)</a>:</h4>
<p>I have a WIT with a wasi:io/poll.  This version is 0.2.6.  However, I see that tinygo uses 0.20.  When I call Block() on the pollable object generated from my WIT file, it blocks execution of all my goroutines.  Do I have to do something special to use the pollable object understood by tinygo so that a Block call does not lock up my program?</p>



<a name="545137339"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545137339" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545137339">(Oct 15 2025 at 22:30)</a>:</h4>
<p>correction: not 0.20, but 0.2.0</p>



<a name="545139165"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545139165" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545139165">(Oct 15 2025 at 22:48)</a>:</h4>
<p>My understanding is that TinyGo uses <a href="https://kripken.github.io/blog/wasm/2019/07/16/asyncify.html">Asyncify</a> to implement goroutines.  One limitation of that approach is that any call to an imported function (such as <code>wasi:io/poll#pollable.block</code>) will effectively suspend <em>all</em> goroutines until the call returns given that no Wasm code in the instance can run in the interim.</p>
<p>I don't expect that will be addressed for WASIp2, but my hope is that with WASIp3 (which is based on a new Component Model async ABI), we'll be able to hook into TinyGo's Asyncify transformation (and, in the case of "big" Go, the equivalent transformation it does at the IR level before emitting Wasm code) and transparently suspend and resume goroutines as they are blocked and unblocked on I/O, respectively -- while still allowing unblocked goroutines to make progress.  I'm specifically planning to create a proof-of-concept demonstrating this for "big" Go when I have a chance, but I'm not sure when that will be.</p>
<p>Eventually, once the TinyGo and "big" Go toolchains have embraced some flavor of Wasm stack switching, these Asyncify-style transformations will no longer be necessary, at which point we'll have a Go concurrency story that's both idiomatic <em>and</em> efficient.  That will be a bigger effort requiring more coordination, though.</p>



<a name="545139504"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545139504" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545139504">(Oct 15 2025 at 22:52)</a>:</h4>
<p>Oh that makes sense.  This means there is no way to do multiple polls in wasip2?</p>



<a name="545139574"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545139574" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545139574">(Oct 15 2025 at 22:52)</a>:</h4>
<p>No, not concurrently.</p>



<a name="545139907"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545139907" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545139907">(Oct 15 2025 at 22:57)</a>:</h4>
<p>Hypothetically, you could arrange for one of your goroutines to be the "designated poller", calling <code>poll</code> only once all the other goroutines have submitted the <code>pollable</code>s they're interested in, e.g. via a channel.</p>



<a name="545147175"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545147175" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545147175">(Oct 16 2025 at 00:27)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="509936">@Joel Dice</span> . So, I will give a "designated poller" a try.</p>



<a name="545147178"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545147178" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545147178">(Oct 16 2025 at 00:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="948912">Joel</span> has marked this topic as resolved.</p>



<a name="545147417"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/tinygo%20and%20pollable/near/545147417" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/tinygo.20and.20pollable.html#545147417">(Oct 16 2025 at 00:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="948912">Joel</span> has marked this topic as unresolved.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>