<html>
<head><meta charset="utf-8"><title>custom WIT component, must implement wasi:cli/imports ? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/index.html">general</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html">custom WIT component, must implement wasi:cli/imports ?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="540599048"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540599048" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540599048">(Sep 20 2025 at 17:04)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">example</span><span class="p">:</span><span class="nc">myfirst</span><span class="o">@</span><span class="mf">0.1.0</span><span class="p">;</span>

<span class="n">world</span><span class="w"> </span><span class="n">myplugin</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">include</span><span class="w"> </span><span class="n">wasi</span><span class="p">:</span><span class="nc">cli</span><span class="o">/</span><span class="n">imports</span><span class="o">@</span><span class="mf">0.2.6</span><span class="p">;</span>
<span class="w">  </span><span class="n">import</span><span class="w"> </span><span class="n">myfirstinterface</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// export: host-&gt;guest function calls</span>
<span class="w">  </span><span class="n">export</span><span class="w"> </span><span class="n">myfirstexport</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>In Rust in the host, i tried linking with:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">myfirstinterface</span><span class="p">::</span><span class="n">add_to_linker</span><span class="o">&lt;</span><span class="n">MyPluginIml</span><span class="p">,</span><span class="n">HasSelf</span><span class="o">&lt;</span><span class="n">MyPluginImpl</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="o">|</span><span class="n">f</span><span class="o">|</span><span class="n">f</span><span class="p">);</span>
</code></pre></div>
<p>But, if I do this, then my wasm file fails to run with an error saying the imported function does not exist.</p>
<p>Am I supposed to do:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">myplugin</span><span class="p">::</span><span class="n">add_to_linker</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">linker</span><span class="p">,</span><span class="o">&amp;</span><span class="n">linkeropts</span><span class="p">,</span><span class="o">|</span><span class="n">f</span><span class="o">|</span><span class="n">f</span><span class="p">);</span>
</code></pre></div>
<p>If i have to do it this way, it means I have to implement all of the wasi:cli/imports, which is a lot of work.  This makes me think there is something I am missing.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code>
</code></pre></div>



<a name="540625966"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540625966" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540625966">(Sep 21 2025 at 02:20)</a>:</h4>
<p>Oh, and if I have to do myfirstinterface::add_to_linker, is there a way to get wasi:cli interfaces to be part of my MyPluginImpl ?  This way, I do not have to implement all the wasi interfaces.</p>



<a name="540631343"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540631343" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540631343">(Sep 21 2025 at 04:55)</a>:</h4>
<p>I see that I can implement the wasi::cli::environment::Host for MyPluginImpl, but how do I get:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="bp">self</span><span class="p">.</span><span class="n">wasi_ctx</span><span class="p">.</span><span class="n">cli</span><span class="p">().</span><span class="n">get_environment</span><span class="p">()</span>
</code></pre></div>
<p>to implement <code>crate::host::wasi::cli::environment::Host</code> for the world <code>myplugin</code> ?  I get a missing trait error in Rust.</p>



<a name="540651387"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540651387" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540651387">(Sep 21 2025 at 11:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="948912">Joel</span> has marked this topic as unresolved.</p>



<a name="540652736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540652736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540652736">(Sep 21 2025 at 11:58)</a>:</h4>
<p>I followed the example from the <code>bindings</code> code hint, but am left wit this clippy error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="n">E0107</span><span class="p">]</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">supplied</span>
<span class="w">   </span><span class="n">argument</span><span class="w"> </span><span class="p">#</span><span class="mi">2</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="err">`</span><span class="o">&amp;</span><span class="n">wasmtime_wasi</span><span class="p">::</span><span class="n">p2</span><span class="p">::</span><span class="n">bindings</span><span class="p">::</span><span class="n">clocks</span><span class="p">::</span><span class="n">timezone</span><span class="p">::</span><span class="n">LinkOptions</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="n">E0061</span><span class="p">]</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="n">E0107</span><span class="p">]</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">supplied</span>
<span class="w">   </span><span class="n">argument</span><span class="w"> </span><span class="p">#</span><span class="mi">2</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="err">`</span><span class="o">&amp;</span><span class="n">wasmtime_wasi</span><span class="p">::</span><span class="n">p2</span><span class="p">::</span><span class="n">bindings</span><span class="p">::</span><span class="n">sockets</span><span class="p">::</span><span class="n">network</span><span class="p">::</span><span class="n">LinkOptions</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">[</span><span class="n">E0061</span><span class="p">]</span>
</code></pre></div>



<a name="540683245"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540683245" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540683245">(Sep 21 2025 at 20:38)</a>:</h4>
<p>you can satisfy that argument with <code>&amp;Default::default()</code></p>



<a name="540683280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/206238-general/topic/custom%20WIT%20component%2C%20must%20implement%20wasi%3Acli/imports%20%3F/near/540683280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/206238-general/topic/custom.20WIT.20component.2C.20must.20implement.20wasi.3Acli.2Fimports.20.3F.html#540683280">(Sep 21 2025 at 20:39)</a>:</h4>
<p>when a wit contains unstable features, wit-bindgen generates a LinkOptions to enable those features, but if you don't know about then then just ignore them, the impl Default is to turn them all off</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>