<html>
<head><meta charset="utf-8"><title>PHP interpreter/JIT using Cranelift? · cranelift · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/index.html">cranelift</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/PHP.20interpreter.2FJIT.20using.20Cranelift.3F.html">PHP interpreter/JIT using Cranelift?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="538004149"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/PHP%20interpreter/JIT%20using%20Cranelift%3F/near/538004149" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP Barringer <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/PHP.20interpreter.2FJIT.20using.20Cranelift.3F.html#538004149">(Sep 06 2025 at 13:49)</a>:</h4>
<p>I'm currently working on this. PHP -&gt; AST -&gt; CLIF -&gt; [Pulley / Cranelift / Cranelift interpreter]<br>
And considering a more complex version: PHP -&gt; AST -&gt; MLIR dialect -&gt; MLIR -&gt; CLIF -&gt; ...</p>
<p>I'm working through some of the PHP fundamentals but I'm curious if anyone here has thoughts on the feasibility of this approach and/or ideas about gotchas or how to do this well. Is Cranelift potentially a good fit?</p>



<a name="538113045"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/PHP%20interpreter/JIT%20using%20Cranelift%3F/near/538113045" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/PHP.20interpreter.2FJIT.20using.20Cranelift.3F.html#538113045">(Sep 07 2025 at 23:58)</a>:</h4>
<p>Sure, Cranelift should be usable as a backend; of course the hard part is going to be the "JIT for a dynamic language" part, not the codegen library/compiler backend that you choose :-)</p>
<p>There are some kinds of things that JITs want to do for dynamism that, if your implementation becomes advanced enough, you'll have to find your way around in: for example, ICs and on-stack replacement (tiering up or tiering down, sometimes called "deopt" in that direction). One could do ICs with function pointers and indirect calls (so dynamic updates are just data updates); replacing stack frames is trickier but I have some vague thoughts how this could eventually work.</p>
<p>I'm not sure about the pathway through MLIR that you describe -- at a glance at least, that seems unnecessarily complex, unless there's some other attraction to it (e.g., pre-existing frontend or PHP-specific dialect+optimizations or...)</p>



<a name="538234865"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217117-cranelift/topic/PHP%20interpreter/JIT%20using%20Cranelift%3F/near/538234865" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> JP Barringer <a href="https://bytecodealliance.github.io/zulip-archive/stream/217117-cranelift/topic/PHP.20interpreter.2FJIT.20using.20Cranelift.3F.html#538234865">(Sep 08 2025 at 14:01)</a>:</h4>
<p>Thanks. Yeah I'm definitely running before I can walk here. This whole question started with a PHP interpreter, with JIT op as a tier 2 feature. Trying to figure out some architectural choices ahead of time to keep that path open. The idea was to use a common MIR for both the interpreter and JIT (with the Cranelift interpreter in mind – although now I'm less sure of that approach).</p>
<p>MLIR is a bit of a side quest. The question is, if this already is looking like PHP -&gt; HIR -&gt; CLIF then "what if the HIR is a PHP MLIR dialect?" This might open up some paths to other backends for AOT (notably MLIR -&gt; LLVM) further down the road.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>