<html>
<head><meta charset="utf-8"><title>Sudden transpiled wasm component error in browser · jco · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/index.html">jco</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html">Sudden transpiled wasm component error in browser</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="513909337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/513909337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#513909337">(Apr 23 2025 at 15:57)</a>:</h4>
<p>My team is seeing errors calling into transpiled wasm components in the browser (suddenly after months of no problems).<br>
Here's a minimal env that reproduces the problem (for some of us):<br>
<a href="https://github.com/James-Mart/minimal-transpile">https://github.com/James-Mart/minimal-transpile</a></p>
<p>Further context:</p>
<ul>
<li>My team uses a docker containerized dev environment (so the same env for all of us regardless of host), in yet we can't repro this issue across all our machines.</li>
<li>I first saw this error (running a Mac M1 in case the host is relevant somehow). Mac up-to-date at v15.4.1. Up-to-date Docker Desktop 4.40.0 (187762)</li>
<li>Reproed in browsers: Brave, LibreWolf, and Chrome (browsers running on host system accessing running app in container via a forwarded port)</li>
<li>we also have a live server running our code (not the referenced minimal repro container). Serving/running the problematic code from that external backend does <em>not</em> produce this error for me (same browsers from same OS).</li>
<li>In the referenced minimal env linked above, I see 2 different errors:</li>
</ul>
<p>1) when the wasm calls println!(), I see the following</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4da7</span><span class="w"> </span><span class="n">Uncaught</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="nc">unreachable</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">__rust_start_panic</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4da7</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">rust_panic</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4c1e</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN3std9panicking20rust_panic_with_hook17h79071f5fb265d1d9E</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4bf1</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN3std9panicking19begin_panic_handler28_</span><span class="cp">$u7b$$u7b$closure$u7d$$u7d$</span><span class="mi">17</span><span class="n">h410c57f452410813E</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x3c9f</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN3std3sys9backtrace26__rust_end_short_backtrace17h514500abf2a2d0caE</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x3c0b</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">rust_begin_unwind</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x4585</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN4core9panicking9panic_fmt17he306018bf71f8e67E</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x9562</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN3std2io5stdio6_print17h4ef99727a983bb66E</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x325e</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">hello</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x2c6</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">Be</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">17452</span><span class="p">)</span>
</code></pre></div>
<p>2) when the wasm calls into rand and returns the result (no call to println!()), I get the following in the browser console</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">assertion</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">line</span>
<span class="w">    </span><span class="n">Ie</span><span class="w">  </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="cp">$indirect</span><span class="o">-</span><span class="n">wasi</span><span class="p">:</span><span class="nc">io</span><span class="o">/</span><span class="n">streams</span><span class="o">@</span><span class="mf">0.2.3</span><span class="o">-</span><span class="p">[</span><span class="n">method</span><span class="p">]</span><span class="n">output</span><span class="o">-</span><span class="n">stream</span><span class="p">.</span><span class="n">blocking</span><span class="o">-</span><span class="n">write</span><span class="o">-</span><span class="n">and</span><span class="o">-</span><span class="n">flush</span><span class="w">  </span><span class="o">@</span><span class="w">   </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="o">-</span><span class="n">f1fd1512</span><span class="p">:</span><span class="mh">0x16a</span>
<span class="w">    </span><span class="cp">$_ZN22wasi_snapshot_preview18bindings4wasi2io7streams12OutputStream24blocking_write_and_flush17h4f9b86b3d19bf6d5E</span><span class="w">   </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1154</span>
<span class="w">    </span><span class="cp">$_ZN22wasi_snapshot_preview16macros5print17h319e9b3e6f2e5d09E</span><span class="w">   </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x9ee</span>
<span class="w">    </span><span class="cp">$_ZN22wasi_snapshot_preview16macros11assert_fail17h67fe26dc6b70f78bE</span><span class="w">    </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x585</span>
<span class="w">    </span><span class="cp">$cabi_import_realloc</span><span class="w">    </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x641</span>
<span class="w">    </span><span class="n">Ee</span><span class="w">  </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="cp">$indirect</span><span class="o">-</span><span class="n">wasi</span><span class="p">:</span><span class="nc">random</span><span class="o">/</span><span class="n">random</span><span class="o">@</span><span class="mf">0.2.3</span><span class="o">-</span><span class="n">get</span><span class="o">-</span><span class="n">random</span><span class="o">-</span><span class="n">bytes</span><span class="w"> </span><span class="o">@</span><span class="w">   </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="o">-</span><span class="n">f1fd1512</span><span class="p">:</span><span class="mh">0x176</span>
<span class="w">    </span><span class="cp">$random_get</span><span class="w"> </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x181a</span>
<span class="w">    </span><span class="cp">$adapt</span><span class="o">-</span><span class="n">wasi_snapshot_preview1</span><span class="o">-</span><span class="n">random_get</span><span class="w">    </span><span class="o">@</span><span class="w">   </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="o">-</span><span class="n">f1fd1512</span><span class="p">:</span><span class="mh">0xb8</span>
<span class="w">    </span><span class="cp">$_ZN3std3sys12thread_local6statik20LazyStorage$LT$T$GT$</span><span class="mi">10</span><span class="n">initialize17h9d56f353d90c9518E</span><span class="w"> </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1b09</span>
<span class="w">    </span><span class="cp">$_ZN4rand4rngs6thread3rng17h1309d710195068edE</span><span class="w">   </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1d18</span>
<span class="w">    </span><span class="cp">$hello</span><span class="w">  </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1641</span>
<span class="w">    </span><span class="n">Ze</span><span class="w">  </span><span class="o">@</span><span class="w">   </span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="n">handleClick</span><span class="w"> </span><span class="o">@</span><span class="w">   </span><span class="n">App</span><span class="p">.</span><span class="n">tsx</span><span class="p">:</span><span class="mi">22</span>
<span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">[</span><span class="n">repeated</span><span class="w"> </span><span class="n">callstacks</span><span class="w"> </span><span class="n">skipped</span><span class="p">]</span>
<span class="o">&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="o">&gt;</span><span class="w"> </span><span class="mi">6</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">Uncaught</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="nc">unreachable</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">adapter</span><span class="p">:</span><span class="nc">wasi_snapshot_preview1</span><span class="p">.</span><span class="n">_ZN22wasi_snapshot_preview16macros11assert_fail17h67fe26dc6b70f78bE</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x58b</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">adapter</span><span class="p">:</span><span class="nc">wasi_snapshot_preview1</span><span class="p">.</span><span class="n">cabi_import_realloc</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x641</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">Ee</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">16790</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="p">.</span><span class="n">indirect</span><span class="o">-</span><span class="n">wasi</span><span class="p">:</span><span class="nc">random</span><span class="o">/</span><span class="n">random</span><span class="o">@</span><span class="mf">0.2.3</span><span class="o">-</span><span class="n">get</span><span class="o">-</span><span class="n">random</span><span class="o">-</span><span class="n">bytes</span><span class="w"> </span><span class="p">(</span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="o">-</span><span class="n">f1fd1512</span><span class="p">:</span><span class="mh">0x176</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">adapter</span><span class="p">:</span><span class="nc">wasi_snapshot_preview1</span><span class="p">.</span><span class="n">random_get</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core2</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x181a</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="p">.</span><span class="n">adapt</span><span class="o">-</span><span class="n">wasi_snapshot_preview1</span><span class="o">-</span><span class="n">random_get</span><span class="w"> </span><span class="p">(</span><span class="n">wit</span><span class="o">-</span><span class="n">component</span><span class="p">:</span><span class="nc">shim</span><span class="o">-</span><span class="n">f1fd1512</span><span class="p">:</span><span class="mh">0xb8</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN3std3sys12thread_local6statik20LazyStorage</span><span class="cp">$LT$T$GT$</span><span class="mi">10</span><span class="n">initialize17h9d56f353d90c9518E</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1b09</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">_ZN4rand4rngs6thread3rng17h1309d710195068edE</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1d18</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">wasm</span><span class="p">.</span><span class="n">wasm</span><span class="p">.</span><span class="n">hello</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">wasm</span><span class="p">:</span><span class="mh">0x1641</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">Ze</span><span class="w"> </span><span class="p">(</span><span class="n">wasm</span><span class="p">.</span><span class="n">js</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">17825</span><span class="p">)</span>
</code></pre></div>
<p>Important notes:</p>
<ul>
<li>This error is inconsistent on our machines. It always happens on my machine and another coworker's Mac M2. It does <em>not</em> happen at all on another coworker's Ubuntu machine. Again, all containerized regardless of host OS...</li>
<li>On systems where it is reproducible, it's 100% of the time.</li>
</ul>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/James-Mart/minimal-transpile" style="background-image: url(&quot;https://uploads.zulipusercontent.net/5676146cdb0bc0f9777bceba8ea94f05ee34c343/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333066356237633439643264393465646161633733343434396566336333373964353264623234303265383164623235373435343632383832343064323235342f4a616d65732d4d6172742f6d696e696d616c2d7472616e7370696c65&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/James-Mart/minimal-transpile" title="GitHub - James-Mart/minimal-transpile">GitHub - James-Mart/minimal-transpile</a></div><div class="message_embed_description">Contribute to James-Mart/minimal-transpile development by creating an account on GitHub.</div></div></div>



<a name="513911684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/513911684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#513911684">(Apr 23 2025 at 16:07)</a>:</h4>
<p>An additional detail:</p>
<p>Mike just sent me his transpiled wasm, and only then can I reproduce the issue. But if I transpile it myself, no error.</p>
<p>Since it's a containerized dev environment, versions of tooling should all basically be the same.</p>



<a name="513911822"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/513911822" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#513911822">(Apr 23 2025 at 16:07)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="901567">@Mike M</span> thanks for reporting this -- would you mind filing this at <a href="https://github.com/bytecodealliance/jco">https://github.com/bytecodealliance/jco</a> (as well as discussing it here) ?</p>
<p>Also, I'm curious -- any idea of what changed here tooling wise that might have started introducing this issue? Was it a toolchain update? jco hasn't changed in a bit but other pieces of the toolchain certainly have.</p>
<p>Fascinating that it seems to only happen on aarch64 somehow (?)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco" style="background-image: url(&quot;https://uploads.zulipusercontent.net/feeb7abd3704245cd0fb2b1fe5ffdac409bb7cb0/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f656333646238306461623939373230396330353033363435336661636465373338363065633132346464613736636536383533643634303636353465383636642f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco" title="GitHub - bytecodealliance/jco: JavaScript toolchain for working with WebAssembly Components">GitHub - bytecodealliance/jco: JavaScript toolchain for working with WebAssembly Components</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div>



<a name="513912926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/513912926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#513912926">(Apr 23 2025 at 16:12)</a>:</h4>
<p>If you go to the line in the source that the error points to, <br>
<a href="/user_uploads/15107/nuwchVA47TC6U_2Y3J7nQb-0/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/15107/nuwchVA47TC6U_2Y3J7nQb-0/image.png" title="image.png"><img data-original-content-type="image/png" data-original-dimensions="330x128" src="/user_uploads/thumbnail/15107/nuwchVA47TC6U_2Y3J7nQb-0/image.png/840x560.webp"></a></div><p>...you end up here</p>
<p><a href="https://github.com/bytecodealliance/wasmtime/blob/4b6e96151f53705fc8c245e5d8efef31b0637eed/crates/wasi-preview1-component-adapter/src/lib.rs#L376">https://github.com/bytecodealliance/wasmtime/blob/4b6e96151f53705fc8c245e5d8efef31b0637eed/crates/wasi-preview1-component-adapter/src/lib.rs#L376</a></p>
<p>...The giant comment from <span class="user-mention" data-user-id="253994">@Alex Crichton</span> above that function seems potentially relevant <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>
<p>But I'm just not sure why we only just started seeing this error</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/4b6e96151f53705fc8c245e5d8efef31b0637eed/crates/wasi-preview1-component-adapter/src/lib.rs#L376" style='background-image: url("https://uploads.zulipusercontent.net/c0e1387ee9618ce1bb92595fe5f5ad40f1bbeef6/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323536393365646535663932336135633961373236333839626232623962336565366266313932326664343566653430376461336437663839666133336437642f62797465636f6465616c6c69616e63652f7761736d74696d65")'></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/4b6e96151f53705fc8c245e5d8efef31b0637eed/crates/wasi-preview1-component-adapter/src/lib.rs#L376" title="wasmtime/crates/wasi-preview1-component-adapter/src/lib.rs at 4b6e96151f53705fc8c245e5d8efef31b0637eed · bytecodealliance/wasmtime">wasmtime/crates/wasi-preview1-component-adapter/src/lib.rs at 4b6e96151f53705fc8c245e5d8efef31b0637eed · bytecodealliance/wasmtime</a></div><div class="message_embed_description">A lightweight WebAssembly runtime that is fast, secure, and standards-compliant - bytecodealliance/wasmtime</div></div></div>



<a name="513913349"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/513913349" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#513913349">(Apr 23 2025 at 16:14)</a>:</h4>
<p>GH issue: <a href="https://github.com/bytecodealliance/jco/issues/634">https://github.com/bytecodealliance/jco/issues/634</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/issues/634" style="background-image: url(&quot;https://uploads.zulipusercontent.net/43abbc3c535a8f64b49c7ec02789243224d1f586/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f633537303236363562363639373430623732383761303336656566383336313132316331616435643736303663386263613730343031343564653338643636322f62797465636f6465616c6c69616e63652f6a636f2f6973737565732f363334&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/issues/634" title="Sudden transpiled wasm component error in browser · Issue #634 · bytecodealliance/jco">Sudden transpiled wasm component error in browser · Issue #634 · bytecodealliance/jco</a></div><div class="message_embed_description">My team is seeing errors calling into transpiled wasm components in the browser (suddenly after months of no problems). Here's a minimal env that reproduces the problem (for some of us): https://gi...</div></div></div>



<a name="514227029"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514227029" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514227029">(Apr 24 2025 at 20:53)</a>:</h4>
<p>Work-around?<br>
It's only been a day, but given this is a blocker for me, I'm curious if there's anything you can offer immediately. We could really use a <strong>work-around / downgrade</strong> if you have one. For now, it's only me who's dead in the water, but I have a feeling we'll have 2 of us blocked very shortly.<br>
Thanks</p>



<a name="514394890"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514394890" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514394890">(Apr 25 2025 at 14:40)</a>:</h4>
<p>I <em>think</em> this error implies that anyone running a Mac M1+ is currently unable to transpile a wasm component and run it in the browser. </p>
<p>The component might need to call a wasi import or something to trigger the error. Tested with generating a random number.</p>



<a name="514408040"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514408040" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514408040">(Apr 25 2025 at 15:46)</a>:</h4>
<p><del>Hey apologies for the delay here <span class="user-mention" data-user-id="901567">@Mike M</span>, but can you confirm what version of componentize-js you're using? Jco dynamically <a href="https://github.com/bytecodealliance/jco/blob/main/src/cmd/componentize.js#L8"><code>eval</code>s componentize-js</a> to build the component and I don't see it in your <code>package.json</code> but I'd like to be sure (seeing if we can go for a downgrade here).</del></p>
<p>[EDIT] Sorry, I misunderstood -- you're <em>only</em> transpiling the rust component, right? You won't need a version of componentize.</p>
<p>At the same time, I'd like to explore what I think could be a workaround -- would you also mind modifying  <a href="https://github.com/James-Mart/minimal-transpile/blob/main/wasm/wit/world.wit">your WIT world</a> to look like the following:</p>
<div class="codehilite" data-code-language="wit"><pre><span></span><code>package component:wasm;

// Not required, but generally interfaces are recommended over bare function exports
interface greet {
  hello: func() -&gt; string;
}

world example {
    import wasi:random/random@0.2.3;
    import wasi:random/insecure@0.2.3;
    import wasi:random/insecure-seed@0.2.3;
    import wasi:cli/environment@0.2.3;
    import wasi:cli/exit@0.2.3;
    import wasi:cli/stdin@0.2.3;
    import wasi:cli/stdout@0.2.3;
    import wasi:cli/stderr@0.2.3;
    import wasi:cli/terminal-input@0.2.3;
    import wasi:cli/terminal-output@0.2.3;
    import wasi:cli/terminal-stdin@0.2.3;
    import wasi:cli/terminal-stdout@0.2.3;
    import wasi:cli/terminal-stderr@0.2.3;

    export greet;
}
</code></pre></div>
<p>The above is  overkill, but I just want to increase the chance of success for the test you run.</p>
<p>Once you've updated your WIT, please run <code>wkg wit fetch</code> to pull in the noted WIT dependencies, from the folder above (from <code>wasm</code>), which should fill out <code>wasm/wit/deps</code>.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/James-Mart/minimal-transpile/blob/main/wasm/wit/world.wit" style="background-image: url(&quot;https://uploads.zulipusercontent.net/d35599688e70c5027dc5da9f9c9185a6ac7c7722/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f353435346338396439343366376134653465646534643330313262626237373361653866666437626236616332346139356333306536313234383533333333622f4a616d65732d4d6172742f6d696e696d616c2d7472616e7370696c65&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/James-Mart/minimal-transpile/blob/main/wasm/wit/world.wit" title="minimal-transpile/wasm/wit/world.wit at main · James-Mart/minimal-transpile">minimal-transpile/wasm/wit/world.wit at main · James-Mart/minimal-transpile</a></div><div class="message_embed_description">Contribute to James-Mart/minimal-transpile development by creating an account on GitHub.</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/blob/main/src/cmd/componentize.js#L8" style="background-image: url(&quot;https://uploads.zulipusercontent.net/994f553c443ccb4c891f4955b35d8a67874b4a2d/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f373965313265366130663938333737343266353939353732353137376236323130646434323763316364313730386333643365326561346336313837393839362f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/blob/main/src/cmd/componentize.js#L8" title="jco/src/cmd/componentize.js at main · bytecodealliance/jco">jco/src/cmd/componentize.js at main · bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div>



<a name="514408840"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514408840" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514408840">(Apr 25 2025 at 15:50)</a>:</h4>
<p>Ahh please note also that if you do the <code>interface</code> change, you'll need to modify your code <em>just a bit</em> to export the right things.</p>



<a name="514409962"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514409962" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514409962">(Apr 25 2025 at 15:56)</a>:</h4>
<p>OH! You know what, I think I might know what is wrong</p>



<a name="514411857"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514411857" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514411857">(Apr 25 2025 at 16:06)</a>:</h4>
<p>I'm going to do a little bit more poking around to try and fix this and send a PR to your repo directly, hopefully before monday!</p>



<a name="514412222"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412222" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412222">(Apr 25 2025 at 16:09)</a>:</h4>
<p>ok, sounds great, Victor!<br>
In case it helps, here's my response to your first message (couldn't get it done before you were on to what sounds like the right direction :) )<br>
NOTE: I did <em>not</em> make the interface change. I left the raw func in the export { ... } because you had already replied with the follow-up, and it was taking me time to rework that. I can add the interface to the defn if you think that would be informative. Just wanted to get you this response asap.</p>
<p>Ok, I'm in unfamiliar territory with the details of this container, so I'll be thorough in my response...<br>
pulled the wkg util and ran it from the wasm folder, which seemed to work:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">wkg</span><span class="o">-</span><span class="n">aarch64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="w"> </span><span class="n">wit</span><span class="w"> </span><span class="n">fetch</span>
<span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">25</span><span class="n">T16</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">12.620227</span><span class="n">Z</span><span class="w">  </span><span class="n">WARN</span><span class="w"> </span><span class="n">wasm_pkg_client</span><span class="p">::</span><span class="n">oci</span><span class="p">::</span><span class="n">loader</span><span class="p">:</span><span class="w"> </span><span class="nc">Ignoring</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s">"sha256-bde08985744034d359aefdfa105be38b75f15c921efada1b6dc081a11090ef45.sig"</span><span class="w"> </span><span class="n">error</span><span class="o">=</span><span class="n">Error</span><span class="p">(</span><span class="s">"unexpected character 's' while parsing major version number"</span><span class="p">)</span>
<span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">25</span><span class="n">T16</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">12.620327</span><span class="n">Z</span><span class="w">  </span><span class="n">WARN</span><span class="w"> </span><span class="n">wasm_pkg_client</span><span class="p">::</span><span class="n">oci</span><span class="p">::</span><span class="n">loader</span><span class="p">:</span><span class="w"> </span><span class="nc">Ignoring</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s">"sha256-3da46c1244c00aebe1c8784f900eb3cf55d19f3bd28ce5303858f888854e3ef4.sig"</span><span class="w"> </span><span class="n">error</span><span class="o">=</span><span class="n">Error</span><span class="p">(</span><span class="s">"unexpected character 's' while parsing major version number"</span><span class="p">)</span>
<span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">25</span><span class="n">T16</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">12.758450</span><span class="n">Z</span><span class="w">  </span><span class="n">WARN</span><span class="w"> </span><span class="n">wasm_pkg_client</span><span class="p">::</span><span class="n">oci</span><span class="p">::</span><span class="n">loader</span><span class="p">:</span><span class="w"> </span><span class="nc">Ignoring</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s">"sha256-e1b6482c98d3d299ce75a80c4d15501e32fbd5b1b8434e23aafafe1677637faf.sig"</span><span class="w"> </span><span class="n">error</span><span class="o">=</span><span class="n">Error</span><span class="p">(</span><span class="s">"unexpected character 's' while parsing major version number"</span><span class="p">)</span>
<span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">25</span><span class="n">T16</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">12.758490</span><span class="n">Z</span><span class="w">  </span><span class="n">WARN</span><span class="w"> </span><span class="n">wasm_pkg_client</span><span class="p">::</span><span class="n">oci</span><span class="p">::</span><span class="n">loader</span><span class="p">:</span><span class="w"> </span><span class="nc">Ignoring</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s">"sha256-4e1a777bd0dd370f680645afe3c7aa230e1ebc6bf0c9ae454546ca0dfe3f4bc9.sig"</span><span class="w"> </span><span class="n">error</span><span class="o">=</span><span class="n">Error</span><span class="p">(</span><span class="s">"unexpected character 's' while parsing major version number"</span><span class="p">)</span>
</code></pre></div>
<p>then recompiled:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">$</span><span class="w"> </span><span class="n">cargo</span><span class="w"> </span><span class="n">build</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">libc</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">2.172</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">getrandom</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">3.2</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">zerocopy</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">8.24</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">wit</span><span class="o">-</span><span class="n">bindgen</span><span class="o">-</span><span class="n">rt</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">41.0</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">rand_core</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">9.3</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">ppv</span><span class="o">-</span><span class="n">lite86</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">2.21</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">rand_chacha</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">9.0</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">rand</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">9.1</span>
<span class="w">   </span><span class="n">Compiling</span><span class="w"> </span><span class="n">wasm</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">1.0</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">workspaces</span><span class="o">/</span><span class="n">minimal</span><span class="o">-</span><span class="n">transpile</span><span class="o">/</span><span class="n">wasm</span><span class="p">)</span>
<span class="w">    </span><span class="n">Finished</span><span class="w"> </span><span class="err">`</span><span class="n">dev</span><span class="err">`</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="p">[</span><span class="n">unoptimized</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">debuginfo</span><span class="p">]</span><span class="w"> </span><span class="n">target</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mf">1.59</span><span class="n">s</span>
</code></pre></div>
<p>and I see the same error</p>



<a name="514412438"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412438" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412438">(Apr 25 2025 at 16:10)</a>:</h4>
<p>Yeah so pulling your code down one thimg I'm wondering is how you're bundling in preview2-shim</p>



<a name="514412478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412478">(Apr 25 2025 at 16:10)</a>:</h4>
<p>This project:</p>
<p><a href="https://www.npmjs.com/package/@bytecodealliance/preview2-shim">https://www.npmjs.com/package/@bytecodealliance/preview2-shim</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://www.npmjs.com/package/@bytecodealliance/preview2-shim" style="background-image: url(&quot;https://uploads.zulipusercontent.net/1f95ebb8bfed4d27a76408b23d90d6ad57189dbd/68747470733a2f2f7374617469632d70726f64756374696f6e2e6e706d6a732e636f6d2f33333865343930356132363834636139366530386337373830666336383431322e706e67&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://www.npmjs.com/package/@bytecodealliance/preview2-shim" title="@bytecodealliance/preview2-shim">@bytecodealliance/preview2-shim</a></div><div class="message_embed_description">WASI Preview2 shim for JS environments. Latest version: 0.17.2, last published: 2 months ago. Start using @bytecodealliance/preview2-shim in your project by running `npm i @bytecodealliance/preview2-shim`. There are 14 other projects in the npm registry using @bytecodealliance/preview2-shim.</div></div></div>



<a name="514412503"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412503" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412503">(Apr 25 2025 at 16:10)</a>:</h4>
<p>Is what adds the shims (like random) to make things work in the browser</p>



<a name="514412675"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412675" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412675">(Apr 25 2025 at 16:11)</a>:</h4>
<p>I <em>think</em> the answer here is that <code>vite</code> is walking your dynamic import in App.tsx, and resolving that to bundle it</p>



<a name="514412831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514412831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514412831">(Apr 25 2025 at 16:12)</a>:</h4>
<p>And I see the output in dist</p>



<a name="514414375"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414375" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414375">(Apr 25 2025 at 16:21)</a>:</h4>
<p>Did your browser change by any chance?</p>



<a name="514414402"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414402" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414402">(Apr 25 2025 at 16:21)</a>:</h4>
<p>I was thinking that jco was bundling the shims as part of transpilation (and transpile is part of the yarn build script).</p>
<p>But now looking at JCO docs I'm seeing</p>
<blockquote>
<p>Components relying on WASI bindings will contain external WASI imports, which are automatically updated to the <code>@bytecodealliance/preview2-shim</code> package.</p>
</blockquote>
<p>In which case, I suppose yeah, it's vite that's resolving them?</p>



<a name="514414433"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414433" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414433">(Apr 25 2025 at 16:21)</a>:</h4>
<p>No, it doesn't bundle the shims -- vite is bundling as normal</p>



<a name="514414612"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414612" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414612">(Apr 25 2025 at 16:22)</a>:</h4>
<p>Sorry didn't update, but that's what's happening -- you can use rollup/esbuild/vite/etc -- that step has to be done somewhere otherwise it'd have nothing to call on the frontend of course, the code is fine and stuff shows up in dist as expected</p>



<a name="514414782"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414782" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414782">(Apr 25 2025 at 16:23)</a>:</h4>
<p>What I'm thinking now is actually that this is a deficiency in the browser shim itself, because it seems like writing to streams (whether via stdout or when random is called) is failing</p>



<a name="514414848"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414848" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414848">(Apr 25 2025 at 16:24)</a>:</h4>
<p>BUT, the really perplexing thing is how it works some places and not others, it's leaving me to think that the browser itself could be different</p>



<a name="514414919"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414919" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414919">(Apr 25 2025 at 16:24)</a>:</h4>
<p>Yeah keep in mind the shim works fine in my browser</p>



<a name="514414972"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514414972" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514414972">(Apr 25 2025 at 16:24)</a>:</h4>
<p>i.e. that a different in browser settings/state is causing shim I/O code to fail in one place and not in the other</p>



<a name="514415033"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415033" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415033">(Apr 25 2025 at 16:24)</a>:</h4>
<p>Actually I think the problem is something at build time, not runtime</p>



<a name="514415156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415156">(Apr 25 2025 at 16:25)</a>:</h4>
<p>Hmnn, interesting. Considering ya'll can take the exact same code and put it in on one machine versus another and have it run fine, I thought we could rule that out</p>



<a name="514415213"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415213" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415213">(Apr 25 2025 at 16:25)</a>:</h4>
<p>(let me know if I misunderstood the situation!)</p>



<a name="514415324"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415324" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415324">(Apr 25 2025 at 16:26)</a>:</h4>
<p>Mike sent me a zip of his wasm-transpiled directory, and I used it in my environment without building it myself, and then I also had the error</p>



<a name="514415353"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415353" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415353">(Apr 25 2025 at 16:26)</a>:</h4>
<p>But if I transpile the component myself, no error</p>



<a name="514415472"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415472" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415472">(Apr 25 2025 at 16:27)</a>:</h4>
<p>Ahh right OK you noted that up top</p>



<a name="514415736"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415736" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415736">(Apr 25 2025 at 16:28)</a>:</h4>
<p>Would you mind providing zip files with both of your versions? built on his computer versus yours?</p>



<a name="514415754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514415754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514415754">(Apr 25 2025 at 16:28)</a>:</h4>
<p>And, we effectively did the reverse as well, where Mike used his browser to run an app that was built in another environment (in this case build env was CICD and wasn't using that <code>minimal-transpile</code> app), and then he does <em>not</em> have the error</p>



<a name="514416014"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514416014" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514416014">(Apr 25 2025 at 16:29)</a>:</h4>
<blockquote>
<p>Would you mind providing zip files with both of your versions? built on his computer versus yours?</p>
</blockquote>
<p>Yeah sure</p>



<a name="514416038"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514416038" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514416038">(Apr 25 2025 at 16:29)</a>:</h4>
<p>And the working build was on Ubuntu (amd64) w/ the failing build on Mac M2 (aarch64) right</p>



<a name="514416519"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514416519" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514416519">(Apr 25 2025 at 16:32)</a>:</h4>
<blockquote>
<p>And the working build was on Ubuntu (amd64) w/ the failing build on Mac M2 (aarch64) right</p>
</blockquote>
<p>Right. Builds from an ubuntu runner in cicd work, as well as builds on my machine which is amd64 (running windows)</p>



<a name="514417252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417252">(Apr 25 2025 at 16:35)</a>:</h4>
<p>Failed on Mac M1 and M2 so far</p>



<a name="514417270"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417270" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417270">(Apr 25 2025 at 16:35)</a>:</h4>
<p>IIRC we do not do much arch-specific conditional compilation/gating on the jco side -- but clearly something is different, and the big difference <em>seems</em> to be arch...</p>



<a name="514417344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417344">(Apr 25 2025 at 16:35)</a>:</h4>
<p>One thing I'm wondering is if it's actually a compiled wasm level issue</p>



<a name="514417493"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417493" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417493">(Apr 25 2025 at 16:36)</a>:</h4>
<p>I'll be able to check with the zip files from both environments (and I have an macbook here I can use to reproduce as well, so even if I don't get it no biggie) -- but I wonder if taking only the wasm file over you can reproduce the failure</p>



<a name="514417566"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417566" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417566">(Apr 25 2025 at 16:36)</a>:</h4>
<p><a href="/user_uploads/15107/vOtVH1LjCp1qdLC-TFAxwEPn/build-artifacts.working.zip">build-artifacts.working.zip</a><br>
<a href="/user_uploads/15107/Fx18yjwlTmoOCvcv2FPapMJ0/build-artifacts.broken.zip">build-artifacts.broken.zip</a></p>



<a name="514417598"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417598" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417598">(Apr 25 2025 at 16:37)</a>:</h4>
<p>i.e. taking only the wasm file over, then transpiling on whichever platform, then trying to repro the failure</p>



<a name="514417660"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417660" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417660">(Apr 25 2025 at 16:37)</a>:</h4>
<p>Good question, I'll do some of that debugging to see if I can better isolate what causes the error</p>



<a name="514417827"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417827" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417827">(Apr 25 2025 at 16:38)</a>:</h4>
<p>Yeah, we've either stumbled upon an bug from arch difference in Rust, or in generated (transpiled) JS.</p>
<p>I am leaning on the transpiled JS side of course, but of course checking is the only way to know for sure</p>



<a name="514417914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514417914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514417914">(Apr 25 2025 at 16:38)</a>:</h4>
<p>My earlier post apparently included some extraneous content. Is a response to your original request still relevant Victor? I'm happy to provide updated/corrected output if still relevant</p>



<a name="514418074"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514418074" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514418074">(Apr 25 2025 at 16:40)</a>:</h4>
<p>Oh no thanks Mike, the details here are certainly enough, and the zip files above should be everything I need</p>



<a name="514418203"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514418203" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514418203">(Apr 25 2025 at 16:40)</a>:</h4>
<p>Thanks for the patience here, this is certainly a head scratcher, but I should be able to get to the bottom of it with allt his information</p>



<a name="514418451"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514418451" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514418451">(Apr 25 2025 at 16:41)</a>:</h4>
<p>No problem at all. We really appreciate your time and effort! If we can provide anything else, we'll be here.</p>



<a name="514419337"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514419337" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514419337">(Apr 25 2025 at 16:43)</a>:</h4>
<p>Okay it's <code>wasm.core2.wasm</code>. I believe transferring <em>only</em> that file over triggers the issue</p>



<a name="514419817"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514419817" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514419817">(Apr 25 2025 at 16:44)</a>:</h4>
<p>So... some difference in how the core wasm is generated across architectures?</p>



<a name="514421467"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514421467" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514421467">(Apr 25 2025 at 16:48)</a>:</h4>
<p>Ah sorry, could you try only transferring the output on the Rust side</p>



<a name="514421541"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514421541" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514421541">(Apr 25 2025 at 16:48)</a>:</h4>
<p>confirming James finding. I swapped out my wasm.core2.wasm with his, and my code now works</p>



<a name="514421812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514421812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514421812">(Apr 25 2025 at 16:49)</a>:</h4>
<p>You should see the same result, but doing it from <em>before</em> transpile runs tells us a little bit more about where the issue is -- whether it's the rust output or "unbundling" routines</p>



<a name="514421880"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514421880" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514421880">(Apr 25 2025 at 16:49)</a>:</h4>
<p>Oh, okay great. Will check</p>



<a name="514422098"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422098" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422098">(Apr 25 2025 at 16:49)</a>:</h4>
<p>Without getting into the nitty gritty -- Rust will output a wasm component (which consists of one or more core modules, i.e. the only thing a browser can run), and jco actually unbundles that component into multiple core modules and supporting machinery</p>



<a name="514422156"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422156" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422156">(Apr 25 2025 at 16:49)</a>:</h4>
<p>Is it enough to just swap the whole <code>target</code> directory?</p>



<a name="514422196"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422196" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422196">(Apr 25 2025 at 16:49)</a>:</h4>
<p>the unbundling functionality could also be a point of failure</p>



<a name="514422357"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422357" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422357">(Apr 25 2025 at 16:50)</a>:</h4>
<p>Or do you want higher resolution</p>



<a name="514422359"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422359" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422359">(Apr 25 2025 at 16:50)</a>:</h4>
<p>Yep! swapping the target directory is fine, because you use <code>wasm/target</code> in <code>transpile.sh</code></p>



<a name="514422439"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514422439" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514422439">(Apr 25 2025 at 16:50)</a>:</h4>
<p>swapping <code>wasm</code>, <code>wasm/target</code>, etc down to <code>./wasm/target/wasm32-wasip1/release/wasm.wasm</code> should be fine</p>



<a name="514425089"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514425089" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514425089">(Apr 25 2025 at 17:04)</a>:</h4>
<p>Ok - confirmed. I swapped only the <code>.wasm</code> file with the version built on the aarch64 machine, reran transpilation, and was able to reproduce the error</p>



<a name="514425238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514425238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514425238">(Apr 25 2025 at 17:05)</a>:</h4>
<p>Well, I definitely didn't want to hear that, but that certainly narrows it down!</p>



<a name="514425271"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514425271" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514425271">(Apr 25 2025 at 17:05)</a>:</h4>
<p>Haha sorry, thank you very much for your support</p>



<a name="514425714"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514425714" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514425714">(Apr 25 2025 at 17:08)</a>:</h4>
<p>Thanks for doing this exploratory work -- it looks like there's a bug in the toolchain somewhere, this is worth surfacing to wasmtime etc. </p>
<p>I'll try to do a little more digging (maybe try and bisect this back) and put up an issue to <code>wasmtime</code>. Clearly the transpilation machinery here isn't the deciding factor, possibly this is a failure of the code generated by <code>wit-bidngen-rt</code>.</p>



<a name="514425722"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514425722" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514425722">(Apr 25 2025 at 17:08)</a>:</h4>
<p>confirmed: <br>
I did the opposite of James: dropped his target/wasm32-wasip1/release/wasm.wasm in my release folder and transpiled, ran, did <em>not</em> see the error</p>



<a name="514426054"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426054" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426054">(Apr 25 2025 at 17:10)</a>:</h4>
<p>If you want to downgrade <code>wit-bindgen-rt</code> to <code>0.40.0</code> (I assume things were working 2 months ago), you could try that... but the current version of wit-bindgen-rt has been in place for a while.</p>



<a name="514426142"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426142" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426142">(Apr 25 2025 at 17:10)</a>:</h4>
<p>I hesitate to think it's code that snuck into the rust toolchain underneath itself, but that's basically going to be what I try next</p>



<a name="514426244"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426244" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426244">(Apr 25 2025 at 17:11)</a>:</h4>
<p>I think it's not wit-bindgen-rt, because in the other project where this surfaced, it's happening in an app where the wit-bindgen-rt version hasn't changed. And it's also 0.39</p>



<a name="514426280"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426280" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426280">(Apr 25 2025 at 17:11)</a>:</h4>
<p>Ah thanks!</p>



<a name="514426297"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426297" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426297">(Apr 25 2025 at 17:11)</a>:</h4>
<p>OK, what about versions of Rust?</p>



<a name="514426305"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426305" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426305">(Apr 25 2025 at 17:11)</a>:</h4>
<p>Is the other project similarly behind on Rust version?</p>



<a name="514426418"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514426418" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514426418">(Apr 25 2025 at 17:12)</a>:</h4>
<p>wouldn't surprised if the other project has an up to date toolchain but just older <code>wit-bindgen-rt</code> dep</p>



<a name="514427070"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514427070" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514427070">(Apr 25 2025 at 17:16)</a>:</h4>
<p>Mike and I are both on the same version of rust:</p>
<p>$ rustc --version<br>
rustc 1.85.1</p>
<p>But... I think it is true to say that that was recently updated. I can't say for certain at the moment if that corresponded with when the error started. But this is something we can check</p>



<a name="514427264"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514427264" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514427264">(Apr 25 2025 at 17:17)</a>:</h4>
<blockquote>
<p>wouldn't surprised if the other project has an up to date toolchain but just older <code>wit-bindgen-rt</code> dep</p>
</blockquote>
<p>Is this a problem? We have a monorepo with lots of apps, each with essentially their own versions of <code>wit-bindgen-rt</code>, and we update the rust toolchain independently (and rarely)</p>



<a name="514429776"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514429776" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514429776">(Apr 25 2025 at 17:31)</a>:</h4>
<p>I just tested one of our apps and got the error in both cases<br>
(both) rustc 1.85.1<br>
first wit-bindgen-rt v0.34.0<br>
second wit-bindgen-rt v0.41.0<br>
So wide range of versions there that don't seem relevant</p>



<a name="514444277"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514444277" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Mart <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514444277">(Apr 25 2025 at 19:01)</a>:</h4>
<p><span class="user-mention" data-user-id="598440">@Victor Adossi</span> </p>
<p>We use containerized development to ensure our environments are the same. Recently, our environment image changed, and it included two changs that are potentially relevant:</p>
<ul>
<li>Rustc went from 1.84.1 =&gt; 1.85.1</li>
<li>cargo-component went from  0.15.0 =&gt; 0.21.1 </li>
</ul>
<p>I was going to try to manually downgrade versions of <code>cargo-component</code>, but it seems that a default <code>cargo-component</code> --lib project at any version prior to <code>0.21.0 --locked</code> cannot build when the rust toolchain is at <code>1.85.1</code>.</p>
<p>So, in the <code>minimal-transpile</code> project, we just dropped the rustc version explicitly to 1.84.1, because that allows us to test prior versions of <code>cargo-component</code>. </p>
<p>Sure enough, with rust toolchain at <code>1.84.1</code> and cargo-component at <code>0.15.0</code>, mike was <strong>unable</strong> to reproduce the error on his aarch64 machine.</p>
<p>Mike is now going to binary search through cargo-component versions until we isolate the one that breaks.</p>



<a name="514446831"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514446831" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514446831">(Apr 25 2025 at 19:18)</a>:</h4>
<p>cargo-component v0.20.0 --&gt; v0.21.0 trips the error</p>



<a name="514477716"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514477716" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514477716">(Apr 25 2025 at 23:44)</a>:</h4>
<p>Thanks for getting to the bottom of this <span class="user-mention" data-user-id="901567">@Mike M</span>  and <span class="user-mention" data-user-id="648387">@James Mart</span> , guess that's where the issue needs to be filed!</p>



<a name="514477789"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514477789" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514477789">(Apr 25 2025 at 23:45)</a>:</h4>
<p>This is excellent, very glad it wasn't the Rust project itself but was instead something else... cargo-component was not the expected problem but definitely a welcome surprise</p>



<a name="514478522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514478522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514478522">(Apr 25 2025 at 23:55)</a>:</h4>
<p>Would you like us to do that Victor? Or do you have a process you want to follow to close and reopen issues and whatnot?</p>



<a name="514478973"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514478973" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514478973">(Apr 26 2025 at 00:01)</a>:</h4>
<p>Oh please go ahead if you'd like! Ya'll did all the work and actually tracked it down</p>



<a name="514479018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514479018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514479018">(Apr 26 2025 at 00:01)</a>:</h4>
<p>At this point you have everything to make a stellar reproduction case for the issue, and what I can do is close out the jco issue in favor of the cargo-component one <em>after</em> you have it, just to ensure it doesn't fall through the cracks</p>



<a name="514479119"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514479119" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514479119">(Apr 26 2025 at 00:02)</a>:</h4>
<p>Sounds good. I'm wrapping up some work now while waiting for a delayed flight. should be able to get that done tonight.</p>



<a name="514479344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514479344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514479344">(Apr 26 2025 at 00:05)</a>:</h4>
<p>No worries, it is friday before the weekend!</p>



<a name="514485979"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514485979" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike M <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514485979">(Apr 26 2025 at 01:33)</a>:</h4>
<p>Ok, new issue is here: <a href="https://github.com/bytecodealliance/cargo-component/issues/398">https://github.com/bytecodealliance/cargo-component/issues/398</a><br>
I've referenced this discussion thread and the jco issue in it.<br>
and closed the jco issue with a link to the new issue.<br>
Finally, I'll start a zulip thread for cargo-component to raise the proper attention.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/cargo-component/issues/398" style="background-image: url(&quot;https://uploads.zulipusercontent.net/884f5b2fd16dd9f814eff98c1f9e95b1654bc61e/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f326165393434653937343763343365616665306532343235383232346438656631353566646364623238616433326433313133303933356264353435306262612f62797465636f6465616c6c69616e63652f636172676f2d636f6d706f6e656e742f6973737565732f333938&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/cargo-component/issues/398" title="Upgrading cargo-component fro v0.20.0 to v0.21.0 leads to adapter/unreachable errors in browser · Issue #398 · bytecodealliance/cargo-component">Upgrading cargo-component fro v0.20.0 to v0.21.0 leads to adapter/unreachable errors in browser · Issue #398 · bytecodealliance/cargo-component</a></div><div class="message_embed_description">Impact It seems this error means that anyone running Apple silicon (M1+ laptops) is currently unable to build/transpile a wasm component and run it in the browser. Brief v0.21.0 introduces issues b...</div></div></div>



<a name="514486903"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Sudden%20transpiled%20wasm%20component%20error%20in%20browser/near/514486903" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Sudden.20transpiled.20wasm.20component.20error.20in.20browser.html#514486903">(Apr 26 2025 at 01:45)</a>:</h4>
<p>Thanks again! <span aria-label="bow" class="emoji emoji-1f647" role="img" title="bow">:bow:</span> I'll maybe add some people</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>