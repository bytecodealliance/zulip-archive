<html>
<head><meta charset="utf-8"><title>Detecting Which Component Called a Host Function Jco 路 jco 路 Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/index.html">jco</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html">Detecting Which Component Called a Host Function Jco</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="566862215"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/566862215" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#566862215">(Jan 08 2026 at 03:51)</a>:</h4>
<p>I'm trying to figure out if in jco-transpile bindings (e.g. preview2-shims or some other custom wit implementation)  there's any kind of state.<br>
In wasmtime bindings, you implement everything as a trait, and the first parameter is always <code>&amp;mut self</code>. You can keep any state inside self. Is there anything like this in Jco?</p>
<p>I'd like to use this in cases where there are multiple wasm components running on the same page, and I wanna customize the behavior according to which component called a function.</p>



<a name="566968078"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/566968078" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#566968078">(Jan 08 2026 at 15:19)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="206238" href="/#narrow/channel/206238-general/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco">#general &gt; Detecting Which Component Called a Host Function Jco</a> by <span class="user-mention silent" data-user-id="253994">Alex Crichton</span>.</p>



<a name="566995684"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/566995684" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ralph <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#566995684">(Jan 08 2026 at 17:23)</a>:</h4>
<p>I can't recall; <span class="user-mention" data-user-id="234973">@Till Schneidereit</span>  should know, or perhaps <span class="user-mention" data-user-id="763150">@Tomasz Andrzejak</span></p>



<a name="567089935"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/567089935" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#567089935">(Jan 09 2026 at 08:18)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="419274">@Mendy Berger</span> could you expand on what you mean here? Do you mean whether <code>preview2-shim</code> depend on any global state <em>outside</em> the module? They are ES modules, so is the question more whether there is any use of <code>globalThis</code>?</p>
<p>Either way, I think a quick way to figure out would be to inspect code from a transpiled component -- it's not too difficult to scan (ignoring any complaints about <em>how</em> the code is written/what code is there, of course!)</p>
<p>With regards to shims, that's entirely up to shims and how you bundle -- in general the shims are also modules, but you could easily write a shim that does depend on global state or one that does not. It also depends on what you're targeting with the shim -- obviously the Node shim versus browser shim (which is pretty incomplete!) must depend on platform primitives, which are globals in a sense... There's no place to pass in a custom implementation of platform primitives like <code>TextEncoder</code> for example, but not sure if that's what you mean by state.</p>
<p>A good place to look might be <a href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/filesystem.js#L722">filesystem implementation from P2-shim</a> -- for example the <code>preopenEntries</code> array is clearly state, but not sure that's what you're referring to.</p>
<p>When you say customize their behavior according to which component called a function, do you mean... when each component calls an import? If that's the case, you should be able to achieve that by wrapping the imports object (or any individual import) with a proxy.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/filesystem.js#L722" style="background-image: url(&quot;https://uploads.zulipusercontent.net/4faf00a6048d320f771d0b4a0077da2c44145407/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f333033373462313535363233323666656430313039316335353831616435316262626137323231313265623035633534613132626337623431313539336631382f62797465636f6465616c6c69616e63652f6a636f&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/jco/blob/main/packages/preview2-shim/lib/nodejs/filesystem.js#L722" title="jco/packages/preview2-shim/lib/nodejs/filesystem.js at main 路 bytecodealliance/jco">jco/packages/preview2-shim/lib/nodejs/filesystem.js at main 路 bytecodealliance/jco</a></div><div class="message_embed_description">JavaScript toolchain for working with WebAssembly Components - bytecodealliance/jco</div></div></div>



<a name="567144958"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/567144958" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendy Berger <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#567144958">(Jan 09 2026 at 13:44)</a>:</h4>
<blockquote>
<p>When you say customize their behavior according to which component called a function, do you mean... when each component calls an import?</p>
</blockquote>
<p>That's pretty much what I'm looking for. <br>
Is there any way I can figure out from inside the function which component called it? <br>
Even with a proxy, how would I know which component called?</p>



<a name="567145395"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/567145395" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#567145395">(Jan 09 2026 at 13:46)</a>:</h4>
<p>I would give each component its own host wrapper that injects the component id, but I haven't used jco in a while so I'm not sure if giving different hosts to instances is hard with the current implementation</p>



<a name="567370960"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/409526-jco/topic/Detecting%20Which%20Component%20Called%20a%20Host%20Function%20Jco/near/567370960" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Victor Adossi <a href="https://bytecodealliance.github.io/zulip-archive/stream/409526-jco/topic/Detecting.20Which.20Component.20Called.20a.20Host.20Function.20Jco.html#567370960">(Jan 11 2026 at 06:33)</a>:</h4>
<p>What Ramon suggested sounds right -- if the function you're calling is an import, then you can give each instantiation wrapper/proxy that identifies the instantiation.</p>
<p>Do you have a quick code snippet of what your instantiation looks like? I think that would help make some of these worries concrete/work through them -- <em>I think</em> you should be good to go by "just" wrapping the imports that components are using (then you would know which component was using that import).</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>