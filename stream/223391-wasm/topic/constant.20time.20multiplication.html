<html>
<head><meta charset="utf-8"><title>constant time multiplication · wasm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/index.html">wasm</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html">constant time multiplication</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="535100199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535100199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535100199">(Aug 19 2025 at 10:42)</a>:</h4>
<p>Similar question to the one Lann raised in <a href="#narrow/channel/223391-wasm/topic/.E2.9C.94.20constant.20time.20equality"><a class="stream-topic" data-stream-id="223391" href="/#narrow/channel/223391-wasm/topic/.E2.9C.94.20constant.20time.20equality/with/516766197">#wasm &gt; ✔ constant time equality</a></a>: do the <a href="https://docs.rs/aes-gcm/latest/aes_gcm/#security-notes">security notes on the aes_gcm crate</a> apply to Wasm such that the implementation can be expected to be constant-time? My reading of the <a href="https://github.com/juliocesarfort/public-pentesting-reports/blob/master/NCCGroup/NCC_Group_MobileCoin_RustCrypto_AESGCM_ChaCha20Poly1305_Implementation_Review_2020-02-12_v1.0.pdf">security audit</a> (the link in the crate docs isn't working anymore) that was done on the implementation in 2019 is that the answer might be yes? <span class="user-mention" data-user-id="254389">@Chris Fallin</span> this seems like a topic you'd have opinions on <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/juliocesarfort/public-pentesting-reports/blob/master/NCCGroup/NCC_Group_MobileCoin_RustCrypto_AESGCM_ChaCha20Poly1305_Implementation_Review_2020-02-12_v1.0.pdf" style="background-image: url(&quot;https://uploads.zulipusercontent.net/929453d145a6db948a661de12a844754563cb091/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f363339313236656334303830653237343562386134663366303236616231653361393164356534633636383933633732636139653564313034626439656537382f6a756c696f6365736172666f72742f7075626c69632d70656e74657374696e672d7265706f727473&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/juliocesarfort/public-pentesting-reports/blob/master/NCCGroup/NCC_Group_MobileCoin_RustCrypto_AESGCM_ChaCha20Poly1305_Implementation_Review_2020-02-12_v1.0.pdf" title="public-pentesting-reports/NCCGroup/NCC_Group_MobileCoin_RustCrypto_AESGCM_ChaCha20Poly1305_Implementation_Review_2020-02-12_v1.0.pdf at master · juliocesarfort/public-pentesting-reports">public-pentesting-reports/NCCGroup/NCC_Group_MobileCoin_RustCrypto_AESGCM_ChaCha20Poly1305_Implementation_Review_2020-02-12_v1.0.pdf at master · juliocesarfort/public-pentesting-reports</a></div><div class="message_embed_description">A list of public penetration test reports published by several consulting firms and academic security groups. - juliocesarfort/public-pentesting-reports</div></div></div>



<a name="535115686"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535115686" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535115686">(Aug 19 2025 at 12:19)</a>:</h4>
<blockquote>
<p>using a portable implementation which is only constant time on processors which implement constant-time multiplication.</p>
</blockquote>
<p>The Wasm spec afaik makes no guarantees but in practice I'd be very surprised if any runtimes themselves triggered data dependent timing for multiplies.</p>



<a name="535171468"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535171468" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535171468">(Aug 19 2025 at 17:06)</a>:</h4>
<p>If we're looking for an auditable chain of specified guarantees, then of course Wasm doesn't give us anything, but as for what to actually expect: for truly data-dependent (i.e., not constant-propagated) ALU operations, we tend to lower them to the equivalent CPU instructions more or less directly, so we "pass through" whatever requirements (downward) or guarantees (upward) re: constant time might apply. This is certainly the case for multiplication -- a plain integer multiply with two non-constant inputs should always lower to a plain integer multiply CPU instruction, so then you'd need to rely on whatever the ISA spec says and/or what the implementation does, depending on what level of guarantee you're looking for.</p>
<p>On Intel and AMD implementations of x86 at least the integer multiplier has a fast fixed-latency pipeline, i.e. latency won't depend on the data. Note this isn't a guarantee but it'd be exceptionally <em>weird</em> for a new high-performance core design to change this.</p>
<p>It'd still be nice to formalize all this with a "constant-time Wasm" spec, but that's a boulder for someone else to roll uphill :-)</p>



<a name="535177914"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535177914" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535177914">(Aug 19 2025 at 17:51)</a>:</h4>
<p>Thank you, that all matches my understanding. I guess basically, "if a security audit says that code is fine when compiled to a mainstream platform via LLVM, then it'll be fine running in wasmtime on the same platform, too"?</p>



<a name="535178262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535178262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535178262">(Aug 19 2025 at 17:54)</a>:</h4>
<p>and yes, constant-time wasm would be awfully nice to have. <span class="user-mention" data-user-id="254083">@Dan Gohman</span> and I talked about this at the CG f2f in Pittsburgh; one key observation is that the ct-wasm proposal does a lot more than what's truly needed in make constant-time-ness a type system concern. To be able to port existing code to target wasm with actual "guarantees" (as far as those go on the target hardware, anyway), we'd only need the actual operations. That seems like it could conceivably be a much smaller lift</p>



<a name="535178946"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535178946" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535178946">(Aug 19 2025 at 17:58)</a>:</h4>
<blockquote>
<p>"if a security audit says that code is fine when compiled to a mainstream platform via LLVM, then it'll be fine running in wasmtime on the same platform, too"?</p>
</blockquote>
<p>Informally and without an official crypto rubber stamp, but "for real people in the real world with real thinking rocks", yep, that sounds right!</p>



<a name="535179046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/223391-wasm/topic/constant%20time%20multiplication/near/535179046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Till Schneidereit <a href="https://bytecodealliance.github.io/zulip-archive/stream/223391-wasm/topic/constant.20time.20multiplication.html#535179046">(Aug 19 2025 at 17:59)</a>:</h4>
<p>oh yeah, I definitely wasn't looking for more than the informal version!</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>