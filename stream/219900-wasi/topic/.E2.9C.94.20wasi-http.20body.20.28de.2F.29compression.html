<html>
<head><meta charset="utf-8"><title>✔ wasi-http body (de/)compression · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.E2.9C.94.20wasi-http.20body.20.28de.2F.29compression.html">✔ wasi-http body (de/)compression</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="562817981"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%E2%9C%94%20wasi-http%20body%20%28de/%29compression/near/562817981" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theodore Brockman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.E2.9C.94.20wasi-http.20body.20.28de.2F.29compression.html#562817981">(Dec 09 2025 at 23:00)</a>:</h4>
<p>! I'm not sure why I assumed <code>Request::consume_body</code> immediately read the body, my apologies <span aria-label="blushing" class="emoji emoji-1f633" role="img" title="blushing">:blushing:</span> </p>
<blockquote>
<p>If we're talking about a custom host embedding of Wasmtime</p>
</blockquote>
<p>This is the case! But I see what you both mean about composition, I'll elect to do that instead</p>



<a name="562818083"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%E2%9C%94%20wasi-http%20body%20%28de/%29compression/near/562818083" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.E2.9C.94.20wasi-http.20body.20.28de.2F.29compression.html#562818083">(Dec 09 2025 at 23:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="937580">Theodore Brockman</span> has marked this topic as resolved.</p>



<a name="562953262"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%E2%9C%94%20wasi-http%20body%20%28de/%29compression/near/562953262" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.E2.9C.94.20wasi-http.20body.20.28de.2F.29compression.html#562953262">(Dec 10 2025 at 13:21)</a>:</h4>
<blockquote>
<p>I'm not sure why I assumed <code>Request::consume_body</code> immediately read the body</p>
</blockquote>
<p>Hmm..."consume" is a little misleading there isn't it?</p>



<a name="563034255"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/%E2%9C%94%20wasi-http%20body%20%28de/%29compression/near/563034255" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theodore Brockman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/.E2.9C.94.20wasi-http.20body.20.28de.2F.29compression.html#563034255">(Dec 10 2025 at 19:30)</a>:</h4>
<blockquote>
<p>Hmm..."consume" is a little misleading there isn't it?</p>
</blockquote>
<p>Oh absolutely, but I also should've known better at this point, I knew it returned a <code>StreamReader</code> -- I think on my first reading I assumed the decoder task executed immediately to completion -- and not that it would block until <code>pipe_rx</code> actually reads the first chunk (I believe this is what I missed? not sure whether executor behavior for <code>wit_bindgen::spawn</code> also comes into play here) -- which is very elegant in how much it accomplishes while remaining so simple.</p>
<p>Until I get better at reading and understanding Rust code I'll probably make a few more mistakes like this though, appreciate the patience <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>