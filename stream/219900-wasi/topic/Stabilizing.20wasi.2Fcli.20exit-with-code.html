<html>
<head><meta charset="utf-8"><title>Stabilizing wasi/cli exit-with-code 路 wasi 路 Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html">Stabilizing wasi/cli exit-with-code</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="534556791"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534556791" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SingleAccretion <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534556791">(Aug 14 2025 at 20:41)</a>:</h4>
<p>A while ago we added cli exit-with-code to the wasi-cli world, but it is still listed as "unstable" in <a href="https://github.com/WebAssembly/wasi-cli/blob/07e4b66066ee7c183b10e8ee696e5aa571e9fbef/wit/exit.wit#L15">https://github.com/WebAssembly/wasi-cli/blob/07e4b66066ee7c183b10e8ee696e5aa571e9fbef/wit/exit.wit#L15</a> so (I presume) we can't really use in e. g. wasi-libc yet. I am wondering what would the process be where the end result is it being usable from libc.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasi-cli/blob/07e4b66066ee7c183b10e8ee696e5aa571e9fbef/wit/exit.wit#L15" style="background-image: url(&quot;https://uploads.zulipusercontent.net/fc000a7c4d55b1cc46d0ebdd015946d398c93ac0/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f386136376461336565316631343233333635323432373730633232616130613235346333663932636165636336336366616431653738363239363661626666302f576562417373656d626c792f776173692d636c69&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasi-cli/blob/07e4b66066ee7c183b10e8ee696e5aa571e9fbef/wit/exit.wit#L15" title="wasi-cli/wit/exit.wit at 07e4b66066ee7c183b10e8ee696e5aa571e9fbef 路 WebAssembly/wasi-cli">wasi-cli/wit/exit.wit at 07e4b66066ee7c183b10e8ee696e5aa571e9fbef 路 WebAssembly/wasi-cli</a></div><div class="message_embed_description">Command-Line Interface (CLI) World for WASI. Contribute to WebAssembly/wasi-cli development by creating an account on GitHub.</div></div></div>



<a name="534557571"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534557571" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534557571">(Aug 14 2025 at 20:47)</a>:</h4>
<p>I think the steps would look more-or-less like:</p>
<ul>
<li>Formally propose in the WASI SG  that this should become a stable API (I'm a bit hazy on this  but if you make a presentation with your case I suspect that's more-or-less sufficient)</li>
<li>Update the WITs</li>
<li>Wait for a WASI release (once every 2 months)</li>
<li>Update Wasmtime with the new WITs plus removal of the feature (e.g. it's always on-by-default now)</li>
</ul>
<p>The next big question is when to update wasi-libc. Unfortunately there's not a great answer there just yet. There's no preexisting policy about which version of the WITs are used to generate bindings in wasi-libc (it's only just now recently getting support for wasip2 natively). Additionally with Wasmtime's p1-to-p2 adapter there's no formal policy yet about what versions of WASI to support.</p>
<p>Basically it's required to get this to a stable API to use, but after that it's not 100% clear when default tooling can use this. If you're interested in pushing this forward I'd recommend starting with a presentation to the WASI SG and then getting it out in Wasmtime, and then after that we can see where we're at and what, if any, policies we need</p>



<a name="534558953"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534558953" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> SingleAccretion <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534558953">(Aug 14 2025 at 20:58)</a>:</h4>
<p>Oh, thank you for such a quick and comprehensive reply :). I'll start working though the steps...</p>



<a name="534559829"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534559829" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534559829">(Aug 14 2025 at 21:05)</a>:</h4>
<p>Regarding which WITs to use for <code>wasi-libc</code>: this is yet another example of where optional imports would be super useful.  <code>wasi-libc</code> could optionally import <code>exit-with-code</code> and fall back to the old <code>exit</code> if needed.</p>



<a name="534563013"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534563013" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534563013">(Aug 14 2025 at 21:28)</a>:</h4>
<p>agreed yeah, although the irony with optional imports is that they're mostly only useful if they were implemented a long time ago, if we were to implement optional imports today it'd still take a long time to percolate to all the runtimes and be usable for wasi-libc (same usability issues as using a newer WASI API on first-time-use)</p>



<a name="534564403"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534564403" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Dice <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534564403">(Aug 14 2025 at 21:41)</a>:</h4>
<p>All the more reason to do it ASAP.</p>



<a name="534565427"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/534565427" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#534565427">(Aug 14 2025 at 21:51)</a>:</h4>
<p>easier said than done :)</p>



<a name="535179984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/Stabilizing%20wasi/cli%20exit-with-code/near/535179984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/Stabilizing.20wasi.2Fcli.20exit-with-code.html#535179984">(Aug 19 2025 at 18:05)</a>:</h4>
<p>On a semi-related note, inspired by this, we had some discussion today about this and I wrote down a plan: <a class="message-link" href="/#narrow/channel/223391-wasm/topic/Optional.20imports.20in.20the.20component.20model/near/535179924">#wasm &gt; Optional imports in the component model @ </a></p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>