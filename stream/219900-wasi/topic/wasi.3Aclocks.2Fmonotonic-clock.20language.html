<html>
<head><meta charset="utf-8"><title>wasi:clocks/monotonic-clock language · wasi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html">wasi:clocks/monotonic-clock language</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="536179909"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536179909" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Wingo <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536179909">(Aug 26 2025 at 07:59)</a>:</h4>
<p>The monotonic clock interface has this language:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">/// A monotonic clock is a clock which has an unspecified initial value, and</span>
</code></pre></div>
<p>OK, sure.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">/// successive reads of the clock will produce non-decreasing values.</span>
</code></pre></div>
<p>Is this right <span class="user-mention" data-user-id="254083">@Dan Gohman</span> ? <code>now()</code> might overflow and wrap, which could be interpreted as "decreasing".</p>



<a name="536182943"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536182943" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Wingo <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536182943">(Aug 26 2025 at 08:17)</a>:</h4>
<p>I think in wasip3 tests I will hard-code a "maximum reasonable duration" of, like, a day, and fail the test if a computed difference between two <code>Instant</code>s is more than a day, under the theory that it's more likely to be a bug than a technically-possible outcome.</p>



<a name="536227536"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536227536" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Wingo <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536227536">(Aug 26 2025 at 12:39)</a>:</h4>
<p>relatedly, <code>wait_until</code> has to bake in some assumption about wraparound, otherwise <code>wait_until()</code> when invoked on a <code>now()</code> that already passed would never wake</p>



<a name="536229114"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536229114" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andy Wingo <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536229114">(Aug 26 2025 at 12:48)</a>:</h4>
<p>related: <a href="https://github.com/WebAssembly/wasi-testsuite/pull/120#pullrequestreview-3155404792">https://github.com/WebAssembly/wasi-testsuite/pull/120#pullrequestreview-3155404792</a> cc <span class="user-mention" data-user-id="484032">@Roman Volosatovs</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasi-testsuite/pull/120#pullrequestreview-3155404792" style="background-image: url(&quot;https://uploads.zulipusercontent.net/a86552be606179368dec2f5d9a51ae0043a57301/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f613334353637643662613337393235366632396561633936346433363635393561623534653938343839663938323066356533366632366265663766353536622f576562417373656d626c792f776173692d7465737473756974652f70756c6c2f313230&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasi-testsuite/pull/120#pullrequestreview-3155404792" title="First wasip3 test by wingo · Pull Request #120 · WebAssembly/wasi-testsuite">First wasip3 test by wingo · Pull Request #120 · WebAssembly/wasi-testsuite</a></div><div class="message_embed_description">Depends on #114.  Adds wasm32-wasip3 Rust test directory, with a first Rust-based test.  Test runner not yet updated; requires passing Wcomponent-model-async=y -Sp3=y to wasmtime.  Building the was...</div></div></div>



<a name="536257731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536257731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536257731">(Aug 26 2025 at 15:03)</a>:</h4>
<p>POSIX seems to be similarly ambiguous about monotonic clock overflow.</p>
<p>I see two reasonable options:</p>
<ul>
<li>It just "can't overflow"; I guess an implementation would trap rather than returning an overflowed value</li>
<li>Carefully define wrapping; this seems somewhat difficult to spec and implement given the other (non-)constraints on monotonic clock values</li>
</ul>



<a name="536265970"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536265970" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536265970">(Aug 26 2025 at 15:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="396878">Andy Wingo</span> <a href="#narrow/channel/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language/near/536179909">said</a>:</p>
<blockquote>
<p>The monotonic clock interface has this language:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">/// A monotonic clock is a clock which has an unspecified initial value, and</span>
</code></pre></div>
<p>OK, sure.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="sd">/// successive reads of the clock will produce non-decreasing values.</span>
</code></pre></div>
<p>Is this right <span class="user-mention silent" data-user-id="254083">Dan Gohman</span> ? <code>now()</code> might overflow and wrap, which could be interpreted as "decreasing".</p>
</blockquote>
<p>The monotonic clock returns a <code>u64</code> of nanoseconds, so the intention here is that the host should trap if it's somehow live for the 584 or so years it would take to achieve a wraparound, so that users of the API never have to deal with this extremely rare and extremely awkward corner case.</p>
<p>We should document that more explicitly.</p>



<a name="536276209"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536276209" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536276209">(Aug 26 2025 at 16:38)</a>:</h4>
<p>I've now filed <a href="https://github.com/WebAssembly/wasi-clocks/pull/96">https://github.com/WebAssembly/wasi-clocks/pull/96</a> to propose wording for this.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/wasi-clocks/pull/96" style="background-image: url(&quot;https://uploads.zulipusercontent.net/32260e3111f433a0303fa9551e6f6c53201f53f5/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f353666303561633332303564313165646664393261613738633639666562333265663836663131326130396362396231313936336632616637393733636134612f576562417373656d626c792f776173692d636c6f636b732f70756c6c2f3936&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/wasi-clocks/pull/96" title="Document that `monotonic-clock.now` doesn't wrap. by sunfishcode · Pull Request #96 · WebAssembly/wasi-clocks">Document that `monotonic-clock.now` doesn't wrap. by sunfishcode · Pull Request #96 · WebAssembly/wasi-clocks</a></div><div class="message_embed_description">584 years ought to be enough for anyone.</div></div></div>



<a name="536297238"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536297238" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Lloyd <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536297238">(Aug 26 2025 at 19:08)</a>:</h4>
<p>if the start value is unspecified, then overflow could happen at <em>any</em> time</p>



<a name="536297362"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536297362" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Lloyd <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536297362">(Aug 26 2025 at 19:09)</a>:</h4>
<p>the start value could be ((2 ** 64) - 1) - (the number of nanoseconds before your lunch break)</p>



<a name="536299691"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536299691" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536299691">(Aug 26 2025 at 19:29)</a>:</h4>
<p>And then the spec says it would have to trap, and then everyone would stop using that implementation <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="536300495"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536300495" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536300495">(Aug 26 2025 at 19:35)</a>:</h4>
<p>Pragmatically, <code>wasi-libc</code> needs to be able to implement <code>clock_gettime(CLOCK_MONOTONIC, ...)</code>, and hosts will typically be using those same semantics in the implementation.</p>



<a name="536301131"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536301131" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536301131">(Aug 26 2025 at 19:39)</a>:</h4>
<p>too bad this wasn't spec'd as a u128 nanos (or u64 seconds + u64 nanos), else we could implement the trap as "rely on the heat death of the universe"</p>



<a name="536301235"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536301235" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536301235">(Aug 26 2025 at 19:40)</a>:</h4>
<p>(a subtype of "unobservable trap because the host no longer exists", which can thus be optimized away, I suppose)</p>



<a name="536301311"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536301311" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536301311">(Aug 26 2025 at 19:40)</a>:</h4>
<p>Sounds like a universally applicable optimization</p>



<a name="536302069"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536302069" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536302069">(Aug 26 2025 at 19:44)</a>:</h4>
<p>ok so it's UB to not make forward progress in C (infinite loops are UB), but if eventually no one can observe the forward progress that means all our programs are already UB -- about to go make the fastest compiler ever</p>



<a name="536302554"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536302554" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536302554">(Aug 26 2025 at 19:48)</a>:</h4>
<p>(I could have sworn I've seen a joke post somewhere that riffs on basically that: C somehow technically admits a compiler that produces zero-byte executables for all programs as standards-compliant. some lesson about spec'ing the right thing here...)</p>



<a name="536309104"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536309104" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536309104">(Aug 26 2025 at 20:40)</a>:</h4>
<p>For what it's worth, the "wall" clock does use a seconds+nanos time, so it can represent astronomical-scale times. It's just the monotonic clock, which is meant for timing durations that is limited to a <code>u64</code>.</p>



<a name="536316751"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536316751" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536316751">(Aug 26 2025 at 21:45)</a>:</h4>
<p>If it wasn't for the compatibility and bookkeeping overhead problems I might suggest that <code>instant</code> should be a resource with methods like <code>elapsed: func() -&gt; duration</code> and <code>since(other: instant) -&gt; duration</code> and no integer repr</p>



<a name="536316916"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536316916" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536316916">(Aug 26 2025 at 21:47)</a>:</h4>
<p>If someone can describe a use case that absolutely needs a single instance to live more than 10 years, convincingly, with a straight face, then maybe it would make sense to consider.</p>



<a name="536317505"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536317505" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536317505">(Aug 26 2025 at 21:54)</a>:</h4>
<p>If you had a runtime that could "suspend"/snapshot instances to disk and resume them later it's at least plausible that an instance could experience years of actual run time, even if the clock also suspends (like CLOCK_MONOTONIC)</p>



<a name="536317630"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536317630" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536317630">(Aug 26 2025 at 21:55)</a>:</h4>
<p>I think it would be something "exotic" (by current standards) like that rather than a host actually having a live instance for that long</p>



<a name="536317975"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536317975" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536317975">(Aug 26 2025 at 21:59)</a>:</h4>
<p>I guess the most plausible use case would be a test harness that implements "time travel" to exercise date calculations or whatever</p>



<a name="536318272"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536318272" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536318272">(Aug 26 2025 at 22:01)</a>:</h4>
<p>I suppose <code>now</code> could just be <code>-&gt; result&lt;instant&gt;</code> instead of trapping?</p>



<a name="536318594"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536318594" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536318594">(Aug 26 2025 at 22:05)</a>:</h4>
<p>To be clear, I do think it's plausible that someone could do this some day. But I think it's worthwhile to have an actual use case at hand rather than trying to guess.</p>



<a name="536318661"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536318661" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536318661">(Aug 26 2025 at 22:06)</a>:</h4>
<p>In most use cases I can imagine, one would still want the ability to cope with rare-but-not-never traps. If you have any data that you really really care about, the best place for it to live is usually in a database, not a suuuuper-long-lived Wasm instance.</p>



<a name="536319287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536319287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Gohman <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536319287">(Aug 26 2025 at 22:12)</a>:</h4>
<p>If we had a use case, then we could meaningfully answer the question of whether <code>-&gt; result&lt;instant&gt;</code> would be good enough. If a single instance lives that long, is it ok if monotonic timers just start failing part-way through its lifetime? If not, then perhaps we really do need the version that works on handles.</p>



<a name="536319754"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536319754" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536319754">(Aug 26 2025 at 22:17)</a>:</h4>
<p>I also think that <code>monotonic-clock</code> falls closer to the "compatibility" end of the spectrum along with e.g. <code>udp-socket</code> than the "model the spec" end like <code>http</code>. If you need time-traveling components maybe you don't use wasi-libc.</p>



<a name="536320030"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536320030" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536320030">(Aug 26 2025 at 22:21)</a>:</h4>
<p>A similarly-pragmatic example is <code>random/random</code> which clearly expects to be running only in certain kinds of environments where you always have access to endless entropy.</p>



<a name="536323641"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536323641" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536323641">(Aug 26 2025 at 22:57)</a>:</h4>
<p>every interface is imperfect, but some interfaces are useful. <code>now: fn() -&gt; result&lt;instant&gt;</code> is not useful because for every not-extremely-exotic program in existence, the only sensible thing to do when you get an error is to trap, because theres no way to continue executing once the monotonic clock stopped working.</p>



<a name="536323910"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536323910" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pat Hickey <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536323910">(Aug 26 2025 at 23:00)</a>:</h4>
<p>plenty of programs that wont use libc will use the monotonic-clock interface, for instance wstd uses it directly without going through wasi-libc. but i dont think a single user writing wasi programs today would be served by us imagining some extremely exotic user that might exist tomorrow and creating an overwrought clocks interface in anticipation. lets save our energy for all the other promises we made that we havent delivered yet</p>



<a name="536427411"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/wasi%3Aclocks/monotonic-clock%20language/near/536427411" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lann Martin <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/wasi.3Aclocks.2Fmonotonic-clock.20language.html#536427411">(Aug 27 2025 at 14:00)</a>:</h4>
<p>To clarify: I agree that this doesn't need to change. The speculation above is just feeling out the design tradeoffs in the context of a real need to clarify the interface docs.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>