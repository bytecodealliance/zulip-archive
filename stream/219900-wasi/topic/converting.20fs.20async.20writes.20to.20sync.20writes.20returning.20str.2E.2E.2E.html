<html>
<head><meta charset="utf-8"><title>converting fs async writes to sync writes returning str... 路 wasi 路 Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/index.html">wasi</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html">converting fs async writes to sync writes returning str...</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="567624752"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567624752" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567624752">(Jan 12 2026 at 19:20)</a>:</h4>
<p>One thing that feels off to me about this change is that it would imply to never mix <code>async</code> and <code>stream</code>s in the same function signature. Which might be totally fine, but still.. <span aria-label="man shrugging" class="emoji emoji-1f937-200d-2642" role="img" title="man shrugging">:man_shrugging:</span></p>



<a name="567626847"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567626847" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567626847">(Jan 12 2026 at 19:31)</a>:</h4>
<p>Agreed yeah, and it also makes me wonder if we should avoid using <code>async</code> in WASI, which feels a bit weird</p>



<a name="567626866"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567626866" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567626866">(Jan 12 2026 at 19:31)</a>:</h4>
<p>or rather, feels like a weird conclusion</p>



<a name="567630801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567630801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567630801">(Jan 12 2026 at 19:52)</a>:</h4>
<p>I think perhaps the general guideline here is: avoid <code>async</code> on resource methods that wait to process an entire stream since that prevents forward-and-forget use cases.  For non-stream-taking functions or scenarios where forward-and-forget isn't desirable (where the stream would be a "child" of the resource and so you're not going to drop/transfer the resource until you're done with it), <code>async</code> is fine.</p>



<a name="567631320"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631320" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631320">(Jan 12 2026 at 19:55)</a>:</h4>
<blockquote>
<p>scenarios where forward-and-forget isn't desirable (..) <code>async</code> is fine.</p>
</blockquote>
<p>that'd still be unrepresentable in Rust (safely)</p>



<a name="567631440"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631440" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631440">(Jan 12 2026 at 19:55)</a>:</h4>
<p>what about, for example, <a href="https://github.com/WebAssembly/WASI/blob/7e643518a4bf9767ca799d7aa776c560a2fc0351/proposals/cli/wit-0.3.0-draft/stdio.wit#L48">write-via-stream</a>?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/WebAssembly/WASI/blob/7e643518a4bf9767ca799d7aa776c560a2fc0351/proposals/cli/wit-0.3.0-draft/stdio.wit#L48" style="background-image: url(&quot;https://uploads.zulipusercontent.net/f567583c630c2055e56ffba254c6d3cfa4faae6e/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643432623862353564623066306566333034363039653435373830346136343338376137356265353230643636376331306336633832333066633962636138612f576562417373656d626c792f57415349&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/WebAssembly/WASI/blob/7e643518a4bf9767ca799d7aa776c560a2fc0351/proposals/cli/wit-0.3.0-draft/stdio.wit#L48" title="WASI/proposals/cli/wit-0.3.0-draft/stdio.wit at 7e643518a4bf9767ca799d7aa776c560a2fc0351 路 WebAssembly/WASI">WASI/proposals/cli/wit-0.3.0-draft/stdio.wit at 7e643518a4bf9767ca799d7aa776c560a2fc0351 路 WebAssembly/WASI</a></div><div class="message_embed_description">WebAssembly System Interface. Contribute to WebAssembly/WASI development by creating an account on GitHub.</div></div></div>



<a name="567631522"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631522" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631522">(Jan 12 2026 at 19:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="889128">Ludea</span> has marked this topic as resolved.</p>



<a name="567631694"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631694" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631694">(Jan 12 2026 at 19:57)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> I think it is in the "fine" category b/c there isn't a resource involved (that you might want to drop/transfer)</p>



<a name="567631784"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631784" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631784">(Jan 12 2026 at 19:57)</a>:</h4>
<p>Technically though it still doesn't allow forward-and-forget, right?</p>



<a name="567631801"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631801" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631801">(Jan 12 2026 at 19:58)</a>:</h4>
<p>because the component always has to be in the middle?</p>



<a name="567631837"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631837" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631837">(Jan 12 2026 at 19:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> has marked this topic as unresolved.</p>



<a name="567631849"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631849" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631849">(Jan 12 2026 at 19:58)</a>:</h4>
<p>(I think the resolution was accidental)</p>



<a name="567631998"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567631998" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567631998">(Jan 12 2026 at 19:59)</a>:</h4>
<p>Hmm, maybe I'm confused.  I thought the thing we're "forgeting" is the resource whose method is borrowing the resource for the duration of the async call?</p>



<a name="567632158"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567632158" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567632158">(Jan 12 2026 at 20:00)</a>:</h4>
<p>Oh, true! I was referring additionally to the component iteslf (I think I crossed some wires here), but the component has to stay alive for <code>async</code> functions where for a sync function you could get your component out of the way entirely</p>



<a name="567632190"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567632190" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567632190">(Jan 12 2026 at 20:00)</a>:</h4>
<p>whether that matters, however, is probably to a much lesser degree</p>



<a name="567632199"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567632199" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567632199">(Jan 12 2026 at 20:00)</a>:</h4>
<p>(More specifically, "forget" means "drop the resource or transfer to another component (which might drop it immediately, you don't know)".)</p>



<a name="567633330"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567633330" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567633330">(Jan 12 2026 at 20:05)</a>:</h4>
<p>FWIW, in a future with runtime-instantiation (where this does come up again), "resource-ifying" a component will "resource-ify" the <code>interface</code>s exported by the component, turning free functions into methods of the instance-resource.  But in this case, I think we actually need the "child" semantics because if the component-instance gets destroyed, it'll delete the actual implementation of the stream consumer (e.g., its linear memory state), so we can't be firing-and-forgetting.</p>



<a name="567634093"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567634093" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567634093">(Jan 12 2026 at 20:09)</a>:</h4>
<p>depends on the implementation(?). If it uses reference counting, the component instance can stay until all its resources have been dropped</p>



<a name="567634492"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567634492" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567634492">(Jan 12 2026 at 20:11)</a>:</h4>
<p>the WASI 0.3 interfaces have moved away from parent-&gt;child resource traps</p>



<a name="567634533"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567634533" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567634533">(Jan 12 2026 at 20:11)</a>:</h4>
<p>Good point!  This depends on how things get specified, but I was thinking that <code>resource.drop</code> would synchronously destroy the component instance (so that way resources are freed when you think they are (and if they can't, b/c you have "dangling" handles, you trap).  Anyhow, farther future topic</p>



<a name="567634752"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567634752" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luke Wagner <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567634752">(Jan 12 2026 at 20:12)</a>:</h4>
<blockquote>
<p>the WASI 0.3 interfaces have moved away from parent-&gt;child resource traps</p>
</blockquote>
<p>True, but that's due to the lack of a <code>child</code> annotation in WIT that allows bindings generators (specifically of GC languages) to do the thing they need to do to avoid the trap.</p>



<a name="567643350"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567643350" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567643350">(Jan 12 2026 at 21:06)</a>:</h4>
<p>There is a somewhat orthogonal vector to all of this where what <span class="user-mention" data-user-id="378155">@Dave Bakker (badeend)</span> you're doing is not pleasant with the default Rust bindings, so e.g. ergonomically we could in theory try to improve things without actually changing WITs</p>



<a name="567643449"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567643449" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567643449">(Jan 12 2026 at 21:06)</a>:</h4>
<p>one example is that changing <code>write-via-stream</code>, which doesn't have resources involved, would actually probably be nice from a rust ergonomics perspective where it's easier to deal with concrete types rather than futures</p>



<a name="567643506"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567643506" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567643506">(Jan 12 2026 at 21:06)</a>:</h4>
<p>but I wouldn't want rust ergonomics alone to guide decisions of API design in WASI of course</p>



<a name="567644702"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567644702" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567644702">(Jan 12 2026 at 21:14)</a>:</h4>
<p>A concrete type instead of <code>impl Future</code> could help with ergonomics and is indeed a Rust-specific thing.<br>
The issue at hand is about lifetimes though, and those are a consequence of the WIT signature.<br>
Unless I'm misunderstanding what you're suggesting</p>



<a name="567645001"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567645001" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567645001">(Jan 12 2026 at 21:17)</a>:</h4>
<p>oh sorry, I'm apparently a bit scatterbrained. I'm assuming, yes, we'll remove <code>async</code> from resource methods in WASI resources, and a general WASI principle will be no <code>async</code> methods without a good reason. That leaves <code>write-via-stream</code> for stdio, however, which is still <code>async</code>. Using that in the Rust standard library is probably going to be easier if it returned a WIT future as opposed to a Rust <code>impl Future</code>. </p>
<p>Although that being said libstd is probably going to use stdio through libc, so you can probably just ignore my musing</p>



<a name="567645711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567645711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567645711">(Jan 12 2026 at 21:23)</a>:</h4>
<p>FWIW, my PR turns <code>write-via-stream</code> non-async as well.<br>
But I've lost track in this chat whether the consensus is if that is a good thing or a bad thing</p>



<a name="567645776"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567645776" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567645776">(Jan 12 2026 at 21:23)</a>:</h4>
<p>I believe consensus is: it's not necessary, but for rust ergonomics it may be nice</p>



<a name="567645812"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567645812" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567645812">(Jan 12 2026 at 21:23)</a>:</h4>
<p>but this logic applies to all <code>async</code> functions everywhere, so I'm not sure if we should follow through with that</p>



<a name="567645926"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567645926" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567645926">(Jan 12 2026 at 21:24)</a>:</h4>
<p>Also, to provide an entire counterpoint to this, it's kind of nice that the component model guarantees you can't close the resource while there's an active async method running on it. That way implementations don't have to handle the question of "someone called write, then closed the resource, what do I do?"</p>



<a name="567646658"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567646658" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dave Bakker (badeend) <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567646658">(Jan 12 2026 at 21:29)</a>:</h4>
<p>Agree. Although that doesn't extrapolate to the read side, where the stream is returned opposed to consumed</p>



<a name="567646726"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567646726" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567646726">(Jan 12 2026 at 21:29)</a>:</h4>
<p>good point yeah</p>



<a name="567646809"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/219900-wasi/topic/converting%20fs%20async%20writes%20to%20sync%20writes%20returning%20str.../near/567646809" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/219900-wasi/topic/converting.20fs.20async.20writes.20to.20sync.20writes.20returning.20str.2E.2E.2E.html#567646809">(Jan 12 2026 at 21:30)</a>:</h4>
<p>changing all resource methods to not be <code>async</code> I believe would require updating quite a lot of <code>wasi:filesystem/types.descriptor</code> functions too, but I'm also less sure that's a good idea</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>