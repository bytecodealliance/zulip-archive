<html>
<head><meta charset="utf-8"><title>Capturing flat ABI representations for interface types · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Capturing.20flat.20ABI.20representations.20for.20interface.20types.html">Capturing flat ABI representations for interface types</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="543331046"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Capturing%20flat%20ABI%20representations%20for%20interface%20types/near/543331046" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Capturing.20flat.20ABI.20representations.20for.20interface.20types.html#543331046">(Oct 06 2025 at 14:27)</a>:</h4>
<p>I think this might be something that's more appropriate to calculate on-the-fly rather than to retain in memory -- I suspect it'd be relatively heavyweight to keep in memory while returning an <code>impl Iterator</code> or similar may not be too hard</p>



<a name="543452984"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Capturing%20flat%20ABI%20representations%20for%20interface%20types/near/543452984" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Arjun Ramesh <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Capturing.20flat.20ABI.20representations.20for.20interface.20types.html#543452984">(Oct 07 2025 at 06:33)</a>:</h4>
<p>That's true, It could be heavyweight for large records, but there's a tradeoff there for RR to minimize performance overheads. Fully reconstructing the flat ABI for types may be expensive, and they are already being parsed once at the very beginning. </p>
<p>Maybe the right approach then is to compute and cache the splits on-the-fly. The overarching issue though is that the flat ABI isn't really formalized anywhere besides the actual lowering implementation. There needs to be a way to keep this computation consistent with any changes made to the lowering implementations. Would we just make a comment there?</p>



<a name="543545931"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Capturing%20flat%20ABI%20representations%20for%20interface%20types/near/543545931" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Capturing.20flat.20ABI.20representations.20for.20interface.20types.html#543545931">(Oct 07 2025 at 14:24)</a>:</h4>
<p>Oh I wouldn't worry much about the cost here, the flat representation is &lt;= 16 types and walking a type tree to produce 16 things should always be quite fast. I would imagine that there's some sort of helper method internally which can be called between the various locations so we'd only implement that once and share it amongst the various callers</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>