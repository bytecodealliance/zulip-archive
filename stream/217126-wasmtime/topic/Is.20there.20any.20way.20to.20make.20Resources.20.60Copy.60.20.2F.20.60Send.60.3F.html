<html>
<head><meta charset="utf-8"><title>Is there any way to make Resources `Copy` / `Send`? · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html">Is there any way to make Resources `Copy` / `Send`?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="534827325"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/534827325" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#534827325">(Aug 17 2025 at 14:34)</a>:</h4>
<p>Hey all, I'm trying my hand at trying to build a wasmtime host that allows a guest to be able to specify a GUI. Yet I'm having a heck of a time trying to get this to work with wasmtime.</p>
<p>One of the thing I'm running into is things (in particular: Resources, tables) needing to be <code>Send</code> / <code>Sync</code> to be able to use them with various GUI crates. And in working on this, I realized: It'd make my life a lot easier if resources were <code>Copy</code> -- that way I could just copy and move resources into closures as needed.</p>
<p>Is there any reason why this is not currently possible with wasmtime? Resources are basically just handles (indices) into a table, right? Shouldn't they be <code>Copy</code>?</p>
<p>I'm not sure if that would solve all my issues of trying to get this to work completely, but I think it'd help.</p>
<p>Another issue I'm running into is to be able to resolve resources within <code>Send</code> / <code>Sync</code> closures, I want to be able to wrap my <code>ResourceTable</code> in <code>Arc&lt;Mutex&lt;&gt;&gt;</code> -- yet as far as I can tell it's not really possible to have a <code>Arc&lt;Mutex&lt;ResourceTable&gt;&gt;</code> field in my state struct due to traits I have to implement like <code>IoView</code>.</p>



<a name="534828971"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/534828971" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christof Petig <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#534828971">(Aug 17 2025 at 15:08)</a>:</h4>
<p>A handle requires reference counting of the object, so, like Arc, it can't be Copy. Up to now there is no common convention on how to name a clone method, but I am quite sure Clone would be the way to go.</p>



<a name="534971016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/534971016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#534971016">(Aug 18 2025 at 15:05)</a>:</h4>
<p>I think it'd be reasonable to add <code>Copy</code> yeah, would you be up for sending a PR? I've historically meant to do this myself but never got around to it alas.</p>



<a name="534971102"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/534971102" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#534971102">(Aug 18 2025 at 15:05)</a>:</h4>
<p>Otherwise for your table-sharing case, you can use two resource tables -- one for WASI and one for your embedding, that way the WASI one wouldn't be behind a mutex but yours would be</p>



<a name="534971204"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/534971204" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#534971204">(Aug 18 2025 at 15:06)</a>:</h4>
<p>Oh and I'm assuming you mean <code>Copy for Resource&lt;T&gt;</code> in the Wasmtime API, if it's something else though I may be misunderstanding</p>



<a name="535009711"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/535009711" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christof Petig <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#535009711">(Aug 18 2025 at 19:29)</a>:</h4>
<p>I am still surprised that Copy is an option because each <code>Resource&lt;T&gt;</code> copy would call <code>[resource-drop]T</code> on the same ID, but that would surely confuse the resource table handling.</p>
<p>Thus I assumed the only option would be to call a <code>[method]T.clone</code> into the resource implementation which would return a new object with a new ID.</p>



<a name="535009921"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/535009921" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christof Petig <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#535009921">(Aug 18 2025 at 19:30)</a>:</h4>
<p>(oh, I misread, this is obviously about the host side)</p>



<a name="535810669"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Is%20there%20any%20way%20to%20make%20Resources%20%60Copy%60%20/%20%60Send%60%3F/near/535810669" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F.html#535810669">(Aug 23 2025 at 14:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/channel/217126-wasmtime/topic/Is.20there.20any.20way.20to.20make.20Resources.20.60Copy.60.20.2F.20.60Send.60.3F/near/534971016">said</a>:</p>
<blockquote>
<p>I think it'd be reasonable to add <code>Copy</code> yeah, would you be up for sending a PR? I've historically meant to do this myself but never got around to it alas.</p>
</blockquote>
<p>Hey, sorry for the delay. Yeah, I'd be up for submitting a PR. I think <code>Clone</code> would work just fine as well if that's necessary for reference counting.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>