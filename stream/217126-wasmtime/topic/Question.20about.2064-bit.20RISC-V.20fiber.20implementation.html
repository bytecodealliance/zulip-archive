<html>
<head><meta charset="utf-8"><title>Question about 64-bit RISC-V fiber implementation · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html">Question about 64-bit RISC-V fiber implementation</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="571086496"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571086496" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max D. <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571086496">(Jan 30 2026 at 17:29)</a>:</h4>
<p>While working on a fiber implementation for 32-bit RISC-V, we noticed that the <a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/fiber/src/stackswitch/riscv64.rs">implementation for 64-bit RISC-V</a> uses instructions specific to the F extension, which includes additional registers for floating point values, regardless whether the CPU has the extension or not.</p>
<p>When using an analogous implementation for a 32-bit RISC-V processor without the F extension, execution stops at the first F-specific instruction without an error (we assume a trap handler is activated). We do not have a 64-bit RISC-V chip without the F-extension to test this with, but we assume it would show the same behaviour.</p>
<p>For our implementation for 32-bit RISC-V, we plan on solving this by checking for the <code>target_feature</code> in addition to the <code>target_arch</code> and only select the implementation if both match the implementation (see the version of <a href="http://stackswitch.rs">stackswitch.rs</a> in <a href="https://github.com/COLORADIO-Project/wasmtime/commit/170042df9834eabb5365d3411e821239c5ce8e5f">our fork</a>).</p>
<p>We're wondering whether the 64-bit RISC-V implementation being used regardless of the F extension being present on the target CPU actually is a bug or is there something we're missing/misunderstanding?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/fiber/src/stackswitch/riscv64.rs" style="background-image: url(&quot;https://uploads.zulipusercontent.net/5ad98427f169338af92e8e5daa989e36ca88f70b/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f353033653039373539383334363562646435346139636361346236333832356232373730373264656138313638366562326362393430613632333734373664662f62797465636f6465616c6c69616e63652f7761736d74696d65&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/blob/main/crates/fiber/src/stackswitch/riscv64.rs" title="wasmtime/crates/fiber/src/stackswitch/riscv64.rs at main · bytecodealliance/wasmtime">wasmtime/crates/fiber/src/stackswitch/riscv64.rs at main · bytecodealliance/wasmtime</a></div><div class="message_embed_description">A lightweight WebAssembly runtime that is fast, secure, and standards-compliant - bytecodealliance/wasmtime</div></div></div><div class="message_embed"><a class="message_embed_image" href="https://github.com/COLORADIO-Project/wasmtime/commit/170042df9834eabb5365d3411e821239c5ce8e5f" style="background-image: url(&quot;https://uploads.zulipusercontent.net/a2c8fcac38008d503c14acc5aec3ef9820259181/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f656539346532363938376165323734626535646434613563323337383164353338356334363664653430373835336366613635646632323465336232373661662f434f4c4f524144494f2d50726f6a6563742f7761736d74696d652f636f6d6d69742f31373030343264663938333465616262353336356433343131653832313233396335636538653566&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/COLORADIO-Project/wasmtime/commit/170042df9834eabb5365d3411e821239c5ce8e5f" title="Added fiber implementation for riscv32 · COLORADIO-Project/wasmtime@170042d">Added fiber implementation for riscv32 · COLORADIO-Project/wasmtime@170042d</a></div><div class="message_embed_description">A lightweight WebAssembly runtime that is fast, secure, and standards-compliant - Added fiber implementation for riscv32 · COLORADIO-Project/wasmtime@170042d</div></div></div>



<a name="571087731"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571087731" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571087731">(Jan 30 2026 at 17:35)</a>:</h4>
<p>The riscv64 port targets riscv64gc, which includes F (and D); these are required for the code that we generate on that platform</p>



<a name="571087796"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571087796" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571087796">(Jan 30 2026 at 17:35)</a>:</h4>
<p>(and the code that rustc will compile since we build with <code>riscv64gc-unknown-linux-gnu</code>)</p>



<a name="571087996"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571087996" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571087996">(Jan 30 2026 at 17:36)</a>:</h4>
<p>You'll need to either do some sort of dynamic feature detection if you want to work on riscv32imac (for example), or build fully for an FPU-free environment</p>



<a name="571510490"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571510490" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571510490">(Feb 02 2026 at 19:35)</a>:</h4>
<p>Rustc only has a baremetal riscv64imac target (Linux requires full gc support and other OSes probably do too). For baremetal targets wasmtime doesn't use fibers at all.</p>



<a name="571513344"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571513344" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Antoine Lavandier <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571513344">(Feb 02 2026 at 19:52)</a>:</h4>
<p>It's perhaps not intended but fibers (as in wasmtime-fiber and the <code>async</code> feature of wasmtime) do work on baremetal ARM Thumbv7/Thumbv8 targets</p>



<a name="571514016"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571514016" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571514016">(Feb 02 2026 at 19:57)</a>:</h4>
<p>indeed, fibers do work in a <code>no_std</code> build and that's intended -- I added that a bit ago for our <code>no_std</code> x86-64 embedding</p>



<a name="571717569"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571717569" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max D. <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571717569">(Feb 03 2026 at 17:08)</a>:</h4>
<p>Thanks for the clarifications!</p>
<p>Quick sanity check about your messages, <span class="user-mention" data-user-id="254389">@Chris Fallin</span>:<br>
So there does not need to be a check for the features in <code>stackswitch.rs</code> because wasmtime only supports riscv64gc.<br>
For the riscv32 implementation, this means we also only need to check for the riscv32 architecture, because only riscv32imac is supported by wasmtime.</p>
<p>Do we understand your comments correctly?</p>



<a name="571718647"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571718647" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571718647">(Feb 03 2026 at 17:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="1015286">Max D.</span> <a href="#narrow/channel/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation/near/571717569">said</a>:</p>
<blockquote>
<p>For the riscv32 implementation, this means we also only need to check for the riscv32 architecture, because only riscv32imac is supported by wasmtime.</p>
</blockquote>
<p>Well, no, not quite; I never said that Wasmtime supports only <code>riscv32imac</code>. In fact (with Pulley) it should run fine (without async/fibers) on all sorts of riscv32 platforms, whatever is supported by rustc.</p>
<p>I would expect that we'd need some sort of feature detection to select between different fiber-switching assembly sequences for different variants...</p>



<a name="571726185"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571726185" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max D. <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571726185">(Feb 03 2026 at 17:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="254389">Chris Fallin</span> <a href="#narrow/channel/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation/near/571718647">said</a>:</p>
<blockquote>
<p>I never said that Wasmtime supports only <code>riscv32imac</code>.</p>
</blockquote>
<p>Oh, sorry, we got that from the <a href="https://docs.wasmtime.dev/stability-tiers.html#tiers-of-support-in-wasmtime">documentation</a>, which we forgot to link. Our implementation only uses instructions from <code>riscv32i</code>, so it should work for any architecture without additional registers, which to our knowledge just means the <code>f</code> and <code>v</code> extensions cannot be present (as the <code>d</code> extension implies the <code>f</code> extension being present).</p>
<blockquote>
<p>I would expect that we'd need some sort of feature detection to select between different fiber-switching assembly sequences for different variants...</p>
</blockquote>
<p>If our assumptions above are correct, the implementation in <a href="https://github.com/bytecodealliance/wasmtime/compare/release-38.0.0...COLORADIO-Project:wasmtime:release-38.0.0">our fork</a> should do this by only using our implementation if <code>target_arch</code> is <code>riscv32</code> and <code>target_feature</code> does not include <code>f</code> or <code>v</code>. Is this what you mean by feature detection?</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/compare/release-38.0.0...COLORADIO-Project:wasmtime:release-38.0.0" style="background-image: url(&quot;https://uploads.zulipusercontent.net/ab0d2ad021ad03b8501550aa546c104f842aeea9/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f643738376638646131626235373765613864643361356431616337386566646530663462396331353363386633383132353966333231353730366139663661392f62797465636f6465616c6c69616e63652f7761736d74696d65&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/compare/release-38.0.0...COLORADIO-Project:wasmtime:release-38.0.0" title="Comparing bytecodealliance:release-38.0.0...COLORADIO-Project:release-38.0.0 · bytecodealliance/wasmtime">Comparing bytecodealliance:release-38.0.0...COLORADIO-Project:release-38.0.0 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">A lightweight WebAssembly runtime that is fast, secure, and standards-compliant - Comparing bytecodealliance:release-38.0.0...COLORADIO-Project:release-38.0.0 · bytecodealliance/wasmtime</div></div></div>



<a name="571727003"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727003" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727003">(Feb 03 2026 at 17:54)</a>:</h4>
<p>Feature-detection-wise yeah you'll want to be using <code>cfg(target_feature = "...")</code> in Rust. In theory it would be best to do runtime feature detection but that's not really suitable given the low-level nature of this crate.</p>



<a name="571727065"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727065" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727065">(Feb 03 2026 at 17:55)</a>:</h4>
<p>In theory what we'll want is something like <code>#[cfg(target_feature = "f")] compile_error!("this isn't ready for the \"f\" feature yet");</code></p>



<a name="571727100"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727100" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727100">(Feb 03 2026 at 17:55)</a>:</h4>
<p>Ah, that's just the list of builds that we check I think, but we don't want to bake in any assumptions that riscv32 == riscv32imac. I think your compile-time feature checks there make sense; let's call the arch-specific file <code>riscv32imac.rs</code> or something more specific like that</p>



<a name="571727394"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727394" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727394">(Feb 03 2026 at 17:56)</a>:</h4>
<p>I'll note though that rustc hasn't stabilized all risc-v features, so for example even the <code>riscv64gc</code> target looks like it has "f" disabled</p>



<a name="571727430"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727430" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727430">(Feb 03 2026 at 17:56)</a>:</h4>
<p>in the sense that <code>cfg(target_feature = "f")</code> isn't set</p>



<a name="571727510"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727510" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727510">(Feb 03 2026 at 17:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="253994">Alex Crichton</span> <a href="#narrow/channel/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation/near/571727394">said</a>:</p>
<blockquote>
<p>I'll note though that rustc hasn't stabilized all risc-v features, so for example even the <code>riscv64gc</code> target looks like it has "f" disabled</p>
</blockquote>
<p>that's... extremely odd and sounds like a bug? egads</p>



<a name="571727553"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727553" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727553">(Feb 03 2026 at 17:57)</a>:</h4>
<p>I don't think this is a situation we can be 100% sound right now -- with a combination of rustc not exposing features to us and there being no reasonable path to runtime feature detection all we can do is try our best to provide guard rails</p>



<a name="571727621"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727621" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727621">(Feb 03 2026 at 17:57)</a>:</h4>
<p>It's not a bug per se, it's that the <code>"f"</code> target feature name in rust isn't stable</p>



<a name="571727649"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727649" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Fallin <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727649">(Feb 03 2026 at 17:57)</a>:</h4>
<p>ah, gotcha</p>



<a name="571727830"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727830" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727830">(Feb 03 2026 at 17:58)</a>:</h4>
<p>for example <a href="https://github.com/rust-lang/rust/blob/79a1e77fe34b70de8b9b9e7c44ff251003b70aaf/compiler/rustc_target/src/target_features.rs#L608">this is stable rust right now</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/rust/blob/79a1e77fe34b70de8b9b9e7c44ff251003b70aaf/compiler/rustc_target/src/target_features.rs#L608" style="background-image: url(&quot;https://uploads.zulipusercontent.net/4fe03cc698a4e4ab4df388142eb8499faa64e251/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626661343338353632626138343835353934326335376134373439366632313731393432666263643635663635623937616637356134366663656361383131302f727573742d6c616e672f72757374&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/rust/blob/79a1e77fe34b70de8b9b9e7c44ff251003b70aaf/compiler/rustc_target/src/target_features.rs#L608" title="rust/compiler/rustc_target/src/target_features.rs at 79a1e77fe34b70de8b9b9e7c44ff251003b70aaf · rust-lang/rust">rust/compiler/rustc_target/src/target_features.rs at 79a1e77fe34b70de8b9b9e7c44ff251003b70aaf · rust-lang/rust</a></div><div class="message_embed_description">Empowering everyone to build reliable and efficient software. - rust-lang/rust</div></div></div>



<a name="571727903"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571727903" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571727903">(Feb 03 2026 at 17:58)</a>:</h4>
<p>and on <a href="https://github.com/rust-lang/rust/blob/55407b8cdb1457c62e0c852f5b53a9cf63ec4e1b/compiler/rustc_target/src/target_features.rs#L608">current <code>main</code> it's still unstable</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/rust-lang/rust/blob/55407b8cdb1457c62e0c852f5b53a9cf63ec4e1b/compiler/rustc_target/src/target_features.rs#L608" style="background-image: url(&quot;https://uploads.zulipusercontent.net/4fe03cc698a4e4ab4df388142eb8499faa64e251/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f626661343338353632626138343835353934326335376134373439366632313731393432666263643635663635623937616637356134366663656361383131302f727573742d6c616e672f72757374&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/rust-lang/rust/blob/55407b8cdb1457c62e0c852f5b53a9cf63ec4e1b/compiler/rustc_target/src/target_features.rs#L608" title="rust/compiler/rustc_target/src/target_features.rs at 55407b8cdb1457c62e0c852f5b53a9cf63ec4e1b · rust-lang/rust">rust/compiler/rustc_target/src/target_features.rs at 55407b8cdb1457c62e0c852f5b53a9cf63ec4e1b · rust-lang/rust</a></div><div class="message_embed_description">Empowering everyone to build reliable and efficient software. - rust-lang/rust</div></div></div>



<a name="571728084"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571728084" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571728084">(Feb 03 2026 at 17:59)</a>:</h4>
<p>another way to put what I'm saying, <span class="user-mention" data-user-id="1015286">@Max D.</span> feel free to send a PR with what you have. I don't think it's currently possible to be 100% correct on riscv32 at this time. We'll just have to document that riscv32 for wasmtime is incompatible with floats and that's the best we can do</p>



<a name="571743826"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Question%20about%2064-bit%20RISC-V%20fiber%20implementation/near/571743826" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max D. <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Question.20about.2064-bit.20RISC-V.20fiber.20implementation.html#571743826">(Feb 03 2026 at 19:22)</a>:</h4>
<p>Thanks a lot again for your help! We've cleaned up our git history and created a pull request on GitHub: <a href="https://github.com/bytecodealliance/wasmtime/pull/12506">https://github.com/bytecodealliance/wasmtime/pull/12506</a></p>
<p>Looking forward to any feedback on this!</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/12506" style="background-image: url(&quot;https://uploads.zulipusercontent.net/ab3b68345e39103eba8dc1bfe53bcb3ac12e6781/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f663539353936396133356531616232376532313331386231653233313261613266316632323735303234643835383235376637653066376438303565643461622f62797465636f6465616c6c69616e63652f7761736d74696d652f70756c6c2f3132353036&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/12506" title="Add fiber implementation for riscv32imac by max-dau · Pull Request #12506 · bytecodealliance/wasmtime">Add fiber implementation for riscv32imac by max-dau · Pull Request #12506 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">This adds an implementation for riscv32imac (and other architectures with identical registers) to the internal fiber crate. This enables usage of the async feature of wasmtime on such platforms.
Th...</div></div></div>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>