<html>
<head><meta charset="utf-8"><title>preferred approach to disabling more WasmFeatures? · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html">preferred approach to disabling more WasmFeatures?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="543654635"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543654635" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543654635">(Oct 08 2025 at 03:44)</a>:</h4>
<p>I'm interested in turning a few of the <code>WasmFeatures</code> off (or explicitly asserting that they're on) that are not presently plumbed through to the surface of <code>wasmtime::Config</code>. Would folks be amenable to a PR that either (a) surfaces each of the missing ones separately as yet another <code>Config::wasm_foo</code> method or (b) just marks the <code>Config::wasm_feature</code> method as <code>pub</code>?</p>
<p>the latter seems easiest to me, but I am nervous it might be read as implying to callers that they can toggle on (or off) features that wasmtime isn't actually prepared to let them toggle. or something. any thoughts?</p>



<a name="543657314"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543657314" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543657314">(Oct 08 2025 at 04:23)</a>:</h4>
<p>The main reason this wasn't done originally was the public API dependency on wasmparser, but nowadays we already have that and wasmtime's version policy is amenable to wasmparser breaking changes. I've also been not super satisfied with method-per-feature especially when it comes to feature sets like wasm{1,2,3}.</p>
<p>Basically I like the idea of exposing WasmFeatures myself. I think it'd be worth reexporting that type from the wasmtime crate for convenience too. </p>
<p>For the actual method one option might be to just expose a &amp;mut WasmFeatures accessor as opposed to a pure getter setter since bitflags have a lot of convenient methods too. Exposing wasm_feature too though also I think would be fine</p>



<a name="543657338"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543657338" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543657338">(Oct 08 2025 at 04:23)</a>:</h4>
<p>Sorry that's a lot of words for "good idea yes please!"</p>



<a name="543657441"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543657441" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543657441">(Oct 08 2025 at 04:25)</a>:</h4>
<p>weirdly enough <code>Config</code> has _two_ <code>WasmFeatures</code> subobjects -- one for things-enabled and one for things-disabled -- which are also, curiously, asserted to be disjoint. The exact nature of this perplexes me! but there is no single subobject to expose a &amp;mut to in any case. It might be worth a bigger refactor someday?</p>



<a name="543657591"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543657591" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543657591">(Oct 08 2025 at 04:27)</a>:</h4>
<p>Oh good point, method it is! The two sets are for explicit enables and explicit disables to handle how the default feature set also changes based on compiler and platform</p>



<a name="543657640"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543657640" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543657640">(Oct 08 2025 at 04:28)</a>:</h4>
<p>It might be worth having a method that's "reset to this feature set" which takes WasmFeatures and resets both sets based on the contents</p>



<a name="543664107"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543664107" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543664107">(Oct 08 2025 at 05:47)</a>:</h4>
<p>like takes foo and sets enabled = foo; disabled = !foo; ?</p>



<a name="543664135"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543664135" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543664135">(Oct 08 2025 at 05:47)</a>:</h4>
<p>(I was literally going to open a 1-token PR that adds <code>pub</code> to the existing fn)</p>



<a name="543676187"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543676187" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543676187">(Oct 08 2025 at 07:25)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/11812">https://github.com/bytecodealliance/wasmtime/pull/11812</a></p>
<p>(More than one token because it needs a doc comment)</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime/pull/11812" style="background-image: url(&quot;https://uploads.zulipusercontent.net/c8d95824df9a0facfbe61cbd3a15c353b74a7fa3/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f623538656536303461633566653734383561646237616338346436363262326537656539356633356665663561643934616231303236326465373137386366332f62797465636f6465616c6c69616e63652f7761736d74696d652f70756c6c2f3131383132&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime/pull/11812" title="Make Config::wasm_feature public. by graydon · Pull Request #11812 · bytecodealliance/wasmtime">Make Config::wasm_feature public. by graydon · Pull Request #11812 · bytecodealliance/wasmtime</a></div><div class="message_embed_description">I wanted to disable (and in some cases explicitly enable) WasmFeatures that are not currently surfaced with specific methods on Config. It seems like the simplest path is just to expose this existi...</div></div></div>



<a name="543870086"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/preferred%20approach%20to%20disabling%20more%20WasmFeatures%3F/near/543870086" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Graydon Hoare <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/preferred.20approach.20to.20disabling.20more.20WasmFeatures.3F.html#543870086">(Oct 09 2025 at 04:47)</a>:</h4>
<p><span class="user-mention" data-user-id="253994">@Alex Crichton</span> I expect you're perpetually buried in notifications so .. um I will .. add one here! .. but no pressure intended. just that I mostly made the necessary changes on this should-be-tiny PR. (and am wrapping up for the night anyway)</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>