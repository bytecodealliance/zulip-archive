<html>
<head><meta charset="utf-8"><title>wasmtime-go: host state on store context? · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html">wasmtime-go: host state on store context?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="553701913"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553701913" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553701913">(Nov 04 2025 at 19:57)</a>:</h4>
<p>In Rust, a Store&lt;T&gt; has a data method that returns T. When you create a store you can pass in arbitrary data, and then get a pointer to it later. This makes it suitable for storing store-specific state.</p>
<p>Is there something similar in wasmtime-go? Based on the package docs, it doesn't <em>appear</em> to be available. To get something similar in Go one option is to recreate the linker for each store so you can link host functions as methods on a "state" struct, but it'd be nice to reuse the linker and then access the state in host calls via, eg, <code>caller.Data()</code>.</p>
<p>Am I missing something?</p>



<a name="553702896"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553702896" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553702896">(Nov 04 2025 at 20:04)</a>:</h4>
<p>Currently this isn't supported yeah. The C API provides a <code>void*</code> pointer storage in a <code>wasmtime_store_t</code> (which is what the Go <code>Store</code> uses) which would probably be suitable for mapping an <code>interface{}</code> into similar to how linker host functions work though</p>



<a name="553703508"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553703508" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553703508">(Nov 04 2025 at 20:08)</a>:</h4>
<p>Was just looking at the store.go implementation and noticed the <code>gStoreMap</code> and the slab and so on and it seemed reasonable to attach something like <code>extra interface{}</code> to the <code>storeData</code> type and make it available via <code>Storelike.Data()</code> which the caller can cast to their own type.</p>
<p>Set it via <code>NewStoreData(engine *Engine, data any) *Store</code> maybe?</p>
<p>I know little about wasmtime internals and even less about cgo, but it seems like there's room to do this.</p>



<a name="553704741"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553704741" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553704741">(Nov 04 2025 at 20:15)</a>:</h4>
<p>oh true! It's been awhile so I forgot about this...</p>



<a name="553704749"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553704749" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553704749">(Nov 04 2025 at 20:15)</a>:</h4>
<p>but yeah adding a field to <code>storeData</code> seems reasonable!</p>



<a name="553704795"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553704795" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553704795">(Nov 04 2025 at 20:15)</a>:</h4>
<p>I'll give it a shot myself</p>



<a name="553704871"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553704871" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553704871">(Nov 04 2025 at 20:16)</a>:</h4>
<p>Been awhile since I've worked on my wasmtime go project but had some recent interest to give it another shot, so now I'm looking at general refactorings</p>



<a name="553705084"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553705084" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553705084">(Nov 04 2025 at 20:17)</a>:</h4>
<p>Currently I have a huge struct with a bunch of methods attached that I relink and have to remember to reset per instantiation, but if I can separate the struct from the functions it should be a bit cleaner..</p>



<a name="553705860"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553705860" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553705860">(Nov 04 2025 at 20:22)</a>:</h4>
<p>That'd be much appreciated, thanks!</p>



<a name="553718715"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553718715" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553718715">(Nov 04 2025 at 21:18)</a>:</h4>
<p>Ok. Got a working version. Forgot I need to fork to send a pull request. Incoming....</p>



<a name="553719018"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553719018" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553719018">(Nov 04 2025 at 21:20)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime-go/pull/260">https://github.com/bytecodealliance/wasmtime-go/pull/260</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/bytecodealliance/wasmtime-go/pull/260" style="background-image: url(&quot;https://uploads.zulipusercontent.net/2d5641e3d87ba4e34a5440d95913aa47bbf9089b/68747470733a2f2f6f70656e67726170682e6769746875626173736574732e636f6d2f323238663036653034613865363661396531613034346664363136366630383562663636366562393037343134333462663466336132343630326433396430392f62797465636f6465616c6c69616e63652f7761736d74696d652d676f2f70756c6c2f323630&quot;)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/bytecodealliance/wasmtime-go/pull/260" title="Support storing arbitrary data on Store by avidal · Pull Request #260 · bytecodealliance/wasmtime-go">Support storing arbitrary data on Store by avidal · Pull Request #260 · bytecodealliance/wasmtime-go</a></div><div class="message_embed_description">This patch introduces Storelike.Data and NewStoreWithData which can be used to attach arbitrary data to a *Store which is also accessible from *Caller.
Using this, embedders can use a shared linker...</div></div></div>



<a name="553728252"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553728252" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553728252">(Nov 04 2025 at 22:31)</a>:</h4>
<p>And merged, amazing.</p>
<p>Thanks for the quick review <span class="user-mention" data-user-id="253994">@Alex Crichton</span> !</p>



<a name="553728335"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553728335" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553728335">(Nov 04 2025 at 22:32)</a>:</h4>
<p>I guess last step is release v38.0.1?</p>



<a name="553728429"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553728429" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553728429">(Nov 04 2025 at 22:32)</a>:</h4>
<p>Mind filing an issue for that? That'll remind me to get to it tomorrow</p>



<a name="553728447"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553728447" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553728447">(Nov 04 2025 at 22:32)</a>:</h4>
<p>(winding down for the day on my end)</p>



<a name="553728478"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/wasmtime-go%3A%20host%20state%20on%20store%20context%3F/near/553728478" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vidal <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/wasmtime-go.3A.20host.20state.20on.20store.20context.3F.html#553728478">(Nov 04 2025 at 22:32)</a>:</h4>
<p>Yup, of course. No rush.</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>