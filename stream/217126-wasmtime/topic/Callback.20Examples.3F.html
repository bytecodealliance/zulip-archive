<html>
<head><meta charset="utf-8"><title>Callback Examples? · wasmtime · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/index.html">wasmtime</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Callback.20Examples.3F.html">Callback Examples?</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="533591685"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Callback%20Examples%3F/near/533591685" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Callback.20Examples.3F.html#533591685">(Aug 09 2025 at 17:29)</a>:</h4>
<p>Hey all, I'm trying to mess around with hacking together some WIT interfaces / worlds for reactive user interfaces. Since async / streams are not currently stable (and I'm also not sure whether or not they are the most appropriate API for my use case anyway), I'm trying to hack something together using callbacks for right now.</p>
<p>I've gotten pretty far, but I'm running into a <code>wasm trap: cannot enter component instance</code> and I'm unsure how to proceed. So I was wondering if there were any examples already out there of what I'm trying to do.</p>
<p>Basically to hack callbacks in the current component model, I'm importing a register callback function (<code>add-on-update-handler: func(callback-id: callback-id);</code>), and exporting a function to actually call the callback in the guest (<code>call-callback: func(callback-id: callback-id, arg: any);</code>).</p>



<a name="533601853"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Callback%20Examples%3F/near/533601853" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Callback.20Examples.3F.html#533601853">(Aug 09 2025 at 21:10)</a>:</h4>
<p>it sounds like you're just running into the reentrancy problem. You are probably calling a guest function which in turn asks a host function for an asynchronous response, but your host function tries to respond immediately. In js I do setImmediate(() =&gt; { respond(id, data) }) so that the respond guest function is called the next frame instead of directly reentering</p>



<a name="533601952"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Callback%20Examples%3F/near/533601952" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ramon Klass <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Callback.20Examples.3F.html#533601952">(Aug 09 2025 at 21:13)</a>:</h4>
<p>wasm only has one stack. The guest has called your host function and the stack is alive at least until your host function returns. If your host function now wouold call another wasm function, then wasm would have to create a second stack that is independent from the first stack and that is not allowed</p>



<a name="533602351"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/217126-wasmtime/topic/Callback%20Examples%3F/near/533602351" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/217126-wasmtime/topic/Callback.20Examples.3F.html#533602351">(Aug 09 2025 at 21:22)</a>:</h4>
<p>Hmm... Ok, I guess I'll play around with when the callbacks are invoked to see if I can get around that.</p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>