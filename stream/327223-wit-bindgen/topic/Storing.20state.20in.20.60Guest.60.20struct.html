<html>
<head><meta charset="utf-8"><title>Storing state in `Guest` struct · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html">Storing state in `Guest` struct</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="532374756"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532374756" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan H <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532374756">(Aug 01 2025 at 20:32)</a>:</h4>
<p>Hi, all. I am wondering what the best way to store state in the <code>Guest</code> struct is when implementing the <code>Guest</code> trait after <code>wit_bindgen::generate</code>.</p>
<p>Ideally I would be able to define fields in the struct for which I am defining the <code>impl</code>. However, there is no <code>self</code> paramter. All the functions are associated functions. Is the only option to store state in global variables?</p>
<p>Thank you.</p>



<a name="532376296"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532376296" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532376296">(Aug 01 2025 at 20:44)</a>:</h4>
<p>Yes you'll have to use global state because these are global functions</p>



<a name="532382993"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532382993" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan H <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532382993">(Aug 01 2025 at 21:44)</a>:</h4>
<p>Do you happen to have any examples for a good convention for that? Or is it just something like <code>OnceCell</code> with a mutex?</p>



<a name="532460765"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532460765" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532460765">(Aug 02 2025 at 14:48)</a>:</h4>
<p>Hey all. Random question: I'm curious what the general performance characteristics are of passing resource types between components. Can it be expected to be fairly fast?</p>
<p>I'm just wondering because I'm used to the JNI, where doing similar things is generally considered to be fairly slow. Is the situation better for WASM?</p>
<p>The larger motivation behind this is I'm trying to figure out the most efficient way to design a wit world for multi-platform UI development. Currently in my prototype I have a resource type for views basically, but I'm wondering if that's the right approach, or if I should try something else (e.x. passing a single representation of the entire UI layout in a single call by value -- so using something like a DOM represented with variants / records basically).</p>
<p>I know I won't get a more concrete answer until I bench this myself, but I'm curious if anyone had any general thoughts.</p>



<a name="532461964"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532461964" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nathan Bedell <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532461964">(Aug 02 2025 at 15:02)</a>:</h4>
<p>Oof, sorry. New to zulip. I think I should have made a new topic for this. :(</p>



<a name="532465823"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532465823" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celarye <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532465823">(Aug 02 2025 at 15:49)</a>:</h4>
<p>I had the same question and if I understand it correctly we should be able to use <a href="https://component-model.bytecodealliance.org/design/wit.html#resources">resources</a> for this. The Rust example in this book has a <a href="https://component-model.bytecodealliance.org/language-support/rust.html#using-them">section on implementing resources</a>.</p>



<a name="532466765"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532466765" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celarye <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532466765">(Aug 02 2025 at 16:01)</a>:</h4>
<p>I broke the second link, it should be <a href="https://component-model.bytecodealliance.org/language-support/rust.html#using-resources">https://component-model.bytecodealliance.org/language-support/rust.html#using-resources</a>.</p>



<a name="532479287"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/Storing%20state%20in%20%60Guest%60%20struct/near/532479287" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celarye <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/Storing.20state.20in.20.60Guest.60.20struct.html#532479287">(Aug 02 2025 at 18:53)</a>:</h4>
<p>Nevermind, global variables are probably better for this <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<hr><p>Last updated: Oct 25 2025 at 23:03 UTC</p>
</html>