<html>
<head><meta charset="utf-8"><title>variant type is omitted if not used · wit-bindgen · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/index.html">wit-bindgen</a></h2>
<h3>Topic: <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/variant.20type.20is.20omitted.20if.20not.20used.html">variant type is omitted if not used</a></h3>

<hr>

<base href="https://bytecodealliance.zulipchat.com">

<head><link href="https://bytecodealliance.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="538576373"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/variant%20type%20is%20omitted%20if%20not%20used/near/538576373" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> anb <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/variant.20type.20is.20omitted.20if.20not.20used.html#538576373">(Sep 10 2025 at 06:34)</a>:</h4>
<p>Hi, I'm not sure if this is intended, but giving the follow snippet, the compiler will "no <code>Foo</code> in <code>my::test::test</code>" unless the <code>test-fn</code> is uncommented. And this only applies to <code>variant</code> but not <code>enum</code>.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">wit_bindgen</span><span class="p">::</span><span class="n">generate</span><span class="o">!</span><span class="p">({</span>
<span class="w">    </span><span class="n">inline</span><span class="p">:</span><span class="w"> </span><span class="nc">r</span><span class="s">"</span>
<span class="s">        package my:test;</span>

<span class="s">        interface test {</span>
<span class="s">            variant foo {</span>
<span class="s">                a,</span>
<span class="s">            }</span>
<span class="s">            enum bar {</span>
<span class="s">                a,</span>
<span class="s">            }</span>
<span class="s">            /// test-fn: func(val: foo);</span>
<span class="s">        }</span>

<span class="s">        world the-world {</span>
<span class="s">            import test;</span>
<span class="s">        }</span>
<span class="s">    "</span><span class="p">,</span>
<span class="p">});</span>

<span class="k">use</span><span class="w"> </span><span class="n">my</span><span class="p">::</span><span class="n">test</span><span class="p">::</span><span class="n">test</span><span class="p">::</span><span class="n">Bar</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">my</span><span class="p">::</span><span class="n">test</span><span class="p">::</span><span class="n">test</span><span class="p">::</span><span class="n">Foo</span><span class="p">;</span>
</code></pre></div>



<a name="538669183"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/variant%20type%20is%20omitted%20if%20not%20used/near/538669183" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/variant.20type.20is.20omitted.20if.20not.20used.html#538669183">(Sep 10 2025 at 14:37)</a>:</h4>
<p>This is expected, but if you don't want this behavior you can pass <code>generate_unused_types: true</code> to the macro (documented <a href="https://docs.rs/wit-bindgen/latest/wit_bindgen/macro.generate.html">here</a>)</p>



<a name="538674191"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/variant%20type%20is%20omitted%20if%20not%20used/near/538674191" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> anb <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/variant.20type.20is.20omitted.20if.20not.20used.html#538674191">(Sep 10 2025 at 14:56)</a>:</h4>
<p>Thank you Alex, as always. How could I miss the obvious setting, and was also looking at the wrong docs at <a href="https://docs.rs/wasmtime/36.0.2/wasmtime/component/macro.bindgen.html">wasmtime/component/bindgen</a>.</p>
<p>Edit: Looks like the option works only for the guest(wit-bindgen), but not the host(wasmtime::component::bindgen).</p>



<a name="538675829"></a>
<h4><a href="https://bytecodealliance.zulipchat.com#narrow/stream/327223-wit-bindgen/topic/variant%20type%20is%20omitted%20if%20not%20used/near/538675829" class="zl"><img src="https://bytecodealliance.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://bytecodealliance.github.io/zulip-archive/stream/327223-wit-bindgen/topic/variant.20type.20is.20omitted.20if.20not.20used.html#538675829">(Sep 10 2025 at 15:03)</a>:</h4>
<p>It's true yeah the two codebases have diverged over time and while we try to keep them similar they aren't the exact same</p>



<hr><p>Last updated: Feb 22 2026 at 11:05 UTC</p>
</html>